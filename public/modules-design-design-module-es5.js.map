{"version":3,"sources":["webpack:///node_modules/angular-split/__ivy_ngcc__/fesm2015/angular-split.js","webpack:///node_modules/jsplumb/dist/js/jsplumb.js","webpack:///src/app/modules/design/design-routing.module.ts","webpack:///src/app/modules/design/design.component.ts","webpack:///src/app/modules/design/design.component.html","webpack:///src/app/modules/design/design.module.ts","webpack:///src/app/modules/design/node.component.ts","webpack:///src/app/modules/design/node.component.html","webpack:///src/app/modules/design/node.service.ts","webpack:///src/app/modules/design/nodes-container/nodes-container.component.ts","webpack:///src/app/modules/design/nodes-container/nodes-container.component.html","webpack:///src/app/modules/design/workflow-node-details/workflow-node-details.component.ts","webpack:///src/app/modules/design/workflow-node-details/workflow-node-details.component.html","webpack:///src/app/modules/design/workflow-studio-root/workflow-studio-root.component.ts","webpack:///src/app/modules/design/workflow-studio-root/workflow-studio-root.component.html"],"names":["_c0","SplitComponent_ng_template_1_div_0_Template","rf","ctx","_r6","SplitComponent_ng_template_1_div_0_Template_div_mousedown_0_listener","$event","index_r1","index","ctx_r5","startDragging","SplitComponent_ng_template_1_div_0_Template_div_touchstart_0_listener","ctx_r8","SplitComponent_ng_template_1_div_0_Template_div_mouseup_0_listener","ctx_r10","clickGutter","SplitComponent_ng_template_1_div_0_Template_div_touchend_0_listener","ctx_r12","ctx_r3","gutterSize","SplitComponent_ng_template_1_Template","last_r2","last","_c1","getPointFromEvent","event","changedTouches","undefined","length","x","clientX","y","clientY","getElementPixelSize","elRef","direction","rect","nativeElement","getBoundingClientRect","width","height","getInputBoolean","v","getInputPositiveNumber","defaultValue","Number","isNaN","isUserSizesValid","unit","sizes","total","reduce","s","every","filter","getAreaMinSize","a","size","component","lockSize","minSize","getAreaMaxSize","maxSize","getGutterSideAbsorptionCapacity","sideAreas","pixels","allAreasSizePixel","acc","area","res","getAreaAbsorptionCapacity","remain","list","push","pixelRemain","areaSnapshot","pixelAbsorb","percentAfterAbsorption","sizePercentAtStart","sizePixelAtStart","getAreaAbsorptionCapacityPercent","getAreaAbsorptionCapacityPixel","tempPixelSize","tempPercentSize","maxSizePixel","minSizePixel","containerSizePixel","updateAreaSize","item","SplitComponent","ngZone","cdRef","renderer","_direction","_unit","_gutterSize","_gutterStep","_restrictMove","_useTransition","_disabled","_dir","_gutterDblClickDuration","dragStart","dragEnd","gutterClick","gutterDblClick","dragProgressSubject","dragProgress$","asObservable","isDragging","dragListeners","snapshot","startPoint","endPoint","displayedAreas","hidedAreas","_clickTimeout","runOutsideAngular","setTimeout","addClass","newArea","order","visible","build","some","find","splice","indexOf","resetOrders","resetSizes","areas","comp","forEach","map","formatedSizes","isValid","i","_size","stopDragging","sort","b","setStyleOrder","useUserSizes","defaultSize","wildcardSizeAreas","alreadyGotOne","refreshStyleSizes","markForCheck","setStyleFlex","sumGutterSize","getNbGutters","gutterNum","tempPoint","window","clearTimeout","notify","gutterDblClickDuration","gutterOrder","preventDefault","stopPropagation","disabled","lastSteppedOffset","allInvolvedAreasSizePercent","areasBeforeGutter","areasAfterGutter","restrictMove","unshift","t","listen","bind","dragEvent","lockEvents","gutterEls","toArray","offset","dir","steppedOffset","Math","round","gutterStep","areasBefore","areasAfter","abs","all","areaToReset","unlockEvents","fct","pop","removeClass","type","getVisibleAreaSizes","emit","transitionEndSubscriber","run","next","setAttribute","subscriber","pipe","ɵfac","SplitComponent_Factory","ɵcmp","selectors","viewQuery","SplitComponent_Query","_t","inputs","useTransition","outputs","transitionEnd","exportAs","ngContentSelectors","decls","vars","consts","template","SplitComponent_Template","directives","styles","changeDetection","ctorParameters","propDecorators","args","selector","OnPush","SplitAreaDirective","split","_order","_minSize","_maxSize","_lockSize","_visible","lockListeners","addArea","transitionListener","propertyName","value","setStyle","grow","shrink","basis","isMin","isMax","e","removeArea","updateArea","showArea","hideArea","SplitAreaDirective_Factory","ɵdir","AngularSplitModule","ngModule","providers","ɵmod","ɵinj","factory","AngularSplitModule_Factory","imports","ngJitMode","declarations","exports","root","sgn","Vectors","subtract","v1","v2","dotProduct","square","sqrt","scale","maxRecursion","flatnessTolerance","pow","_distanceFromCurve","point","curve","candidates","w","_convertToBezier","degree","higherDegree","numSolutions","_findRoots","dist","_bezier","newDist","location","distance","_nearestPointOnCurve","td","c","d","cdTable","z","row","column","parseFloat","n","m","k","lb","max","ub","min","j","depth","left","right","left_count","right_count","left_t","right_t","_getCrossingCount","_isFlatEnough","_computeXIntercept","n_crossings","sign","old_sign","error","intercept_1","intercept_2","left_intercept","right_intercept","det","dInv","a1","b1","c1","a2","b2","c2","max_distance_above","max_distance_below","XLK","YLK","XNM","YNM","XMK","YMK","detInv","S","temp","_curveFunctionCache","_getCurveFunctions","fns","f_term","l_term","c_term","t_term","one_minus_t_term","_termFunc","terms","p","_pointOnPath","cc","_x","_y","_dist","p1","p2","_isPoint","_pointAlongPath","prev","tally","curLoc","cur","_length","Date","getTime","console","log","_pointAlongPathFrom","_locationAlongPathFrom","_gradientAtPoint","slice","dy","dx","Infinity","atan","_gradientAtPointAlongPathFrom","_perpendicularToPathAt","_theta2","sin","cos","_lineIntersection","x1","y1","x2","y2","coeffs","_computeCoefficients","r","_cubicRoots","apply","intersections","t2","t3","_boxIntersection","h","_boundingBoxIntersection","boundingBox","_computeCoefficientsForAxis","axis","A","B","C","Q","R","D","T","th","acos","PI","jsBezier","distanceFromCurve","gradientAtPoint","gradientAtPointAlongCurveFrom","nearestPointOnCurve","pointOnCurve","pointAlongCurveFrom","perpendicularToCurveAt","locationAlongCurveFrom","getLength","lineIntersection","boxIntersection","boundingBoxIntersection","version","call","Biltong","_isa","Object","prototype","toString","_pointHelper","fn","_gradient","gradient","_p1","_p2","_normal","normal","_lineLength","lineLength","_quadrant","quadrant","_theta","theta","_intersects","intersects","r1","r2","_encloses","encloses","allowSharedEdges","v3","v4","_segmentMultipliers","_inverseSegmentMultipliers","_pointOnLine","pointOnLine","fromPoint","toPoint","segmentMultiplier","_perpendicularLineTo","perpendicularLineTo","theta2","_touch","view","target","pageX","pageY","screenX","screenY","Touch","identifier","_uuid","_touchList","Array","arguments","_touchAndList","matchesSelector","el","parentNode","possibles","querySelectorAll","_gel","constructor","String","document","getElementById","srcElement","_pi","obj","doCompute","path","end","out","_one","_d","l","guid","_store","g","__ta","__tauid","_unstore","__taExtra","_unbind","__taUnstore","_curryChildFilter","children","evt","_fn","pathInfo","registerExtraFunction","newFn","DefaultHandler","isTouchDevice","touchMap","tfn","_bind","getAttribute","SmartClickHandler","__taSmartClicks","down","__tad","_pageLocation","up","__tau","click","_tapProfiles","touches","taps","TapHandler","clickThreshold","dblClickThreshold","isMouseDevice","__taTapHandler","tt","tap","dbltap","contextmenu","downSelectors","finished","clearSingle","clearDouble","currentTarget","tc","_touchCount","eventId","hasOwnProperty","pLoop","meeHelper","__tamee","MouseEnterExitHandler","activeElements","over","mouseenter","mouseexit","relatedTarget","toElement","documentElement","navigator","maxTouchPoints","touchstart","touchend","touchmove","iev","rv","appName","ua","userAgent","re","RegExp","exec","$1","isIELT9","_genLoc","prefix","ts","_touches","_getTouch","scrollLeft","scrollTop","_screenLocation","_clientLocation","idx","targetTouches","originalFn","addEventListener","attachEvent","key","_each","_el","removeEventListener","detachEvent","__taTouchProxy","Window","top","tagName","replace","random","Mottle","params","mouseEnterExitHandler","tapHandler","_smartClicks","smartClicks","_doBind","remove","removeChild","on","_c","_e","_f","off","trigger","originalEvent","payload","originalIsMouse","MouseEvent","eventToBind","bindingAMouseEvent","pl","sl","cl","_decorate","_evt","eventGenerators","touchList","init","initTouchEvent","initEvent","initMouseEvent","createEvent","ite","evtName","dispatchEvent","createEventObject","eventType","eventName","fireEvent","consume","doNotPreventDefault","returnValue","pageLocation","setForceTouchEvents","setForceMouseEvents","_suggest","head","_vanquish","_difference","l1","l2","_isString","f","getOffsetRect","elem","box","body","docElem","pageYOffset","pageXOffset","clientTop","clientLeft","findDelegateElement","parentElement","childElement","currentParent","findMatchingSelector","availableSelectors","draggableId","matches","exclude","filterExclude","DEFAULT_GRID_X","DEFAULT_GRID_Y","isIE9","_pl","_classes","delegatedDraggable","draggable","droppable","drag","selected","active","hover","noSelect","ghostProxy","clonedDrag","_defaultScope","_events","_devNull","_true","_foreach","from","_setDroppablesActive","dd","val","andHover","setActive","updatePosition","setHover","_consume","_defaultInputFilterSelector","_inputFilter","_katavorio","getInputFilterSelector","Super","css","scope","_class","uuid","enabled","setEnabled","isEnabled","toggleEnabled","setScope","scopes","addScope","removeScope","toggleScope","katavorio","TRUE","FALSE","Drag","rightButtonCanDrag","downAt","posAtDown","pagePosAtDown","pageDelta","moving","initialScroll","consumeStartEvent","dragEl","clone","scroll","_multipleDrop","multipleDrop","isConstrained","useGhostProxy","cloneNode","elementToDrag","activeSelectorParams","ghostProxyParent","currentParentPosition","ghostParentPosition","ghostDx","ghostDy","snapThreshold","_snap","pos","gridX","gridY","thresholdX","thresholdY","_dx","floor","_dxl","_dxt","_dy","_dyl","_dyt","posses","posseRoles","toGrid","grid","tx","ty","snap","getPosition","snapped","setPosition","setUseGhostProxy","constrain","negativeFilter","allowNegative","_setConstrain","_constrainRect","containment","setConstrain","revertFunction","setRevert","revert","_assignId","_katavorioId","_filters","_testFilter","_setFilter","setFilter","_exclude","_addFilter","addFilter","_removeFilter","removeFilter","clearAllFilters","canDrag","constrainRect","matchingDroppables","intersectingDroppables","addSelector","downListener","defaultPrevented","isNotRightClick","which","button","match","style","position","parent","appendChild","moveListener","upListener","markSelection","markPosses","_dispatch","consumeFilteredEvents","_continue","mark","abort","ignoreZoom","getZoom","moveBy","updateSelection","updatePosses","unbind","unmark","unmarkSelection","unmarkPosses","stop","notifyPosseDragStop","getFilters","getDragElement","retrieveOriginalElement","listeners","events","start","beforeStart","result","notifyStart","force","positions","sel","getSelection","dPos","ghostProxyOffsets","finalPos","selection","andNotify","getSize","getMatchingDroppables","dragClass","cs","getConstrainingRectangle","notifySelectionDragStart","doNotCheckDroppables","offsetLeft","offsetTop","_rankSort","retVal","drop","desiredLoc","cPos","gp","pageRect","focusDropElement","pagePosition","canDrop","isHover","destroy","handle","Drop","rank","_activeClass","activeClass","_hoverClass","hoverClass","allowLoopback","_katavorioDragHover","Katavorio","katavorioParams","_selection","_selectionMap","_dragsByScope","_dropsByScope","_zoom","_reg","_obj","_unreg","_getMatchingDroppables","_m","_dd","_prepareParams","_p","_mistletoe","existingDrag","_css","overrideCss","_scope","inputFilterSelector","setInputFilterSelector","o","_katavorioDrag","_katavorioDrop","select","deselect","_s","deselectAll","_posses","members","_posseAction","notifySelectionDragStop","setZoom","_scopeManip","kObj","_kObj","snapToGrid","getDragsForScope","getDropsForScope","_destroy","selIdx","_removeListener","elementRemoved","destroyDraggable","destroyDroppable","reset","_processOneSpec","_spec","dontAddExisting","posseId","id","posse","name","addToPosse","spec","setPosse","diff","removeFromPosse","TypeError","removeFromAllPosses","setPosseState","state","jsPlumbUtil","isArray","isNumber","isString","isBoolean","isNull","isObject","isDate","isFunction","isNamedFunction","isEmpty","merge","collations","overwrites","cMap","ar","oMap","inObj","q","term","lc","str","array","_getArray","a_1","functionChain","successValue","failValue","populate","model","values","functionPrefix","doNotExpandFunctions","getValue","fromString","substring","findWithFunction","removeWithFunction","addWithFunction","hashFunction","addToList","insertAtStart","suggest","insertAtHead","extend","child","_protoFn","_copyProtoChain","focus","proto","__proto__","_makeFn","protoFn","_oneSet","lut","d0","d1","d2","d3","fastTrim","ws","test","charAt","each","mergeWithParents","parentAttribute","_def","_parent","def","overrides","mergeStrategy","d_1","_getDef","done","logEnabled","_i","msg","wrap","wrappedFunction","newFunction","returnOnThisValue","EventGenerator","_this","_listeners","eventsSuspended","tick","eventsToDieOn","queue","listener","__jsPlumb","fire","_gone","ret","shouldFireEvent","_drain","eventOrListener","getListener","forEvent","setSuspendEvents","isSuspendEvents","silently","cleanupListeners","sizeElement","DEFAULT_OPTIONS","deriveAnchor","edge","ep","conn","bottom","ListManager","jsPlumbInstance","count","instance","lists","options","addList","listManager","removeList","scrollableLists","getSelector","_maybeUpdateParentList","source","jsPlumbListManager","dp","getInstanceIndex","join","List","_jsPlumbList","container","getContainer","_jsPlumbScrollHandler","anchor","deriveEndpoint","endpoint","_maybeUpdateDraggable","hasClass","recalculateOffsets","scrollHandler","elId","getId","_jsPlumbProxies","proxyConnection","endpoints","offsetHeight","unproxyConnection","revalidate","_ju","_timestamp","_updateHoverStyle","_jsPlumb","paintStyle","hoverPaintStyle","mergedHoverStyle","jsPlumb","fill","eventFilters","_updateAttachedElements","timestamp","sourceElement","affectedElements","getAttachedElements","_splitType","_mapType","typeId","_applyTypes","doNotRepaint","getDefaultType","getTypeDescriptor","defType","types","tid","getType","applyType","repaint","jsPlumbUIComponent","self","idPrefix","parameters","paintStyleInUse","beforeDetach","beforeDrop","overlayPlacements","Defaults","HoverClass","typeCache","cacheTypeItem","getCachedTypeItem","overlays","oo","defaultOverlayKeys","fo","convertToFullOverlaySpec","_defaultType","getDefaultScope","appendToDefaultType","create","isDetachAllowed","connection","isDropAllowed","sourceId","targetId","dropEndpoint","checkCondition","domListeners","setListenerComponent","_removeTypeCssHelper","typeIndex","cssClass","canvas","getParameter","setParameter","getParameters","setParameters","getClass","clazz","updateClasses","classesToAdd","classesToRemove","setType","clearTypes","reapplyTypes","hasType","addType","_cont","removeType","toggleType","setPaintStyle","setHoverPaintStyle","getPaintStyle","getHoverPaintStyle","ignoreAttachedElements","currentlyDragging","isHoverSuspended","method","isSuspendDrawing","recalc","_jsPlumbInstanceIndex","_defaults","Anchor","Anchors","ConnectionsDetachable","ConnectionOverlays","Connector","Container","DoNotThrowErrors","DragOptions","DropOptions","Endpoint","EndpointOverlays","Endpoints","EndpointStyle","EndpointStyles","EndpointHoverStyle","EndpointHoverStyles","HoverPaintStyle","LabelStyle","color","ListStyle","LogEnabled","Overlays","MaxConnections","PaintStyle","stroke","ReattachConnections","RenderMode","Scope","_connectionTypes","_endpointTypes","_currentInstance","_instanceIndex","_bb","_initialDefaults","_info","nodeType","text","getElement","_getId","repaintEverything","_container","_containerDelegations","unbindContainer","setContainer","moveParent","selectEndpoints","previousContainer","eventAliases","_oneDelegateHandler","componentType","jp","alias","_addOneDelegate","_oneDelegate","managedElements","initialized","importDefaults","restoreDefaults","connections","endpointsByElement","endpointsByUUID","offsets","offsetTimestamps","draggableStates","connectionBeingDragged","_suspendDrawing","_suspendedAt","DEFAULT_SCOPE","_curIdStamp","_idstamp","_appendElement","appendToRoot","_draw","element","ui","clearEdits","repaintEls","_updateOffset","anchorManager","redraw","_getEndpoint","_scopeMatch","e1","e2","s1","s2","_mergeOverrides","_prepareConnectionParams","referenceParams","sourceEndpoint","targetEndpoint","uuids","isFull","connectionType","connectorOverlays","connectorPointerEvents","_addEndpoint","anchors","endpointStyles","endpointStyle","endpointHoverStyles","endpointHoverStyle","addEndpoint","_oneElementDef","defs","matchType","newConnection","tep","epDef","label","newEndpoint","uniqueEndpoint","setDeleteOnEmpty","finalEndpoint","sourceEndpointDefinitions","targetEndpointDefinitions","_newConnection","connectionFunc","ConnectionType","getDefaultConnectionType","_newEndpoint","finaliseConnection","_finaliseConnection","con","isDetachable","initDraggable","jpc","doInformAnchorManager","suspendedEndpoint","pending","isTemporarySource","router","doNotFireConnectionEvent","eventArgs","endpointFunc","EndpointType","fireDetachEvent","elementId","_manage","headless","getDragManager","endpointAdded","_operation","func","ii","jj","_setDraggable","isDragSupported","setElementDraggable","_setVisible","alsoChangeEndpoints","setVisible","info","oidx","isVisible","_toggleVisible","changeEndpoints","_getCachedData","doNotCreateIfNotFound","setConnectionBeingDragged","isConnectionBeingDragged","getManagedElements","connectorClass","connectorOutlineClass","connectedClass","endpointClass","endpointConnectedClass","endpointFullClass","endpointDropAllowedClass","endpointDropForbiddenClass","overlayClass","draggingClass","elementDraggingClass","sourceElementDraggingClass","targetElementDraggingClass","endpointAnchorClassPrefix","hoverSourceClass","hoverTargetClass","dragSelectClass","Connectors","ConnectorRenderers","SVG","results","_ensureContainer","myOffset","paint","anchorLoc","compute","xy","wh","addEndpoints","animate","properties","animationSupported","del","stepFunction","animEvents","step","completeFunction","complete","doAnimate","conditionName","connect","stTypes","epDefs","_set","_st","cId","cEl","sid","sep","oldEndpoint","evtParams","originalSourceId","newSourceId","originalTargetId","newTargetId","addConnection","makeEndpoint","detachFromConnection","fireMoveEvent","setSource","sourceOrTargetChanged","setTarget","deleteEndpoint","object","dontUpdateHover","deleteAttachedObjects","deleteObject","deleteEveryEndpoint","_is","setSuspendDrawing","dm","doFireEvent","connType","argIsConnection","connectionDetached","unregisterEndpoint","newEndpoints","IS_DETACH_ALLOWED","BEFORE_DETACH","CHECK_CONDITION","deleteConnection","cleanup","deleteEveryConnection","deletedCount","batch","deleteConnectionsForElement","endpointCount","connectionCount","unravelConnection","unravelEndpoint","doNotCleanup","_setOperation","_getOperation","setter","getter","prepareList","input","doNotGetIds","filterList","missingIsFalse","getConnections","flat","sources","targets","_addOne","ss","proxies","originalEp","_curryEach","executor","_curryGet","_makeCommonSelectHandler","get","setters","getters","_makeConnectionSelectHandler","common","setDetachable","setReattach","setConnector","isReattach","_makeEndpointSelectHandler","setAnchor","noElementFilters","elements","either","sourceMatchExact","targetMatchExact","inner","_ep","noMatchSource","isSource","noMatchTarget","isTarget","getAllConnections","getEndpoint","getEndpoints","getDefaultEndpointType","Connection","draw","appendElement","_hoverSuspended","setHoverSuspended","hide","idstamp","candidate","can","offsetParent","_getContainerFromDefaults","manage","_transient","_recalc","_unmanage","unmanage","getOffset","centerx","centery","updateOffset","DefaultRouter","makeAnchor","pp","_a","specimen","newAnchor","getOrientation","DynamicAnchor","anchorParams","orientation","makeAnchors","makeDynamicAnchor","anchorSelector","selectorFilter","_instance","negate","ok","_makeElementDropHandler","elInfo","dropOptions","proxyComponent","_drop","EndpointDropHandler","targetCount","maxConnections","onDrop","unlock","isRedrop","suspendedElement","eps","deriveEndpointAndAnchorSpec","_mtNew","positionFinder","dropPosition","getUIPosition","elPosition","elSize","ap","constructorParams","maybeCleanup","dropEvent","dragEvents","_drag","de","_jsPlumbRelatedElement","initDroppable","makeTarget","_doOne","elid","_isJsPlumbGroup","createEndpoint","targetDef","unmakeTarget","doNotClearArrays","makeSource","aae","onMaxConnections","_del","stopEvent","dragOptions","existingStop","endpointAddedButNoDragYet","anchorDef","oldAnchor","oldConnection","mouseDownListener","sourceCount","elxy","getPositionOnElement","tempEndpointParams","_delTempEndpoint","extract","att","setDragFilter","unmakeSource","eldefs","unmakeEverySource","_getScope","_setScope","getScope","getSourceScope","getTargetScope","setSourceScope","setTargetScope","setDragScope","setDropScope","unmakeEveryTarget","_setEnabled","toggle","originalState","newState","_first","toggleSourceEnabled","isSourceEnabled","setSourceEnabled","toggleTargetEnabled","isTargetEnabled","setTargetEnabled","ready","_elEach","isIdAlready","updateOffsets","removeAllEndpoints","recurse","ebe","childNodes","_doRemove","floatingConnections","removeElement","ae","empty","dontRemoveFocus","doNotUnbindInstanceEventListeners","removeAllGroups","removeGroupManager","doReset","_clearObject","clear","setDefaultScope","dontPrependDefault","bits","as","setId","newId","doNotSetAttribute","sConns","tConns","setElementId","setReferenceElement","changeId","_conns","epIdx","setDebugLog","debugLog","repaintAfterwards","curVal","getSuspendedAt","doNotRepaintAfterwards","_wasSuspended","doWhileSuspended","getCachedData","show","toggleVisible","addListener","registerFloatingConnection","getFloatingConnectionFor","registerConnectionType","to","registerConnectionTypes","registerEndpointType","registerEndpointTypes","typeDescriptor","setIdChanged","oldId","setParent","newParent","_dom","_id","_pdom","_pid","o1","o2","names","getFloatingAnchorIndex","isFloating","proxyEl","proxyElId","endpointGenerator","anchorGenerator","proxyEp","originalElementId","originalEndpoint","isProxyEndpoint","originalElement","getInstance","overrideFns","ovf","_jp","_internalLabelOverlayId","_makeLabelOverlay","_params","labelStyle","mergedParams","getRenderMode","Label","_processOverlay","_newOverlay","OverlayCapableJsPlumbUIComponent","overlayPositions","labelLocation","defaultLabelLocation","keep","existing","updateFrom","reattach","addOverlay","removeOverlay","overlay","getData","locationAttribute","labelLocationAttribute","loc","getOverlay","getOverlays","hideOverlay","hideOverlays","showOverlay","showOverlays","removeAllOverlays","overlayId","dontCleanup","removeOverlays","bgCanvas","isAppendedAtTopLevel","getLabel","lo","getLabelOverlay","setLabel","Function","setLocation","setAbsoluteOverlayPosition","getAbsoluteOverlayPosition","_clazzManip","action","dontUpdateOverlays","_makeConnectionDragHandler","placeholder","stopped","_ui","anchorPoint","getCurrentLocation","stopDrag","_makeDraggablePlaceholder","ipco","ips","createElement","_makeFloatingEndpoint","referenceAnchor","referenceCanvas","floatingAnchor","FloatingAnchor","reference","typeParameters","findConnectionToUseForDynamicAnchor","elementWithPrecedence","connectorStyle","connectorHoverStyle","connectorHoverClass","connector","connectorTooltip","floatingEndpoint","inPlaceCopy","dragProxy","connectionCost","connectionsDirected","currentAnchorClass","deleteOnEmpty","_updateAnchorClass","oldAnchorClass","getCssClass","anchorClass","prepareAnchor","currentAnchor","setPreparedAnchor","continuousAnchorFactory","internalHover","add","prepareEndpoint","rm","endpointArgs","tooltip","setEndpoint","setPreparedEndpoint","reattachConnections","connectionsDetachable","detachable","dragAllowedWhenFull","detachFrom","setElement","parentId","curId","rehomeEndpoint","dragManager","makeInPlaceCopy","inPlaceAnchor","hideOnDrag","connectorSelector","connectorPaintStyle","dimensions","isDynamic","oIdx","oId","oInfo","oOffset","oWH","txy","twh","tElement","draggingInitialised","placeholderInfo","existingJpc","existingJpcParams","_dragHandler","defaultOpts","startEvent","beforeStartEvent","beforeStartParams","startParams","beforeDrag","canvasElement","setAttributes","endpointToFloat","centerAnchor","_savedAnchor","data","anchorIdx","dragScope","getDragScope","suspendedElementId","suspendedElementType","referenceEndpoint","getDropEvent","deleteConnectionNow","floatingElement","floatingId","floatingIndex","fe","_forceReattach","_forceDetach","deleteAfterDragStop","visibility","anchorParamsToUse","_initDropTarget","isTransient","isDropSupported","overEvent","outEvent","dhParams","getDragObject","_jpc","bb","doNotChangeConnections","doNotNotifyOtherEndpoint","display","isConnectedTo","found","getConnectionCost","setConnectionCost","areConnectionsDirected","setConnectionsDirected","_elId","setDragAllowedWhenFull","allowed","equals","getUuid","computeAnchor","existingConnection","_doContinue","continueFunction","optionalData","aParam","originalSourceEndpoint","newSourceEndpoint","originalTargetEndpoint","newTargetEndpoint","_toDelete","mergeData","dontContinueFunction","makeConnector","renderMode","connectorName","connectorArgs","forComponent","_makeAnchor","_updateConnectedClass","_jsPlumbConnections","previousConnection","editorParams","lastPaintedAt","definition","eS","eT","deleteEndpointsOnEmpty","_detachable","_reattach","myInfo","myWH","otherInfo","otherOffset","otherWH","initialTimestamp","cost","directed","setData","_types","updateConnectedClass","typeMap","_connector","prepareConnector","setPreparedConnector","_anchors","informEndpoints","getUuids","getCost","setCost","isDirected","getConnector","connectorSpec","doNotChangeListenerComponent","previous","previousClasses","transfer","swap","tId","sId","tIdx","sIdx","sourceInfo","targetInfo","sE","tE","sAnchorP","tAnchorP","resetBounds","sourcePos","targetPos","sourceOrientation","targetOrientation","strokeWidth","extents","xmin","bounds","minX","ymin","minY","xmax","maxX","ymax","maxY","paintExtents","es","outlineStroke","outlineWidth","ehs","u","drawEndpoints","replaceEndpoint","endpointDef","current","_idx","_new","AnchorManager","_amEndpoints","continuousAnchorLocations","continuousAnchorOrientations","connectionsByElementId","anchorLists","placeAnchorsOnLine","desc","elementDimensions","elementPosition","horizontal","otherMultiplier","reverse","other","xp","yp","rightAndBottomSort","leftAndTopSort","edgeSortFunctions","_sortHelper","_array","placeAnchors","_anchorLists","cd","sS","sO","placeSomeAnchors","unsortedConnections","isHorizontal","sc","_setAnchorLocation","anchorPos","weAreSource","weAreTarget","addFloatingConnection","doRegisterTarget","registerConnection","otherIndex","otherEndpoint","otherAnchor","isContinuous","removeEndpointFromAnchorLists","eId","connInfo","doNotRedraw","removeConnection","getConnectionsFor","getEndpointsFor","_updateAnchorList","aBoolean","otherElId","edgeId","connsToPaint","endpointsToPaint","exactIdx","firstMatchingElIdx","endpointId","listToAddTo","listToRemoveFrom","_continuousAnchorEdge","rIdx","insertIdx","originalId","newElement","anchorIndex","sourceElId","sIndex","tIndex","currentId","offsetToUI","doNotRecalcEndpoint","endpointConnections","connectionsToPaint","anchorsToUpdate","orientationCache","sourceContinuous","targetContinuous","oKey","sd","calculateOrientation","getDefaultFace","fc","ContinuousAnchor","faces","clockwise","availableFaces","opposites","clockwiseOptions","antiClockwiseOptions","secondBest","lastChoice","_currentFace","_lockedFace","X_AXIS_FACES","Y_AXIS_FACES","_lockedAxis","isRelocatable","isSnapOnRelocate","verifyEdge","isEdgeSupported","setCurrentFace","face","overrideLock","getCurrentFace","getSupportedFaces","af","lock","isLocked","lockCurrentAxis","unlockCurrentAxis","sourceAnchor","targetAnchor","Orientation","HORIZONTAL","VERTICAL","DIAGONAL","IDENTITY","axes","atan2","midpoints","dim","sf","tf","sourceEdge","targetEdge","userDefinedLocation","lastReturnValue","relocatable","setRelocatable","_relocatable","snapOnRelocate","locked","clearUserDefinedLocation","ox","oy","ao","getUserDefinedLocation","setUserDefinedLocation","ref","refCanvas","xDir","yDir","_lastResult","_endpoint","_convertAnchor","getAnchors","_curAnchor","_lastAnchor","_distance","cx","cy","ax","ay","acx","acy","_anchorSelector","minIdx","minDist","udl","setAnchorCoordinates","coords","_curryAnchor","fnInit","DynamicAnchors","AutoDefault","_curryContinuousAnchor","Continuous","pf","AnchorPositionFinders","gx","gy","mx","my","Perimeter","anchorCount","shape","Error","_circle","_path","segments","anchorsPerFace","_computeFace","fractionalLength","_shape","_rectangle","_shapes","points","tl","_rotate","amountInDegrees","da","rotation","_jg","Segments","AbstractSegment","findClosestPointOnPath","getBounds","Straight","_super","m2","getGradient","getCoordinates","setCoordinates","pointOnPath","absolute","_","pointAlongPathFrom","farAwayPoint","within","closest","_x1","_y1","fractionInSegment","_pointLiesBetween","_plb","_x2","_y2","m1","X","Y","Arc","_calcAngle","_calcAngleForLocation","segment","anticlockwise","sa","startAngle","endAngle","TWO_PI","ea","radius","ac","sweep","circumference","frac","VERY_SMALL_VALUE","gentleRound","ceil","angle","arcSpan","startX","startY","Bezier","cp1x","cp1y","cp2x","cp2y","_compute","EMPTY_POINT","_getLUT","steps","_computeLength","_translateLocation","_curve","SegmentRenderer","getPath","isFirstSegment","laf","AbstractComponent","AbstractConnector","totalLength","segmentProportions","segmentProportionalLengths","stub","sourceStub","targetStub","gap","sourceGap","targetGap","userProvidedSegments","paintInfo","getPathData","findSegmentForPoint","connectorLocation","_updateSegmentProportions","_findSegmentForLocation","inSegmentProportion","proportion","_addSegment","updateBounds","_clearSegments","setSegments","_segs","_prepareCompute","swapX","swapY","lw","so","oIndex","sx","sy","oProduct","xSpan","ySpan","startStubX","startStubY","endStubX","endStubY","isXGreaterThanStubTimes2","isYGreaterThanStubTimes2","opposite","perpendicular","orthogonal","sourceAxis","stubs","anchorOrientation","getSegments","segBounds","dumpSegmentsToConsole","seg","addSegment","prepareCompute","maxStub","maxGap","AbstractEndpoint","Dot","defaultOffset","defaultInnerRadius","Rectangle","DOMElementEndpoint","displayElements","getDisplayElements","appendDisplayElement","Image","_onload","onload","src","url","img","deleted","widthToUse","heightToUse","setImage","_img","margin","padding","outline","actuallyPaint","Blank","background","Triangle","AbstractOverlay","endpointLoc","endpointLocation","incrementLocation","amount","getLocation","Arrow","foldback","computeMaxSize","elementCreated","currentConnectionPaintStyle","hxy","mid","tail","cxy","parseInt","fromLoc","__","lineWidth","PlainArrow","Diamond","_getDimensions","forceRefresh","cachedDimensions","getDimensions","AbstractDOMOverlay","detached","div","initialised","initiallyInvisible","webkitTransform","mozTransform","msTransform","oTransform","transform","absolutePosition","locToUse","minx","miny","clearCachedDimensions","containerExtents","Custom","GuideLines","tailLine","headLine","labelWidth","labelHeight","labelText","labelPadding","font","borderWidth","dStyle","borderStyle","border","update","lt","innerHTML","_jpi","GROUP_COLLAPSED_CLASS","GROUP_EXPANDED_CLASS","GROUP_CONTAINER_SELECTOR","ELEMENT_DRAGGABLE_EVENT","STOP","REVERT","GROUP_MANAGER","GROUP","GROUP_DRAG_SCOPE","EVT_CHILD_ADDED","EVT_CHILD_REMOVED","EVT_GROUP_ADDED","EVT_GROUP_REMOVED","EVT_EXPAND","EVT_COLLAPSE","EVT_GROUP_DRAG_STOP","EVT_CONNECTION_MOVED","EVT_INTERNAL_CONNECTION_DETACHED","CMD_REMOVE_ALL","CMD_ORPHAN_ALL","CMD_SHOW","CMD_HIDE","GroupManager","_managedGroups","_connectionSourceMap","_connectionTargetMap","isDescendant","parentEl","sourceGroup","getGroupFor","targetGroup","_cleanupDetachedConnection","group","connMap","addGroup","getEl","manager","_updateConnectionsForGroup","addToGroup","doNotFireEvent","getGroup","groupEl","currentGroup","_jsPlumbGroup","removeFromDragSelection","elpos","cpos","collapsed","getDragArea","updateConnectionsForGroup","handleDroppedConnections","_expandConnection","_collapseConnection","newPosition","revalidateParent","removeFromGroup","_expandSet","conns","proxiedElement","groupId","getGroups","removeGroup","deleteMembers","manipulateDOM","expandGroup","newPositions","_groups","otherEl","shouldProxy","groupElId","getAnchor","collapseGroup","_collapseSet","repaintGroup","getMembers","childMembers","processed","oneSet","gs","gt","refreshAllGroups","Group","ghost","orphan","prune","dropOverride","proxied","internal","endpointIndex","opts","overrideDrop","getGroupManager","els","dragArea","__el","isAlreadyDraggable","_bindDragHandlers","doNotUpdateConnections","_unbindDragHandlers","removeAll","orphanAll","orphanedPositions","_orphan","dragParams","_findParent","_isInsideParent","leftEdge","rightEdge","topEdge","bottomEdge","clearParent","_pruneOrOrphan","orphanedPosition","_revalidate","toggleGroup","mgr","STRAIGHT","ARC","Flowchart","midpoint","alwaysRespectStubs","lastx","lasty","lastOrientation","cornerRadius","loopbackRadius","isLoopbackCurrently","segmentDirections","lx","ly","segLength","_cloneArray","writeSegments","currentDirection","nextDirection","minSegLength","radiusToUse","sgny","sgnx","sgnEqual","commonStubCalculator","stubCalculators","pi","areInProximity","oss","oes","midx","midy","orientations","lineCalculators","sis","midLines","linesToEnd","startToEnd","startToMidToEnd","otherStubs","soIdx","toIdx","_so","_to","otherFlipped","stub1","stub2","segmentIndexes","startStub","otherStartStub","endStub","otherEndStub","extent","otherAxis","comparator","toUpperCase","_val","AbstractBezierConnector","showLoopback","curviness","proximityLimit","sp","tp","_w","_h","_computeBezier","loopback","majorAnchor","minorAnchor","getCurviness","_findControlPoint","sourceAnchorPosition","targetAnchorPosition","soo","too","_CP","_CP2","_sx","_sy","_tx","_ty","_segment","StateMachine","_controlPoint","_midx","_midy","svgAttributeMap","STROKE_DASHARRAY","DASHSTYLE","LINEAR_GRADIENT","RADIAL_GRADIENT","DEFS","FILL","STROKE","STROKE_WIDTH","STYLE","NONE","JSPLUMB_GRADIENT","LINE_WIDTH","ns","svg","_attr","node","attributes","_node","xmlns","createElementNS","_pos","_clearGradient","_updateGradient","uiComponent","gradientUnits","stops","styleToUse","stopColor","applyGradientTo","_applyStyles","parts","_appendAtIndex","insertBefore","attr","SvgComponent","pointerEventsSpec","originalArgs","svgParams","useDivWrapper","className","outlineStyle","outlineStrokeWidth","bgPath","SvgEndpoint","makeNode","updateNode","AbstractSvgArrowOverlay","superclass","makePath","svgProtoFunctions","p1_1","p1_2","attachListeners","_jk","_getEventManager","_mottle","_getDragManager","category","getEventManager","scrollWidth","scrollHeight","relativeToRoot","_dragStart","_jsPlumbDragOptions","cont","_dragMove","_dragging","_dragStop","uip","dragEnded","_animProps","pName","DragManager","_draggables","_dlist","_delements","_elementsWithEndpoints","_draggablesForElements","register","parentOffset","_oneLevel","cid","cOff","childOffsetOverrides","domEl","cel","pid","pLoc","cLoc","endpointDeleted","getElementsForDraggable","ancestor","pId","currentChildLocation","childOffset","co","getDragAncestor","aid","_setClassName","cn","classList","baseVal","_getClassName","_classManip","curClasses","classes","screenLocation","clientLocation","tag","atts","attName","getRenderModes","contains","toggleClass","toAdd","toRemove","setClass","prop","getStyle","getComputedStyle","getPropertyValue","currentStyle","op","_maybeAdjustScroll","zoom","pst","psl","offsetWidth","getAbsolutePosition","setAbsolutePosition","animateFrom","animateOptions","getWidth","getHeight","_initDraggableIfNecessary","_oneEl","_me","mel","unbindDraggable","setDraggable","_draggableStates","toggleDraggable","isDraggable","_draggable","enctype","ldist","tdist","duration","linc","tinc","_int","setInterval","clearInterval","unbindDroppable","isElementDraggable","oc","specs","addToDragSelection","getDragSelection","clearDragSelection","callback","_do","readyState","routes","DesignRoutingModule","forChild","DesignComponent","dataService","nodeService","activatedRoute","nodes","loading","showNodeConfig","currentNode","rootDirectory","icon","expanded","files","activeDemoVariant","droppedFiles","directoryName","fileName","indexInFiles","newNode","dragDataTransfer","node_type","_workflow","workflow","description","dropPointPosition","createRecord","then","addDynamicNode","updateRecord","templateUrl","styleUrls","DesignModule","entryComponents","NodeComponent","joinstyle","sourceAnchors","metaKey","alert","_addEndpoints","toId","targetAnchors","sourceUUID","targetUUID","showDetails","handleClick","loadNodeDetails","encapsulation","None","NodeService","factoryResolver","showNodeDetails","showNodeDetails$","currentNodeDetails","currentNodeDetails$","cursor","zIndex","viewContainerRef","rootViewContainer","resolveComponentFactory","parentInjector","insert","hostView","NodesContainerComponent","setRootViewContainerRef","nodesAdded","findRecords","json","JSON","stringify","saveNodeJson","read","WorkflowNodeDetailsComponent","node_vars","parentVariables$","records$","subscribe","parent$","record$","getRecord","WorkflowStudioRootComponent"],"mappings":"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","file":"modules-design-design-module-es5.js","sourcesContent":["import { EventEmitter, Component, ChangeDetectionStrategy, NgZone, ElementRef, ChangeDetectorRef, Renderer2, Input, Output, ViewChildren, Directive, NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Subject, Observable } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @param {?} event\n * @return {?}\n */\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@angular/common';\n\nconst _c0 = [\"gutterEls\"];\nfunction SplitComponent_ng_template_1_div_0_Template(rf, ctx) { if (rf & 1) {\n    const _r6 = ɵngcc0.ɵɵgetCurrentView();\n    ɵngcc0.ɵɵelementStart(0, \"div\", 2, 3);\n    ɵngcc0.ɵɵlistener(\"mousedown\", function SplitComponent_ng_template_1_div_0_Template_div_mousedown_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r6); const index_r1 = ɵngcc0.ɵɵnextContext().index; const ctx_r5 = ɵngcc0.ɵɵnextContext(); return ctx_r5.startDragging($event, index_r1 * 2 + 1, index_r1 + 1); })(\"touchstart\", function SplitComponent_ng_template_1_div_0_Template_div_touchstart_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r6); const index_r1 = ɵngcc0.ɵɵnextContext().index; const ctx_r8 = ɵngcc0.ɵɵnextContext(); return ctx_r8.startDragging($event, index_r1 * 2 + 1, index_r1 + 1); })(\"mouseup\", function SplitComponent_ng_template_1_div_0_Template_div_mouseup_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r6); const index_r1 = ɵngcc0.ɵɵnextContext().index; const ctx_r10 = ɵngcc0.ɵɵnextContext(); return ctx_r10.clickGutter($event, index_r1 + 1); })(\"touchend\", function SplitComponent_ng_template_1_div_0_Template_div_touchend_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r6); const index_r1 = ɵngcc0.ɵɵnextContext().index; const ctx_r12 = ɵngcc0.ɵɵnextContext(); return ctx_r12.clickGutter($event, index_r1 + 1); });\n    ɵngcc0.ɵɵelement(2, \"div\", 4);\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const index_r1 = ɵngcc0.ɵɵnextContext().index;\n    const ctx_r3 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵstyleProp(\"flex-basis\", ctx_r3.gutterSize, \"px\")(\"order\", index_r1 * 2 + 1);\n} }\nfunction SplitComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {\n    ɵngcc0.ɵɵtemplate(0, SplitComponent_ng_template_1_div_0_Template, 3, 4, \"div\", 1);\n} if (rf & 2) {\n    const last_r2 = ctx.last;\n    ɵngcc0.ɵɵproperty(\"ngIf\", last_r2 === false);\n} }\nconst _c1 = [\"*\"];\nfunction getPointFromEvent(event) {\n    // TouchEvent\n    if (((/** @type {?} */ (event))).changedTouches !== undefined && ((/** @type {?} */ (event))).changedTouches.length > 0) {\n        return {\n            x: ((/** @type {?} */ (event))).changedTouches[0].clientX,\n            y: ((/** @type {?} */ (event))).changedTouches[0].clientY,\n        };\n    }\n    // MouseEvent\n    else if (((/** @type {?} */ (event))).clientX !== undefined && ((/** @type {?} */ (event))).clientY !== undefined) {\n        return {\n            x: ((/** @type {?} */ (event))).clientX,\n            y: ((/** @type {?} */ (event))).clientY,\n        };\n    }\n    return null;\n}\n/**\n * @param {?} elRef\n * @param {?} direction\n * @return {?}\n */\nfunction getElementPixelSize(elRef, direction) {\n    /** @type {?} */\n    const rect = ((/** @type {?} */ (elRef.nativeElement))).getBoundingClientRect();\n    return (direction === 'horizontal') ? rect.width : rect.height;\n}\n/**\n * @param {?} v\n * @return {?}\n */\nfunction getInputBoolean(v) {\n    return (typeof (v) === 'boolean') ? v : (v === 'false' ? false : true);\n}\n/**\n * @template T\n * @param {?} v\n * @param {?} defaultValue\n * @return {?}\n */\nfunction getInputPositiveNumber(v, defaultValue) {\n    if (v === null || v === undefined)\n        return defaultValue;\n    v = Number(v);\n    return !isNaN(v) && v >= 0 ? v : defaultValue;\n}\n/**\n * @param {?} unit\n * @param {?} sizes\n * @return {?}\n */\nfunction isUserSizesValid(unit, sizes) {\n    // All sizes have to be not null and total should be 100\n    if (unit === 'percent') {\n        /** @type {?} */\n        const total = sizes.reduce((/**\n         * @param {?} total\n         * @param {?} s\n         * @return {?}\n         */\n        (total, s) => s !== null ? total + s : total), 0);\n        return sizes.every((/**\n         * @param {?} s\n         * @return {?}\n         */\n        s => s !== null)) && total > 99.9 && total < 100.1;\n    }\n    // A size at null is mandatory but only one.\n    if (unit === 'pixel') {\n        return sizes.filter((/**\n         * @param {?} s\n         * @return {?}\n         */\n        s => s === null)).length === 1;\n    }\n}\n/**\n * @param {?} a\n * @return {?}\n */\nfunction getAreaMinSize(a) {\n    if (a.size === null) {\n        return null;\n    }\n    if (a.component.lockSize === true) {\n        return a.size;\n    }\n    if (a.component.minSize === null) {\n        return null;\n    }\n    if (a.component.minSize > a.size) {\n        return a.size;\n    }\n    return a.component.minSize;\n}\n/**\n * @param {?} a\n * @return {?}\n */\nfunction getAreaMaxSize(a) {\n    if (a.size === null) {\n        return null;\n    }\n    if (a.component.lockSize === true) {\n        return a.size;\n    }\n    if (a.component.maxSize === null) {\n        return null;\n    }\n    if (a.component.maxSize < a.size) {\n        return a.size;\n    }\n    return a.component.maxSize;\n}\n/**\n * @param {?} unit\n * @param {?} sideAreas\n * @param {?} pixels\n * @param {?} allAreasSizePixel\n * @return {?}\n */\nfunction getGutterSideAbsorptionCapacity(unit, sideAreas, pixels, allAreasSizePixel) {\n    return sideAreas.reduce((/**\n     * @param {?} acc\n     * @param {?} area\n     * @return {?}\n     */\n    (acc, area) => {\n        /** @type {?} */\n        const res = getAreaAbsorptionCapacity(unit, area, acc.remain, allAreasSizePixel);\n        acc.list.push(res);\n        acc.remain = res.pixelRemain;\n        return acc;\n    }), { remain: pixels, list: [] });\n}\n/**\n * @param {?} unit\n * @param {?} areaSnapshot\n * @param {?} pixels\n * @param {?} allAreasSizePixel\n * @return {?}\n */\nfunction getAreaAbsorptionCapacity(unit, areaSnapshot, pixels, allAreasSizePixel) {\n    // No pain no gain\n    if (pixels === 0) {\n        return {\n            areaSnapshot,\n            pixelAbsorb: 0,\n            percentAfterAbsorption: areaSnapshot.sizePercentAtStart,\n            pixelRemain: 0,\n        };\n    }\n    // Area start at zero and need to be reduced, not possible\n    if (areaSnapshot.sizePixelAtStart === 0 && pixels < 0) {\n        return {\n            areaSnapshot,\n            pixelAbsorb: 0,\n            percentAfterAbsorption: 0,\n            pixelRemain: pixels,\n        };\n    }\n    if (unit === 'percent') {\n        return getAreaAbsorptionCapacityPercent(areaSnapshot, pixels, allAreasSizePixel);\n    }\n    if (unit === 'pixel') {\n        return getAreaAbsorptionCapacityPixel(areaSnapshot, pixels);\n    }\n}\n/**\n * @param {?} areaSnapshot\n * @param {?} pixels\n * @param {?} allAreasSizePixel\n * @return {?}\n */\nfunction getAreaAbsorptionCapacityPercent(areaSnapshot, pixels, allAreasSizePixel) {\n    /** @type {?} */\n    const tempPixelSize = areaSnapshot.sizePixelAtStart + pixels;\n    /** @type {?} */\n    const tempPercentSize = tempPixelSize / allAreasSizePixel * 100;\n    // ENLARGE AREA\n    if (pixels > 0) {\n        // If maxSize & newSize bigger than it > absorb to max and return remaining pixels \n        if (areaSnapshot.area.maxSize !== null && tempPercentSize > areaSnapshot.area.maxSize) {\n            // Use area.area.maxSize as newPercentSize and return calculate pixels remaining\n            /** @type {?} */\n            const maxSizePixel = areaSnapshot.area.maxSize / 100 * allAreasSizePixel;\n            return {\n                areaSnapshot,\n                pixelAbsorb: maxSizePixel,\n                percentAfterAbsorption: areaSnapshot.area.maxSize,\n                pixelRemain: areaSnapshot.sizePixelAtStart + pixels - maxSizePixel\n            };\n        }\n        return {\n            areaSnapshot,\n            pixelAbsorb: pixels,\n            percentAfterAbsorption: tempPercentSize > 100 ? 100 : tempPercentSize,\n            pixelRemain: 0\n        };\n    }\n    // REDUCE AREA\n    else if (pixels < 0) {\n        // If minSize & newSize smaller than it > absorb to min and return remaining pixels \n        if (areaSnapshot.area.minSize !== null && tempPercentSize < areaSnapshot.area.minSize) {\n            // Use area.area.minSize as newPercentSize and return calculate pixels remaining\n            /** @type {?} */\n            const minSizePixel = areaSnapshot.area.minSize / 100 * allAreasSizePixel;\n            return {\n                areaSnapshot,\n                pixelAbsorb: minSizePixel,\n                percentAfterAbsorption: areaSnapshot.area.minSize,\n                pixelRemain: areaSnapshot.sizePixelAtStart + pixels - minSizePixel\n            };\n        }\n        // If reduced under zero > return remaining pixels\n        else if (tempPercentSize < 0) {\n            // Use 0 as newPercentSize and return calculate pixels remaining\n            return {\n                areaSnapshot,\n                pixelAbsorb: -areaSnapshot.sizePixelAtStart,\n                percentAfterAbsorption: 0,\n                pixelRemain: pixels + areaSnapshot.sizePixelAtStart\n            };\n        }\n        return {\n            areaSnapshot,\n            pixelAbsorb: pixels,\n            percentAfterAbsorption: tempPercentSize,\n            pixelRemain: 0\n        };\n    }\n}\n/**\n * @param {?} areaSnapshot\n * @param {?} pixels\n * @param {?} containerSizePixel\n * @return {?}\n */\nfunction getAreaAbsorptionCapacityPixel(areaSnapshot, pixels, containerSizePixel) {\n    /** @type {?} */\n    const tempPixelSize = areaSnapshot.sizePixelAtStart + pixels;\n    // ENLARGE AREA\n    if (pixels > 0) {\n        // If maxSize & newSize bigger than it > absorb to max and return remaining pixels \n        if (areaSnapshot.area.maxSize !== null && tempPixelSize > areaSnapshot.area.maxSize) {\n            return {\n                areaSnapshot,\n                pixelAbsorb: areaSnapshot.area.maxSize - areaSnapshot.sizePixelAtStart,\n                percentAfterAbsorption: -1,\n                pixelRemain: tempPixelSize - areaSnapshot.area.maxSize\n            };\n        }\n        return {\n            areaSnapshot,\n            pixelAbsorb: pixels,\n            percentAfterAbsorption: -1,\n            pixelRemain: 0\n        };\n    }\n    // REDUCE AREA\n    else if (pixels < 0) {\n        // If minSize & newSize smaller than it > absorb to min and return remaining pixels \n        if (areaSnapshot.area.minSize !== null && tempPixelSize < areaSnapshot.area.minSize) {\n            return {\n                areaSnapshot,\n                pixelAbsorb: areaSnapshot.area.minSize + pixels - tempPixelSize,\n                percentAfterAbsorption: -1,\n                pixelRemain: tempPixelSize - areaSnapshot.area.minSize\n            };\n        }\n        // If reduced under zero > return remaining pixels\n        else if (tempPixelSize < 0) {\n            return {\n                areaSnapshot,\n                pixelAbsorb: -areaSnapshot.sizePixelAtStart,\n                percentAfterAbsorption: -1,\n                pixelRemain: pixels + areaSnapshot.sizePixelAtStart\n            };\n        }\n        return {\n            areaSnapshot,\n            pixelAbsorb: pixels,\n            percentAfterAbsorption: -1,\n            pixelRemain: 0\n        };\n    }\n}\n/**\n * @param {?} unit\n * @param {?} item\n * @return {?}\n */\nfunction updateAreaSize(unit, item) {\n    if (unit === 'percent') {\n        item.areaSnapshot.area.size = item.percentAfterAbsorption;\n    }\n    else if (unit === 'pixel') {\n        // Update size except for the wildcard size area\n        if (item.areaSnapshot.area.size !== null) {\n            item.areaSnapshot.area.size = item.areaSnapshot.sizePixelAtStart + item.pixelAbsorb;\n        }\n    }\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * angular-split\n *\n *\n *  PERCENT MODE ([unit]=\"'percent'\")\n *  ___________________________________________________________________________________________\n * |       A       [g1]       B       [g2]       C       [g3]       D       [g4]       E       |\n * |-------------------------------------------------------------------------------------------|\n * |       20                 30                 20                 15                 15      | <-- [size]=\"x\"\n * |               10px               10px               10px               10px               | <-- [gutterSize]=\"10\"\n * |calc(20% - 8px)    calc(30% - 12px)   calc(20% - 8px)    calc(15% - 6px)    calc(15% - 6px)| <-- CSS flex-basis property (with flex-grow&shrink at 0)\n * |     152px              228px              152px              114px              114px     | <-- el.getBoundingClientRect().width\n * |___________________________________________________________________________________________|\n *                                                                                 800px         <-- el.getBoundingClientRect().width\n *  flex-basis = calc( { area.size }% - { area.size/100 * nbGutter*gutterSize }px );\n *\n *\n *  PIXEL MODE ([unit]=\"'pixel'\")\n *  ___________________________________________________________________________________________\n * |       A       [g1]       B       [g2]       C       [g3]       D       [g4]       E       |\n * |-------------------------------------------------------------------------------------------|\n * |      100                250                 *                 150                100      | <-- [size]=\"y\"\n * |               10px               10px               10px               10px               | <-- [gutterSize]=\"10\"\n * |   0 0 100px          0 0 250px           1 1 auto          0 0 150px          0 0 100px   | <-- CSS flex property (flex-grow/flex-shrink/flex-basis)\n * |     100px              250px              200px              150px              100px     | <-- el.getBoundingClientRect().width\n * |___________________________________________________________________________________________|\n *                                                                                 800px         <-- el.getBoundingClientRect().width\n *\n */\nclass SplitComponent {\n    /**\n     * @param {?} ngZone\n     * @param {?} elRef\n     * @param {?} cdRef\n     * @param {?} renderer\n     */\n    constructor(ngZone, elRef, cdRef, renderer) {\n        this.ngZone = ngZone;\n        this.elRef = elRef;\n        this.cdRef = cdRef;\n        this.renderer = renderer;\n        this._direction = 'horizontal';\n        ////\n        this._unit = 'percent';\n        ////\n        this._gutterSize = 11;\n        ////\n        this._gutterStep = 1;\n        ////\n        this._restrictMove = false;\n        ////\n        this._useTransition = false;\n        ////\n        this._disabled = false;\n        ////\n        this._dir = 'ltr';\n        ////\n        this._gutterDblClickDuration = 0;\n        ////\n        this.dragStart = new EventEmitter(false);\n        this.dragEnd = new EventEmitter(false);\n        this.gutterClick = new EventEmitter(false);\n        this.gutterDblClick = new EventEmitter(false);\n        this.dragProgressSubject = new Subject();\n        this.dragProgress$ = this.dragProgressSubject.asObservable();\n        ////\n        this.isDragging = false;\n        this.dragListeners = [];\n        this.snapshot = null;\n        this.startPoint = null;\n        this.endPoint = null;\n        this.displayedAreas = [];\n        this.hidedAreas = [];\n        this._clickTimeout = null;\n        // To force adding default class, could be override by user @Input() or not\n        this.direction = this._direction;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set direction(v) {\n        this._direction = (v === 'vertical') ? 'vertical' : 'horizontal';\n        this.renderer.addClass(this.elRef.nativeElement, `as-${this._direction}`);\n        this.renderer.removeClass(this.elRef.nativeElement, `as-${(this._direction === 'vertical') ? 'horizontal' : 'vertical'}`);\n        this.build(false, false);\n    }\n    /**\n     * @return {?}\n     */\n    get direction() {\n        return this._direction;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set unit(v) {\n        this._unit = (v === 'pixel') ? 'pixel' : 'percent';\n        this.renderer.addClass(this.elRef.nativeElement, `as-${this._unit}`);\n        this.renderer.removeClass(this.elRef.nativeElement, `as-${(this._unit === 'pixel') ? 'percent' : 'pixel'}`);\n        this.build(false, true);\n    }\n    /**\n     * @return {?}\n     */\n    get unit() {\n        return this._unit;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set gutterSize(v) {\n        this._gutterSize = getInputPositiveNumber(v, 11);\n        this.build(false, false);\n    }\n    /**\n     * @return {?}\n     */\n    get gutterSize() {\n        return this._gutterSize;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set gutterStep(v) {\n        this._gutterStep = getInputPositiveNumber(v, 1);\n    }\n    /**\n     * @return {?}\n     */\n    get gutterStep() {\n        return this._gutterStep;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set restrictMove(v) {\n        this._restrictMove = getInputBoolean(v);\n    }\n    /**\n     * @return {?}\n     */\n    get restrictMove() {\n        return this._restrictMove;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set useTransition(v) {\n        this._useTransition = getInputBoolean(v);\n        if (this._useTransition)\n            this.renderer.addClass(this.elRef.nativeElement, 'as-transition');\n        else\n            this.renderer.removeClass(this.elRef.nativeElement, 'as-transition');\n    }\n    /**\n     * @return {?}\n     */\n    get useTransition() {\n        return this._useTransition;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set disabled(v) {\n        this._disabled = getInputBoolean(v);\n        if (this._disabled)\n            this.renderer.addClass(this.elRef.nativeElement, 'as-disabled');\n        else\n            this.renderer.removeClass(this.elRef.nativeElement, 'as-disabled');\n    }\n    /**\n     * @return {?}\n     */\n    get disabled() {\n        return this._disabled;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set dir(v) {\n        this._dir = (v === 'rtl') ? 'rtl' : 'ltr';\n        this.renderer.setAttribute(this.elRef.nativeElement, 'dir', this._dir);\n    }\n    /**\n     * @return {?}\n     */\n    get dir() {\n        return this._dir;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set gutterDblClickDuration(v) {\n        this._gutterDblClickDuration = getInputPositiveNumber(v, 0);\n    }\n    /**\n     * @return {?}\n     */\n    get gutterDblClickDuration() {\n        return this._gutterDblClickDuration;\n    }\n    /**\n     * @return {?}\n     */\n    get transitionEnd() {\n        return new Observable((/**\n         * @param {?} subscriber\n         * @return {?}\n         */\n        subscriber => this.transitionEndSubscriber = subscriber)).pipe(debounceTime(20));\n    }\n    /**\n     * @return {?}\n     */\n    ngAfterViewInit() {\n        this.ngZone.runOutsideAngular((/**\n         * @return {?}\n         */\n        () => {\n            // To avoid transition at first rendering\n            setTimeout((/**\n             * @return {?}\n             */\n            () => this.renderer.addClass(this.elRef.nativeElement, 'as-init')));\n        }));\n    }\n    /**\n     * @private\n     * @return {?}\n     */\n    getNbGutters() {\n        return (this.displayedAreas.length === 0) ? 0 : this.displayedAreas.length - 1;\n    }\n    /**\n     * @param {?} component\n     * @return {?}\n     */\n    addArea(component) {\n        /** @type {?} */\n        const newArea = {\n            component,\n            order: 0,\n            size: 0,\n            minSize: null,\n            maxSize: null,\n        };\n        if (component.visible === true) {\n            this.displayedAreas.push(newArea);\n            this.build(true, true);\n        }\n        else {\n            this.hidedAreas.push(newArea);\n        }\n    }\n    /**\n     * @param {?} component\n     * @return {?}\n     */\n    removeArea(component) {\n        if (this.displayedAreas.some((/**\n         * @param {?} a\n         * @return {?}\n         */\n        a => a.component === component))) {\n            /** @type {?} */\n            const area = this.displayedAreas.find((/**\n             * @param {?} a\n             * @return {?}\n             */\n            a => a.component === component));\n            this.displayedAreas.splice(this.displayedAreas.indexOf(area), 1);\n            this.build(true, true);\n        }\n        else if (this.hidedAreas.some((/**\n         * @param {?} a\n         * @return {?}\n         */\n        a => a.component === component))) {\n            /** @type {?} */\n            const area = this.hidedAreas.find((/**\n             * @param {?} a\n             * @return {?}\n             */\n            a => a.component === component));\n            this.hidedAreas.splice(this.hidedAreas.indexOf(area), 1);\n        }\n    }\n    /**\n     * @param {?} component\n     * @param {?} resetOrders\n     * @param {?} resetSizes\n     * @return {?}\n     */\n    updateArea(component, resetOrders, resetSizes) {\n        if (component.visible === true) {\n            this.build(resetOrders, resetSizes);\n        }\n    }\n    /**\n     * @param {?} component\n     * @return {?}\n     */\n    showArea(component) {\n        /** @type {?} */\n        const area = this.hidedAreas.find((/**\n         * @param {?} a\n         * @return {?}\n         */\n        a => a.component === component));\n        if (area === undefined) {\n            return;\n        }\n        /** @type {?} */\n        const areas = this.hidedAreas.splice(this.hidedAreas.indexOf(area), 1);\n        this.displayedAreas.push(...areas);\n        this.build(true, true);\n    }\n    /**\n     * @param {?} comp\n     * @return {?}\n     */\n    hideArea(comp) {\n        /** @type {?} */\n        const area = this.displayedAreas.find((/**\n         * @param {?} a\n         * @return {?}\n         */\n        a => a.component === comp));\n        if (area === undefined) {\n            return;\n        }\n        /** @type {?} */\n        const areas = this.displayedAreas.splice(this.displayedAreas.indexOf(area), 1);\n        areas.forEach((/**\n         * @param {?} area\n         * @return {?}\n         */\n        area => {\n            area.order = 0;\n            area.size = 0;\n        }));\n        this.hidedAreas.push(...areas);\n        this.build(true, true);\n    }\n    /**\n     * @return {?}\n     */\n    getVisibleAreaSizes() {\n        return this.displayedAreas.map((/**\n         * @param {?} a\n         * @return {?}\n         */\n        a => a.size === null ? '*' : a.size));\n    }\n    /**\n     * @param {?} sizes\n     * @return {?}\n     */\n    setVisibleAreaSizes(sizes) {\n        if (sizes.length !== this.displayedAreas.length) {\n            return false;\n        }\n        /** @type {?} */\n        const formatedSizes = sizes.map((/**\n         * @param {?} s\n         * @return {?}\n         */\n        s => getInputPositiveNumber(s, null)));\n        /** @type {?} */\n        const isValid = isUserSizesValid(this.unit, formatedSizes);\n        if (isValid === false) {\n            return false;\n        }\n        // @ts-ignore\n        this.displayedAreas.forEach((/**\n         * @param {?} area\n         * @param {?} i\n         * @return {?}\n         */\n        (area, i) => area.component._size = formatedSizes[i]));\n        this.build(false, true);\n        return true;\n    }\n    /**\n     * @private\n     * @param {?} resetOrders\n     * @param {?} resetSizes\n     * @return {?}\n     */\n    build(resetOrders, resetSizes) {\n        this.stopDragging();\n        // ¤ AREAS ORDER\n        if (resetOrders === true) {\n            // If user provided 'order' for each area, use it to sort them.\n            if (this.displayedAreas.every((/**\n             * @param {?} a\n             * @return {?}\n             */\n            a => a.component.order !== null))) {\n                this.displayedAreas.sort((/**\n                 * @param {?} a\n                 * @param {?} b\n                 * @return {?}\n                 */\n                (a, b) => ((/** @type {?} */ (a.component.order))) - ((/** @type {?} */ (b.component.order)))));\n            }\n            // Then set real order with multiples of 2, numbers between will be used by gutters.\n            this.displayedAreas.forEach((/**\n             * @param {?} area\n             * @param {?} i\n             * @return {?}\n             */\n            (area, i) => {\n                area.order = i * 2;\n                area.component.setStyleOrder(area.order);\n            }));\n        }\n        // ¤ AREAS SIZE\n        if (resetSizes === true) {\n            /** @type {?} */\n            const useUserSizes = isUserSizesValid(this.unit, this.displayedAreas.map((/**\n             * @param {?} a\n             * @return {?}\n             */\n            a => a.component.size)));\n            switch (this.unit) {\n                case 'percent': {\n                    /** @type {?} */\n                    const defaultSize = 100 / this.displayedAreas.length;\n                    this.displayedAreas.forEach((/**\n                     * @param {?} area\n                     * @return {?}\n                     */\n                    area => {\n                        area.size = useUserSizes ? (/** @type {?} */ (area.component.size)) : defaultSize;\n                        area.minSize = getAreaMinSize(area);\n                        area.maxSize = getAreaMaxSize(area);\n                    }));\n                    break;\n                }\n                case 'pixel': {\n                    if (useUserSizes) {\n                        this.displayedAreas.forEach((/**\n                         * @param {?} area\n                         * @return {?}\n                         */\n                        area => {\n                            area.size = area.component.size;\n                            area.minSize = getAreaMinSize(area);\n                            area.maxSize = getAreaMaxSize(area);\n                        }));\n                    }\n                    else {\n                        /** @type {?} */\n                        const wildcardSizeAreas = this.displayedAreas.filter((/**\n                         * @param {?} a\n                         * @return {?}\n                         */\n                        a => a.component.size === null));\n                        // No wildcard area > Need to select one arbitrarily > first\n                        if (wildcardSizeAreas.length === 0 && this.displayedAreas.length > 0) {\n                            this.displayedAreas.forEach((/**\n                             * @param {?} area\n                             * @param {?} i\n                             * @return {?}\n                             */\n                            (area, i) => {\n                                area.size = (i === 0) ? null : area.component.size;\n                                area.minSize = (i === 0) ? null : getAreaMinSize(area);\n                                area.maxSize = (i === 0) ? null : getAreaMaxSize(area);\n                            }));\n                        }\n                        // More than one wildcard area > Need to keep only one arbitrarly > first\n                        else if (wildcardSizeAreas.length > 1) {\n                            /** @type {?} */\n                            let alreadyGotOne = false;\n                            this.displayedAreas.forEach((/**\n                             * @param {?} area\n                             * @return {?}\n                             */\n                            area => {\n                                if (area.component.size === null) {\n                                    if (alreadyGotOne === false) {\n                                        area.size = null;\n                                        area.minSize = null;\n                                        area.maxSize = null;\n                                        alreadyGotOne = true;\n                                    }\n                                    else {\n                                        area.size = 100;\n                                        area.minSize = null;\n                                        area.maxSize = null;\n                                    }\n                                }\n                                else {\n                                    area.size = area.component.size;\n                                    area.minSize = getAreaMinSize(area);\n                                    area.maxSize = getAreaMaxSize(area);\n                                }\n                            }));\n                        }\n                    }\n                    break;\n                }\n            }\n        }\n        this.refreshStyleSizes();\n        this.cdRef.markForCheck();\n    }\n    /**\n     * @private\n     * @return {?}\n     */\n    refreshStyleSizes() {\n        ///////////////////////////////////////////\n        // PERCENT MODE\n        if (this.unit === 'percent') {\n            // Only one area > flex-basis 100%\n            if (this.displayedAreas.length === 1) {\n                this.displayedAreas[0].component.setStyleFlex(0, 0, `100%`, false, false);\n            }\n            // Multiple areas > use each percent basis\n            else {\n                /** @type {?} */\n                const sumGutterSize = this.getNbGutters() * this.gutterSize;\n                this.displayedAreas.forEach((/**\n                 * @param {?} area\n                 * @return {?}\n                 */\n                area => {\n                    area.component.setStyleFlex(0, 0, `calc( ${area.size}% - ${(/** @type {?} */ (area.size)) / 100 * sumGutterSize}px )`, (area.minSize !== null && area.minSize === area.size) ? true : false, (area.maxSize !== null && area.maxSize === area.size) ? true : false);\n                }));\n            }\n        }\n        ///////////////////////////////////////////\n        // PIXEL MODE\n        else if (this.unit === 'pixel') {\n            this.displayedAreas.forEach((/**\n             * @param {?} area\n             * @return {?}\n             */\n            area => {\n                // Area with wildcard size\n                if (area.size === null) {\n                    if (this.displayedAreas.length === 1) {\n                        area.component.setStyleFlex(1, 1, `100%`, false, false);\n                    }\n                    else {\n                        area.component.setStyleFlex(1, 1, `auto`, false, false);\n                    }\n                }\n                // Area with pixel size\n                else {\n                    // Only one area > flex-basis 100%\n                    if (this.displayedAreas.length === 1) {\n                        area.component.setStyleFlex(0, 0, `100%`, false, false);\n                    }\n                    // Multiple areas > use each pixel basis\n                    else {\n                        area.component.setStyleFlex(0, 0, `${area.size}px`, (area.minSize !== null && area.minSize === area.size) ? true : false, (area.maxSize !== null && area.maxSize === area.size) ? true : false);\n                    }\n                }\n            }));\n        }\n    }\n    /**\n     * @param {?} event\n     * @param {?} gutterNum\n     * @return {?}\n     */\n    clickGutter(event, gutterNum) {\n        /** @type {?} */\n        const tempPoint = getPointFromEvent(event);\n        // Be sure mouseup/touchend happened at same point as mousedown/touchstart to trigger click/dblclick\n        if (this.startPoint && this.startPoint.x === tempPoint.x && this.startPoint.y === tempPoint.y) {\n            // If timeout in progress and new click > clearTimeout & dblClickEvent\n            if (this._clickTimeout !== null) {\n                window.clearTimeout(this._clickTimeout);\n                this._clickTimeout = null;\n                this.notify('dblclick', gutterNum);\n                this.stopDragging();\n            }\n            // Else start timeout to call clickEvent at end\n            else {\n                this._clickTimeout = window.setTimeout((/**\n                 * @return {?}\n                 */\n                () => {\n                    this._clickTimeout = null;\n                    this.notify('click', gutterNum);\n                    this.stopDragging();\n                }), this.gutterDblClickDuration);\n            }\n        }\n    }\n    /**\n     * @param {?} event\n     * @param {?} gutterOrder\n     * @param {?} gutterNum\n     * @return {?}\n     */\n    startDragging(event, gutterOrder, gutterNum) {\n        event.preventDefault();\n        event.stopPropagation();\n        this.startPoint = getPointFromEvent(event);\n        if (this.startPoint === null || this.disabled === true) {\n            return;\n        }\n        this.snapshot = {\n            gutterNum,\n            lastSteppedOffset: 0,\n            allAreasSizePixel: getElementPixelSize(this.elRef, this.direction) - this.getNbGutters() * this.gutterSize,\n            allInvolvedAreasSizePercent: 100,\n            areasBeforeGutter: [],\n            areasAfterGutter: [],\n        };\n        this.displayedAreas.forEach((/**\n         * @param {?} area\n         * @return {?}\n         */\n        area => {\n            /** @type {?} */\n            const areaSnapshot = {\n                area,\n                sizePixelAtStart: getElementPixelSize(area.component.elRef, this.direction),\n                sizePercentAtStart: (this.unit === 'percent') ? area.size : -1 // If pixel mode, anyway, will not be used.\n            };\n            if (area.order < gutterOrder) {\n                if (this.restrictMove === true) {\n                    this.snapshot.areasBeforeGutter = [areaSnapshot];\n                }\n                else {\n                    this.snapshot.areasBeforeGutter.unshift(areaSnapshot);\n                }\n            }\n            else if (area.order > gutterOrder) {\n                if (this.restrictMove === true) {\n                    if (this.snapshot.areasAfterGutter.length === 0)\n                        this.snapshot.areasAfterGutter = [areaSnapshot];\n                }\n                else {\n                    this.snapshot.areasAfterGutter.push(areaSnapshot);\n                }\n            }\n        }));\n        this.snapshot.allInvolvedAreasSizePercent = [...this.snapshot.areasBeforeGutter, ...this.snapshot.areasAfterGutter].reduce((/**\n         * @param {?} t\n         * @param {?} a\n         * @return {?}\n         */\n        (t, a) => t + a.sizePercentAtStart), 0);\n        if (this.snapshot.areasBeforeGutter.length === 0 || this.snapshot.areasAfterGutter.length === 0) {\n            return;\n        }\n        this.dragListeners.push(this.renderer.listen('document', 'mouseup', this.stopDragging.bind(this)));\n        this.dragListeners.push(this.renderer.listen('document', 'touchend', this.stopDragging.bind(this)));\n        this.dragListeners.push(this.renderer.listen('document', 'touchcancel', this.stopDragging.bind(this)));\n        this.ngZone.runOutsideAngular((/**\n         * @return {?}\n         */\n        () => {\n            this.dragListeners.push(this.renderer.listen('document', 'mousemove', this.dragEvent.bind(this)));\n            this.dragListeners.push(this.renderer.listen('document', 'touchmove', this.dragEvent.bind(this)));\n        }));\n        this.displayedAreas.forEach((/**\n         * @param {?} area\n         * @return {?}\n         */\n        area => area.component.lockEvents()));\n        this.isDragging = true;\n        this.renderer.addClass(this.elRef.nativeElement, 'as-dragging');\n        this.renderer.addClass(this.gutterEls.toArray()[this.snapshot.gutterNum - 1].nativeElement, 'as-dragged');\n        this.notify('start', this.snapshot.gutterNum);\n    }\n    /**\n     * @private\n     * @param {?} event\n     * @return {?}\n     */\n    dragEvent(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        if (this._clickTimeout !== null) {\n            window.clearTimeout(this._clickTimeout);\n            this._clickTimeout = null;\n        }\n        if (this.isDragging === false) {\n            return;\n        }\n        this.endPoint = getPointFromEvent(event);\n        if (this.endPoint === null) {\n            return;\n        }\n        // Calculate steppedOffset\n        /** @type {?} */\n        let offset = (this.direction === 'horizontal') ? (this.startPoint.x - this.endPoint.x) : (this.startPoint.y - this.endPoint.y);\n        if (this.dir === 'rtl') {\n            offset = -offset;\n        }\n        /** @type {?} */\n        const steppedOffset = Math.round(offset / this.gutterStep) * this.gutterStep;\n        if (steppedOffset === this.snapshot.lastSteppedOffset) {\n            return;\n        }\n        this.snapshot.lastSteppedOffset = steppedOffset;\n        // Need to know if each gutter side areas could reacts to steppedOffset\n        /** @type {?} */\n        let areasBefore = getGutterSideAbsorptionCapacity(this.unit, this.snapshot.areasBeforeGutter, -steppedOffset, this.snapshot.allAreasSizePixel);\n        /** @type {?} */\n        let areasAfter = getGutterSideAbsorptionCapacity(this.unit, this.snapshot.areasAfterGutter, steppedOffset, this.snapshot.allAreasSizePixel);\n        // Each gutter side areas can't absorb all offset \n        if (areasBefore.remain !== 0 && areasAfter.remain !== 0) {\n            if (Math.abs(areasBefore.remain) === Math.abs(areasAfter.remain)) ;\n            else if (Math.abs(areasBefore.remain) > Math.abs(areasAfter.remain)) {\n                areasAfter = getGutterSideAbsorptionCapacity(this.unit, this.snapshot.areasAfterGutter, steppedOffset + areasBefore.remain, this.snapshot.allAreasSizePixel);\n            }\n            else {\n                areasBefore = getGutterSideAbsorptionCapacity(this.unit, this.snapshot.areasBeforeGutter, -(steppedOffset - areasAfter.remain), this.snapshot.allAreasSizePixel);\n            }\n        }\n        // Areas before gutter can't absorbs all offset > need to recalculate sizes for areas after gutter.\n        else if (areasBefore.remain !== 0) {\n            areasAfter = getGutterSideAbsorptionCapacity(this.unit, this.snapshot.areasAfterGutter, steppedOffset + areasBefore.remain, this.snapshot.allAreasSizePixel);\n        }\n        // Areas after gutter can't absorbs all offset > need to recalculate sizes for areas before gutter.\n        else if (areasAfter.remain !== 0) {\n            areasBefore = getGutterSideAbsorptionCapacity(this.unit, this.snapshot.areasBeforeGutter, -(steppedOffset - areasAfter.remain), this.snapshot.allAreasSizePixel);\n        }\n        if (this.unit === 'percent') {\n            // Hack because of browser messing up with sizes using calc(X% - Ypx) -> el.getBoundingClientRect()\n            // If not there, playing with gutters makes total going down to 99.99875% then 99.99286%, 99.98986%,..\n            /** @type {?} */\n            const all = [...areasBefore.list, ...areasAfter.list];\n            /** @type {?} */\n            const areaToReset = all.find((/**\n             * @param {?} a\n             * @return {?}\n             */\n            a => a.percentAfterAbsorption !== 0 && a.percentAfterAbsorption !== a.areaSnapshot.area.minSize && a.percentAfterAbsorption !== a.areaSnapshot.area.maxSize));\n            if (areaToReset) {\n                areaToReset.percentAfterAbsorption = this.snapshot.allInvolvedAreasSizePercent - all.filter((/**\n                 * @param {?} a\n                 * @return {?}\n                 */\n                a => a !== areaToReset)).reduce((/**\n                 * @param {?} total\n                 * @param {?} a\n                 * @return {?}\n                 */\n                (total, a) => total + a.percentAfterAbsorption), 0);\n            }\n        }\n        // Now we know areas could absorb steppedOffset, time to really update sizes\n        areasBefore.list.forEach((/**\n         * @param {?} item\n         * @return {?}\n         */\n        item => updateAreaSize(this.unit, item)));\n        areasAfter.list.forEach((/**\n         * @param {?} item\n         * @return {?}\n         */\n        item => updateAreaSize(this.unit, item)));\n        this.refreshStyleSizes();\n        this.notify('progress', this.snapshot.gutterNum);\n    }\n    /**\n     * @private\n     * @param {?=} event\n     * @return {?}\n     */\n    stopDragging(event) {\n        if (event) {\n            event.preventDefault();\n            event.stopPropagation();\n        }\n        if (this.isDragging === false) {\n            return;\n        }\n        this.displayedAreas.forEach((/**\n         * @param {?} area\n         * @return {?}\n         */\n        area => area.component.unlockEvents()));\n        while (this.dragListeners.length > 0) {\n            /** @type {?} */\n            const fct = this.dragListeners.pop();\n            if (fct)\n                fct();\n        }\n        // Warning: Have to be before \"notify('end')\" \n        // because \"notify('end')\"\" can be linked to \"[size]='x'\" > \"build()\" > \"stopDragging()\"\n        this.isDragging = false;\n        // If moved from starting point, notify end\n        if (this.endPoint && (this.startPoint.x !== this.endPoint.x || this.startPoint.y !== this.endPoint.y)) {\n            this.notify('end', this.snapshot.gutterNum);\n        }\n        this.renderer.removeClass(this.elRef.nativeElement, 'as-dragging');\n        this.renderer.removeClass(this.gutterEls.toArray()[this.snapshot.gutterNum - 1].nativeElement, 'as-dragged');\n        this.snapshot = null;\n        // Needed to let (click)=\"clickGutter(...)\" event run and verify if mouse moved or not\n        this.ngZone.runOutsideAngular((/**\n         * @return {?}\n         */\n        () => {\n            setTimeout((/**\n             * @return {?}\n             */\n            () => {\n                this.startPoint = null;\n                this.endPoint = null;\n            }));\n        }));\n    }\n    /**\n     * @param {?} type\n     * @param {?} gutterNum\n     * @return {?}\n     */\n    notify(type, gutterNum) {\n        /** @type {?} */\n        const sizes = this.getVisibleAreaSizes();\n        if (type === 'start') {\n            this.dragStart.emit({ gutterNum, sizes });\n        }\n        else if (type === 'end') {\n            this.dragEnd.emit({ gutterNum, sizes });\n        }\n        else if (type === 'click') {\n            this.gutterClick.emit({ gutterNum, sizes });\n        }\n        else if (type === 'dblclick') {\n            this.gutterDblClick.emit({ gutterNum, sizes });\n        }\n        else if (type === 'transitionEnd') {\n            if (this.transitionEndSubscriber) {\n                this.ngZone.run((/**\n                 * @return {?}\n                 */\n                () => this.transitionEndSubscriber.next(sizes)));\n            }\n        }\n        else if (type === 'progress') {\n            // Stay outside zone to allow users do what they want about change detection mechanism.\n            this.dragProgressSubject.next({ gutterNum, sizes });\n        }\n    }\n    /**\n     * @return {?}\n     */\n    ngOnDestroy() {\n        this.stopDragging();\n    }\n}\nSplitComponent.ɵfac = function SplitComponent_Factory(t) { return new (t || SplitComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2)); };\nSplitComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: SplitComponent, selectors: [[\"as-split\"]], viewQuery: function SplitComponent_Query(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵviewQuery(_c0, true);\n    } if (rf & 2) {\n        var _t;\n        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.gutterEls = _t);\n    } }, inputs: { direction: \"direction\", unit: \"unit\", gutterSize: \"gutterSize\", gutterStep: \"gutterStep\", restrictMove: \"restrictMove\", useTransition: \"useTransition\", disabled: \"disabled\", dir: \"dir\", gutterDblClickDuration: \"gutterDblClickDuration\" }, outputs: { dragStart: \"dragStart\", dragEnd: \"dragEnd\", gutterClick: \"gutterClick\", gutterDblClick: \"gutterDblClick\", transitionEnd: \"transitionEnd\" }, exportAs: [\"asSplit\"], ngContentSelectors: _c1, decls: 2, vars: 1, consts: [[\"ngFor\", \"\", 3, \"ngForOf\"], [\"class\", \"as-split-gutter\", 3, \"flex-basis\", \"order\", \"mousedown\", \"touchstart\", \"mouseup\", \"touchend\", 4, \"ngIf\"], [1, \"as-split-gutter\", 3, \"mousedown\", \"touchstart\", \"mouseup\", \"touchend\"], [\"gutterEls\", \"\"], [1, \"as-split-gutter-icon\"]], template: function SplitComponent_Template(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵprojectionDef();\n        ɵngcc0.ɵɵprojection(0);\n        ɵngcc0.ɵɵtemplate(1, SplitComponent_ng_template_1_Template, 1, 1, \"ng-template\", 0);\n    } if (rf & 2) {\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"ngForOf\", ctx.displayedAreas);\n    } }, directives: [ɵngcc1.NgForOf, ɵngcc1.NgIf], styles: [\"[_nghost-%COMP%]{display:flex;flex-wrap:nowrap;justify-content:flex-start;align-items:stretch;overflow:hidden;width:100%;height:100%}[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;background-color:#eee;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%] > .as-split-gutter-icon[_ngcontent-%COMP%]{width:100%;height:100%;background-position:center center;background-repeat:no-repeat}[_nghost-%COMP%]    >.as-split-area{flex-grow:0;flex-shrink:0;overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]    >.as-split-area.as-hidden{flex:0 1 0!important;overflow-x:hidden;overflow-y:hidden}.as-horizontal[_nghost-%COMP%]{flex-direction:row}.as-horizontal[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-direction:row;cursor:col-resize;height:100%}.as-horizontal[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%] > .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==)}.as-horizontal[_nghost-%COMP%]    >.as-split-area{height:100%}.as-vertical[_nghost-%COMP%]{flex-direction:column}.as-vertical[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-direction:column;cursor:row-resize;width:100%}.as-vertical[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]   .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC)}.as-vertical[_nghost-%COMP%]    >.as-split-area{width:100%}.as-vertical[_nghost-%COMP%]    >.as-split-area.as-hidden{max-width:0}.as-disabled[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{cursor:default}.as-disabled[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]   .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(\\\"\\\")}.as-transition.as-init[_nghost-%COMP%]:not(.as-dragging)    >.as-split-area, .as-transition.as-init[_nghost-%COMP%]:not(.as-dragging) > .as-split-gutter[_ngcontent-%COMP%]{transition:flex-basis .3s}\"], changeDetection: 0 });\n/** @nocollapse */\nSplitComponent.ctorParameters = () => [\n    { type: NgZone },\n    { type: ElementRef },\n    { type: ChangeDetectorRef },\n    { type: Renderer2 }\n];\nSplitComponent.propDecorators = {\n    direction: [{ type: Input }],\n    unit: [{ type: Input }],\n    gutterSize: [{ type: Input }],\n    gutterStep: [{ type: Input }],\n    restrictMove: [{ type: Input }],\n    useTransition: [{ type: Input }],\n    disabled: [{ type: Input }],\n    dir: [{ type: Input }],\n    gutterDblClickDuration: [{ type: Input }],\n    dragStart: [{ type: Output }],\n    dragEnd: [{ type: Output }],\n    gutterClick: [{ type: Output }],\n    gutterDblClick: [{ type: Output }],\n    transitionEnd: [{ type: Output }],\n    gutterEls: [{ type: ViewChildren, args: ['gutterEls',] }]\n};\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SplitComponent, [{\n        type: Component,\n        args: [{\n                selector: 'as-split',\n                exportAs: 'asSplit',\n                changeDetection: ChangeDetectionStrategy.OnPush,\n                template: `\r\n        <ng-content></ng-content>\r\n        <ng-template ngFor [ngForOf]=\"displayedAreas\" let-index=\"index\" let-last=\"last\">\r\n            <div *ngIf=\"last === false\" \r\n                 #gutterEls\r\n                 class=\"as-split-gutter\"\r\n                 [style.flex-basis.px]=\"gutterSize\"\r\n                 [style.order]=\"index*2+1\"\r\n                 (mousedown)=\"startDragging($event, index*2+1, index+1)\"\r\n                 (touchstart)=\"startDragging($event, index*2+1, index+1)\"\r\n                 (mouseup)=\"clickGutter($event, index+1)\"\r\n                 (touchend)=\"clickGutter($event, index+1)\">\r\n                <div class=\"as-split-gutter-icon\"></div>\r\n            </div>\r\n        </ng-template>`,\n                styles: [\":host{display:flex;flex-wrap:nowrap;justify-content:flex-start;align-items:stretch;overflow:hidden;width:100%;height:100%}:host>.as-split-gutter{flex-grow:0;flex-shrink:0;background-color:#eee;display:flex;align-items:center;justify-content:center}:host>.as-split-gutter>.as-split-gutter-icon{width:100%;height:100%;background-position:center center;background-repeat:no-repeat}:host ::ng-deep>.as-split-area{flex-grow:0;flex-shrink:0;overflow-x:hidden;overflow-y:auto}:host ::ng-deep>.as-split-area.as-hidden{flex:0 1 0!important;overflow-x:hidden;overflow-y:hidden}:host.as-horizontal{flex-direction:row}:host.as-horizontal>.as-split-gutter{flex-direction:row;cursor:col-resize;height:100%}:host.as-horizontal>.as-split-gutter>.as-split-gutter-icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==)}:host.as-horizontal ::ng-deep>.as-split-area{height:100%}:host.as-vertical{flex-direction:column}:host.as-vertical>.as-split-gutter{flex-direction:column;cursor:row-resize;width:100%}:host.as-vertical>.as-split-gutter .as-split-gutter-icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC)}:host.as-vertical ::ng-deep>.as-split-area{width:100%}:host.as-vertical ::ng-deep>.as-split-area.as-hidden{max-width:0}:host.as-disabled>.as-split-gutter{cursor:default}:host.as-disabled>.as-split-gutter .as-split-gutter-icon{background-image:url(\\\"\\\")}:host.as-transition.as-init:not(.as-dragging) ::ng-deep>.as-split-area,:host.as-transition.as-init:not(.as-dragging)>.as-split-gutter{transition:flex-basis .3s}\"]\n            }]\n    }], function () { return [{ type: ɵngcc0.NgZone }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.Renderer2 }]; }, { dragStart: [{\n            type: Output\n        }], dragEnd: [{\n            type: Output\n        }], gutterClick: [{\n            type: Output\n        }], gutterDblClick: [{\n            type: Output\n        }], direction: [{\n            type: Input\n        }], unit: [{\n            type: Input\n        }], gutterSize: [{\n            type: Input\n        }], gutterStep: [{\n            type: Input\n        }], restrictMove: [{\n            type: Input\n        }], useTransition: [{\n            type: Input\n        }], disabled: [{\n            type: Input\n        }], dir: [{\n            type: Input\n        }], gutterDblClickDuration: [{\n            type: Input\n        }], transitionEnd: [{\n            type: Output\n        }], gutterEls: [{\n            type: ViewChildren,\n            args: ['gutterEls']\n        }] }); })();\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\nclass SplitAreaDirective {\n    /**\n     * @param {?} ngZone\n     * @param {?} elRef\n     * @param {?} renderer\n     * @param {?} split\n     */\n    constructor(ngZone, elRef, renderer, split) {\n        this.ngZone = ngZone;\n        this.elRef = elRef;\n        this.renderer = renderer;\n        this.split = split;\n        this._order = null;\n        ////\n        this._size = null;\n        ////\n        this._minSize = null;\n        ////\n        this._maxSize = null;\n        ////\n        this._lockSize = false;\n        ////\n        this._visible = true;\n        this.lockListeners = [];\n        this.renderer.addClass(this.elRef.nativeElement, 'as-split-area');\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set order(v) {\n        this._order = getInputPositiveNumber(v, null);\n        this.split.updateArea(this, true, false);\n    }\n    /**\n     * @return {?}\n     */\n    get order() {\n        return this._order;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set size(v) {\n        this._size = getInputPositiveNumber(v, null);\n        this.split.updateArea(this, false, true);\n    }\n    /**\n     * @return {?}\n     */\n    get size() {\n        return this._size;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set minSize(v) {\n        this._minSize = getInputPositiveNumber(v, null);\n        this.split.updateArea(this, false, true);\n    }\n    /**\n     * @return {?}\n     */\n    get minSize() {\n        return this._minSize;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set maxSize(v) {\n        this._maxSize = getInputPositiveNumber(v, null);\n        this.split.updateArea(this, false, true);\n    }\n    /**\n     * @return {?}\n     */\n    get maxSize() {\n        return this._maxSize;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set lockSize(v) {\n        this._lockSize = getInputBoolean(v);\n        this.split.updateArea(this, false, true);\n    }\n    /**\n     * @return {?}\n     */\n    get lockSize() {\n        return this._lockSize;\n    }\n    /**\n     * @param {?} v\n     * @return {?}\n     */\n    set visible(v) {\n        this._visible = getInputBoolean(v);\n        if (this._visible) {\n            this.split.showArea(this);\n            this.renderer.removeClass(this.elRef.nativeElement, 'as-hidden');\n        }\n        else {\n            this.split.hideArea(this);\n            this.renderer.addClass(this.elRef.nativeElement, 'as-hidden');\n        }\n    }\n    /**\n     * @return {?}\n     */\n    get visible() {\n        return this._visible;\n    }\n    /**\n     * @return {?}\n     */\n    ngOnInit() {\n        this.split.addArea(this);\n        this.ngZone.runOutsideAngular((/**\n         * @return {?}\n         */\n        () => {\n            this.transitionListener = this.renderer.listen(this.elRef.nativeElement, 'transitionend', (/**\n             * @param {?} event\n             * @return {?}\n             */\n            (event) => {\n                // Limit only flex-basis transition to trigger the event\n                if (event.propertyName === 'flex-basis') {\n                    this.split.notify('transitionEnd', -1);\n                }\n            }));\n        }));\n    }\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    setStyleOrder(value) {\n        this.renderer.setStyle(this.elRef.nativeElement, 'order', value);\n    }\n    /**\n     * @param {?} grow\n     * @param {?} shrink\n     * @param {?} basis\n     * @param {?} isMin\n     * @param {?} isMax\n     * @return {?}\n     */\n    setStyleFlex(grow, shrink, basis, isMin, isMax) {\n        // Need 3 separated properties to work on IE11 (https://github.com/angular/flex-layout/issues/323)\n        this.renderer.setStyle(this.elRef.nativeElement, 'flex-grow', grow);\n        this.renderer.setStyle(this.elRef.nativeElement, 'flex-shrink', shrink);\n        this.renderer.setStyle(this.elRef.nativeElement, 'flex-basis', basis);\n        if (isMin === true)\n            this.renderer.addClass(this.elRef.nativeElement, 'as-min');\n        else\n            this.renderer.removeClass(this.elRef.nativeElement, 'as-min');\n        if (isMax === true)\n            this.renderer.addClass(this.elRef.nativeElement, 'as-max');\n        else\n            this.renderer.removeClass(this.elRef.nativeElement, 'as-max');\n    }\n    /**\n     * @return {?}\n     */\n    lockEvents() {\n        this.ngZone.runOutsideAngular((/**\n         * @return {?}\n         */\n        () => {\n            this.lockListeners.push(this.renderer.listen(this.elRef.nativeElement, 'selectstart', (/**\n             * @param {?} e\n             * @return {?}\n             */\n            (e) => false)));\n            this.lockListeners.push(this.renderer.listen(this.elRef.nativeElement, 'dragstart', (/**\n             * @param {?} e\n             * @return {?}\n             */\n            (e) => false)));\n        }));\n    }\n    /**\n     * @return {?}\n     */\n    unlockEvents() {\n        while (this.lockListeners.length > 0) {\n            /** @type {?} */\n            const fct = this.lockListeners.pop();\n            if (fct)\n                fct();\n        }\n    }\n    /**\n     * @return {?}\n     */\n    ngOnDestroy() {\n        this.unlockEvents();\n        if (this.transitionListener) {\n            this.transitionListener();\n        }\n        this.split.removeArea(this);\n    }\n}\nSplitAreaDirective.ɵfac = function SplitAreaDirective_Factory(t) { return new (t || SplitAreaDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(SplitComponent)); };\nSplitAreaDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: SplitAreaDirective, selectors: [[\"as-split-area\"], [\"\", \"as-split-area\", \"\"]], inputs: { order: \"order\", size: \"size\", minSize: \"minSize\", maxSize: \"maxSize\", lockSize: \"lockSize\", visible: \"visible\" }, exportAs: [\"asSplitArea\"] });\n/** @nocollapse */\nSplitAreaDirective.ctorParameters = () => [\n    { type: NgZone },\n    { type: ElementRef },\n    { type: Renderer2 },\n    { type: SplitComponent }\n];\nSplitAreaDirective.propDecorators = {\n    order: [{ type: Input }],\n    size: [{ type: Input }],\n    minSize: [{ type: Input }],\n    maxSize: [{ type: Input }],\n    lockSize: [{ type: Input }],\n    visible: [{ type: Input }]\n};\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SplitAreaDirective, [{\n        type: Directive,\n        args: [{\n                selector: 'as-split-area, [as-split-area]',\n                exportAs: 'asSplitArea'\n            }]\n    }], function () { return [{ type: ɵngcc0.NgZone }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: SplitComponent }]; }, { order: [{\n            type: Input\n        }], size: [{\n            type: Input\n        }], minSize: [{\n            type: Input\n        }], maxSize: [{\n            type: Input\n        }], lockSize: [{\n            type: Input\n        }], visible: [{\n            type: Input\n        }] }); })();\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\nclass AngularSplitModule {\n    /**\n     * @return {?}\n     */\n    static forRoot() {\n        return {\n            ngModule: AngularSplitModule,\n            providers: []\n        };\n    }\n    /**\n     * @return {?}\n     */\n    static forChild() {\n        return {\n            ngModule: AngularSplitModule,\n            providers: []\n        };\n    }\n}\nAngularSplitModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: AngularSplitModule });\nAngularSplitModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function AngularSplitModule_Factory(t) { return new (t || AngularSplitModule)(); }, imports: [[\n            CommonModule\n        ]] });\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(AngularSplitModule, { declarations: function () { return [SplitComponent,\n        SplitAreaDirective]; }, imports: function () { return [CommonModule]; }, exports: function () { return [SplitComponent,\n        SplitAreaDirective]; } }); })();\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AngularSplitModule, [{\n        type: NgModule,\n        args: [{\n                imports: [\n                    CommonModule\n                ],\n                declarations: [\n                    SplitComponent,\n                    SplitAreaDirective,\n                ],\n                exports: [\n                    SplitComponent,\n                    SplitAreaDirective,\n                ]\n            }]\n    }], null, null); })();\n\nexport { AngularSplitModule, SplitAreaDirective, SplitComponent };\n\n//# sourceMappingURL=angular-split.js.map","/**\n * jsBezier\n *\n * Copyright (c) 2010 - 2017 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * licensed under the MIT license.\n *\n * a set of Bezier curve functions that deal with Beziers, used by jsPlumb, and perhaps useful for other people.  These functions work with Bezier\n * curves of arbitrary degree.\n *\n * - functions are all in the 'jsBezier' namespace.\n *\n * - all input points should be in the format {x:.., y:..}. all output points are in this format too.\n *\n * - all input curves should be in the format [ {x:.., y:..}, {x:.., y:..}, {x:.., y:..}, {x:.., y:..} ]\n *\n * - 'location' as used as an input here refers to a decimal in the range 0-1 inclusive, which indicates a point some proportion along the length\n * of the curve.  location as output has the same format and meaning.\n *\n *\n * Function List:\n * --------------\n *\n * distanceFromCurve(point, curve)\n *\n * \tCalculates the distance that the given point lies from the given Bezier.  Note that it is computed relative to the center of the Bezier,\n * so if you have stroked the curve with a wide pen you may wish to take that into account!  The distance returned is relative to the values\n * of the curve and the point - it will most likely be pixels.\n *\n * gradientAtPoint(curve, location)\n *\n * \tCalculates the gradient to the curve at the given location, as a decimal between 0 and 1 inclusive.\n *\n * gradientAtPointAlongCurveFrom (curve, location)\n *\n *\tCalculates the gradient at the point on the given curve that is 'distance' units from location.\n *\n * nearestPointOnCurve(point, curve)\n *\n *\tCalculates the nearest point to the given point on the given curve.  The return value of this is a JS object literal, containing both the\n *point's coordinates and also the 'location' of the point (see above), for example:  { point:{x:551,y:150}, location:0.263365 }.\n *\n * pointOnCurve(curve, location)\n *\n * \tCalculates the coordinates of the point on the given Bezier curve at the given location.\n *\n * pointAlongCurveFrom(curve, location, distance)\n *\n * \tCalculates the coordinates of the point on the given curve that is 'distance' units from location.  'distance' should be in the same coordinate\n * space as that used to construct the Bezier curve.  For an HTML Canvas usage, for example, distance would be a measure of pixels.\n *\n * locationAlongCurveFrom(curve, location, distance)\n *\n * \tCalculates the location on the given curve that is 'distance' units from location.  'distance' should be in the same coordinate\n * space as that used to construct the Bezier curve.  For an HTML Canvas usage, for example, distance would be a measure of pixels.\n *\n * perpendicularToCurveAt(curve, location, length, distance)\n *\n * \tCalculates the perpendicular to the given curve at the given location.  length is the length of the line you wish for (it will be centered\n * on the point at 'location'). distance is optional, and allows you to specify a point along the path from the given location as the center of\n * the perpendicular returned.  The return value of this is an array of two points: [ {x:...,y:...}, {x:...,y:...} ].\n *\n *\n */\n\n(function() {\n\n    var root = this;\n\n    if(typeof Math.sgn == \"undefined\") {\n        Math.sgn = function(x) { return x == 0 ? 0 : x > 0 ? 1 :-1; };\n    }\n\n    var Vectors = {\n            subtract \t: \tfunction(v1, v2) { return {x:v1.x - v2.x, y:v1.y - v2.y }; },\n            dotProduct\t: \tfunction(v1, v2) { return (v1.x * v2.x)  + (v1.y * v2.y); },\n            square\t\t:\tfunction(v) { return Math.sqrt((v.x * v.x) + (v.y * v.y)); },\n            scale\t\t:\tfunction(v, s) { return {x:v.x * s, y:v.y * s }; }\n        },\n\n        maxRecursion = 64,\n        flatnessTolerance = Math.pow(2.0,-maxRecursion-1);\n\n    /**\n     * Calculates the distance that the point lies from the curve.\n     *\n     * @param point a point in the form {x:567, y:3342}\n     * @param curve a Bezier curve in the form [{x:..., y:...}, {x:..., y:...}, {x:..., y:...}, {x:..., y:...}].  note that this is currently\n     * hardcoded to assume cubiz beziers, but would be better off supporting any degree.\n     * @return a JS object literal containing location and distance, for example: {location:0.35, distance:10}.  Location is analogous to the location\n     * argument you pass to the pointOnPath function: it is a ratio of distance travelled along the curve.  Distance is the distance in pixels from\n     * the point to the curve.\n     */\n    var _distanceFromCurve = function(point, curve) {\n        var candidates = [],\n            w = _convertToBezier(point, curve),\n            degree = curve.length - 1, higherDegree = (2 * degree) - 1,\n            numSolutions = _findRoots(w, higherDegree, candidates, 0),\n            v = Vectors.subtract(point, curve[0]), dist = Vectors.square(v), t = 0.0;\n\n        for (var i = 0; i < numSolutions; i++) {\n            v = Vectors.subtract(point, _bezier(curve, degree, candidates[i], null, null));\n            var newDist = Vectors.square(v);\n            if (newDist < dist) {\n                dist = newDist;\n                t = candidates[i];\n            }\n        }\n        v = Vectors.subtract(point, curve[degree]);\n        newDist = Vectors.square(v);\n        if (newDist < dist) {\n            dist = newDist;\n            t = 1.0;\n        }\n        return {location:t, distance:dist};\n    };\n    /**\n     * finds the nearest point on the curve to the given point.\n     */\n    var _nearestPointOnCurve = function(point, curve) {\n        var td = _distanceFromCurve(point, curve);\n        return {point:_bezier(curve, curve.length - 1, td.location, null, null), location:td.location};\n    };\n    var _convertToBezier = function(point, curve) {\n        var degree = curve.length - 1, higherDegree = (2 * degree) - 1,\n            c = [], d = [], cdTable = [], w = [],\n            z = [ [1.0, 0.6, 0.3, 0.1], [0.4, 0.6, 0.6, 0.4], [0.1, 0.3, 0.6, 1.0] ];\n\n        for (var i = 0; i <= degree; i++) c[i] = Vectors.subtract(curve[i], point);\n        for (var i = 0; i <= degree - 1; i++) {\n            d[i] = Vectors.subtract(curve[i+1], curve[i]);\n            d[i] = Vectors.scale(d[i], 3.0);\n        }\n        for (var row = 0; row <= degree - 1; row++) {\n            for (var column = 0; column <= degree; column++) {\n                if (!cdTable[row]) cdTable[row] = [];\n                cdTable[row][column] = Vectors.dotProduct(d[row], c[column]);\n            }\n        }\n        for (i = 0; i <= higherDegree; i++) {\n            if (!w[i]) w[i] = [];\n            w[i].y = 0.0;\n            w[i].x = parseFloat(i) / higherDegree;\n        }\n        var n = degree, m = degree-1;\n        for (var k = 0; k <= n + m; k++) {\n            var lb = Math.max(0, k - m),\n                ub = Math.min(k, n);\n            for (i = lb; i <= ub; i++) {\n                var j = k - i;\n                w[i+j].y += cdTable[j][i] * z[j][i];\n            }\n        }\n        return w;\n    };\n    /**\n     * counts how many roots there are.\n     */\n    var _findRoots = function(w, degree, t, depth) {\n        var left = [], right = [],\n            left_count, right_count,\n            left_t = [], right_t = [];\n\n        switch (_getCrossingCount(w, degree)) {\n            case 0 : {\n                return 0;\n            }\n            case 1 : {\n                if (depth >= maxRecursion) {\n                    t[0] = (w[0].x + w[degree].x) / 2.0;\n                    return 1;\n                }\n                if (_isFlatEnough(w, degree)) {\n                    t[0] = _computeXIntercept(w, degree);\n                    return 1;\n                }\n                break;\n            }\n        }\n        _bezier(w, degree, 0.5, left, right);\n        left_count  = _findRoots(left,  degree, left_t, depth+1);\n        right_count = _findRoots(right, degree, right_t, depth+1);\n        for (var i = 0; i < left_count; i++) t[i] = left_t[i];\n        for (var i = 0; i < right_count; i++) t[i+left_count] = right_t[i];\n        return (left_count+right_count);\n    };\n    var _getCrossingCount = function(curve, degree) {\n        var n_crossings = 0, sign, old_sign;\n        sign = old_sign = Math.sgn(curve[0].y);\n        for (var i = 1; i <= degree; i++) {\n            sign = Math.sgn(curve[i].y);\n            if (sign != old_sign) n_crossings++;\n            old_sign = sign;\n        }\n        return n_crossings;\n    };\n    var _isFlatEnough = function(curve, degree) {\n        var  error,\n            intercept_1, intercept_2, left_intercept, right_intercept,\n            a, b, c, det, dInv, a1, b1, c1, a2, b2, c2;\n        a = curve[0].y - curve[degree].y;\n        b = curve[degree].x - curve[0].x;\n        c = curve[0].x * curve[degree].y - curve[degree].x * curve[0].y;\n\n        var max_distance_above, max_distance_below;\n        max_distance_above = max_distance_below = 0.0;\n\n        for (var i = 1; i < degree; i++) {\n            var value = a * curve[i].x + b * curve[i].y + c;\n            if (value > max_distance_above)\n                max_distance_above = value;\n            else if (value < max_distance_below)\n                max_distance_below = value;\n        }\n\n        a1 = 0.0; b1 = 1.0; c1 = 0.0; a2 = a; b2 = b;\n        c2 = c - max_distance_above;\n        det = a1 * b2 - a2 * b1;\n        dInv = 1.0/det;\n        intercept_1 = (b1 * c2 - b2 * c1) * dInv;\n        a2 = a; b2 = b; c2 = c - max_distance_below;\n        det = a1 * b2 - a2 * b1;\n        dInv = 1.0/det;\n        intercept_2 = (b1 * c2 - b2 * c1) * dInv;\n        left_intercept = Math.min(intercept_1, intercept_2);\n        right_intercept = Math.max(intercept_1, intercept_2);\n        error = right_intercept - left_intercept;\n        return (error < flatnessTolerance)? 1 : 0;\n    };\n    var _computeXIntercept = function(curve, degree) {\n        var XLK = 1.0, YLK = 0.0,\n            XNM = curve[degree].x - curve[0].x, YNM = curve[degree].y - curve[0].y,\n            XMK = curve[0].x - 0.0, YMK = curve[0].y - 0.0,\n            det = XNM*YLK - YNM*XLK, detInv = 1.0/det,\n            S = (XNM*YMK - YNM*XMK) * detInv;\n        return 0.0 + XLK * S;\n    };\n    var _bezier = function(curve, degree, t, left, right) {\n        var temp = [[]];\n        for (var j =0; j <= degree; j++) temp[0][j] = curve[j];\n        for (var i = 1; i <= degree; i++) {\n            for (var j =0 ; j <= degree - i; j++) {\n                if (!temp[i]) temp[i] = [];\n                if (!temp[i][j]) temp[i][j] = {};\n                temp[i][j].x = (1.0 - t) * temp[i-1][j].x + t * temp[i-1][j+1].x;\n                temp[i][j].y = (1.0 - t) * temp[i-1][j].y + t * temp[i-1][j+1].y;\n            }\n        }\n        if (left != null)\n            for (j = 0; j <= degree; j++) left[j]  = temp[j][0];\n        if (right != null)\n            for (j = 0; j <= degree; j++) right[j] = temp[degree-j][j];\n\n        return (temp[degree][0]);\n    };\n\n    var _curveFunctionCache = {};\n    var _getCurveFunctions = function(order) {\n        var fns = _curveFunctionCache[order];\n        if (!fns) {\n            fns = [];\n            var f_term = function() { return function(t) { return Math.pow(t, order); }; },\n                l_term = function() { return function(t) { return Math.pow((1-t), order); }; },\n                c_term = function(c) { return function(t) { return c; }; },\n                t_term = function() { return function(t) { return t; }; },\n                one_minus_t_term = function() { return function(t) { return 1-t; }; },\n                _termFunc = function(terms) {\n                    return function(t) {\n                        var p = 1;\n                        for (var i = 0; i < terms.length; i++) p = p * terms[i](t);\n                        return p;\n                    };\n                };\n\n            fns.push(new f_term());  // first is t to the power of the curve order\n            for (var i = 1; i < order; i++) {\n                var terms = [new c_term(order)];\n                for (var j = 0 ; j < (order - i); j++) terms.push(new t_term());\n                for (var j = 0 ; j < i; j++) terms.push(new one_minus_t_term());\n                fns.push(new _termFunc(terms));\n            }\n            fns.push(new l_term());  // last is (1-t) to the power of the curve order\n\n            _curveFunctionCache[order] = fns;\n        }\n\n        return fns;\n    };\n\n\n    /**\n     * calculates a point on the curve, for a Bezier of arbitrary order.\n     * @param curve an array of control points, eg [{x:10,y:20}, {x:50,y:50}, {x:100,y:100}, {x:120,y:100}].  For a cubic bezier this should have four points.\n     * @param location a decimal indicating the distance along the curve the point should be located at.  this is the distance along the curve as it travels, taking the way it bends into account.  should be a number from 0 to 1, inclusive.\n     */\n    var _pointOnPath = function(curve, location) {\n        var cc = _getCurveFunctions(curve.length - 1),\n            _x = 0, _y = 0;\n        for (var i = 0; i < curve.length ; i++) {\n            _x = _x + (curve[i].x * cc[i](location));\n            _y = _y + (curve[i].y * cc[i](location));\n        }\n\n        return {x:_x, y:_y};\n    };\n\n    var _dist = function(p1,p2) {\n        return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n    };\n\n    var _isPoint = function(curve) {\n        return curve[0].x === curve[1].x && curve[0].y === curve[1].y;\n    };\n\n    /**\n     * finds the point that is 'distance' along the path from 'location'.  this method returns both the x,y location of the point and also\n     * its 'location' (proportion of travel along the path); the method below - _pointAlongPathFrom - calls this method and just returns the\n     * point.\n     */\n    var _pointAlongPath = function(curve, location, distance) {\n        \n        if (_isPoint(curve)) {\n            return {\n                point:curve[0],\n                location:location\n            };\n        }\n\n        var prev = _pointOnPath(curve, location),\n            tally = 0,\n            curLoc = location,\n            direction = distance > 0 ? 1 : -1,\n            cur = null;\n\n        while (tally < Math.abs(distance)) {\n            curLoc += (0.005 * direction);\n            cur = _pointOnPath(curve, curLoc);\n            tally += _dist(cur, prev);\n            prev = cur;\n        }\n\n        return {point:cur, location:curLoc};\n    };\n\n    var _length = function(curve) {\n\n        var d = new Date().getTime();\n\n        if (_isPoint(curve)) return 0;\n\n        var prev = _pointOnPath(curve, 0),\n            tally = 0,\n            curLoc = 0,\n            direction = 1,\n            cur = null;\n\n        while (curLoc < 1) {\n            curLoc += (0.005 * direction);\n            cur = _pointOnPath(curve, curLoc);\n            tally += _dist(cur, prev);\n            prev = cur;\n        }\n        console.log(\"length\", new Date().getTime() - d);\n\n        return tally;\n    };\n\n    /**\n     * finds the point that is 'distance' along the path from 'location'.\n     */\n    var _pointAlongPathFrom = function(curve, location, distance) {\n        return _pointAlongPath(curve, location, distance).point;\n    };\n\n    /**\n     * finds the location that is 'distance' along the path from 'location'.\n     */\n    var _locationAlongPathFrom = function(curve, location, distance) {\n        return _pointAlongPath(curve, location, distance).location;\n    };\n\n    /**\n     * returns the gradient of the curve at the given location, which is a decimal between 0 and 1 inclusive.\n     *\n     * thanks // http://bimixual.org/AnimationLibrary/beziertangents.html\n     */\n    var _gradientAtPoint = function(curve, location) {\n\n        var p1 = _pointOnPath(curve, location),\n            p2 = _pointOnPath(curve.slice(0, curve.length - 1), location),\n            dy = p2.y - p1.y, dx = p2.x - p1.x;\n\n        return dy === 0 ? Infinity : Math.atan(dy / dx);\n    };\n\n    /**\n     returns the gradient of the curve at the point which is 'distance' from the given location.\n     if this point is greater than location 1, the gradient at location 1 is returned.\n     if this point is less than location 0, the gradient at location 0 is returned.\n     */\n    var _gradientAtPointAlongPathFrom = function(curve, location, distance) {\n        var p = _pointAlongPath(curve, location, distance);\n        if (p.location > 1) p.location = 1;\n        if (p.location < 0) p.location = 0;\n        return _gradientAtPoint(curve, p.location);\n    };\n\n    /**\n     * calculates a line that is 'length' pixels long, perpendicular to, and centered on, the path at 'distance' pixels from the given location.\n     * if distance is not supplied, the perpendicular for the given location is computed (ie. we set distance to zero).\n     */\n    var _perpendicularToPathAt = function(curve, location, length, distance) {\n        distance = distance == null ? 0 : distance;\n        var p = _pointAlongPath(curve, location, distance),\n            m = _gradientAtPoint(curve, p.location),\n            _theta2 = Math.atan(-1 / m),\n            y =  length / 2 * Math.sin(_theta2),\n            x =  length / 2 * Math.cos(_theta2);\n        return [{x:p.point.x + x, y:p.point.y + y}, {x:p.point.x - x, y:p.point.y - y}];\n    };\n\n    /**\n     * Calculates all intersections of the given line with the given curve.\n     * @param x1\n     * @param y1\n     * @param x2\n     * @param y2\n     * @param curve\n     * @returns {Array}\n     */\n    var _lineIntersection = function(x1, y1, x2, y2, curve) {\n        var a = y2 - y1,\n            b = x1 - x2,\n            c = (x1 * (y1 - y2)) + (y1 * (x2-x1)),\n            coeffs = _computeCoefficients(curve),\n            p = [\n                (a*coeffs[0][0]) + (b * coeffs[1][0]),\n                (a*coeffs[0][1])+(b*coeffs[1][1]),\n                (a*coeffs[0][2])+(b*coeffs[1][2]),\n                (a*coeffs[0][3])+(b*coeffs[1][3]) + c\n            ],\n            r = _cubicRoots.apply(null, p),\n            intersections = [];\n\n        if (r != null) {\n\n            for (var i = 0; i < 3; i++) {\n                var t = r[i],\n                    t2 = Math.pow(t, 2),\n                    t3 = Math.pow(t, 3),\n                    x = [\n                        (coeffs[0][0] * t3) + (coeffs[0][1] * t2) + (coeffs[0][2] * t) + coeffs[0][3],\n                        (coeffs[1][0] * t3) + (coeffs[1][1] * t2) + (coeffs[1][2] * t) + coeffs[1][3]\n                    ];\n\n                // check bounds of the line\n                var s;\n                if ((x2 - x1) !== 0) {\n                    s = (x[0] - x1) / (x2 - x1);\n                }\n                else {\n                    s = (x[1] - y1) / (y2 - y1);\n                }\n\n                if (t >= 0 && t <= 1.0 && s >= 0 && s <= 1.0) {\n                    intersections.push(x);\n                }\n            }\n        }\n\n        return intersections;\n    };\n\n    /**\n     * Calculates all intersections of the given box with the given curve.\n     * @param x X position of top left corner of box\n     * @param y Y position of top left corner of box\n     * @param w width of box\n     * @param h height of box\n     * @param curve\n     * @returns {Array}\n     */\n    var _boxIntersection = function(x, y, w, h, curve) {\n        var i = [];\n        i.push.apply(i, _lineIntersection(x, y, x + w, y, curve));\n        i.push.apply(i, _lineIntersection(x + w, y, x + w, y + h, curve));\n        i.push.apply(i, _lineIntersection(x + w, y + h, x, y + h, curve));\n        i.push.apply(i, _lineIntersection(x, y + h, x, y, curve));\n        return i;\n    };\n\n    /**\n     * Calculates all intersections of the given bounding box with the given curve.\n     * @param boundingBox Bounding box, in { x:.., y:..., w:..., h:... } format.\n     * @param curve\n     * @returns {Array}\n     */\n    var _boundingBoxIntersection = function(boundingBox, curve) {\n        var i = [];\n        i.push.apply(i, _lineIntersection(boundingBox.x, boundingBox.y, boundingBox.x + boundingBox.w, boundingBox.y, curve));\n        i.push.apply(i, _lineIntersection(boundingBox.x + boundingBox.w, boundingBox.y, boundingBox.x + boundingBox.w, boundingBox.y + boundingBox.h, curve));\n        i.push.apply(i, _lineIntersection(boundingBox.x + boundingBox.w, boundingBox.y + boundingBox.h, boundingBox.x, boundingBox.y + boundingBox.h, curve));\n        i.push.apply(i, _lineIntersection(boundingBox.x, boundingBox.y + boundingBox.h, boundingBox.x, boundingBox.y, curve));\n        return i;\n    };\n\n\n    function _computeCoefficientsForAxis(curve, axis) {\n        return [\n            -(curve[0][axis]) + (3*curve[1][axis]) + (-3 * curve[2][axis]) + curve[3][axis],\n            (3*(curve[0][axis])) - (6*(curve[1][axis])) + (3*(curve[2][axis])),\n            -3*curve[0][axis] + 3*curve[1][axis],\n            curve[0][axis]\n        ];\n    }\n\n    function _computeCoefficients(curve)\n    {\n        return [\n            _computeCoefficientsForAxis(curve, \"x\"),\n            _computeCoefficientsForAxis(curve, \"y\")\n        ];\n    }\n\n    function sgn(x) {\n        return x < 0 ? -1 : x > 0 ? 1 : 0;\n    }\n\n    function _cubicRoots(a, b, c, d) {\n        var A = b / a,\n            B = c / a,\n            C = d / a,\n            Q = (3*B - Math.pow(A, 2))/9,\n            R = (9*A*B - 27*C - 2*Math.pow(A, 3))/54,\n            D = Math.pow(Q, 3) + Math.pow(R, 2),\n            S,\n            T,\n            t = [];\n\n        if (D >= 0)                                 // complex or duplicate roots\n        {\n            S = sgn(R + Math.sqrt(D))*Math.pow(Math.abs(R + Math.sqrt(D)),(1/3));\n            T = sgn(R - Math.sqrt(D))*Math.pow(Math.abs(R - Math.sqrt(D)),(1/3));\n\n            t[0] = -A/3 + (S + T);\n            t[1] = -A/3 - (S + T)/2;\n            t[2] = -A/3 - (S + T)/2;\n\n            /*discard complex roots*/\n            if (Math.abs(Math.sqrt(3)*(S - T)/2) !== 0) {\n                t[1] = -1;\n                t[2] = -1;\n            }\n        }\n        else                                          // distinct real roots\n        {\n            var th = Math.acos(R/Math.sqrt(-Math.pow(Q, 3)));\n            t[0] = 2*Math.sqrt(-Q)*Math.cos(th/3) - A/3;\n            t[1] = 2*Math.sqrt(-Q)*Math.cos((th + 2*Math.PI)/3) - A/3;\n            t[2] = 2*Math.sqrt(-Q)*Math.cos((th + 4*Math.PI)/3) - A/3;\n        }\n\n        // discard out of spec roots\n        for (var i = 0; i < 3; i++) {\n            if (t[i] < 0 || t[i] > 1.0) {\n                t[i] = -1;\n            }\n        }\n\n        return t;\n    }\n\n    var jsBezier = this.jsBezier = {\n        distanceFromCurve : _distanceFromCurve,\n        gradientAtPoint : _gradientAtPoint,\n        gradientAtPointAlongCurveFrom : _gradientAtPointAlongPathFrom,\n        nearestPointOnCurve : _nearestPointOnCurve,\n        pointOnCurve : _pointOnPath,\n        pointAlongCurveFrom : _pointAlongPathFrom,\n        perpendicularToCurveAt : _perpendicularToPathAt,\n        locationAlongCurveFrom:_locationAlongPathFrom,\n        getLength:_length,\n        lineIntersection:_lineIntersection,\n        boxIntersection:_boxIntersection,\n        boundingBoxIntersection:_boundingBoxIntersection,\n        version:\"0.9.0\"\n    };\n\n    if (typeof exports !== \"undefined\") {\n        exports.jsBezier = jsBezier;\n    }\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/**\n * Biltong v0.4.0\n *\n * Various geometry functions written as part of jsPlumb and perhaps useful for others.\n *\n * Copyright (c) 2017 jsPlumb\n * https://jsplumbtoolkit.com\n *\n * Permission is hereby granted, free of charge, to any person\n * obtaining a copy of this software and associated documentation\n * files (the \"Software\"), to deal in the Software without\n * restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following\n * conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n * OTHER DEALINGS IN THE SOFTWARE.\n */\n;(function() {\n\n    \"use strict\";\n    var root = this;\n\n    var Biltong = root.Biltong = {\n        version:\"0.4.0\"\n    };\n\n    if (typeof exports !== \"undefined\") {\n        exports.Biltong = Biltong;\n    }\n\n    var _isa = function(a) { return Object.prototype.toString.call(a) === \"[object Array]\"; },\n        _pointHelper = function(p1, p2, fn) {\n            p1 = _isa(p1) ? p1 : [p1.x, p1.y];\n            p2 = _isa(p2) ? p2 : [p2.x, p2.y];\n            return fn(p1, p2);\n        },\n        /**\n         * @name Biltong.gradient\n         * @function\n         * @desc Calculates the gradient of a line between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The gradient of a line between the two points.\n         */\n        _gradient = Biltong.gradient = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                if (_p2[0] == _p1[0])\n                    return _p2[1] > _p1[1] ? Infinity : -Infinity;\n                else if (_p2[1] == _p1[1])\n                    return _p2[0] > _p1[0] ? 0 : -0;\n                else\n                    return (_p2[1] - _p1[1]) / (_p2[0] - _p1[0]);\n            });\n        },\n        /**\n         * @name Biltong.normal\n         * @function\n         * @desc Calculates the gradient of a normal to a line between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The gradient of a normal to a line between the two points.\n         */\n        _normal = Biltong.normal = function(p1, p2) {\n            return -1 / _gradient(p1, p2);\n        },\n        /**\n         * @name Biltong.lineLength\n         * @function\n         * @desc Calculates the length of a line between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The length of a line between the two points.\n         */\n        _lineLength = Biltong.lineLength = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                return Math.sqrt(Math.pow(_p2[1] - _p1[1], 2) + Math.pow(_p2[0] - _p1[0], 2));\n            });\n        },\n        /**\n         * @name Biltong.quadrant\n         * @function\n         * @desc Calculates the quadrant in which the angle between the two points lies.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Integer} The quadrant - 1 for upper right, 2 for lower right, 3 for lower left, 4 for upper left.\n         */\n        _quadrant = Biltong.quadrant = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                if (_p2[0] > _p1[0]) {\n                    return (_p2[1] > _p1[1]) ? 2 : 1;\n                }\n                else if (_p2[0] == _p1[0]) {\n                    return _p2[1] > _p1[1] ? 2 : 1;\n                }\n                else {\n                    return (_p2[1] > _p1[1]) ? 3 : 4;\n                }\n            });\n        },\n        /**\n         * @name Biltong.theta\n         * @function\n         * @desc Calculates the angle between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The angle between the two points.\n         */\n        _theta = Biltong.theta = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                var m = _gradient(_p1, _p2),\n                    t = Math.atan(m),\n                    s = _quadrant(_p1, _p2);\n                if ((s == 4 || s== 3)) t += Math.PI;\n                if (t < 0) t += (2 * Math.PI);\n\n                return t;\n            });\n        },\n        /**\n         * @name Biltong.intersects\n         * @function\n         * @desc Calculates whether or not the two rectangles intersect.\n         * @param {Rectangle} r1 First rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @param {Rectangle} r2 Second rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @return {Boolean} True if the rectangles intersect, false otherwise.\n         */\n        _intersects = Biltong.intersects = function(r1, r2) {\n            var x1 = r1.x, x2 = r1.x + r1.w, y1 = r1.y, y2 = r1.y + r1.h,\n                a1 = r2.x, a2 = r2.x + r2.w, b1 = r2.y, b2 = r2.y + r2.h;\n\n            return  ( (x1 <= a1 && a1 <= x2) && (y1 <= b1 && b1 <= y2) ) ||\n                ( (x1 <= a2 && a2 <= x2) && (y1 <= b1 && b1 <= y2) ) ||\n                ( (x1 <= a1 && a1 <= x2) && (y1 <= b2 && b2 <= y2) ) ||\n                ( (x1 <= a2 && a1 <= x2) && (y1 <= b2 && b2 <= y2) ) ||\n                ( (a1 <= x1 && x1 <= a2) && (b1 <= y1 && y1 <= b2) ) ||\n                ( (a1 <= x2 && x2 <= a2) && (b1 <= y1 && y1 <= b2) ) ||\n                ( (a1 <= x1 && x1 <= a2) && (b1 <= y2 && y2 <= b2) ) ||\n                ( (a1 <= x2 && x1 <= a2) && (b1 <= y2 && y2 <= b2) );\n        },\n        /**\n         * @name Biltong.encloses\n         * @function\n         * @desc Calculates whether or not r2 is completely enclosed by r1.\n         * @param {Rectangle} r1 First rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @param {Rectangle} r2 Second rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @param {Boolean} [allowSharedEdges=false] If true, the concept of enclosure allows for one or more edges to be shared by the two rectangles.\n         * @return {Boolean} True if r1 encloses r2, false otherwise.\n         */\n        _encloses = Biltong.encloses = function(r1, r2, allowSharedEdges) {\n            var x1 = r1.x, x2 = r1.x + r1.w, y1 = r1.y, y2 = r1.y + r1.h,\n                a1 = r2.x, a2 = r2.x + r2.w, b1 = r2.y, b2 = r2.y + r2.h,\n                c = function(v1, v2, v3, v4) { return allowSharedEdges ? v1 <= v2 && v3>= v4 : v1 < v2 && v3 > v4; };\n\n            return c(x1,a1,x2,a2) && c(y1,b1,y2,b2);\n        },\n        _segmentMultipliers = [null, [1, -1], [1, 1], [-1, 1], [-1, -1] ],\n        _inverseSegmentMultipliers = [null, [-1, -1], [-1, 1], [1, 1], [1, -1] ],\n        /**\n         * @name Biltong.pointOnLine\n         * @function\n         * @desc Calculates a point on the line from `fromPoint` to `toPoint` that is `distance` units along the length of the line.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Point} Point on the line, in the form `{ x:..., y:... }`.\n         */\n        _pointOnLine = Biltong.pointOnLine = function(fromPoint, toPoint, distance) {\n            var m = _gradient(fromPoint, toPoint),\n                s = _quadrant(fromPoint, toPoint),\n                segmentMultiplier = distance > 0 ? _segmentMultipliers[s] : _inverseSegmentMultipliers[s],\n                theta = Math.atan(m),\n                y = Math.abs(distance * Math.sin(theta)) * segmentMultiplier[1],\n                x =  Math.abs(distance * Math.cos(theta)) * segmentMultiplier[0];\n            return { x:fromPoint.x + x, y:fromPoint.y + y };\n        },\n        /**\n         * @name Biltong.perpendicularLineTo\n         * @function\n         * @desc Calculates a line of length `length` that is perpendicular to the line from `fromPoint` to `toPoint` and passes through `toPoint`.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Line} Perpendicular line, in the form `[ { x:..., y:... }, { x:..., y:... } ]`.\n         */\n        _perpendicularLineTo = Biltong.perpendicularLineTo = function(fromPoint, toPoint, length) {\n            var m = _gradient(fromPoint, toPoint),\n                theta2 = Math.atan(-1 / m),\n                y =  length / 2 * Math.sin(theta2),\n                x =  length / 2 * Math.cos(theta2);\n            return [{x:toPoint.x + x, y:toPoint.y + y}, {x:toPoint.x - x, y:toPoint.y - y}];\n        };\n}).call(typeof window !== 'undefined' ? window : this);\n;\n(function () {\n\n    \"use strict\";\n\n    /**\n     * Creates a Touch object.\n     * @param view\n     * @param target\n     * @param pageX\n     * @param pageY\n     * @param screenX\n     * @param screenY\n     * @param clientX\n     * @param clientY\n     * @returns {Touch}\n     * @private\n     */\n    function _touch(view, target, pageX, pageY, screenX, screenY, clientX, clientY) {\n\n            return new Touch({\n                target:target,\n                identifier:_uuid(),\n                pageX: pageX,\n                pageY: pageY,\n                screenX: screenX,\n                screenY: screenY,\n                clientX: clientX || screenX,\n                clientY: clientY || screenY\n            });\n    }\n\n    /**\n     * Create a synthetic touch list from the given list of Touch objects.\n     * @returns {Array}\n     * @private\n     */\n    function _touchList() {\n        var list = [];\n        Array.prototype.push.apply(list, arguments);\n        list.item =  function(index) { return this[index]; };\n        return list;\n    }\n\n    /**\n     * Create a Touch object and then insert it into a synthetic touch list, returning the list.s\n     * @param view\n     * @param target\n     * @param pageX\n     * @param pageY\n     * @param screenX\n     * @param screenY\n     * @param clientX\n     * @param clientY\n     * @returns {Array}\n     * @private\n     */\n    function _touchAndList(view, target, pageX, pageY, screenX, screenY, clientX, clientY) {\n        return _touchList(_touch.apply(null, arguments));\n    }\n\n    var root = this,\n        matchesSelector = function (el, selector, ctx) {\n            ctx = ctx || el.parentNode;\n            var possibles = ctx.querySelectorAll(selector);\n            for (var i = 0; i < possibles.length; i++) {\n                if (possibles[i] === el) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        _gel = function (el) {\n            return (typeof el == \"string\" || el.constructor === String) ? document.getElementById(el) : el;\n        },\n        _t = function (e) {\n            return e.srcElement || e.target;\n        },\n    //\n    // gets path info for the given event - the path from target to obj, in the event's bubble chain. if doCompute\n    // is false we just return target for the path.\n    //\n        _pi = function(e, target, obj, doCompute) {\n            if (!doCompute) return { path:[target], end:1 };\n            else if (typeof e.path !== \"undefined\" && e.path.indexOf) {\n                return { path: e.path, end: e.path.indexOf(obj) };\n            } else {\n                var out = { path:[], end:-1 }, _one = function(el) {\n                    out.path.push(el);\n                    if (el === obj) {\n                        out.end = out.path.length - 1;\n                    }\n                    else if (el.parentNode != null) {\n                        _one(el.parentNode)\n                    }\n                };\n                _one(target);\n                return out;\n            }\n        },\n        _d = function (l, fn) {\n            for (var i = 0, j = l.length; i < j; i++) {\n                if (l[i] == fn) break;\n            }\n            if (i < l.length) l.splice(i, 1);\n        },\n        guid = 1,\n    //\n    // this function generates a guid for every handler, sets it on the handler, then adds\n    // it to the associated object's map of handlers for the given event. this is what enables us\n    // to unbind all events of some type, or all events (the second of which can be requested by the user,\n    // but it also used by Mottle when an element is removed.)\n        _store = function (obj, event, fn) {\n            var g = guid++;\n            obj.__ta = obj.__ta || {};\n            obj.__ta[event] = obj.__ta[event] || {};\n            // store each handler with a unique guid.\n            obj.__ta[event][g] = fn;\n            // set the guid on the handler.\n            fn.__tauid = g;\n            return g;\n        },\n        _unstore = function (obj, event, fn) {\n            obj.__ta && obj.__ta[event] && delete obj.__ta[event][fn.__tauid];\n            // a handler might have attached extra functions, so we unbind those too.\n            if (fn.__taExtra) {\n                for (var i = 0; i < fn.__taExtra.length; i++) {\n                    _unbind(obj, fn.__taExtra[i][0], fn.__taExtra[i][1]);\n                }\n                fn.__taExtra.length = 0;\n            }\n            // a handler might have attached an unstore callback\n            fn.__taUnstore && fn.__taUnstore();\n        },\n        _curryChildFilter = function (children, obj, fn, evt) {\n            if (children == null) return fn;\n            else {\n                var c = children.split(\",\"),\n                    _fn = function (e) {\n                        _fn.__tauid = fn.__tauid;\n                        var t = _t(e), target = t;  // t is the target element on which the event occurred. it is the\n                        // element we will wish to pass to any callbacks.\n                        var pathInfo = _pi(e, t, obj, children != null)\n                        if (pathInfo.end != -1) {\n                            for (var p = 0; p < pathInfo.end; p++) {\n                                target = pathInfo.path[p];\n                                for (var i = 0; i < c.length; i++) {\n                                    if (matchesSelector(target, c[i], obj)) {\n                                        fn.apply(target, arguments);\n                                    }\n                                }\n                            }\n                        }\n                    };\n                registerExtraFunction(fn, evt, _fn);\n                return _fn;\n            }\n        },\n    //\n    // registers an 'extra' function on some event listener function we were given - a function that we\n    // created and bound to the element as part of our housekeeping, and which we want to unbind and remove\n    // whenever the given function is unbound.\n        registerExtraFunction = function (fn, evt, newFn) {\n            fn.__taExtra = fn.__taExtra || [];\n            fn.__taExtra.push([evt, newFn]);\n        },\n        DefaultHandler = function (obj, evt, fn, children) {\n            if (isTouchDevice && touchMap[evt]) {\n                var tfn = _curryChildFilter(children, obj, fn, touchMap[evt]);\n                _bind(obj, touchMap[evt], tfn , fn);\n            }\n            if (evt === \"focus\" && obj.getAttribute(\"tabindex\") == null) {\n                obj.setAttribute(\"tabindex\", \"1\");\n            }\n            _bind(obj, evt, _curryChildFilter(children, obj, fn, evt), fn);\n        },\n        SmartClickHandler = function (obj, evt, fn, children) {\n            if (obj.__taSmartClicks == null) {\n                var down = function (e) {\n                        obj.__tad = _pageLocation(e);\n                    },\n                    up = function (e) {\n                        obj.__tau = _pageLocation(e);\n                    },\n                    click = function (e) {\n                        if (obj.__tad && obj.__tau && obj.__tad[0] === obj.__tau[0] && obj.__tad[1] === obj.__tau[1]) {\n                            for (var i = 0; i < obj.__taSmartClicks.length; i++)\n                                obj.__taSmartClicks[i].apply(_t(e), [ e ]);\n                        }\n                    };\n                DefaultHandler(obj, \"mousedown\", down, children);\n                DefaultHandler(obj, \"mouseup\", up, children);\n                DefaultHandler(obj, \"click\", click, children);\n                obj.__taSmartClicks = [];\n            }\n\n            // store in the list of callbacks\n            obj.__taSmartClicks.push(fn);\n            // the unstore function removes this function from the object's listener list for this type.\n            fn.__taUnstore = function () {\n                _d(obj.__taSmartClicks, fn);\n            };\n        },\n        _tapProfiles = {\n            \"tap\": {touches: 1, taps: 1},\n            \"dbltap\": {touches: 1, taps: 2},\n            \"contextmenu\": {touches: 2, taps: 1}\n        },\n        TapHandler = function (clickThreshold, dblClickThreshold) {\n            return function (obj, evt, fn, children) {\n                // if event is contextmenu, for devices which are mouse only, we want to\n                // use the default bind.\n                if (evt == \"contextmenu\" && isMouseDevice)\n                    DefaultHandler(obj, evt, fn, children);\n                else {\n                    // the issue here is that this down handler gets registered only for the\n                    // child nodes in the first registration. in fact it should be registered with\n                    // no child selector and then on down we should cycle through the registered\n                    // functions to see if one of them matches. on mouseup we should execute ALL of\n                    // the functions whose children are either null or match the element.\n                    if (obj.__taTapHandler == null) {\n                        var tt = obj.__taTapHandler = {\n                            tap: [],\n                            dbltap: [],\n                            contextmenu: [],\n                            down: false,\n                            taps: 0,\n                            downSelectors: []\n                        };\n                        var down = function (e) {\n                                var target = _t(e), pathInfo = _pi(e, target, obj, children != null), finished = false;\n                                for (var p = 0; p < pathInfo.end; p++) {\n                                    if (finished) return;\n                                    target = pathInfo.path[p];\n                                    for (var i = 0; i < tt.downSelectors.length; i++) {\n                                        if (tt.downSelectors[i] == null || matchesSelector(target, tt.downSelectors[i], obj)) {\n                                            tt.down = true;\n                                            setTimeout(clearSingle, clickThreshold);\n                                            setTimeout(clearDouble, dblClickThreshold);\n                                            finished = true;\n                                            break; // we only need one match on mousedown\n                                        }\n                                    }\n                                }\n                            },\n                            up = function (e) {\n                                if (tt.down) {\n                                    var target = _t(e), currentTarget, pathInfo;\n                                    tt.taps++;\n                                    var tc = _touchCount(e);\n                                    for (var eventId in _tapProfiles) {\n                                        if (_tapProfiles.hasOwnProperty(eventId)) {\n                                            var p = _tapProfiles[eventId];\n                                            if (p.touches === tc && (p.taps === 1 || p.taps === tt.taps)) {\n                                                for (var i = 0; i < tt[eventId].length; i++) {\n                                                    pathInfo = _pi(e, target, obj, tt[eventId][i][1] != null);\n                                                    for (var pLoop = 0; pLoop < pathInfo.end; pLoop++) {\n                                                        currentTarget = pathInfo.path[pLoop];\n                                                        // this is a single event registration handler.\n                                                        if (tt[eventId][i][1] == null || matchesSelector(currentTarget, tt[eventId][i][1], obj)) {\n                                                            tt[eventId][i][0].apply(currentTarget, [ e ]);\n                                                            break;\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            },\n                            clearSingle = function () {\n                                tt.down = false;\n                            },\n                            clearDouble = function () {\n                                tt.taps = 0;\n                            };\n\n                        DefaultHandler(obj, \"mousedown\", down);\n                        DefaultHandler(obj, \"mouseup\", up);\n                    }\n                    // add this child selector (it can be null, that's fine).\n                    obj.__taTapHandler.downSelectors.push(children);\n\n                    obj.__taTapHandler[evt].push([fn, children]);\n                    // the unstore function removes this function from the object's listener list for this type.\n                    fn.__taUnstore = function () {\n                        _d(obj.__taTapHandler[evt], fn);\n                    };\n                }\n            };\n        },\n        meeHelper = function (type, evt, obj, target) {\n            for (var i in obj.__tamee[type]) {\n                if (obj.__tamee[type].hasOwnProperty(i)) {\n                    obj.__tamee[type][i].apply(target, [ evt ]);\n                }\n            }\n        },\n        MouseEnterExitHandler = function () {\n            var activeElements = [];\n            return function (obj, evt, fn, children) {\n                if (!obj.__tamee) {\n                    // __tamee holds a flag saying whether the mouse is currently \"in\" the element, and a list of\n                    // both mouseenter and mouseexit functions.\n                    obj.__tamee = { over: false, mouseenter: [], mouseexit: [] };\n                    // register over and out functions\n                    var over = function (e) {\n                            var t = _t(e);\n                            if ((children == null && (t == obj && !obj.__tamee.over)) || (matchesSelector(t, children, obj) && (t.__tamee == null || !t.__tamee.over))) {\n                                meeHelper(\"mouseenter\", e, obj, t);\n                                t.__tamee = t.__tamee || {};\n                                t.__tamee.over = true;\n                                activeElements.push(t);\n                            }\n                        },\n                        out = function (e) {\n                            var t = _t(e);\n                            // is the current target one of the activeElements? and is the\n                            // related target NOT a descendant of it?\n                            for (var i = 0; i < activeElements.length; i++) {\n                                if (t == activeElements[i] && !matchesSelector((e.relatedTarget || e.toElement), \"*\", t)) {\n                                    t.__tamee.over = false;\n                                    activeElements.splice(i, 1);\n                                    meeHelper(\"mouseexit\", e, obj, t);\n                                }\n                            }\n                        };\n\n                    _bind(obj, \"mouseover\", _curryChildFilter(children, obj, over, \"mouseover\"), over);\n                    _bind(obj, \"mouseout\", _curryChildFilter(children, obj, out, \"mouseout\"), out);\n                }\n\n                fn.__taUnstore = function () {\n                    delete obj.__tamee[evt][fn.__tauid];\n                };\n\n                _store(obj, evt, fn);\n                obj.__tamee[evt][fn.__tauid] = fn;\n            };\n        },\n        isTouchDevice = \"ontouchstart\" in document.documentElement || navigator.maxTouchPoints,\n        isMouseDevice = \"onmousedown\" in document.documentElement,\n        touchMap = { \"mousedown\": \"touchstart\", \"mouseup\": \"touchend\", \"mousemove\": \"touchmove\" },\n        touchstart = \"touchstart\", touchend = \"touchend\", touchmove = \"touchmove\",\n        iev = (function () {\n            var rv = -1;\n            if (navigator.appName == 'Microsoft Internet Explorer') {\n                var ua = navigator.userAgent,\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\n                if (re.exec(ua) != null)\n                    rv = parseFloat(RegExp.$1);\n            }\n            return rv;\n        })(),\n        isIELT9 = iev > -1 && iev < 9,\n        _genLoc = function (e, prefix) {\n            if (e == null) return [ 0, 0 ];\n            var ts = _touches(e), t = _getTouch(ts, 0);\n            return [t[prefix + \"X\"], t[prefix + \"Y\"]];\n        },\n        _pageLocation = function (e) {\n            if (e == null) return [ 0, 0 ];\n            if (isIELT9) {\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\n            }\n            else {\n                return _genLoc(e, \"page\");\n            }\n        },\n        _screenLocation = function (e) {\n            return _genLoc(e, \"screen\");\n        },\n        _clientLocation = function (e) {\n            return _genLoc(e, \"client\");\n        },\n        _getTouch = function (touches, idx) {\n            return touches.item ? touches.item(idx) : touches[idx];\n        },\n        _touches = function (e) {\n            return e.touches && e.touches.length > 0 ? e.touches :\n                    e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\n                [ e ];\n        },\n        _touchCount = function (e) {\n            return _touches(e).length;\n        },\n    //http://www.quirksmode.org/blog/archives/2005/10/_and_the_winner_1.html\n        _bind = function (obj, type, fn, originalFn) {\n            _store(obj, type, fn);\n            originalFn.__tauid = fn.__tauid;\n            if (obj.addEventListener)\n                obj.addEventListener(type, fn, false);\n            else if (obj.attachEvent) {\n                var key = type + fn.__tauid;\n                obj[\"e\" + key] = fn;\n                // TODO look at replacing with .call(..)\n                obj[key] = function () {\n                    obj[\"e\" + key] && obj[\"e\" + key](window.event);\n                };\n                obj.attachEvent(\"on\" + type, obj[key]);\n            }\n        },\n        _unbind = function (obj, type, fn) {\n            if (fn == null) return;\n            _each(obj, function () {\n                var _el = _gel(this);\n                _unstore(_el, type, fn);\n                // it has been bound if there is a tauid. otherwise it was not bound and we can ignore it.\n                if (fn.__tauid != null) {\n                    if (_el.removeEventListener) {\n                        _el.removeEventListener(type, fn, false);\n                        if (isTouchDevice && touchMap[type]) _el.removeEventListener(touchMap[type], fn, false);\n                    }\n                    else if (this.detachEvent) {\n                        var key = type + fn.__tauid;\n                        _el[key] && _el.detachEvent(\"on\" + type, _el[key]);\n                        _el[key] = null;\n                        _el[\"e\" + key] = null;\n                    }\n                }\n\n                // if a touch event was also registered, deregister now.\n                if (fn.__taTouchProxy) {\n                    _unbind(obj, fn.__taTouchProxy[1], fn.__taTouchProxy[0]);\n                }\n            });\n        },\n        _each = function (obj, fn) {\n            if (obj == null) return;\n            // if a list (or list-like), use it. if a string, get a list\n            // by running the string through querySelectorAll. else, assume\n            // it's an Element.\n            // obj.top is \"unknown\" in IE8.\n            obj = (typeof Window !== \"undefined\" && (typeof obj.top !== \"unknown\" && obj == obj.top)) ? [ obj ] :\n                    (typeof obj !== \"string\") && (obj.tagName == null && obj.length != null) ? obj :\n                    typeof obj === \"string\" ? document.querySelectorAll(obj)\n                : [ obj ];\n\n            for (var i = 0; i < obj.length; i++)\n                fn.apply(obj[i]);\n        },\n        _uuid = function () {\n            return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n                return v.toString(16);\n            }));\n        };\n\n    /**\n     * Mottle offers support for abstracting out the differences\n     * between touch and mouse devices, plus \"smart click\" functionality\n     * (don't fire click if the mouse has moved between mousedown and mouseup),\n     * and synthesized click/tap events.\n     * @class Mottle\n     * @constructor\n     * @param {Object} params Constructor params\n     * @param {Number} [params.clickThreshold=250] Threshold, in milliseconds beyond which a touchstart followed by a touchend is not considered to be a click.\n     * @param {Number} [params.dblClickThreshold=450] Threshold, in milliseconds beyond which two successive tap events are not considered to be a click.\n     * @param {Boolean} [params.smartClicks=false] If true, won't fire click events if the mouse has moved between mousedown and mouseup. Note that this functionality\n     * requires that Mottle consume the mousedown event, and so may not be viable in all use cases.\n     */\n    root.Mottle = function (params) {\n        params = params || {};\n        var clickThreshold = params.clickThreshold || 250,\n            dblClickThreshold = params.dblClickThreshold || 450,\n            mouseEnterExitHandler = new MouseEnterExitHandler(),\n            tapHandler = new TapHandler(clickThreshold, dblClickThreshold),\n            _smartClicks = params.smartClicks,\n            _doBind = function (obj, evt, fn, children) {\n                if (fn == null) return;\n                _each(obj, function () {\n                    var _el = _gel(this);\n                    if (_smartClicks && evt === \"click\")\n                        SmartClickHandler(_el, evt, fn, children);\n                    else if (evt === \"tap\" || evt === \"dbltap\" || evt === \"contextmenu\") {\n                        tapHandler(_el, evt, fn, children);\n                    }\n                    else if (evt === \"mouseenter\" || evt == \"mouseexit\")\n                        mouseEnterExitHandler(_el, evt, fn, children);\n                    else\n                        DefaultHandler(_el, evt, fn, children);\n                });\n            };\n\n        /**\n         * Removes an element from the DOM, and deregisters all event handlers for it. You should use this\n         * to ensure you don't leak memory.\n         * @method remove\n         * @param {String|Element} el Element, or id of the element, to remove.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.remove = function (el) {\n            _each(el, function () {\n                var _el = _gel(this);\n                if (_el.__ta) {\n                    for (var evt in _el.__ta) {\n                        if (_el.__ta.hasOwnProperty(evt)) {\n                            for (var h in _el.__ta[evt]) {\n                                if (_el.__ta[evt].hasOwnProperty(h))\n                                    _unbind(_el, evt, _el.__ta[evt][h]);\n                            }\n                        }\n                    }\n                }\n                _el.parentNode && _el.parentNode.removeChild(_el);\n            });\n            return this;\n        };\n\n        /**\n         * Register an event handler, optionally as a delegate for some set of descendant elements. Note\n         * that this method takes either 3 or 4 arguments - if you supply 3 arguments it is assumed you have\n         * omitted the `children` parameter, and that the event handler should be bound directly to the given element.\n         * @method on\n         * @param {Element[]|Element|String} el Either an Element, or a CSS spec for a list of elements, or an array of Elements.\n         * @param {String} [children] Comma-delimited list of selectors identifying allowed children.\n         * @param {String} event Event ID.\n         * @param {Function} fn Event handler function.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.on = function (el, event, children, fn) {\n            var _el = arguments[0],\n                _c = arguments.length == 4 ? arguments[2] : null,\n                _e = arguments[1],\n                _f = arguments[arguments.length - 1];\n\n            _doBind(_el, _e, _f, _c);\n            return this;\n        };\n\n        /**\n         * Cancel delegate event handling for the given function. Note that unlike with 'on' you do not supply\n         * a list of child selectors here: it removes event delegation from all of the child selectors for which the\n         * given function was registered (if any).\n         * @method off\n         * @param {Element[]|Element|String} el Element - or ID of element - from which to remove event listener.\n         * @param {String} event Event ID.\n         * @param {Function} fn Event handler function.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.off = function (el, event, fn) {\n            _unbind(el, event, fn);\n            return this;\n        };\n\n        /**\n         * Triggers some event for a given element.\n         * @method trigger\n         * @param {Element} el Element for which to trigger the event.\n         * @param {String} event Event ID.\n         * @param {Event} originalEvent The original event. Should be optional of course, but currently is not, due\n         * to the jsPlumb use case that caused this method to be added.\n         * @param {Object} [payload] Optional object to set as `payload` on the generated event; useful for message passing.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.trigger = function (el, event, originalEvent, payload) {\n            // MouseEvent undefined in old IE; that's how we know it's a mouse event.  A fine Microsoft paradox.\n            var originalIsMouse = isMouseDevice && (typeof MouseEvent === \"undefined\" || originalEvent == null || originalEvent.constructor === MouseEvent);\n\n            var eventToBind = (isTouchDevice && !isMouseDevice && touchMap[event]) ? touchMap[event] : event,\n                bindingAMouseEvent = !(isTouchDevice && !isMouseDevice && touchMap[event]);\n\n            var pl = _pageLocation(originalEvent), sl = _screenLocation(originalEvent), cl = _clientLocation(originalEvent);\n            _each(el, function () {\n                var _el = _gel(this), evt;\n                originalEvent = originalEvent || {\n                    screenX: sl[0],\n                    screenY: sl[1],\n                    clientX: cl[0],\n                    clientY: cl[1]\n                };\n\n                var _decorate = function (_evt) {\n                    if (payload) _evt.payload = payload;\n                };\n\n                var eventGenerators = {\n                    \"TouchEvent\": function (evt) {\n\n                        var touchList = _touchAndList(window, _el, 0, pl[0], pl[1], sl[0], sl[1], cl[0], cl[1]),\n                            init = evt.initTouchEvent || evt.initEvent;\n\n                        init(eventToBind, true, true, window, null, sl[0], sl[1],\n                            cl[0], cl[1], false, false, false, false,\n                            touchList, touchList, touchList, 1, 0);\n                    },\n                    \"MouseEvents\": function (evt) {\n                        evt.initMouseEvent(eventToBind, true, true, window, 0,\n                            sl[0], sl[1],\n                            cl[0], cl[1],\n                            false, false, false, false, 1, _el);\n                    }\n                };\n\n                if (document.createEvent) {\n\n                    var ite = !bindingAMouseEvent && !originalIsMouse && (isTouchDevice && touchMap[event]),\n                        evtName = ite ? \"TouchEvent\" : \"MouseEvents\";\n\n                    evt = document.createEvent(evtName);\n                    eventGenerators[evtName](evt);\n                    _decorate(evt);\n                    _el.dispatchEvent(evt);\n                }\n                else if (document.createEventObject) {\n                    evt = document.createEventObject();\n                    evt.eventType = evt.eventName = eventToBind;\n                    evt.screenX = sl[0];\n                    evt.screenY = sl[1];\n                    evt.clientX = cl[0];\n                    evt.clientY = cl[1];\n                    _decorate(evt);\n                    _el.fireEvent('on' + eventToBind, evt);\n                }\n            });\n            return this;\n        }\n    };\n\n    /**\n     * Static method to assist in 'consuming' an element: uses `stopPropagation` where available, or sets\n     * `e.returnValue=false` where it is not.\n     * @method Mottle.consume\n     * @param {Event} e Event to consume\n     * @param {Boolean} [doNotPreventDefault=false] If true, does not call `preventDefault()` on the event.\n     */\n    root.Mottle.consume = function (e, doNotPreventDefault) {\n        if (e.stopPropagation)\n            e.stopPropagation();\n        else\n            e.returnValue = false;\n\n        if (!doNotPreventDefault && e.preventDefault)\n            e.preventDefault();\n    };\n\n    /**\n     * Gets the page location corresponding to the given event. For touch events this means get the page location of the first touch.\n     * @method Mottle.pageLocation\n     * @param {Event} e Event to get page location for.\n     * @return {Number[]} [left, top] for the given event.\n     */\n    root.Mottle.pageLocation = _pageLocation;\n\n    /**\n     * Forces touch events to be turned \"on\". Useful for testing: even if you don't have a touch device, you can still\n     * trigger a touch event when this is switched on and it will be captured and acted on.\n     * @method setForceTouchEvents\n     * @param {Boolean} value If true, force touch events to be on.\n     */\n    root.Mottle.setForceTouchEvents = function (value) {\n        isTouchDevice = value;\n    };\n\n    /**\n     * Forces mouse events to be turned \"on\". Useful for testing: even if you don't have a mouse, you can still\n     * trigger a mouse event when this is switched on and it will be captured and acted on.\n     * @method setForceMouseEvents\n     * @param {Boolean} value If true, force mouse events to be on.\n     */\n    root.Mottle.setForceMouseEvents = function (value) {\n        isMouseDevice = value;\n    };\n\n    root.Mottle.version = \"0.8.0\";\n\n    if (typeof exports !== \"undefined\") {\n        exports.Mottle = root.Mottle;\n    }\n\n}).call(typeof window === \"undefined\" ? this : window);\n\n/**\n drag/drop functionality for use with jsPlumb but with\n no knowledge of jsPlumb. supports multiple scopes (separated by whitespace), dragging\n multiple elements, constrain to parent, drop filters, drag start filters, custom\n css classes.\n\n a lot of the functionality of this script is expected to be plugged in:\n\n addClass\n removeClass\n\n addEvent\n removeEvent\n\n getPosition\n setPosition\n getSize\n\n indexOf\n intersects\n\n the name came from here:\n\n http://mrsharpoblunto.github.io/foswig.js/\n\n copyright 2016 jsPlumb\n */\n\n;(function() {\n\n    \"use strict\";\n    var root = this;\n\n    var _suggest = function(list, item, head) {\n        if (list.indexOf(item) === -1) {\n            head ? list.unshift(item) : list.push(item);\n            return true;\n        }\n        return false;\n    };\n\n    var _vanquish = function(list, item) {\n        var idx = list.indexOf(item);\n        if (idx !== -1) list.splice(idx, 1);\n    };\n\n    var _difference = function(l1, l2) {\n        var d = [];\n        for (var i = 0; i < l1.length; i++) {\n            if (l2.indexOf(l1[i]) === -1)\n                d.push(l1[i]);\n        }\n        return d;\n    };\n\n    var _isString = function(f) {\n        return f == null ? false : (typeof f === \"string\" || f.constructor === String);\n    };\n\n    var getOffsetRect = function (elem) {\n        // (1)\n        var box = elem.getBoundingClientRect(),\n            body = document.body,\n            docElem = document.documentElement,\n        // (2)\n            scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\n            scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\n        // (3)\n            clientTop = docElem.clientTop || body.clientTop || 0,\n            clientLeft = docElem.clientLeft || body.clientLeft || 0,\n        // (4)\n            top  = box.top +  scrollTop - clientTop,\n            left = box.left + scrollLeft - clientLeft;\n\n        return { top: Math.round(top), left: Math.round(left) };\n    };\n\n    var matchesSelector = function(el, selector, ctx) {\n        ctx = ctx || el.parentNode;\n        var possibles = ctx.querySelectorAll(selector);\n        for (var i = 0; i < possibles.length; i++) {\n            if (possibles[i] === el)\n                return true;\n        }\n        return false;\n    };\n\n    var findDelegateElement = function(parentElement, childElement, selector) {\n        if (matchesSelector(childElement, selector, parentElement)) {\n            return childElement;\n        } else {\n            var currentParent = childElement.parentNode;\n            while (currentParent != null && currentParent !== parentElement) {\n                if (matchesSelector(currentParent, selector, parentElement)) {\n                    return currentParent;\n                } else {\n                    currentParent = currentParent.parentNode;\n                }\n            }\n        }\n    };\n\n    /**\n     * Finds all elements matching the given selector, for the given parent. In order to support \"scoped root\" selectors,\n     * ie. things like \"> .someClass\", that is .someClass elements that are direct children of `parentElement`, we have to\n     * jump through a small hoop here: when a delegate draggable is registered, we write a `katavorio-draggable` attribute\n     * on the element on which the draggable is registered. Then when this method runs, we grab the value of that attribute and\n     * prepend it as part of the selector we're looking for.  So \"> .someClass\" ends up being written as\n     * \"[katavorio-draggable='...' > .someClass]\", which works with querySelectorAll.\n     *\n     * @param availableSelectors\n     * @param parentElement\n     * @param childElement\n     * @returns {*}\n     */\n    var findMatchingSelector = function(availableSelectors, parentElement, childElement) {\n        var el = null;\n        var draggableId = parentElement.getAttribute(\"katavorio-draggable\"),\n            prefix = draggableId != null ? \"[katavorio-draggable='\" + draggableId + \"'] \" : \"\";\n\n        for (var i = 0; i < availableSelectors.length; i++) {\n            el = findDelegateElement(parentElement, childElement, prefix + availableSelectors[i].selector);\n            if (el != null) {\n                if (availableSelectors[i].filter) {\n                    var matches = matchesSelector(childElement, availableSelectors[i].filter, el),\n                        exclude = availableSelectors[i].filterExclude === true;\n\n                    if ( (exclude && !matches) || matches) {\n                        return null;\n                    }\n\n                }\n                return [ availableSelectors[i], el ];\n            }\n        }\n        return null;\n    };\n\n    var iev = (function() {\n            var rv = -1;\n            if (navigator.appName === 'Microsoft Internet Explorer') {\n                var ua = navigator.userAgent,\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\n                if (re.exec(ua) != null)\n                    rv = parseFloat(RegExp.$1);\n            }\n            return rv;\n        })(),\n        DEFAULT_GRID_X = 10,\n        DEFAULT_GRID_Y = 10,\n        isIELT9 = iev > -1 && iev < 9,\n        isIE9 = iev === 9,\n        _pl = function(e) {\n            if (isIELT9) {\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\n            }\n            else {\n                var ts = _touches(e), t = _getTouch(ts, 0);\n                // for IE9 pageX might be null if the event was synthesized. We try for pageX/pageY first,\n                // falling back to clientX/clientY if necessary. In every other browser we want to use pageX/pageY.\n                return isIE9 ? [t.pageX || t.clientX, t.pageY || t.clientY] : [t.pageX, t.pageY];\n            }\n        },\n        _getTouch = function(touches, idx) { return touches.item ? touches.item(idx) : touches[idx]; },\n        _touches = function(e) {\n            return e.touches && e.touches.length > 0 ? e.touches :\n                    e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\n                [ e ];\n        },\n        _classes = {\n            delegatedDraggable:\"katavorio-delegated-draggable\",  // elements that are the delegated drag handler for a bunch of other elements\n            draggable:\"katavorio-draggable\",    // draggable elements\n            droppable:\"katavorio-droppable\",    // droppable elements\n            drag : \"katavorio-drag\",            // elements currently being dragged\n            selected:\"katavorio-drag-selected\", // elements in current drag selection\n            active : \"katavorio-drag-active\",   // droppables that are targets of a currently dragged element\n            hover : \"katavorio-drag-hover\",     // droppables over which a matching drag element is hovering\n            noSelect : \"katavorio-drag-no-select\", // added to the body to provide a hook to suppress text selection\n            ghostProxy:\"katavorio-ghost-proxy\",  // added to a ghost proxy element in use when a drag has exited the bounds of its parent.\n            clonedDrag:\"katavorio-clone-drag\"     // added to a node that is a clone of an element created at the start of a drag\n        },\n        _defaultScope = \"katavorio-drag-scope\",\n        _events = [ \"stop\", \"start\", \"drag\", \"drop\", \"over\", \"out\", \"beforeStart\" ],\n        _devNull = function() {},\n        _true = function() { return true; },\n        _foreach = function(l, fn, from) {\n            for (var i = 0; i < l.length; i++) {\n                if (l[i] != from)\n                    fn(l[i]);\n            }\n        },\n        _setDroppablesActive = function(dd, val, andHover, drag) {\n            _foreach(dd, function(e) {\n                e.setActive(val);\n                if (val) e.updatePosition();\n                if (andHover) e.setHover(drag, val);\n            });\n        },\n        _each = function(obj, fn) {\n            if (obj == null) return;\n            obj = !_isString(obj) && (obj.tagName == null && obj.length != null) ? obj : [ obj ];\n            for (var i = 0; i < obj.length; i++)\n                fn.apply(obj[i], [ obj[i] ]);\n        },\n        _consume = function(e) {\n            if (e.stopPropagation) {\n                e.stopPropagation();\n                e.preventDefault();\n            }\n            else {\n                e.returnValue = false;\n            }\n        },\n        _defaultInputFilterSelector = \"input,textarea,select,button,option\",\n    //\n    // filters out events on all input elements, like textarea, checkbox, input, select.\n        _inputFilter = function(e, el, _katavorio) {\n            var t = e.srcElement || e.target;\n            return !matchesSelector(t, _katavorio.getInputFilterSelector(), el);\n        };\n\n    var Super = function(el, params, css, scope) {\n        this.params = params || {};\n        this.el = el;\n        this.params.addClass(this.el, this._class);\n        this.uuid = _uuid();\n        var enabled = true;\n        this.setEnabled = function(e) { enabled = e; };\n        this.isEnabled = function() { return enabled; };\n        this.toggleEnabled = function() { enabled = !enabled; };\n        this.setScope = function(scopes) {\n            this.scopes = scopes ? scopes.split(/\\s+/) : [ scope ];\n        };\n        this.addScope = function(scopes) {\n            var m = {};\n            _each(this.scopes, function(s) { m[s] = true;});\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) { m[s] = true;});\n            this.scopes = [];\n            for (var i in m) this.scopes.push(i);\n        };\n        this.removeScope = function(scopes) {\n            var m = {};\n            _each(this.scopes, function(s) { m[s] = true;});\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) { delete m[s];});\n            this.scopes = [];\n            for (var i in m) this.scopes.push(i);\n        };\n        this.toggleScope = function(scopes) {\n            var m = {};\n            _each(this.scopes, function(s) { m[s] = true;});\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) {\n                if (m[s]) delete m[s];\n                else m[s] = true;\n            });\n            this.scopes = [];\n            for (var i in m) this.scopes.push(i);\n        };\n        this.setScope(params.scope);\n        this.k = params.katavorio;\n        return params.katavorio;\n    };\n\n    var TRUE = function() { return true; };\n    var FALSE = function() { return false; };\n\n    var Drag = function(el, params, css, scope) {\n        this._class = css.draggable;\n        var k = Super.apply(this, arguments);\n        this.rightButtonCanDrag = this.params.rightButtonCanDrag;\n        var downAt = [0,0], posAtDown = null, pagePosAtDown = null, pageDelta = [0,0], moving = false, initialScroll = [0,0],\n            consumeStartEvent = this.params.consumeStartEvent !== false,\n            dragEl = this.el,\n            clone = this.params.clone,\n            scroll = this.params.scroll,\n            _multipleDrop = params.multipleDrop !== false,\n            isConstrained = false,\n            useGhostProxy = params.ghostProxy === true ? TRUE : params.ghostProxy && typeof params.ghostProxy === \"function\" ? params.ghostProxy : FALSE,\n            ghostProxy = function(el) { return el.cloneNode(true); },\n            elementToDrag = null,\n            availableSelectors = [],\n            activeSelectorParams = null, // which, if any, selector config is currently active.\n            ghostProxyParent = params.ghostProxyParent,\n            currentParentPosition,\n            ghostParentPosition,\n            ghostDx,\n            ghostDy;\n\n        // if an initial selector was provided, push the entire set of params as a selector config.\n        if (params.selector) {\n            var draggableId = el.getAttribute(\"katavorio-draggable\");\n            if (draggableId == null) {\n                draggableId = \"\" + new Date().getTime();\n                el.setAttribute(\"katavorio-draggable\", draggableId);\n            }\n\n            availableSelectors.push(params);\n        }\n\n        var snapThreshold = params.snapThreshold,\n            _snap = function(pos, gridX, gridY, thresholdX, thresholdY) {\n                var _dx = Math.floor(pos[0] / gridX),\n                    _dxl = gridX * _dx,\n                    _dxt = _dxl + gridX,\n                    _x = Math.abs(pos[0] - _dxl) <= thresholdX ? _dxl : Math.abs(_dxt - pos[0]) <= thresholdX ? _dxt : pos[0];\n\n                var _dy = Math.floor(pos[1] / gridY),\n                    _dyl = gridY * _dy,\n                    _dyt = _dyl + gridY,\n                    _y = Math.abs(pos[1] - _dyl) <= thresholdY ? _dyl : Math.abs(_dyt - pos[1]) <= thresholdY ? _dyt : pos[1];\n\n                return [ _x, _y];\n            };\n\n        this.posses = [];\n        this.posseRoles = {};\n\n        this.toGrid = function(pos) {\n            if (this.params.grid == null) {\n                return pos;\n            }\n            else {\n                var tx = this.params.grid ? this.params.grid[0] / 2 : snapThreshold ? snapThreshold : DEFAULT_GRID_X / 2,\n                    ty = this.params.grid ? this.params.grid[1] / 2 : snapThreshold ? snapThreshold : DEFAULT_GRID_Y / 2;\n\n                return _snap(pos, this.params.grid[0], this.params.grid[1], tx, ty);\n            }\n        };\n\n        this.snap = function(x, y) {\n            if (dragEl == null) return;\n            x = x || (this.params.grid ? this.params.grid[0] : DEFAULT_GRID_X);\n            y = y || (this.params.grid ? this.params.grid[1] : DEFAULT_GRID_Y);\n            var p = this.params.getPosition(dragEl),\n                tx = this.params.grid ? this.params.grid[0] / 2 : snapThreshold,\n                ty = this.params.grid ? this.params.grid[1] / 2 : snapThreshold,\n                snapped = _snap(p, x, y, tx, ty);\n\n            this.params.setPosition(dragEl, snapped);\n            return snapped;\n        };\n\n        this.setUseGhostProxy = function(val) {\n            useGhostProxy = val ? TRUE : FALSE;\n        };\n\n        var constrain;\n        var negativeFilter = function(pos) {\n            return (params.allowNegative === false) ? [ Math.max (0, pos[0]), Math.max(0, pos[1]) ] : pos;\n        };\n\n        var _setConstrain = function(value) {\n            constrain = typeof value === \"function\" ? value : value ? function(pos, dragEl, _constrainRect, _size) {\n                return negativeFilter([\n                    Math.max(0, Math.min(_constrainRect.w - _size[0], pos[0])),\n                    Math.max(0, Math.min(_constrainRect.h - _size[1], pos[1]))\n                ]);\n            }.bind(this) : function(pos) { return negativeFilter(pos); };\n        }.bind(this);\n\n        _setConstrain(typeof this.params.constrain === \"function\" ? this.params.constrain  : (this.params.constrain || this.params.containment));\n\n\n        /**\n         * Sets whether or not the Drag is constrained. A value of 'true' means constrain to parent bounds; a function\n         * will be executed and returns true if the position is allowed.\n         * @param value\n         */\n        this.setConstrain = function(value) {\n            _setConstrain(value);\n        };\n\n        var revertFunction;\n        /**\n         * Sets a function to call on drag stop, which, if it returns true, indicates that the given element should\n         * revert to its position before the previous drag.\n         * @param fn\n         */\n        this.setRevert = function(fn) {\n            revertFunction = fn;\n        };\n\n        if (this.params.revert) {\n            revertFunction = this.params.revert;\n        }\n\n        var _assignId = function(obj) {\n                if (typeof obj === \"function\") {\n                    obj._katavorioId = _uuid();\n                    return obj._katavorioId;\n                } else {\n                    return obj;\n                }\n            },\n        // a map of { spec -> [ fn, exclusion ] } entries.\n            _filters = {},\n            _testFilter = function(e) {\n                for (var key in _filters) {\n                    var f = _filters[key];\n                    var rv = f[0](e);\n                    if (f[1]) rv = !rv;\n                    if (!rv) return false;\n                }\n                return true;\n            },\n            _setFilter = this.setFilter = function(f, _exclude) {\n                if (f) {\n                    var key = _assignId(f);\n                    _filters[key] = [\n                        function(e) {\n                            var t = e.srcElement || e.target, m;\n                            if (_isString(f)) {\n                                m = matchesSelector(t, f, el);\n                            }\n                            else if (typeof f === \"function\") {\n                                m = f(e, el);\n                            }\n                            return m;\n                        },\n                            _exclude !== false\n                    ];\n\n                }\n            },\n            _addFilter = this.addFilter = _setFilter,\n            _removeFilter = this.removeFilter = function(f) {\n                var key = typeof f === \"function\" ? f._katavorioId : f;\n                delete _filters[key];\n            };\n\n        this.clearAllFilters = function() {\n            _filters = {};\n        };\n\n        this.canDrag = this.params.canDrag || _true;\n\n        var constrainRect,\n            matchingDroppables = [],\n            intersectingDroppables = [];\n\n        this.addSelector = function(params) {\n            if (params.selector) {\n                availableSelectors.push(params);\n            }\n        };\n\n        this.downListener = function(e) {\n            if (e.defaultPrevented) { return; }\n            var isNotRightClick = this.rightButtonCanDrag || (e.which !== 3 && e.button !== 2);\n            if (isNotRightClick && this.isEnabled() && this.canDrag()) {\n\n                var _f =  _testFilter(e) && _inputFilter(e, this.el, this.k);\n                if (_f) {\n\n                    activeSelectorParams = null;\n                    elementToDrag = null;\n\n                    // if (selector) {\n                    //     elementToDrag = findDelegateElement(this.el, e.target || e.srcElement, selector);\n                    //     if(elementToDrag == null) {\n                    //         return;\n                    //     }\n                    // }\n                    if (availableSelectors.length > 0) {\n                        var match = findMatchingSelector(availableSelectors, this.el, e.target || e.srcElement);\n                        if (match != null) {\n                            activeSelectorParams = match[0];\n                            elementToDrag = match[1];\n                        }\n                        // elementToDrag = findDelegateElement(this.el, e.target || e.srcElement, selector);\n                        if(elementToDrag == null) {\n                            return;\n                        }\n                    }\n                    else {\n                        elementToDrag = this.el;\n                    }\n\n                    if (clone) {\n                        dragEl = elementToDrag.cloneNode(true);\n                        this.params.addClass(dragEl, _classes.clonedDrag);\n\n                        dragEl.setAttribute(\"id\", null);\n                        dragEl.style.position = \"absolute\";\n\n                        if (this.params.parent != null) {\n                            var p = this.params.getPosition(this.el);\n                            dragEl.style.left = p[0] + \"px\";\n                            dragEl.style.top = p[1] + \"px\";\n                            this.params.parent.appendChild(dragEl);\n                        } else {\n                            // the clone node is added to the body; getOffsetRect gives us a value\n                            // relative to the body.\n                            var b = getOffsetRect(elementToDrag);\n                            dragEl.style.left = b.left + \"px\";\n                            dragEl.style.top = b.top + \"px\";\n\n                            document.body.appendChild(dragEl);\n                        }\n\n                    } else {\n                        dragEl = elementToDrag;\n                    }\n\n                    consumeStartEvent && _consume(e);\n                    downAt = _pl(e);\n                    if (dragEl && dragEl.parentNode)\n                    {\n                        initialScroll = [dragEl.parentNode.scrollLeft, dragEl.parentNode.scrollTop];\n                    }\n                    //\n                    this.params.bind(document, \"mousemove\", this.moveListener);\n                    this.params.bind(document, \"mouseup\", this.upListener);\n                    k.markSelection(this);\n                    k.markPosses(this);\n                    this.params.addClass(document.body, css.noSelect);\n                    _dispatch(\"beforeStart\", {el:this.el, pos:posAtDown, e:e, drag:this});\n                }\n                else if (this.params.consumeFilteredEvents) {\n                    _consume(e);\n                }\n            }\n        }.bind(this);\n\n        this.moveListener = function(e) {\n            if (downAt) {\n                if (!moving) {\n                    var _continue = _dispatch(\"start\", {el:this.el, pos:posAtDown, e:e, drag:this});\n                    if (_continue !== false) {\n                        if (!downAt) {\n                            return;\n                        }\n                        this.mark(true);\n                        moving = true;\n                    } else {\n                        this.abort();\n                    }\n                }\n\n                // it is possible that the start event caused the drag to be aborted. So we check\n                // again that we are currently dragging.\n                if (downAt) {\n                    intersectingDroppables.length = 0;\n                    var pos = _pl(e), dx = pos[0] - downAt[0], dy = pos[1] - downAt[1],\n                        z = this.params.ignoreZoom ? 1 : k.getZoom();\n                    if (dragEl && dragEl.parentNode)\n                    {\n                        dx += dragEl.parentNode.scrollLeft - initialScroll[0];\n                        dy += dragEl.parentNode.scrollTop - initialScroll[1];\n                    }\n                    dx /= z;\n                    dy /= z;\n                    this.moveBy(dx, dy, e);\n                    k.updateSelection(dx, dy, this);\n                    k.updatePosses(dx, dy, this);\n                }\n            }\n        }.bind(this);\n\n        this.upListener = function(e) {\n            if (downAt) {\n                downAt = null;\n                this.params.unbind(document, \"mousemove\", this.moveListener);\n                this.params.unbind(document, \"mouseup\", this.upListener);\n                this.params.removeClass(document.body, css.noSelect);\n                this.unmark(e);\n                k.unmarkSelection(this, e);\n                k.unmarkPosses(this, e);\n                this.stop(e);\n\n                k.notifyPosseDragStop(this, e);\n                moving = false;\n                intersectingDroppables.length = 0;\n\n                if (clone) {\n                    dragEl && dragEl.parentNode && dragEl.parentNode.removeChild(dragEl);\n                    dragEl = null;\n                } else {\n                    if (revertFunction && revertFunction(dragEl, this.params.getPosition(dragEl)) === true) {\n                        this.params.setPosition(dragEl, posAtDown);\n                        _dispatch(\"revert\", dragEl);\n                    }\n                }\n\n            }\n        }.bind(this);\n\n        this.getFilters = function() { return _filters; };\n\n        this.abort = function() {\n            if (downAt != null) {\n                this.upListener();\n            }\n        };\n\n        /**\n         * Returns the element that was last dragged. This may be some original element from the DOM, or if `clone` is\n         * set, then its actually a copy of some original DOM element. In some client calls to this method, it is the\n         * actual element that was dragged that is desired. In others, it is the original DOM element that the user\n         * wishes to get - in which case, pass true for `retrieveOriginalElement`.\n         *\n         * @returns {*}\n         */\n        this.getDragElement = function(retrieveOriginalElement) {\n            return retrieveOriginalElement ? elementToDrag || this.el : dragEl || this.el;\n        };\n\n        var listeners = {\"start\":[], \"drag\":[], \"stop\":[], \"over\":[], \"out\":[], \"beforeStart\":[], \"revert\":[] };\n        if (params.events.start) listeners.start.push(params.events.start);\n        if (params.events.beforeStart) listeners.beforeStart.push(params.events.beforeStart);\n        if (params.events.stop) listeners.stop.push(params.events.stop);\n        if (params.events.drag) listeners.drag.push(params.events.drag);\n        if (params.events.revert) listeners.revert.push(params.events.revert);\n\n        this.on = function(evt, fn) {\n            if (listeners[evt]) listeners[evt].push(fn);\n        };\n\n        this.off = function(evt, fn) {\n            if (listeners[evt]) {\n                var l = [];\n                for (var i = 0; i < listeners[evt].length; i++) {\n                    if (listeners[evt][i] !== fn) l.push(listeners[evt][i]);\n                }\n                listeners[evt] = l;\n            }\n        };\n\n        var _dispatch = function(evt, value) {\n            var result = null;\n            if (activeSelectorParams && activeSelectorParams[evt]) {\n                result = activeSelectorParams[evt](value);\n            } else if (listeners[evt]) {\n                for (var i = 0; i < listeners[evt].length; i++) {\n                    try {\n                        var v = listeners[evt][i](value);\n                        if (v != null) {\n                            result = v;\n                        }\n                    }\n                    catch (e) { }\n                }\n            }\n            return result;\n        };\n\n        this.notifyStart = function(e) {\n            _dispatch(\"start\", {el:this.el, pos:this.params.getPosition(dragEl), e:e, drag:this});\n        };\n\n        this.stop = function(e, force) {\n            if (force || moving) {\n                var positions = [],\n                    sel = k.getSelection(),\n                    dPos = this.params.getPosition(dragEl);\n\n                if (sel.length > 0) {\n                    for (var i = 0; i < sel.length; i++) {\n                        var p = this.params.getPosition(sel[i].el);\n                        positions.push([ sel[i].el, { left: p[0], top: p[1] }, sel[i] ]);\n                    }\n                }\n                else {\n                    positions.push([ dragEl, {left:dPos[0], top:dPos[1]}, this ]);\n                }\n\n                _dispatch(\"stop\", {\n                    el: dragEl,\n                    pos: ghostProxyOffsets || dPos,\n                    finalPos:dPos,\n                    e: e,\n                    drag: this,\n                    selection:positions\n                });\n            }\n        };\n\n        this.mark = function(andNotify) {\n            posAtDown = this.params.getPosition(dragEl);\n            pagePosAtDown = this.params.getPosition(dragEl, true);\n            pageDelta = [pagePosAtDown[0] - posAtDown[0], pagePosAtDown[1] - posAtDown[1]];\n            this.size = this.params.getSize(dragEl);\n            matchingDroppables = k.getMatchingDroppables(this);\n            _setDroppablesActive(matchingDroppables, true, false, this);\n            this.params.addClass(dragEl, this.params.dragClass || css.drag);\n\n            var cs;\n            if (this.params.getConstrainingRectangle) {\n                cs = this.params.getConstrainingRectangle(dragEl)\n            } else {\n                cs = this.params.getSize(dragEl.parentNode);\n            }\n            constrainRect = {w: cs[0], h: cs[1]};\n\n            ghostDx = 0;\n            ghostDy = 0;\n\n            if (andNotify) {\n                k.notifySelectionDragStart(this);\n            }\n        };\n        var ghostProxyOffsets;\n        this.unmark = function(e, doNotCheckDroppables) {\n            _setDroppablesActive(matchingDroppables, false, true, this);\n\n            if (isConstrained && useGhostProxy(elementToDrag, dragEl)) {\n                ghostProxyOffsets = [dragEl.offsetLeft - ghostDx, dragEl.offsetTop - ghostDy];\n                dragEl.parentNode.removeChild(dragEl);\n                dragEl = elementToDrag;\n            }\n            else {\n                ghostProxyOffsets = null;\n            }\n\n            this.params.removeClass(dragEl, this.params.dragClass || css.drag);\n            matchingDroppables.length = 0;\n            isConstrained = false;\n            if (!doNotCheckDroppables) {\n                if (intersectingDroppables.length > 0 && ghostProxyOffsets) {\n                    params.setPosition(elementToDrag, ghostProxyOffsets);\n                }\n                intersectingDroppables.sort(_rankSort);\n                for (var i = 0; i < intersectingDroppables.length; i++) {\n                    var retVal = intersectingDroppables[i].drop(this, e);\n                    if (retVal === true) break;\n                }\n            }\n        };\n        this.moveBy = function(dx, dy, e) {\n            intersectingDroppables.length = 0;\n\n            var desiredLoc = this.toGrid([posAtDown[0] + dx, posAtDown[1] + dy]),\n                cPos = constrain(desiredLoc, dragEl, constrainRect, this.size);\n\n            // if we should use a ghost proxy...\n            if (useGhostProxy(this.el, dragEl)) {\n                // and the element has been dragged outside of its parent bounds\n                if (desiredLoc[0] !== cPos[0] || desiredLoc[1] !== cPos[1]) {\n\n                    // ...if ghost proxy not yet created\n                    if (!isConstrained) {\n                        // create it\n                        var gp = ghostProxy(elementToDrag);\n                        params.addClass(gp, _classes.ghostProxy);\n\n                        if (ghostProxyParent) {\n                            ghostProxyParent.appendChild(gp);\n                            // find offset between drag el's parent the ghost parent\n                           currentParentPosition = params.getPosition(elementToDrag.parentNode, true);\n                           ghostParentPosition = params.getPosition(params.ghostProxyParent, true);\n                           ghostDx = currentParentPosition[0] - ghostParentPosition[0];\n                           ghostDy = currentParentPosition[1] - ghostParentPosition[1];\n\n                        } else {\n                            elementToDrag.parentNode.appendChild(gp);\n                        }\n\n                        // the ghost proxy is the drag element\n                        dragEl = gp;\n                        // set this flag so we dont recreate the ghost proxy\n                        isConstrained = true;\n                    }\n                    // now the drag position can be the desired position, as the ghost proxy can support it.\n                    cPos = desiredLoc;\n                }\n                else {\n                    // if the element is not outside of its parent bounds, and ghost proxy is in place,\n                    if (isConstrained) {\n                        // remove the ghost proxy from the dom\n                        dragEl.parentNode.removeChild(dragEl);\n                        // reset the drag element to the original element\n                        dragEl = elementToDrag;\n                        // clear this flag.\n                        isConstrained = false;\n                        currentParentPosition = null;\n                        ghostParentPosition = null;\n                        ghostDx = 0;\n                        ghostDy = 0;\n                    }\n                }\n            }\n\n            var rect = { x:cPos[0], y:cPos[1], w:this.size[0], h:this.size[1]},\n                pageRect = { x:rect.x + pageDelta[0], y:rect.y + pageDelta[1], w:rect.w, h:rect.h},\n                focusDropElement = null;\n\n            this.params.setPosition(dragEl, [cPos[0] + ghostDx, cPos[1] + ghostDy]);\n\n            for (var i = 0; i < matchingDroppables.length; i++) {\n                var r2 = { x:matchingDroppables[i].pagePosition[0], y:matchingDroppables[i].pagePosition[1], w:matchingDroppables[i].size[0], h:matchingDroppables[i].size[1]};\n                if (this.params.intersects(pageRect, r2) && (_multipleDrop || focusDropElement == null || focusDropElement === matchingDroppables[i].el) && matchingDroppables[i].canDrop(this)) {\n                    if (!focusDropElement) focusDropElement = matchingDroppables[i].el;\n                    intersectingDroppables.push(matchingDroppables[i]);\n                    matchingDroppables[i].setHover(this, true, e);\n                }\n                else if (matchingDroppables[i].isHover()) {\n                    matchingDroppables[i].setHover(this, false, e);\n                }\n            }\n\n            _dispatch(\"drag\", {el:this.el, pos:cPos, e:e, drag:this});\n\n            /* test to see if the parent needs to be scrolled (future)\n             if (scroll) {\n             var pnsl = dragEl.parentNode.scrollLeft, pnst = dragEl.parentNode.scrollTop;\n             console.log(\"scroll!\", pnsl, pnst);\n             }*/\n        };\n        this.destroy = function() {\n            this.params.unbind(this.el, \"mousedown\", this.downListener);\n            this.params.unbind(document, \"mousemove\", this.moveListener);\n            this.params.unbind(document, \"mouseup\", this.upListener);\n            this.downListener = null;\n            this.upListener = null;\n            this.moveListener = null;\n        };\n\n        // init:register mousedown, and perhaps set a filter\n        this.params.bind(this.el, \"mousedown\", this.downListener);\n\n        // if handle provided, use that.  otherwise, try to set a filter.\n        // note that a `handle` selector always results in filterExclude being set to false, ie.\n        // the selector defines the handle element(s).\n        if (this.params.handle)\n            _setFilter(this.params.handle, false);\n        else\n            _setFilter(this.params.filter, this.params.filterExclude);\n    };\n\n    var Drop = function(el, params, css, scope) {\n        this._class = css.droppable;\n        this.params = params || {};\n        this.rank = params.rank || 0;\n        this._activeClass = this.params.activeClass || css.active;\n        this._hoverClass = this.params.hoverClass || css.hover;\n        Super.apply(this, arguments);\n        var hover = false;\n        this.allowLoopback = this.params.allowLoopback !== false;\n\n        this.setActive = function(val) {\n            this.params[val ? \"addClass\" : \"removeClass\"](this.el, this._activeClass);\n        };\n\n        this.updatePosition = function() {\n            this.position = this.params.getPosition(this.el);\n            this.pagePosition = this.params.getPosition(this.el, true);\n            this.size = this.params.getSize(this.el);\n        };\n\n        this.canDrop = this.params.canDrop || function(drag) {\n            return true;\n        };\n\n        this.isHover = function() { return hover; };\n\n        this.setHover = function(drag, val, e) {\n            // if turning off hover but this was not the drag that caused the hover, ignore.\n            if (val || this.el._katavorioDragHover == null || this.el._katavorioDragHover === drag.el._katavorio) {\n                this.params[val ? \"addClass\" : \"removeClass\"](this.el, this._hoverClass);\n                this.el._katavorioDragHover = val ? drag.el._katavorio : null;\n                if (hover !== val) {\n                    this.params.events[val ? \"over\" : \"out\"]({el: this.el, e: e, drag: drag, drop: this});\n                }\n                hover = val;\n            }\n        };\n\n        /**\n         * A drop event. `drag` is the corresponding Drag object, which may be a Drag for some specific element, or it\n         * may be a Drag on some element acting as a delegate for elements contained within it.\n         * @param drag\n         * @param event\n         * @returns {*}\n         */\n        this.drop = function(drag, event) {\n            return this.params.events[\"drop\"]({ drag:drag, e:event, drop:this });\n        };\n\n        this.destroy = function() {\n            this._class = null;\n            this._activeClass = null;\n            this._hoverClass = null;\n            hover = null;\n        };\n    };\n\n    var _uuid = function() {\n        return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n            var r = Math.random()*16|0, v = c === 'x' ? r : (r&0x3|0x8);\n            return v.toString(16);\n        }));\n    };\n\n    var _rankSort = function(a,b) {\n        return a.rank < b.rank ? 1 : a.rank > b.rank ? -1 : 0;\n    };\n\n    var _gel = function(el) {\n        if (el == null) return null;\n        el = (typeof el === \"string\" || el.constructor === String)  ? document.getElementById(el) : el;\n        if (el == null) return null;\n        el._katavorio = el._katavorio || _uuid();\n        return el;\n    };\n\n    root.Katavorio = function(katavorioParams) {\n\n        var _selection = [],\n            _selectionMap = {};\n\n        this._dragsByScope = {};\n        this._dropsByScope = {};\n        var _zoom = 1,\n            _reg = function(obj, map) {\n                _each(obj, function(_obj) {\n                    for(var i = 0; i < _obj.scopes.length; i++) {\n                        map[_obj.scopes[i]] = map[_obj.scopes[i]] || [];\n                        map[_obj.scopes[i]].push(_obj);\n                    }\n                });\n            },\n            _unreg = function(obj, map) {\n                var c = 0;\n                _each(obj, function(_obj) {\n                    for(var i = 0; i < _obj.scopes.length; i++) {\n                        if (map[_obj.scopes[i]]) {\n                            var idx = katavorioParams.indexOf(map[_obj.scopes[i]], _obj);\n                            if (idx !== -1) {\n                                map[_obj.scopes[i]].splice(idx, 1);\n                                c++;\n                            }\n                        }\n                    }\n                });\n\n                return c > 0 ;\n            },\n            _getMatchingDroppables = this.getMatchingDroppables = function(drag) {\n                var dd = [], _m = {};\n                for (var i = 0; i < drag.scopes.length; i++) {\n                    var _dd = this._dropsByScope[drag.scopes[i]];\n                    if (_dd) {\n                        for (var j = 0; j < _dd.length; j++) {\n                            if (_dd[j].canDrop(drag) &&  !_m[_dd[j].uuid] && (_dd[j].allowLoopback || _dd[j].el !== drag.el)) {\n                                _m[_dd[j].uuid] = true;\n                                dd.push(_dd[j]);\n                            }\n                        }\n                    }\n                }\n                dd.sort(_rankSort);\n                return dd;\n            },\n            _prepareParams = function(p) {\n                p = p || {};\n                var _p = {\n                    events:{}\n                }, i;\n                for (i in katavorioParams) _p[i] = katavorioParams[i];\n                for (i in p) _p[i] = p[i];\n                // events\n\n                for (i = 0; i < _events.length; i++) {\n                    _p.events[_events[i]] = p[_events[i]] || _devNull;\n                }\n                _p.katavorio = this;\n                return _p;\n            }.bind(this),\n            _mistletoe = function(existingDrag, params) {\n                for (var i = 0; i < _events.length; i++) {\n                    if (params[_events[i]]) {\n                        existingDrag.on(_events[i], params[_events[i]]);\n                    }\n                }\n            }.bind(this),\n            _css = {},\n            overrideCss = katavorioParams.css || {},\n            _scope = katavorioParams.scope || _defaultScope;\n\n        // prepare map of css classes based on defaults frst, then optional overrides\n        for (var i in _classes) _css[i] = _classes[i];\n        for (var i in overrideCss) _css[i] = overrideCss[i];\n\n        var inputFilterSelector = katavorioParams.inputFilterSelector || _defaultInputFilterSelector;\n        /**\n         * Gets the selector identifying which input elements to filter from drag events.\n         * @method getInputFilterSelector\n         * @return {String} Current input filter selector.\n         */\n        this.getInputFilterSelector = function() { return inputFilterSelector; };\n\n        /**\n         * Sets the selector identifying which input elements to filter from drag events.\n         * @method setInputFilterSelector\n         * @param {String} selector Input filter selector to set.\n         * @return {Katavorio} Current instance; method may be chained.\n         */\n        this.setInputFilterSelector = function(selector) {\n            inputFilterSelector = selector;\n            return this;\n        };\n\n        /**\n         * Either makes the given element draggable, or identifies it as an element inside which some identified list\n         * of elements may be draggable.\n         * @param el\n         * @param params\n         * @returns {Array}\n         */\n        this.draggable = function(el, params) {\n            var o = [];\n            _each(el, function (_el) {\n                _el = _gel(_el);\n                if (_el != null) {\n                    if (_el._katavorioDrag == null) {\n                        var p = _prepareParams(params);\n                        _el._katavorioDrag = new Drag(_el, p, _css, _scope);\n                        _reg(_el._katavorioDrag, this._dragsByScope);\n                        o.push(_el._katavorioDrag);\n                        katavorioParams.addClass(_el, p.selector ? _css.delegatedDraggable : _css.draggable);\n                    }\n                    else {\n                        _mistletoe(_el._katavorioDrag, params);\n                    }\n                }\n            }.bind(this));\n            return o;\n        };\n\n        this.droppable = function(el, params) {\n            var o = [];\n            _each(el, function(_el) {\n                _el = _gel(_el);\n                if (_el != null) {\n                    var drop = new Drop(_el, _prepareParams(params), _css, _scope);\n                    _el._katavorioDrop = _el._katavorioDrop || [];\n                    _el._katavorioDrop.push(drop);\n                    _reg(drop, this._dropsByScope);\n                    o.push(drop);\n                    katavorioParams.addClass(_el, _css.droppable);\n                }\n            }.bind(this));\n            return o;\n        };\n\n        /**\n         * @name Katavorio#select\n         * @function\n         * @desc Adds an element to the current selection (for multiple node drag)\n         * @param {Element|String} DOM element - or id of the element - to add.\n         */\n        this.select = function(el) {\n            _each(el, function() {\n                var _el = _gel(this);\n                if (_el && _el._katavorioDrag) {\n                    if (!_selectionMap[_el._katavorio]) {\n                        _selection.push(_el._katavorioDrag);\n                        _selectionMap[_el._katavorio] = [ _el, _selection.length - 1 ];\n                        katavorioParams.addClass(_el, _css.selected);\n                    }\n                }\n            });\n            return this;\n        };\n\n        /**\n         * @name Katavorio#deselect\n         * @function\n         * @desc Removes an element from the current selection (for multiple node drag)\n         * @param {Element|String} DOM element - or id of the element - to remove.\n         */\n        this.deselect = function(el) {\n            _each(el, function() {\n                var _el = _gel(this);\n                if (_el && _el._katavorio) {\n                    var e = _selectionMap[_el._katavorio];\n                    if (e) {\n                        var _s = [];\n                        for (var i = 0; i < _selection.length; i++)\n                            if (_selection[i].el !== _el) _s.push(_selection[i]);\n                        _selection = _s;\n                        delete _selectionMap[_el._katavorio];\n                        katavorioParams.removeClass(_el, _css.selected);\n                    }\n                }\n            });\n            return this;\n        };\n\n        this.deselectAll = function() {\n            for (var i in _selectionMap) {\n                var d = _selectionMap[i];\n                katavorioParams.removeClass(d[0], _css.selected);\n            }\n\n            _selection.length = 0;\n            _selectionMap = {};\n        };\n\n        this.markSelection = function(drag) {\n            _foreach(_selection, function(e) { e.mark(); }, drag);\n        };\n\n        this.markPosses = function(drag) {\n            if (drag.posses) {\n                _each(drag.posses, function(p) {\n                    if (drag.posseRoles[p] && _posses[p]) {\n                        _foreach(_posses[p].members, function (d) {\n                            d.mark();\n                        }, drag);\n                    }\n                })\n            }\n        };\n\n        this.unmarkSelection = function(drag, event) {\n            _foreach(_selection, function(e) { e.unmark(event); }, drag);\n        };\n\n        this.unmarkPosses = function(drag, event) {\n            if (drag.posses) {\n                _each(drag.posses, function(p) {\n                    if (drag.posseRoles[p] && _posses[p]) {\n                        _foreach(_posses[p].members, function (d) {\n                            d.unmark(event, true);\n                        }, drag);\n                    }\n                });\n            }\n        };\n\n        this.getSelection = function() { return _selection.slice(0); };\n\n        this.updateSelection = function(dx, dy, drag) {\n            _foreach(_selection, function(e) { e.moveBy(dx, dy); }, drag);\n        };\n\n        var _posseAction = function(fn, drag) {\n            if (drag.posses) {\n                _each(drag.posses, function(p) {\n                    if (drag.posseRoles[p] && _posses[p]) {\n                        _foreach(_posses[p].members, function (e) {\n                            fn(e);\n                        }, drag);\n                    }\n                });\n            }\n        };\n\n        this.updatePosses = function(dx, dy, drag) {\n            _posseAction(function(e) { e.moveBy(dx, dy); }, drag);\n        };\n\n        this.notifyPosseDragStop = function(drag, evt) {\n            _posseAction(function(e) { e.stop(evt, true); }, drag);\n        };\n\n        this.notifySelectionDragStop = function(drag, evt) {\n            _foreach(_selection, function(e) { e.stop(evt, true); }, drag);\n        };\n\n        this.notifySelectionDragStart = function(drag, evt) {\n            _foreach(_selection, function(e) { e.notifyStart(evt);}, drag);\n        };\n\n        this.setZoom = function(z) { _zoom = z; };\n        this.getZoom = function() { return _zoom; };\n\n        // does the work of changing scopes\n        var _scopeManip = function(kObj, scopes, map, fn) {\n            _each(kObj, function(_kObj) {\n                _unreg(_kObj, map);  // deregister existing scopes\n                _kObj[fn](scopes); // set scopes\n                _reg(_kObj, map); // register new ones\n            });\n        };\n\n        _each([ \"set\", \"add\", \"remove\", \"toggle\"], function(v) {\n            this[v + \"Scope\"] = function(el, scopes) {\n                _scopeManip(el._katavorioDrag, scopes, this._dragsByScope, v + \"Scope\");\n                _scopeManip(el._katavorioDrop, scopes, this._dropsByScope, v + \"Scope\");\n            }.bind(this);\n            this[v + \"DragScope\"] = function(el, scopes) {\n                _scopeManip(el.constructor === Drag ? el : el._katavorioDrag, scopes, this._dragsByScope, v + \"Scope\");\n            }.bind(this);\n            this[v + \"DropScope\"] = function(el, scopes) {\n                _scopeManip(el.constructor === Drop ? el : el._katavorioDrop, scopes, this._dropsByScope, v + \"Scope\");\n            }.bind(this);\n        }.bind(this));\n\n        this.snapToGrid = function(x, y) {\n            for (var s in this._dragsByScope) {\n                _foreach(this._dragsByScope[s], function(d) { d.snap(x, y); });\n            }\n        };\n\n        this.getDragsForScope = function(s) { return this._dragsByScope[s]; };\n        this.getDropsForScope = function(s) { return this._dropsByScope[s]; };\n\n        var _destroy = function(el, type, map) {\n            el = _gel(el);\n            if (el[type]) {\n\n                // remove from selection, if present.\n                var selIdx = _selection.indexOf(el[type]);\n                if (selIdx >= 0) {\n                    _selection.splice(selIdx, 1);\n                }\n\n                if (_unreg(el[type], map)) {\n                    _each(el[type], function(kObj) { kObj.destroy() });\n                }\n\n                delete el[type];\n            }\n        };\n\n        var _removeListener = function(el, type, evt, fn) {\n            el = _gel(el);\n            if (el[type]) {\n                el[type].off(evt, fn);\n            }\n        };\n\n        this.elementRemoved = function(el) {\n            this.destroyDraggable(el);\n            this.destroyDroppable(el);\n        };\n\n        /**\n         * Either completely remove drag functionality from the given element, or remove a specific event handler. If you\n         * call this method with a single argument - the element - all drag functionality is removed from it. Otherwise, if\n         * you provide an event name and listener function, this function is de-registered (if found).\n         * @param el Element to update\n         * @param {string} [evt] Optional event name to unsubscribe\n         * @param {Function} [fn] Optional function to unsubscribe\n         */\n        this.destroyDraggable = function(el, evt, fn) {\n            if (arguments.length === 1) {\n                _destroy(el, \"_katavorioDrag\", this._dragsByScope);\n            } else {\n                _removeListener(el, \"_katavorioDrag\", evt, fn);\n            }\n        };\n\n        /**\n         * Either completely remove drop functionality from the given element, or remove a specific event handler. If you\n         * call this method with a single argument - the element - all drop functionality is removed from it. Otherwise, if\n         * you provide an event name and listener function, this function is de-registered (if found).\n         * @param el Element to update\n         * @param {string} [evt] Optional event name to unsubscribe\n         * @param {Function} [fn] Optional function to unsubscribe\n         */\n        this.destroyDroppable = function(el, evt, fn) {\n            if (arguments.length === 1) {\n                _destroy(el, \"_katavorioDrop\", this._dropsByScope);\n            } else {\n                _removeListener(el, \"_katavorioDrop\", evt, fn);\n            }\n        };\n\n        this.reset = function() {\n            this._dragsByScope = {};\n            this._dropsByScope = {};\n            _selection = [];\n            _selectionMap = {};\n            _posses = {};\n        };\n\n        // ----- groups\n        var _posses = {};\n\n        var _processOneSpec = function(el, _spec, dontAddExisting) {\n            var posseId = _isString(_spec) ? _spec : _spec.id;\n            var active = _isString(_spec) ? true : _spec.active !== false;\n            var posse = _posses[posseId] || (function() {\n                var g = {name:posseId, members:[]};\n                _posses[posseId] = g;\n                return g;\n            })();\n            _each(el, function(_el) {\n                if (_el._katavorioDrag) {\n\n                    if (dontAddExisting && _el._katavorioDrag.posseRoles[posse.name] != null) return;\n\n                    _suggest(posse.members, _el._katavorioDrag);\n                    _suggest(_el._katavorioDrag.posses, posse.name);\n                    _el._katavorioDrag.posseRoles[posse.name] = active;\n                }\n            });\n            return posse;\n        };\n\n        /**\n         * Add the given element to the posse with the given id, creating the group if it at first does not exist.\n         * @method addToPosse\n         * @param {Element} el Element to add.\n         * @param {String...|Object...} spec Variable args parameters. Each argument can be a either a String, indicating\n         * the ID of a Posse to which the element should be added as an active participant, or an Object containing\n         * `{ id:\"posseId\", active:false/true}`. In the latter case, if `active` is not provided it is assumed to be\n         * true.\n         * @returns {Posse|Posse[]} The Posse(s) to which the element(s) was/were added.\n         */\n        this.addToPosse = function(el, spec) {\n\n            var posses = [];\n\n            for (var i = 1; i < arguments.length; i++) {\n                posses.push(_processOneSpec(el, arguments[i]));\n            }\n\n            return posses.length === 1 ? posses[0] : posses;\n        };\n\n        /**\n         * Sets the posse(s) for the element with the given id, creating those that do not yet exist, and removing from\n         * the element any current Posses that are not specified by this method call. This method will not change the\n         * active/passive state if it is given a posse in which the element is already a member.\n         * @method setPosse\n         * @param {Element} el Element to set posse(s) on.\n         * @param {String...|Object...} spec Variable args parameters. Each argument can be a either a String, indicating\n         * the ID of a Posse to which the element should be added as an active participant, or an Object containing\n         * `{ id:\"posseId\", active:false/true}`. In the latter case, if `active` is not provided it is assumed to be\n         * true.\n         * @returns {Posse|Posse[]} The Posse(s) to which the element(s) now belongs.\n         */\n        this.setPosse = function(el, spec) {\n\n            var posses = [];\n\n            for (var i = 1; i < arguments.length; i++) {\n                posses.push(_processOneSpec(el, arguments[i], true).name);\n            }\n\n            _each(el, function(_el) {\n                if (_el._katavorioDrag) {\n                    var diff = _difference(_el._katavorioDrag.posses, posses);\n                    var p = [];\n                    Array.prototype.push.apply(p, _el._katavorioDrag.posses);\n                    for (var i = 0; i < diff.length; i++) {\n                        this.removeFromPosse(_el, diff[i]);\n                    }\n                }\n            }.bind(this));\n\n            return posses.length === 1 ? posses[0] : posses;\n        };\n\n        /**\n         * Remove the given element from the given posse(s).\n         * @method removeFromPosse\n         * @param {Element} el Element to remove.\n         * @param {String...} posseId Varargs parameter: one value for each posse to remove the element from.\n         */\n        this.removeFromPosse = function(el, posseId) {\n            if (arguments.length < 2) throw new TypeError(\"No posse id provided for remove operation\");\n            for(var i = 1; i < arguments.length; i++) {\n                posseId = arguments[i];\n                _each(el, function (_el) {\n                    if (_el._katavorioDrag && _el._katavorioDrag.posses) {\n                        var d = _el._katavorioDrag;\n                        _each(posseId, function (p) {\n                            _vanquish(_posses[p].members, d);\n                            _vanquish(d.posses, p);\n                            delete d.posseRoles[p];\n                        });\n                    }\n                });\n            }\n        };\n\n        /**\n         * Remove the given element from all Posses to which it belongs.\n         * @method removeFromAllPosses\n         * @param {Element|Element[]} el Element to remove from Posses.\n         */\n        this.removeFromAllPosses = function(el) {\n            _each(el, function(_el) {\n                if (_el._katavorioDrag && _el._katavorioDrag.posses) {\n                    var d = _el._katavorioDrag;\n                    _each(d.posses, function(p) {\n                        _vanquish(_posses[p].members, d);\n                    });\n                    d.posses.length = 0;\n                    d.posseRoles = {};\n                }\n            });\n        };\n\n        /**\n         * Changes the participation state for the element in the Posse with the given ID.\n         * @param {Element|Element[]} el Element(s) to change state for.\n         * @param {String} posseId ID of the Posse to change element state for.\n         * @param {Boolean} state True to make active, false to make passive.\n         */\n        this.setPosseState = function(el, posseId, state) {\n            var posse = _posses[posseId];\n            if (posse) {\n                _each(el, function(_el) {\n                    if (_el._katavorioDrag && _el._katavorioDrag.posses) {\n                        _el._katavorioDrag.posseRoles[posse.name] = state;\n                    }\n                });\n            }\n        };\n\n    };\n\n    root.Katavorio.version = \"1.0.0\";\n\n    if (typeof exports !== \"undefined\") {\n        exports.Katavorio = root.Katavorio;\n    }\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * Utility functions.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n(function() {\n\n    var root = this;\n    root.jsPlumbUtil = root.jsPlumbUtil || {};\n    var jsPlumbUtil = root.jsPlumbUtil;\n\n    if (typeof exports !=='undefined') { exports.jsPlumbUtil = jsPlumbUtil;}\n\n\n    /**\n     * Tests if the given object is an Array.\n     * @param a\n     */\n    function isArray(a) {\n        return Object.prototype.toString.call(a) === \"[object Array]\";\n    }\n    jsPlumbUtil.isArray = isArray;\n    /**\n     * Tests if the given object is a Number.\n     * @param n\n     */\n    function isNumber(n) {\n        return Object.prototype.toString.call(n) === \"[object Number]\";\n    }\n    jsPlumbUtil.isNumber = isNumber;\n    function isString(s) {\n        return typeof s === \"string\";\n    }\n    jsPlumbUtil.isString = isString;\n    function isBoolean(s) {\n        return typeof s === \"boolean\";\n    }\n    jsPlumbUtil.isBoolean = isBoolean;\n    function isNull(s) {\n        return s == null;\n    }\n    jsPlumbUtil.isNull = isNull;\n    function isObject(o) {\n        return o == null ? false : Object.prototype.toString.call(o) === \"[object Object]\";\n    }\n    jsPlumbUtil.isObject = isObject;\n    function isDate(o) {\n        return Object.prototype.toString.call(o) === \"[object Date]\";\n    }\n    jsPlumbUtil.isDate = isDate;\n    function isFunction(o) {\n        return Object.prototype.toString.call(o) === \"[object Function]\";\n    }\n    jsPlumbUtil.isFunction = isFunction;\n    function isNamedFunction(o) {\n        return isFunction(o) && o.name != null && o.name.length > 0;\n    }\n    jsPlumbUtil.isNamedFunction = isNamedFunction;\n    function isEmpty(o) {\n        for (var i in o) {\n            if (o.hasOwnProperty(i)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    jsPlumbUtil.isEmpty = isEmpty;\n    function clone(a) {\n        if (isString(a)) {\n            return \"\" + a;\n        }\n        else if (isBoolean(a)) {\n            return !!a;\n        }\n        else if (isDate(a)) {\n            return new Date(a.getTime());\n        }\n        else if (isFunction(a)) {\n            return a;\n        }\n        else if (isArray(a)) {\n            var b = [];\n            for (var i = 0; i < a.length; i++) {\n                b.push(clone(a[i]));\n            }\n            return b;\n        }\n        else if (isObject(a)) {\n            var c = {};\n            for (var j in a) {\n                c[j] = clone(a[j]);\n            }\n            return c;\n        }\n        else {\n            return a;\n        }\n    }\n    jsPlumbUtil.clone = clone;\n    function merge(a, b, collations, overwrites) {\n        // first change the collations array - if present - into a lookup table, because its faster.\n        var cMap = {}, ar, i, oMap = {};\n        collations = collations || [];\n        overwrites = overwrites || [];\n        for (i = 0; i < collations.length; i++) {\n            cMap[collations[i]] = true;\n        }\n        for (i = 0; i < overwrites.length; i++) {\n            oMap[overwrites[i]] = true;\n        }\n        var c = clone(a);\n        for (i in b) {\n            if (c[i] == null || oMap[i]) {\n                c[i] = b[i];\n            }\n            else if (isString(b[i]) || isBoolean(b[i])) {\n                if (!cMap[i]) {\n                    c[i] = b[i]; // if we dont want to collate, just copy it in.\n                }\n                else {\n                    ar = [];\n                    // if c's object is also an array we can keep its values.\n                    ar.push.apply(ar, isArray(c[i]) ? c[i] : [c[i]]);\n                    ar.push.apply(ar, isBoolean(b[i]) ? b[i] : [b[i]]);\n                    c[i] = ar;\n                }\n            }\n            else {\n                if (isArray(b[i])) {\n                    ar = [];\n                    // if c's object is also an array we can keep its values.\n                    if (isArray(c[i])) {\n                        ar.push.apply(ar, c[i]);\n                    }\n                    ar.push.apply(ar, b[i]);\n                    c[i] = ar;\n                }\n                else if (isObject(b[i])) {\n                    // overwrite c's value with an object if it is not already one.\n                    if (!isObject(c[i])) {\n                        c[i] = {};\n                    }\n                    for (var j in b[i]) {\n                        c[i][j] = b[i][j];\n                    }\n                }\n            }\n        }\n        return c;\n    }\n    jsPlumbUtil.merge = merge;\n    function replace(inObj, path, value) {\n        if (inObj == null) {\n            return;\n        }\n        var q = inObj, t = q;\n        path.replace(/([^\\.])+/g, function (term, lc, pos, str) {\n            var array = term.match(/([^\\[0-9]+){1}(\\[)([0-9+])/), last = pos + term.length >= str.length, _getArray = function () {\n                return t[array[1]] || (function () {\n                    t[array[1]] = [];\n                    return t[array[1]];\n                })();\n            };\n            if (last) {\n                // set term = value on current t, creating term as array if necessary.\n                if (array) {\n                    _getArray()[array[3]] = value;\n                }\n                else {\n                    t[term] = value;\n                }\n            }\n            else {\n                // set to current t[term], creating t[term] if necessary.\n                if (array) {\n                    var a_1 = _getArray();\n                    t = a_1[array[3]] || (function () {\n                        a_1[array[3]] = {};\n                        return a_1[array[3]];\n                    })();\n                }\n                else {\n                    t = t[term] || (function () {\n                        t[term] = {};\n                        return t[term];\n                    })();\n                }\n            }\n            return \"\";\n        });\n        return inObj;\n    }\n    jsPlumbUtil.replace = replace;\n    //\n    // chain a list of functions, supplied by [ object, method name, args ], and return on the first\n    // one that returns the failValue. if none return the failValue, return the successValue.\n    //\n    function functionChain(successValue, failValue, fns) {\n        for (var i = 0; i < fns.length; i++) {\n            var o = fns[i][0][fns[i][1]].apply(fns[i][0], fns[i][2]);\n            if (o === failValue) {\n                return o;\n            }\n        }\n        return successValue;\n    }\n    jsPlumbUtil.functionChain = functionChain;\n    /**\n     *\n     * Take the given model and expand out any parameters. 'functionPrefix' is optional, and if present, helps jsplumb figure out what to do if a value is a Function.\n     * if you do not provide it (and doNotExpandFunctions is null, or false), jsplumb will run the given values through any functions it finds, and use the function's\n     * output as the value in the result. if you do provide the prefix, only functions that are named and have this prefix\n     * will be executed; other functions will be passed as values to the output.\n     *\n     * @param model\n     * @param values\n     * @param functionPrefix\n     * @param doNotExpandFunctions\n     * @returns {any}\n     */\n    function populate(model, values, functionPrefix, doNotExpandFunctions) {\n        // for a string, see if it has parameter matches, and if so, try to make the substitutions.\n        var getValue = function (fromString) {\n            var matches = fromString.match(/(\\${.*?})/g);\n            if (matches != null) {\n                for (var i = 0; i < matches.length; i++) {\n                    var val = values[matches[i].substring(2, matches[i].length - 1)] || \"\";\n                    if (val != null) {\n                        fromString = fromString.replace(matches[i], val);\n                    }\n                }\n            }\n            return fromString;\n        };\n        // process one entry.\n        var _one = function (d) {\n            if (d != null) {\n                if (isString(d)) {\n                    return getValue(d);\n                }\n                else if (isFunction(d) && !doNotExpandFunctions && (functionPrefix == null || (d.name || \"\").indexOf(functionPrefix) === 0)) {\n                    return d(values);\n                }\n                else if (isArray(d)) {\n                    var r = [];\n                    for (var i = 0; i < d.length; i++) {\n                        r.push(_one(d[i]));\n                    }\n                    return r;\n                }\n                else if (isObject(d)) {\n                    var s = {};\n                    for (var j in d) {\n                        s[j] = _one(d[j]);\n                    }\n                    return s;\n                }\n                else {\n                    return d;\n                }\n            }\n        };\n        return _one(model);\n    }\n    jsPlumbUtil.populate = populate;\n    /**\n     * Find the index of a given object in an array.\n     * @param a The array to search\n     * @param f The function to run on each element. Return true if the element matches.\n     * @returns {number} -1 if not found, otherwise the index in the array.\n     */\n    function findWithFunction(a, f) {\n        if (a) {\n            for (var i = 0; i < a.length; i++) {\n                if (f(a[i])) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    }\n    jsPlumbUtil.findWithFunction = findWithFunction;\n    /**\n     * Remove some element from an array by matching each element in the array against some predicate function. Note that this\n     * is an in-place removal; the array is altered.\n     * @param a The array to search\n     * @param f The function to run on each element. Return true if the element matches.\n     * @returns {boolean} true if removed, false otherwise.\n     */\n    function removeWithFunction(a, f) {\n        var idx = findWithFunction(a, f);\n        if (idx > -1) {\n            a.splice(idx, 1);\n        }\n        return idx !== -1;\n    }\n    jsPlumbUtil.removeWithFunction = removeWithFunction;\n    /**\n     * Remove some element from an array by simple lookup in the array for the given element. Note that this\n     * is an in-place removal; the array is altered.\n     * @param l The array to search\n     * @param v The value to remove.\n     * @returns {boolean} true if removed, false otherwise.\n     */\n    function remove(l, v) {\n        var idx = l.indexOf(v);\n        if (idx > -1) {\n            l.splice(idx, 1);\n        }\n        return idx !== -1;\n    }\n    jsPlumbUtil.remove = remove;\n    /**\n     * Add some element to the given array, unless it is determined that it is already in the array.\n     * @param list The array to add the element to.\n     * @param item The item to add.\n     * @param hashFunction A function to use to determine if the given item already exists in the array.\n     */\n    function addWithFunction(list, item, hashFunction) {\n        if (findWithFunction(list, hashFunction) === -1) {\n            list.push(item);\n        }\n    }\n    jsPlumbUtil.addWithFunction = addWithFunction;\n    /**\n     * Add some element to a list that is contained in a map of lists.\n     * @param map The map of [ key -> list ] entries\n     * @param key The name of the list to insert into\n     * @param value The value to insert\n     * @param insertAtStart Whether or not to insert at the start; defaults to false.\n     */\n    function addToList(map, key, value, insertAtStart) {\n        var l = map[key];\n        if (l == null) {\n            l = [];\n            map[key] = l;\n        }\n        l[insertAtStart ? \"unshift\" : \"push\"](value);\n        return l;\n    }\n    jsPlumbUtil.addToList = addToList;\n    /**\n     * Add an item to a list, unless it is already in the list. The test for pre-existence is a simple list lookup.\n     * If you want to do something more complex, perhaps #addWithFunction might help.\n     * @param list List to add the item to\n     * @param item Item to add\n     * @param insertAtHead Whether or not to insert at the start; defaults to false.\n     */\n    function suggest(list, item, insertAtHead) {\n        if (list.indexOf(item) === -1) {\n            if (insertAtHead) {\n                list.unshift(item);\n            }\n            else {\n                list.push(item);\n            }\n            return true;\n        }\n        return false;\n    }\n    jsPlumbUtil.suggest = suggest;\n    /**\n     * Extends the given obj (which can be an array) with the given constructor function, prototype functions, and class members, any of which may be null.\n     * @param child\n     * @param parent\n     * @param _protoFn\n     */\n    function extend(child, parent, _protoFn) {\n        var i;\n        parent = isArray(parent) ? parent : [parent];\n        var _copyProtoChain = function (focus) {\n            var proto = focus.__proto__;\n            while (proto != null) {\n                if (proto.prototype != null) {\n                    for (var j in proto.prototype) {\n                        if (proto.prototype.hasOwnProperty(j) && !child.prototype.hasOwnProperty(j)) {\n                            child.prototype[j] = proto.prototype[j];\n                        }\n                    }\n                    proto = proto.prototype.__proto__;\n                }\n                else {\n                    proto = null;\n                }\n            }\n        };\n        for (i = 0; i < parent.length; i++) {\n            for (var j in parent[i].prototype) {\n                if (parent[i].prototype.hasOwnProperty(j) && !child.prototype.hasOwnProperty(j)) {\n                    child.prototype[j] = parent[i].prototype[j];\n                }\n            }\n            _copyProtoChain(parent[i]);\n        }\n        var _makeFn = function (name, protoFn) {\n            return function () {\n                for (i = 0; i < parent.length; i++) {\n                    if (parent[i].prototype[name]) {\n                        parent[i].prototype[name].apply(this, arguments);\n                    }\n                }\n                return protoFn.apply(this, arguments);\n            };\n        };\n        var _oneSet = function (fns) {\n            for (var k in fns) {\n                child.prototype[k] = _makeFn(k, fns[k]);\n            }\n        };\n        if (arguments.length > 2) {\n            for (i = 2; i < arguments.length; i++) {\n                _oneSet(arguments[i]);\n            }\n        }\n        return child;\n    }\n    jsPlumbUtil.extend = extend;\n    /**\n     * Generate a UUID.\n     */\n        // export function uuid(): string {\n        //     return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        //         let r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);\n        //         return v.toString(16);\n        //     }));\n        // }\n    var lut = [];\n    for (var i = 0; i < 256; i++) {\n        lut[i] = (i < 16 ? '0' : '') + (i).toString(16);\n    }\n    function uuid() {\n        var d0 = Math.random() * 0xffffffff | 0;\n        var d1 = Math.random() * 0xffffffff | 0;\n        var d2 = Math.random() * 0xffffffff | 0;\n        var d3 = Math.random() * 0xffffffff | 0;\n        return lut[d0 & 0xff] + lut[d0 >> 8 & 0xff] + lut[d0 >> 16 & 0xff] + lut[d0 >> 24 & 0xff] + '-' +\n            lut[d1 & 0xff] + lut[d1 >> 8 & 0xff] + '-' + lut[d1 >> 16 & 0x0f | 0x40] + lut[d1 >> 24 & 0xff] + '-' +\n            lut[d2 & 0x3f | 0x80] + lut[d2 >> 8 & 0xff] + '-' + lut[d2 >> 16 & 0xff] + lut[d2 >> 24 & 0xff] +\n            lut[d3 & 0xff] + lut[d3 >> 8 & 0xff] + lut[d3 >> 16 & 0xff] + lut[d3 >> 24 & 0xff];\n    }\n    jsPlumbUtil.uuid = uuid;\n    /**\n     * Trim a string.\n     * @param s String to trim\n     * @returns the String with leading and trailing whitespace removed.\n     */\n    function fastTrim(s) {\n        if (s == null) {\n            return null;\n        }\n        var str = s.replace(/^\\s\\s*/, ''), ws = /\\s/, i = str.length;\n        while (ws.test(str.charAt(--i))) {\n        }\n        return str.slice(0, i + 1);\n    }\n    jsPlumbUtil.fastTrim = fastTrim;\n    function each(obj, fn) {\n        obj = obj.length == null || typeof obj === \"string\" ? [obj] : obj;\n        for (var i = 0; i < obj.length; i++) {\n            fn(obj[i]);\n        }\n    }\n    jsPlumbUtil.each = each;\n    function map(obj, fn) {\n        var o = [];\n        for (var i = 0; i < obj.length; i++) {\n            o.push(fn(obj[i]));\n        }\n        return o;\n    }\n    jsPlumbUtil.map = map;\n    function mergeWithParents(type, map, parentAttribute) {\n        parentAttribute = parentAttribute || \"parent\";\n        var _def = function (id) {\n            return id ? map[id] : null;\n        };\n        var _parent = function (def) {\n            return def ? _def(def[parentAttribute]) : null;\n        };\n        var _one = function (parent, def) {\n            if (parent == null) {\n                return def;\n            }\n            else {\n                var overrides = [\"anchor\", \"anchors\", \"cssClass\", \"connector\", \"paintStyle\", \"hoverPaintStyle\", \"endpoint\", \"endpoints\"];\n                if (def.mergeStrategy === \"override\") {\n                    Array.prototype.push.apply(overrides, [\"events\", \"overlays\"]);\n                }\n                var d_1 = merge(parent, def, [], overrides);\n                return _one(_parent(parent), d_1);\n            }\n        };\n        var _getDef = function (t) {\n            if (t == null) {\n                return {};\n            }\n            if (typeof t === \"string\") {\n                return _def(t);\n            }\n            else if (t.length) {\n                var done = false, i = 0, _dd = void 0;\n                while (!done && i < t.length) {\n                    _dd = _getDef(t[i]);\n                    if (_dd) {\n                        done = true;\n                    }\n                    else {\n                        i++;\n                    }\n                }\n                return _dd;\n            }\n        };\n        var d = _getDef(type);\n        if (d) {\n            return _one(_parent(d), d);\n        }\n        else {\n            return {};\n        }\n    }\n    jsPlumbUtil.mergeWithParents = mergeWithParents;\n    jsPlumbUtil.logEnabled = true;\n    function log() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (jsPlumbUtil.logEnabled && typeof console !== \"undefined\") {\n            try {\n                var msg = arguments[arguments.length - 1];\n                console.log(msg);\n            }\n            catch (e) {\n            }\n        }\n    }\n    jsPlumbUtil.log = log;\n    /**\n     * Wraps one function with another, creating a placeholder for the\n     * wrapped function if it was null. this is used to wrap the various\n     * drag/drop event functions - to allow jsPlumb to be notified of\n     * important lifecycle events without imposing itself on the user's\n     * drag/drop functionality.\n     * @method jsPlumbUtil.wrap\n     * @param {Function} wrappedFunction original function to wrap; may be null.\n     * @param {Function} newFunction function to wrap the original with.\n     * @param {Object} [returnOnThisValue] Optional. Indicates that the wrappedFunction should\n     * not be executed if the newFunction returns a value matching 'returnOnThisValue'.\n     * note that this is a simple comparison and only works for primitives right now.\n     */\n    function wrap(wrappedFunction, newFunction, returnOnThisValue) {\n        return function () {\n            var r = null;\n            try {\n                if (newFunction != null) {\n                    r = newFunction.apply(this, arguments);\n                }\n            }\n            catch (e) {\n                log(\"jsPlumb function failed : \" + e);\n            }\n            if ((wrappedFunction != null) && (returnOnThisValue == null || (r !== returnOnThisValue))) {\n                try {\n                    r = wrappedFunction.apply(this, arguments);\n                }\n                catch (e) {\n                    log(\"wrapped function failed : \" + e);\n                }\n            }\n            return r;\n        };\n    }\n    jsPlumbUtil.wrap = wrap;\n    var EventGenerator = /** @class */ (function () {\n        function EventGenerator() {\n            var _this = this;\n            this._listeners = {};\n            this.eventsSuspended = false;\n            this.tick = false;\n            // this is a list of events that should re-throw any errors that occur during their dispatch.\n            this.eventsToDieOn = { \"ready\": true };\n            this.queue = [];\n            this.bind = function (event, listener, insertAtStart) {\n                var _one = function (evt) {\n                    addToList(_this._listeners, evt, listener, insertAtStart);\n                    listener.__jsPlumb = listener.__jsPlumb || {};\n                    listener.__jsPlumb[uuid()] = evt;\n                };\n                if (typeof event === \"string\") {\n                    _one(event);\n                }\n                else if (event.length != null) {\n                    for (var i = 0; i < event.length; i++) {\n                        _one(event[i]);\n                    }\n                }\n                return _this;\n            };\n            this.fire = function (event, value, originalEvent) {\n                if (!this.tick) {\n                    this.tick = true;\n                    if (!this.eventsSuspended && this._listeners[event]) {\n                        var l = this._listeners[event].length, i = 0, _gone = false, ret = null;\n                        if (!this.shouldFireEvent || this.shouldFireEvent(event, value, originalEvent)) {\n                            while (!_gone && i < l && ret !== false) {\n                                // doing it this way rather than catching and then possibly re-throwing means that an error propagated by this\n                                // method will have the whole call stack available in the debugger.\n                                if (this.eventsToDieOn[event]) {\n                                    this._listeners[event][i].apply(this, [value, originalEvent]);\n                                }\n                                else {\n                                    try {\n                                        ret = this._listeners[event][i].apply(this, [value, originalEvent]);\n                                    }\n                                    catch (e) {\n                                        log(\"jsPlumb: fire failed for event \" + event + \" : \" + e);\n                                    }\n                                }\n                                i++;\n                                if (this._listeners == null || this._listeners[event] == null) {\n                                    _gone = true;\n                                }\n                            }\n                        }\n                    }\n                    this.tick = false;\n                    this._drain();\n                }\n                else {\n                    this.queue.unshift(arguments);\n                }\n                return this;\n            };\n            this._drain = function () {\n                var n = _this.queue.pop();\n                if (n) {\n                    _this.fire.apply(_this, n);\n                }\n            };\n            this.unbind = function (eventOrListener, listener) {\n                if (arguments.length === 0) {\n                    this._listeners = {};\n                }\n                else if (arguments.length === 1) {\n                    if (typeof eventOrListener === \"string\") {\n                        delete this._listeners[eventOrListener];\n                    }\n                    else if (eventOrListener.__jsPlumb) {\n                        var evt = void 0;\n                        for (var i in eventOrListener.__jsPlumb) {\n                            evt = eventOrListener.__jsPlumb[i];\n                            remove(this._listeners[evt] || [], eventOrListener);\n                        }\n                    }\n                }\n                else if (arguments.length === 2) {\n                    remove(this._listeners[eventOrListener] || [], listener);\n                }\n                return this;\n            };\n            this.getListener = function (forEvent) {\n                return _this._listeners[forEvent];\n            };\n            this.setSuspendEvents = function (val) {\n                _this.eventsSuspended = val;\n            };\n            this.isSuspendEvents = function () {\n                return _this.eventsSuspended;\n            };\n            this.silently = function (fn) {\n                _this.setSuspendEvents(true);\n                try {\n                    fn();\n                }\n                catch (e) {\n                    log(\"Cannot execute silent function \" + e);\n                }\n                _this.setSuspendEvents(false);\n            };\n            this.cleanupListeners = function () {\n                for (var i in _this._listeners) {\n                    _this._listeners[i] = null;\n                }\n            };\n        }\n        return EventGenerator;\n    }());\n    jsPlumbUtil.EventGenerator = EventGenerator;\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains utility functions that run in browsers only.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n ;(function() {\n\n  \"use strict\";\n\n   var root = this;\n\n    root.jsPlumbUtil.matchesSelector = function(el, selector, ctx) {\n       ctx = ctx || el.parentNode;\n       var possibles = ctx.querySelectorAll(selector);\n       for (var i = 0; i < possibles.length; i++) {\n           if (possibles[i] === el) {\n               return true;\n           }\n       }\n       return false;\n   };\n\n    root.jsPlumbUtil.consume = function(e, doNotPreventDefault) {\n       if (e.stopPropagation) {\n           e.stopPropagation();\n       }\n       else {\n           e.returnValue = false;\n       }\n\n       if (!doNotPreventDefault && e.preventDefault){\n           e.preventDefault();\n       }\n   };\n\n   /*\n    * Function: sizeElement\n    * Helper to size and position an element. You would typically use\n    * this when writing your own Connector or Endpoint implementation.\n    *\n    * Parameters:\n    *  x - [int] x position for the element origin\n    *  y - [int] y position for the element origin\n    *  w - [int] width of the element\n    *  h - [int] height of the element\n    *\n    */\n    root.jsPlumbUtil.sizeElement = function(el, x, y, w, h) {\n       if (el) {\n           el.style.height = h + \"px\";\n           el.height = h;\n           el.style.width = w + \"px\";\n           el.width = w;\n           el.style.left = x + \"px\";\n           el.style.top = y + \"px\";\n       }\n   };\n\n }).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the code for working with scrollable lists.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function() {\n\n    var DEFAULT_OPTIONS = {\n        deriveAnchor:function(edge, index, ep, conn) {\n            return {\n                top:[\"TopRight\", \"TopLeft\"],\n                bottom:[\"BottomRight\", \"BottomLeft\"]\n            }[edge][index];\n        }\n    };\n\n    var root = this;\n\n    var ListManager = function(jsPlumbInstance, params) {\n\n        this.count = 0;\n        this.instance = jsPlumbInstance;\n        this.lists = {};\n        this.options = params || {};\n\n        this.instance.addList = function(el, options) {\n            return this.listManager.addList(el, options);\n        };\n\n        this.instance.removeList = function(el) {\n            this.listManager.removeList(el);\n        };\n\n        this.instance.bind(\"manageElement\", function(p) {\n\n            //look for [jtk-scrollable-list] elements and attach scroll listeners if necessary\n            var scrollableLists = this.instance.getSelector(p.el, \"[jtk-scrollable-list]\");\n            for (var i = 0; i < scrollableLists.length; i++) {\n                this.addList(scrollableLists[i]);\n            }\n\n        }.bind(this));\n\n        this.instance.bind(\"unmanageElement\", function(p) {\n            this.removeList(p.el);\n        });\n\n\n        this.instance.bind(\"connection\", function(c, evt) {\n            if (evt == null) {\n                // not added by mouse. look for an ancestor of the source and/or target element that is a scrollable list, and run\n                // its scroll method.\n                this._maybeUpdateParentList(c.source);\n                this._maybeUpdateParentList(c.target);\n            }\n        }.bind(this));\n    };\n\n    root.jsPlumbListManager = ListManager;\n\n    ListManager.prototype = {\n\n        addList : function(el, options) {\n            var dp = this.instance.extend({}, DEFAULT_OPTIONS);\n            this.instance.extend(dp, this.options);\n            options = this.instance.extend(dp,  options || {});\n            var id = [this.instance.getInstanceIndex(), this.count++].join(\"_\");\n            this.lists[id] = new List(this.instance, el, options, id);\n        },\n\n        removeList:function(el) {\n            var list = this.lists[el._jsPlumbList];\n            if (list) {\n                list.destroy();\n                delete this.lists[el._jsPlumbList];\n            }\n        },\n\n        _maybeUpdateParentList:function (el) {\n            var parent = el.parentNode, container = this.instance.getContainer();\n            while(parent != null && parent !== container) {\n                if (parent._jsPlumbList != null && this.lists[parent._jsPlumbList] != null) {\n                    parent._jsPlumbScrollHandler();\n                    return\n                }\n                parent = parent.parentNode;\n            }\n        }\n\n\n    };\n\n    var List = function(instance, el, options, id) {\n\n        el[\"_jsPlumbList\"] = id;\n\n        //\n        // Derive an anchor to use for the current situation. In contrast to the way we derive an endpoint, here we use `anchor` from the options, if present, as\n        // our first choice, and then `deriveAnchor` as our next choice. There is a default `deriveAnchor` implementation that uses TopRight/TopLeft for top and\n        // BottomRight/BottomLeft for bottom.\n        //\n        // edge - \"top\" or \"bottom\"\n        // index - 0 when endpoint is connection source, 1 when endpoint is connection target\n        // ep - the endpoint that is being proxied\n        // conn - the connection that is being proxied\n        //\n        function deriveAnchor(edge, index, ep, conn) {\n            return options.anchor ? options.anchor : options.deriveAnchor(edge, index, ep, conn);\n        }\n\n        //\n        // Derive an endpoint to use for the current situation. We'll use a `deriveEndpoint` function passed in to the options as our first choice,\n        // followed by `endpoint` (an endpoint spec) from the options, and failing either of those we just use the `type` of the endpoint that is being proxied.\n        //\n        // edge - \"top\" or \"bottom\"\n        // index - 0 when endpoint is connection source, 1 when endpoint is connection target\n        // endpoint - the endpoint that is being proxied\n        // connection - the connection that is being proxied\n        //\n        function deriveEndpoint(edge, index, ep, conn) {\n            return options.deriveEndpoint ? options.deriveEndpoint(edge, index, ep, conn) : options.endpoint ? options.endpoint : ep.type;\n        }\n\n        //\n        // look for a parent of the given scrollable list that is draggable, and then update the child offsets for it. this should not\n        // be necessary in the delegated drag stuff from the upcoming 3.0.0 release.\n        //\n        function _maybeUpdateDraggable(el) {\n            var parent = el.parentNode, container = instance.getContainer();\n            while(parent != null && parent !== container) {\n                if (instance.hasClass(parent, \"jtk-managed\")) {\n                    instance.recalculateOffsets(parent);\n                    return\n                }\n                parent = parent.parentNode;\n            }\n        }\n\n        var scrollHandler = function(e) {\n\n            var children = instance.getSelector(el, \".jtk-managed\");\n            var elId = instance.getId(el);\n\n            for (var i = 0; i < children.length; i++) {\n\n                if (children[i].offsetTop < el.scrollTop) {\n                    if (!children[i]._jsPlumbProxies) {\n                        children[i]._jsPlumbProxies = children[i]._jsPlumbProxies || [];\n                        instance.select({source: children[i]}).each(function (c) {\n\n\n                            instance.proxyConnection(c, 0, el, elId, function () {\n                                return deriveEndpoint(\"top\", 0, c.endpoints[0], c);\n                            }, function () {\n                                return deriveAnchor(\"top\", 0, c.endpoints[0], c);\n                            });\n                            children[i]._jsPlumbProxies.push([c, 0]);\n                        });\n\n                        instance.select({target: children[i]}).each(function (c) {\n                            instance.proxyConnection(c, 1, el, elId, function () {\n                                return deriveEndpoint(\"top\", 1, c.endpoints[1], c);\n                            }, function () {\n                                return deriveAnchor(\"top\", 1, c.endpoints[1], c);\n                            });\n                            children[i]._jsPlumbProxies.push([c, 1]);\n                        });\n                    }\n                }\n                //\n                else if (children[i].offsetTop + children[i].offsetHeight > el.scrollTop + el.offsetHeight) {\n                    if (!children[i]._jsPlumbProxies) {\n                        children[i]._jsPlumbProxies = children[i]._jsPlumbProxies || [];\n\n                        instance.select({source: children[i]}).each(function (c) {\n                            instance.proxyConnection(c, 0, el, elId, function () {\n                                return deriveEndpoint(\"bottom\", 0, c.endpoints[0], c);\n                            }, function () {\n                                return deriveAnchor(\"bottom\", 0, c.endpoints[0], c);\n                            });\n                            children[i]._jsPlumbProxies.push([c, 0]);\n                        });\n\n                        instance.select({target: children[i]}).each(function (c) {\n                            instance.proxyConnection(c, 1, el, elId, function () {\n                                return deriveEndpoint(\"bottom\", 1, c.endpoints[1], c);\n                            }, function () {\n                                return deriveAnchor(\"bottom\", 1, c.endpoints[1], c);\n                            });\n                            children[i]._jsPlumbProxies.push([c, 1]);\n                        });\n                    }\n                } else if (children[i]._jsPlumbProxies) {\n                    for (var j = 0; j < children[i]._jsPlumbProxies.length; j++) {\n                        instance.unproxyConnection(children[i]._jsPlumbProxies[j][0], children[i]._jsPlumbProxies[j][1], elId);\n                    }\n\n                    delete children[i]._jsPlumbProxies;\n                }\n\n                instance.revalidate(children[i]);\n            }\n\n            _maybeUpdateDraggable(el);\n        };\n\n        instance.setAttribute(el, \"jtk-scrollable-list\", \"true\");\n        el._jsPlumbScrollHandler = scrollHandler;\n        instance.on(el, \"scroll\", scrollHandler);\n        scrollHandler(); // run it once; there may be connections already.\n\n        this.destroy = function() {\n            instance.off(el, \"scroll\", scrollHandler);\n            delete el._jsPlumbScrollHandler;\n\n            var children = instance.getSelector(el, \".jtk-managed\");\n            var elId = instance.getId(el);\n\n            for (var i = 0; i < children.length; i++) {\n                if (children[i]._jsPlumbProxies) {\n                    for (var j = 0; j < children[i]._jsPlumbProxies.length; j++) {\n                        instance.unproxyConnection(children[i]._jsPlumbProxies[j][0], children[i]._jsPlumbProxies[j][1], elId);\n                    }\n\n                    delete children[i]._jsPlumbProxies;\n                }\n            }\n        };\n    };\n\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the core code.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function () {\n\n    \"use strict\";\n\n    var root = this;\n\n    var _ju = root.jsPlumbUtil,\n\n        /**\n         * creates a timestamp, using milliseconds since 1970, but as a string.\n         */\n        _timestamp = function () {\n            return \"\" + (new Date()).getTime();\n        },\n\n        // helper method to update the hover style whenever it, or paintStyle, changes.\n        // we use paintStyle as the foundation and merge hoverPaintStyle over the\n        // top.\n        _updateHoverStyle = function (component) {\n            if (component._jsPlumb.paintStyle && component._jsPlumb.hoverPaintStyle) {\n                var mergedHoverStyle = {};\n                jsPlumb.extend(mergedHoverStyle, component._jsPlumb.paintStyle);\n                jsPlumb.extend(mergedHoverStyle, component._jsPlumb.hoverPaintStyle);\n                delete component._jsPlumb.hoverPaintStyle;\n                // we want the fill of paintStyle to override a gradient, if possible.\n                if (mergedHoverStyle.gradient && component._jsPlumb.paintStyle.fill) {\n                    delete mergedHoverStyle.gradient;\n                }\n                component._jsPlumb.hoverPaintStyle = mergedHoverStyle;\n            }\n        },\n        events = [\"tap\", \"dbltap\", \"click\", \"dblclick\", \"mouseover\", \"mouseout\", \"mousemove\", \"mousedown\", \"mouseup\", \"contextmenu\" ],\n        eventFilters = { \"mouseout\": \"mouseleave\", \"mouseexit\": \"mouseleave\" },\n        _updateAttachedElements = function (component, state, timestamp, sourceElement) {\n            var affectedElements = component.getAttachedElements();\n            if (affectedElements) {\n                for (var i = 0, j = affectedElements.length; i < j; i++) {\n                    if (!sourceElement || sourceElement !== affectedElements[i]) {\n                        affectedElements[i].setHover(state, true, timestamp);\t\t\t// tell the attached elements not to inform their own attached elements.\n                    }\n                }\n            }\n        },\n        _splitType = function (t) {\n            return t == null ? null : t.split(\" \");\n        },\n        _mapType = function(map, obj, typeId) {\n            for (var i in obj) {\n                map[i] = typeId;\n            }\n        },\n        _each = function(fn, obj) {\n            obj = _ju.isArray(obj) || (obj.length != null && !_ju.isString(obj)) ? obj : [ obj ];\n            for (var i = 0; i < obj.length; i++) {\n                try {\n                    fn.apply(obj[i], [ obj[i] ]);\n                }\n                catch (e) {\n                    _ju.log(\".each iteration failed : \" + e);\n                }\n            }\n        },\n        _applyTypes = function (component, params, doNotRepaint) {\n            if (component.getDefaultType) {\n                var td = component.getTypeDescriptor(), map = {};\n                var defType = component.getDefaultType();\n                var o = _ju.merge({}, defType);\n                _mapType(map, defType, \"__default\");\n                for (var i = 0, j = component._jsPlumb.types.length; i < j; i++) {\n                    var tid = component._jsPlumb.types[i];\n                    if (tid !== \"__default\") {\n                        var _t = component._jsPlumb.instance.getType(tid, td);\n                        if (_t != null) {\n\n                            var overrides = [\"anchor\", \"anchors\", \"connector\", \"paintStyle\", \"hoverPaintStyle\", \"endpoint\", \"endpoints\", \"connectorOverlays\", \"connectorStyle\", \"connectorHoverStyle\", \"endpointStyle\", \"endpointHoverStyle\"];\n                            var collations = [ ];\n\n                            if (_t.mergeStrategy === \"override\") {\n                                Array.prototype.push.apply(overrides, [\"events\", \"overlays\", \"cssClass\"]);\n                            } else {\n                                collations.push(\"cssClass\");\n                            }\n\n                            o = _ju.merge(o, _t, collations, overrides);\n                            _mapType(map, _t, tid);\n                        }\n                    }\n                }\n\n                if (params) {\n                    o = _ju.populate(o, params, \"_\");\n                }\n\n                component.applyType(o, doNotRepaint, map);\n                if (!doNotRepaint) {\n                    component.repaint();\n                }\n            }\n        },\n\n// ------------------------------ BEGIN jsPlumbUIComponent --------------------------------------------\n\n        jsPlumbUIComponent = root.jsPlumbUIComponent = function (params) {\n\n            _ju.EventGenerator.apply(this, arguments);\n\n            var self = this,\n                a = arguments,\n                idPrefix = self.idPrefix,\n                id = idPrefix + (new Date()).getTime();\n\n            this._jsPlumb = {\n                instance: params._jsPlumb,\n                parameters: params.parameters || {},\n                paintStyle: null,\n                hoverPaintStyle: null,\n                paintStyleInUse: null,\n                hover: false,\n                beforeDetach: params.beforeDetach,\n                beforeDrop: params.beforeDrop,\n                overlayPlacements: [],\n                hoverClass: params.hoverClass || params._jsPlumb.Defaults.HoverClass,\n                types: [],\n                typeCache:{}\n            };\n\n            this.cacheTypeItem = function(key, item, typeId) {\n                this._jsPlumb.typeCache[typeId] = this._jsPlumb.typeCache[typeId] || {};\n                this._jsPlumb.typeCache[typeId][key] = item;\n            };\n            this.getCachedTypeItem = function(key, typeId) {\n                return this._jsPlumb.typeCache[typeId] ? this._jsPlumb.typeCache[typeId][key] : null;\n            };\n\n            this.getId = function () {\n                return id;\n            };\n\n// ----------------------------- default type --------------------------------------------\n\n\n            var o = params.overlays || [], oo = {};\n            if (this.defaultOverlayKeys) {\n                for (var i = 0; i < this.defaultOverlayKeys.length; i++) {\n                    Array.prototype.push.apply(o, this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[i]] || []);\n                }\n\n                for (i = 0; i < o.length; i++) {\n                    // if a string, convert to object representation so that we can store the typeid on it.\n                    // also assign an id.\n                    var fo = jsPlumb.convertToFullOverlaySpec(o[i]);\n                    oo[fo[1].id] = fo;\n                }\n            }\n\n            var _defaultType = {\n                overlays:oo,\n                parameters: params.parameters || {},\n                scope: params.scope || this._jsPlumb.instance.getDefaultScope()\n            };\n            this.getDefaultType = function() {\n                return _defaultType;\n            };\n            this.appendToDefaultType = function(obj) {\n                for (var i in obj) {\n                    _defaultType[i] = obj[i];\n                }\n            };\n\n// ----------------------------- end default type --------------------------------------------\n\n            // all components can generate events\n\n            if (params.events) {\n                for (var evtName in params.events) {\n                    self.bind(evtName, params.events[evtName]);\n                }\n            }\n\n            // all components get this clone function.\n            // TODO issue 116 showed a problem with this - it seems 'a' that is in\n            // the clone function's scope is shared by all invocations of it, the classic\n            // JS closure problem.  for now, jsPlumb does a version of this inline where\n            // it used to call clone.  but it would be nice to find some time to look\n            // further at this.\n            this.clone = function () {\n                var o = Object.create(this.constructor.prototype);\n                this.constructor.apply(o, a);\n                return o;\n            }.bind(this);\n\n            // user can supply a beforeDetach callback, which will be executed before a detach\n            // is performed; returning false prevents the detach.\n            this.isDetachAllowed = function (connection) {\n                var r = true;\n                if (this._jsPlumb.beforeDetach) {\n                    try {\n                        r = this._jsPlumb.beforeDetach(connection);\n                    }\n                    catch (e) {\n                        _ju.log(\"jsPlumb: beforeDetach callback failed\", e);\n                    }\n                }\n                return r;\n            };\n\n            // user can supply a beforeDrop callback, which will be executed before a dropped\n            // connection is confirmed. user can return false to reject connection.\n            this.isDropAllowed = function (sourceId, targetId, scope, connection, dropEndpoint, source, target) {\n                var r = this._jsPlumb.instance.checkCondition(\"beforeDrop\", {\n                    sourceId: sourceId,\n                    targetId: targetId,\n                    scope: scope,\n                    connection: connection,\n                    dropEndpoint: dropEndpoint,\n                    source: source, target: target\n                });\n                if (this._jsPlumb.beforeDrop) {\n                    try {\n                        r = this._jsPlumb.beforeDrop({\n                            sourceId: sourceId,\n                            targetId: targetId,\n                            scope: scope,\n                            connection: connection,\n                            dropEndpoint: dropEndpoint,\n                            source: source, target: target\n                        });\n                    }\n                    catch (e) {\n                        _ju.log(\"jsPlumb: beforeDrop callback failed\", e);\n                    }\n                }\n                return r;\n            };\n\n            var domListeners = [];\n\n            // sets the component associated with listener events. for instance, an overlay delegates\n            // its events back to a connector. but if the connector is swapped on the underlying connection,\n            // then this component must be changed. This is called by setConnector in the Connection class.\n            this.setListenerComponent = function (c) {\n                for (var i = 0; i < domListeners.length; i++) {\n                    domListeners[i][3] = c;\n                }\n            };\n\n\n        };\n\n    var _removeTypeCssHelper = function (component, typeIndex) {\n        var typeId = component._jsPlumb.types[typeIndex],\n            type = component._jsPlumb.instance.getType(typeId, component.getTypeDescriptor());\n\n        if (type != null && type.cssClass && component.canvas) {\n            component._jsPlumb.instance.removeClass(component.canvas, type.cssClass);\n        }\n    };\n\n    _ju.extend(root.jsPlumbUIComponent, _ju.EventGenerator, {\n\n        getParameter: function (name) {\n            return this._jsPlumb.parameters[name];\n        },\n\n        setParameter: function (name, value) {\n            this._jsPlumb.parameters[name] = value;\n        },\n\n        getParameters: function () {\n            return this._jsPlumb.parameters;\n        },\n\n        setParameters: function (p) {\n            this._jsPlumb.parameters = p;\n        },\n\n        getClass:function() {\n            return jsPlumb.getClass(this.canvas);\n        },\n\n        hasClass:function(clazz) {\n            return jsPlumb.hasClass(this.canvas, clazz);\n        },\n\n        addClass: function (clazz) {\n            jsPlumb.addClass(this.canvas, clazz);\n        },\n\n        removeClass: function (clazz) {\n            jsPlumb.removeClass(this.canvas, clazz);\n        },\n\n        updateClasses: function (classesToAdd, classesToRemove) {\n            jsPlumb.updateClasses(this.canvas, classesToAdd, classesToRemove);\n        },\n\n        setType: function (typeId, params, doNotRepaint) {\n            this.clearTypes();\n            this._jsPlumb.types = _splitType(typeId) || [];\n            _applyTypes(this, params, doNotRepaint);\n        },\n\n        getType: function () {\n            return this._jsPlumb.types;\n        },\n\n        reapplyTypes: function (params, doNotRepaint) {\n            _applyTypes(this, params, doNotRepaint);\n        },\n\n        hasType: function (typeId) {\n            return this._jsPlumb.types.indexOf(typeId) !== -1;\n        },\n\n        addType: function (typeId, params, doNotRepaint) {\n            var t = _splitType(typeId), _cont = false;\n            if (t != null) {\n                for (var i = 0, j = t.length; i < j; i++) {\n                    if (!this.hasType(t[i])) {\n                        this._jsPlumb.types.push(t[i]);\n                        _cont = true;\n                    }\n                }\n                if (_cont) {\n                    _applyTypes(this, params, doNotRepaint);\n                }\n            }\n        },\n\n        removeType: function (typeId, params, doNotRepaint) {\n            var t = _splitType(typeId), _cont = false, _one = function (tt) {\n                var idx = this._jsPlumb.types.indexOf(tt);\n                if (idx !== -1) {\n                    // remove css class if necessary\n                    _removeTypeCssHelper(this, idx);\n                    this._jsPlumb.types.splice(idx, 1);\n                    return true;\n                }\n                return false;\n            }.bind(this);\n\n            if (t != null) {\n                for (var i = 0, j = t.length; i < j; i++) {\n                    _cont = _one(t[i]) || _cont;\n                }\n                if (_cont) {\n                    _applyTypes(this, params, doNotRepaint);\n                }\n            }\n        },\n        clearTypes: function (params, doNotRepaint) {\n            var i = this._jsPlumb.types.length;\n            for (var j = 0; j < i; j++) {\n                _removeTypeCssHelper(this, 0);\n                this._jsPlumb.types.splice(0, 1);\n            }\n            _applyTypes(this, params, doNotRepaint);\n        },\n\n        toggleType: function (typeId, params, doNotRepaint) {\n            var t = _splitType(typeId);\n            if (t != null) {\n                for (var i = 0, j = t.length; i < j; i++) {\n                    var idx = this._jsPlumb.types.indexOf(t[i]);\n                    if (idx !== -1) {\n                        _removeTypeCssHelper(this, idx);\n                        this._jsPlumb.types.splice(idx, 1);\n                    }\n                    else {\n                        this._jsPlumb.types.push(t[i]);\n                    }\n                }\n\n                _applyTypes(this, params, doNotRepaint);\n            }\n        },\n        applyType: function (t, doNotRepaint) {\n            this.setPaintStyle(t.paintStyle, doNotRepaint);\n            this.setHoverPaintStyle(t.hoverPaintStyle, doNotRepaint);\n            if (t.parameters) {\n                for (var i in t.parameters) {\n                    this.setParameter(i, t.parameters[i]);\n                }\n            }\n            this._jsPlumb.paintStyleInUse = this.getPaintStyle();\n        },\n        setPaintStyle: function (style, doNotRepaint) {\n            // this._jsPlumb.paintStyle = jsPlumb.extend({}, style);\n            // TODO figure out if we want components to clone paintStyle so as not to share it.\n            this._jsPlumb.paintStyle = style;\n            this._jsPlumb.paintStyleInUse = this._jsPlumb.paintStyle;\n            _updateHoverStyle(this);\n            if (!doNotRepaint) {\n                this.repaint();\n            }\n        },\n        getPaintStyle: function () {\n            return this._jsPlumb.paintStyle;\n        },\n        setHoverPaintStyle: function (style, doNotRepaint) {\n            //this._jsPlumb.hoverPaintStyle = jsPlumb.extend({}, style);\n            // TODO figure out if we want components to clone paintStyle so as not to share it.\n            this._jsPlumb.hoverPaintStyle = style;\n            _updateHoverStyle(this);\n            if (!doNotRepaint) {\n                this.repaint();\n            }\n        },\n        getHoverPaintStyle: function () {\n            return this._jsPlumb.hoverPaintStyle;\n        },\n        destroy: function (force) {\n            if (force || this.typeId == null) {\n                this.cleanupListeners(); // this is on EventGenerator\n                this.clone = null;\n                this._jsPlumb = null;\n            }\n        },\n\n        isHover: function () {\n            return this._jsPlumb.hover;\n        },\n\n        setHover: function (hover, ignoreAttachedElements, timestamp) {\n            // while dragging, we ignore these events.  this keeps the UI from flashing and\n            // swishing and whatevering.\n            if (this._jsPlumb && !this._jsPlumb.instance.currentlyDragging && !this._jsPlumb.instance.isHoverSuspended()) {\n\n                this._jsPlumb.hover = hover;\n                var method = hover ? \"addClass\" : \"removeClass\";\n\n                if (this.canvas != null) {\n                    if (this._jsPlumb.instance.hoverClass != null) {\n                        this._jsPlumb.instance[method](this.canvas, this._jsPlumb.instance.hoverClass);\n                    }\n                    if (this._jsPlumb.hoverClass != null) {\n                        this._jsPlumb.instance[method](this.canvas, this._jsPlumb.hoverClass);\n                    }\n                }\n                if (this._jsPlumb.hoverPaintStyle != null) {\n                    this._jsPlumb.paintStyleInUse = hover ? this._jsPlumb.hoverPaintStyle : this._jsPlumb.paintStyle;\n                    if (!this._jsPlumb.instance.isSuspendDrawing()) {\n                        timestamp = timestamp || _timestamp();\n                        this.repaint({timestamp: timestamp, recalc: false});\n                    }\n                }\n                // get the list of other affected elements, if supported by this component.\n                // for a connection, its the endpoints.  for an endpoint, its the connections! surprise.\n                if (this.getAttachedElements && !ignoreAttachedElements) {\n                    _updateAttachedElements(this, hover, _timestamp(), this);\n                }\n            }\n        }\n    });\n\n// ------------------------------ END jsPlumbUIComponent --------------------------------------------\n\n    var _jsPlumbInstanceIndex = 0,\n        getInstanceIndex = function () {\n            var i = _jsPlumbInstanceIndex + 1;\n            _jsPlumbInstanceIndex++;\n            return i;\n        };\n\n    var jsPlumbInstance = root.jsPlumbInstance = function (_defaults) {\n\n        this.version = \"2.14.2\";\n\n        this.Defaults = {\n            Anchor: \"Bottom\",\n            Anchors: [ null, null ],\n            ConnectionsDetachable: true,\n            ConnectionOverlays: [ ],\n            Connector: \"Bezier\",\n            Container: null,\n            DoNotThrowErrors: false,\n            DragOptions: { },\n            DropOptions: { },\n            Endpoint: \"Dot\",\n            EndpointOverlays: [ ],\n            Endpoints: [ null, null ],\n            EndpointStyle: { fill: \"#456\" },\n            EndpointStyles: [ null, null ],\n            EndpointHoverStyle: null,\n            EndpointHoverStyles: [ null, null ],\n            HoverPaintStyle: null,\n            LabelStyle: { color: \"black\" },\n            ListStyle: { },\n            LogEnabled: false,\n            Overlays: [ ],\n            MaxConnections: 1,\n            PaintStyle: { \"stroke-width\": 4, stroke: \"#456\" },\n            ReattachConnections: false,\n            RenderMode: \"svg\",\n            Scope: \"jsPlumb_DefaultScope\"\n        };\n\n        if (_defaults) {\n            jsPlumb.extend(this.Defaults, _defaults);\n        }\n\n        this.logEnabled = this.Defaults.LogEnabled;\n        this._connectionTypes = {};\n        this._endpointTypes = {};\n\n        _ju.EventGenerator.apply(this);\n\n        var _currentInstance = this,\n            _instanceIndex = getInstanceIndex(),\n            _bb = _currentInstance.bind,\n            _initialDefaults = {},\n            _zoom = 1,\n            _info = function (el) {\n                if (el == null) {\n                    return null;\n                }\n                else if (el.nodeType === 3 || el.nodeType === 8) {\n                    return { el:el, text:true };\n                }\n                else {\n                    var _el = _currentInstance.getElement(el);\n                    return { el: _el, id: (_ju.isString(el) && _el == null) ? el : _getId(_el) };\n                }\n            };\n\n        this.getInstanceIndex = function () {\n            return _instanceIndex;\n        };\n\n        // CONVERTED\n        this.setZoom = function (z, repaintEverything) {\n            _zoom = z;\n            _currentInstance.fire(\"zoom\", _zoom);\n            if (repaintEverything) {\n                _currentInstance.repaintEverything();\n            }\n            return true;\n        };\n        // CONVERTED\n        this.getZoom = function () {\n            return _zoom;\n        };\n\n        for (var i in this.Defaults) {\n            _initialDefaults[i] = this.Defaults[i];\n        }\n\n        var _container, _containerDelegations = [];\n        this.unbindContainer = function() {\n            if (_container != null && _containerDelegations.length > 0) {\n                for (var i = 0; i < _containerDelegations.length; i++) {\n                    _currentInstance.off(_container, _containerDelegations[i][0], _containerDelegations[i][1]);\n                }\n            }\n        };\n        this.setContainer = function (c) {\n\n            this.unbindContainer();\n\n            // get container as dom element.\n            c = this.getElement(c);\n            // move existing connections and endpoints, if any.\n            this.select().each(function (conn) {\n                conn.moveParent(c);\n            });\n            this.selectEndpoints().each(function (ep) {\n                ep.moveParent(c);\n            });\n\n            // set container.\n            var previousContainer = _container;\n            _container = c;\n            _containerDelegations.length = 0;\n            var eventAliases = {\n                \"endpointclick\":\"endpointClick\",\n                \"endpointdblclick\":\"endpointDblClick\"\n            };\n\n            var _oneDelegateHandler = function (id, e, componentType) {\n                var t = e.srcElement || e.target,\n                    jp = (t && t.parentNode ? t.parentNode._jsPlumb : null) || (t ? t._jsPlumb : null) || (t && t.parentNode && t.parentNode.parentNode ? t.parentNode.parentNode._jsPlumb : null);\n                if (jp) {\n                    jp.fire(id, jp, e);\n                    var alias = componentType ? eventAliases[componentType + id] || id : id;\n                    // jsplumb also fires every event coming from components/overlays. That's what the test for `jp.component` is for.\n                    _currentInstance.fire(alias, jp.component || jp, e);\n                }\n            };\n\n            var _addOneDelegate = function(eventId, selector, fn) {\n                _containerDelegations.push([eventId, fn]);\n                _currentInstance.on(_container, eventId, selector, fn);\n            };\n\n            // delegate one event on the container to jsplumb elements. it might be possible to\n            // abstract this out: each of endpoint, connection and overlay could register themselves with\n            // jsplumb as \"component types\" or whatever, and provide a suitable selector. this would be\n            // done by the renderer (although admittedly from 2.0 onwards we're not supporting vml anymore)\n            var _oneDelegate = function (id) {\n                // connections.\n                _addOneDelegate(id, \".jtk-connector\", function (e) {\n                    _oneDelegateHandler(id, e);\n                });\n                // endpoints. note they can have an enclosing div, or not.\n                _addOneDelegate(id, \".jtk-endpoint\", function (e) {\n                    _oneDelegateHandler(id, e, \"endpoint\");\n                });\n                // overlays\n                _addOneDelegate(id, \".jtk-overlay\", function (e) {\n                    _oneDelegateHandler(id, e);\n                });\n            };\n\n            for (var i = 0; i < events.length; i++) {\n                _oneDelegate(events[i]);\n            }\n\n            // managed elements\n            for (var elId in managedElements) {\n                var el = managedElements[elId].el;\n                if (el.parentNode === previousContainer) {\n                    previousContainer.removeChild(el);\n                    _container.appendChild(el);\n                }\n            }\n\n        };\n        this.getContainer = function () {\n            return _container;\n        };\n\n        this.bind = function (event, fn) {\n            if (\"ready\" === event && initialized) {\n                fn();\n            }\n            else {\n                _bb.apply(_currentInstance, [event, fn]);\n            }\n        };\n\n        _currentInstance.importDefaults = function (d) {\n            for (var i in d) {\n                _currentInstance.Defaults[i] = d[i];\n            }\n            if (d.Container) {\n                _currentInstance.setContainer(d.Container);\n            }\n\n            return _currentInstance;\n        };\n\n        _currentInstance.restoreDefaults = function () {\n            _currentInstance.Defaults = jsPlumb.extend({}, _initialDefaults);\n            return _currentInstance;\n        };\n\n        var log = null,\n            initialized = false,\n            // TODO remove from window scope\n            connections = [],\n            // map of element id -> endpoint lists. an element can have an arbitrary\n            // number of endpoints on it, and not all of them have to be connected\n            // to anything.\n            endpointsByElement = {},\n            endpointsByUUID = {},\n            managedElements = {},\n            offsets = {},\n            offsetTimestamps = {},\n            draggableStates = {},\n            connectionBeingDragged = false,\n            sizes = [],\n            _suspendDrawing = false,\n            _suspendedAt = null,\n            DEFAULT_SCOPE = this.Defaults.Scope,\n            _curIdStamp = 1,\n            _idstamp = function () {\n                return \"\" + _curIdStamp++;\n            },\n\n            //\n            // appends an element to some other element, which is calculated as follows:\n            //\n            // 1. if Container exists, use that element.\n            // 2. if the 'parent' parameter exists, use that.\n            // 3. otherwise just use the root element.\n            //\n            //\n            _appendElement = function (el, parent) {\n                if (_container) {\n                    _container.appendChild(el);\n                }\n                else if (!parent) {\n                    this.appendToRoot(el);\n                }\n                else {\n                    this.getElement(parent).appendChild(el);\n                }\n            }.bind(this),\n\n            //\n            // Draws an endpoint and its connections. this is the main entry point into drawing connections as well\n            // as endpoints, since jsPlumb is endpoint-centric under the hood.\n            //\n            // @param element element to draw (of type library specific element object)\n            // @param ui UI object from current library's event system. optional.\n            // @param timestamp timestamp for this paint cycle. used to speed things up a little by cutting down the amount of offset calculations we do.\n            // @param clearEdits defaults to false; indicates that mouse edits for connectors should be cleared\n            ///\n            _draw = function (element, ui, timestamp, clearEdits) {\n\n                if (!_suspendDrawing) {\n\n                    element = _currentInstance.getElement(element);\n\n                    if (element != null) {\n\n                        var id = _getId(element),\n                            repaintEls = element.querySelectorAll(\".jtk-managed\");\n\n                        if (timestamp == null) {\n                            timestamp = _timestamp();\n                        }\n\n                        // update the offset of everything _before_ we try to draw anything.\n                        var o = _updateOffset({elId: id, offset: ui, recalc: false, timestamp: timestamp});\n\n                        for (var i = 0; i < repaintEls.length; i++) {\n                            _updateOffset({\n                                elId: repaintEls[i].getAttribute(\"id\"),\n                                // offset: {\n                                //     left: o.o.left + repaintEls[i].offset.left,\n                                //     top: o.o.top + repaintEls[i].offset.top\n                                // },\n                                recalc: true,\n                                timestamp: timestamp\n                            });\n                        }\n\n                        _currentInstance.anchorManager.redraw(id, ui, timestamp, null, clearEdits);\n\n                        if (repaintEls) {\n                            for (var j = 0; j < repaintEls.length; j++) {\n                                _currentInstance.anchorManager.redraw(repaintEls[j].getAttribute(\"id\"), null, timestamp, null, clearEdits, true);\n                            }\n                        }\n                    }\n                }\n            },\n\n            //\n            // gets an Endpoint by uuid.\n            //\n            _getEndpoint = function (uuid) {\n                return endpointsByUUID[uuid];\n            },\n\n            /**\n             * inits a draggable if it's not already initialised.\n             * TODO: somehow abstract this to the adapter, because the concept of \"draggable\" has no\n             * place on the server.\n             */\n\n\n            _scopeMatch = function (e1, e2) {\n                var s1 = e1.scope.split(/\\s/), s2 = e2.scope.split(/\\s/);\n                for (var i = 0; i < s1.length; i++) {\n                    for (var j = 0; j < s2.length; j++) {\n                        if (s2[j] === s1[i]) {\n                            return true;\n                        }\n                    }\n                }\n\n                return false;\n            },\n\n            _mergeOverrides = function (def, values) {\n                var m = jsPlumb.extend({}, def);\n                for (var i in values) {\n                    if (values[i]) {\n                        m[i] = values[i];\n                    }\n                }\n                return m;\n            },\n\n            /*\n             * prepares a final params object that can be passed to _newConnection, taking into account defaults, events, etc.\n             */\n            _prepareConnectionParams = function (params, referenceParams) {\n                var _p = jsPlumb.extend({ }, params);\n                if (referenceParams) {\n                    jsPlumb.extend(_p, referenceParams);\n                }\n\n                // hotwire endpoints passed as source or target to sourceEndpoint/targetEndpoint, respectively.\n                if (_p.source) {\n                    if (_p.source.endpoint) {\n                        _p.sourceEndpoint = _p.source;\n                    }\n                    else {\n                        _p.source = _currentInstance.getElement(_p.source);\n                    }\n                }\n                if (_p.target) {\n                    if (_p.target.endpoint) {\n                        _p.targetEndpoint = _p.target;\n                    }\n                    else {\n                        _p.target = _currentInstance.getElement(_p.target);\n                    }\n                }\n\n                // test for endpoint uuids to connect\n                if (params.uuids) {\n                    _p.sourceEndpoint = _getEndpoint(params.uuids[0]);\n                    _p.targetEndpoint = _getEndpoint(params.uuids[1]);\n                }\n\n                // now ensure that if we do have Endpoints already, they're not full.\n                // source:\n                if (_p.sourceEndpoint && _p.sourceEndpoint.isFull()) {\n                    _ju.log(_currentInstance, \"could not add connection; source endpoint is full\");\n                    return;\n                }\n\n                // target:\n                if (_p.targetEndpoint && _p.targetEndpoint.isFull()) {\n                    _ju.log(_currentInstance, \"could not add connection; target endpoint is full\");\n                    return;\n                }\n\n                // if source endpoint mandates connection type and nothing specified in our params, use it.\n                if (!_p.type && _p.sourceEndpoint) {\n                    _p.type = _p.sourceEndpoint.connectionType;\n                }\n\n                // copy in any connectorOverlays that were specified on the source endpoint.\n                // it doesnt copy target endpoint overlays.  i'm not sure if we want it to or not.\n                if (_p.sourceEndpoint && _p.sourceEndpoint.connectorOverlays) {\n                    _p.overlays = _p.overlays || [];\n                    for (var i = 0, j = _p.sourceEndpoint.connectorOverlays.length; i < j; i++) {\n                        _p.overlays.push(_p.sourceEndpoint.connectorOverlays[i]);\n                    }\n                }\n\n                // scope\n                if (_p.sourceEndpoint && _p.sourceEndpoint.scope) {\n                    _p.scope = _p.sourceEndpoint.scope;\n                }\n\n                // pointer events\n                if (!_p[\"pointer-events\"] && _p.sourceEndpoint && _p.sourceEndpoint.connectorPointerEvents) {\n                    _p[\"pointer-events\"] = _p.sourceEndpoint.connectorPointerEvents;\n                }\n\n\n                var _addEndpoint = function (el, def, idx) {\n                    var params = _mergeOverrides(def, {\n                        anchor: _p.anchors ? _p.anchors[idx] : _p.anchor,\n                        endpoint: _p.endpoints ? _p.endpoints[idx] : _p.endpoint,\n                        paintStyle: _p.endpointStyles ? _p.endpointStyles[idx] : _p.endpointStyle,\n                        hoverPaintStyle: _p.endpointHoverStyles ? _p.endpointHoverStyles[idx] : _p.endpointHoverStyle\n                    });\n                    return _currentInstance.addEndpoint(el, params);\n                };\n\n                // check for makeSource/makeTarget specs.\n\n                var _oneElementDef = function (type, idx, defs, matchType) {\n                    if (_p[type] && !_p[type].endpoint && !_p[type + \"Endpoint\"] && !_p.newConnection) {\n                        var tid = _getId(_p[type]), tep = defs[tid];\n\n                        tep = tep ? tep[matchType] : null;\n\n                        if (tep) {\n                            // if not enabled, return.\n                            if (!tep.enabled) {\n                                return false;\n                            }\n\n                            var epDef = jsPlumb.extend({}, tep.def);\n                            delete epDef.label;\n\n                            var newEndpoint = tep.endpoint != null && tep.endpoint._jsPlumb ? tep.endpoint : _addEndpoint(_p[type], epDef, idx);\n                            if (newEndpoint.isFull()) {\n                                return false;\n                            }\n                            _p[type + \"Endpoint\"] = newEndpoint;\n                            if (!_p.scope && epDef.scope) {\n                                _p.scope = epDef.scope;\n                            } // provide scope if not already provided and endpoint def has one.\n                            if (tep.uniqueEndpoint) {\n                                if (!tep.endpoint) {\n                                    tep.endpoint = newEndpoint;\n                                    newEndpoint.setDeleteOnEmpty(false);\n                                }\n                                else {\n                                    newEndpoint.finalEndpoint = tep.endpoint;\n                                }\n                            } else {\n                                newEndpoint.setDeleteOnEmpty(true);\n                            }\n\n                            //\n                            // copy in connector overlays if present on the source definition.\n                            //\n                            if (idx === 0 && tep.def.connectorOverlays) {\n                                _p.overlays = _p.overlays || [];\n                                Array.prototype.push.apply(_p.overlays, tep.def.connectorOverlays);\n                            }\n                        }\n                    }\n                };\n\n                if (_oneElementDef(\"source\", 0, this.sourceEndpointDefinitions, _p.type || \"default\") === false) {\n                    return;\n                }\n                if (_oneElementDef(\"target\", 1, this.targetEndpointDefinitions, _p.type || \"default\") === false) {\n                    return;\n                }\n\n                // last, ensure scopes match\n                if (_p.sourceEndpoint && _p.targetEndpoint) {\n                    if (!_scopeMatch(_p.sourceEndpoint, _p.targetEndpoint)) {\n                        _p = null;\n                    }\n                }\n\n                return _p;\n            }.bind(_currentInstance),\n\n            _newConnection = function (params) {\n                var connectionFunc = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType();\n\n                params._jsPlumb = _currentInstance;\n                params.newConnection = _newConnection;\n                params.newEndpoint = _newEndpoint;\n                params.endpointsByUUID = endpointsByUUID;\n                params.endpointsByElement = endpointsByElement;\n                params.finaliseConnection = _finaliseConnection;\n                params.id = \"con_\" + _idstamp();\n                var con = new connectionFunc(params);\n\n                // if the connection is draggable, then maybe we need to tell the target endpoint to init the\n                // dragging code. it won't run again if it already configured to be draggable.\n                if (con.isDetachable()) {\n                    con.endpoints[0].initDraggable(\"_jsPlumbSource\");\n                    con.endpoints[1].initDraggable(\"_jsPlumbTarget\");\n                }\n\n                return con;\n            },\n\n            //\n            // adds the connection to the backing model, fires an event if necessary and then redraws\n            //\n            _finaliseConnection = _currentInstance.finaliseConnection = function (jpc, params, originalEvent, doInformAnchorManager) {\n                params = params || {};\n                // add to list of connections (by scope).\n                if (!jpc.suspendedEndpoint) {\n                    connections.push(jpc);\n                }\n\n                jpc.pending = null;\n\n                // turn off isTemporarySource on the source endpoint (only viable on first draw)\n                jpc.endpoints[0].isTemporarySource = false;\n\n                // always inform the anchor manager\n                // except that if jpc has a suspended endpoint it's not true to say the\n                // connection is new; it has just (possibly) moved. the question is whether\n                // to make that call here or in the anchor manager.  i think perhaps here.\n                if (doInformAnchorManager !== false) {\n                    _currentInstance.router.newConnection(jpc);\n                }\n\n                // force a paint\n                _draw(jpc.source);\n\n                // fire an event\n                if (!params.doNotFireConnectionEvent && params.fireEvent !== false) {\n\n                    var eventArgs = {\n                        connection: jpc,\n                        source: jpc.source, target: jpc.target,\n                        sourceId: jpc.sourceId, targetId: jpc.targetId,\n                        sourceEndpoint: jpc.endpoints[0], targetEndpoint: jpc.endpoints[1]\n                    };\n\n                    _currentInstance.fire(\"connection\", eventArgs, originalEvent);\n                }\n            },\n\n            /*\n             factory method to prepare a new endpoint.  this should always be used instead of creating Endpoints\n             manually, since this method attaches event listeners and an id.\n             */\n            _newEndpoint = function (params, id) {\n                var endpointFunc = _currentInstance.Defaults.EndpointType || jsPlumb.Endpoint;\n                var _p = jsPlumb.extend({}, params);\n                //delete _p.label; // not supported by endpoint.\n                _p._jsPlumb = _currentInstance;\n                _p.newConnection = _newConnection;\n                _p.newEndpoint = _newEndpoint;\n                _p.endpointsByUUID = endpointsByUUID;\n                _p.endpointsByElement = endpointsByElement;\n                _p.fireDetachEvent = fireDetachEvent;\n                _p.elementId = id || _getId(_p.source);\n                var ep = new endpointFunc(_p);\n                ep.id = \"ep_\" + _idstamp();\n                _manage(_p.elementId, _p.source);\n\n                if (!jsPlumb.headless) {\n                    _currentInstance.getDragManager().endpointAdded(_p.source, id);\n                }\n\n                return ep;\n            },\n\n            /*\n             * performs the given function operation on all the connections found\n             * for the given element id; this means we find all the endpoints for\n             * the given element, and then for each endpoint find the connectors\n             * connected to it. then we pass each connection in to the given\n             * function.\n             */\n            _operation = function (elId, func, endpointFunc) {\n                var endpoints = endpointsByElement[elId];\n                if (endpoints && endpoints.length) {\n                    for (var i = 0, ii = endpoints.length; i < ii; i++) {\n                        for (var j = 0, jj = endpoints[i].connections.length; j < jj; j++) {\n                            var retVal = func(endpoints[i].connections[j]);\n                            // if the function passed in returns true, we exit.\n                            // most functions return false.\n                            if (retVal) {\n                                return;\n                            }\n                        }\n                        if (endpointFunc) {\n                            endpointFunc(endpoints[i]);\n                        }\n                    }\n                }\n            },\n\n            _setDraggable = function (element, draggable) {\n                return jsPlumb.each(element, function (el) {\n                    if (_currentInstance.isDragSupported(el)) {\n                        draggableStates[_currentInstance.getAttribute(el, \"id\")] = draggable;\n                        _currentInstance.setElementDraggable(el, draggable);\n                    }\n                });\n            },\n            /*\n             * private method to do the business of hiding/showing.\n             *\n             * @param el\n             *            either Id of the element in question or a library specific\n             *            object for the element.\n             * @param state\n             *            String specifying a value for the css 'display' property\n             *            ('block' or 'none').\n             */\n            _setVisible = function (el, state, alsoChangeEndpoints) {\n                state = state === \"block\";\n                var endpointFunc = null;\n                if (alsoChangeEndpoints) {\n                    endpointFunc = function (ep) {\n                        ep.setVisible(state, true, true);\n                    };\n                }\n                var info = _info(el);\n                _operation(info.id, function (jpc) {\n                    if (state && alsoChangeEndpoints) {\n                        // this test is necessary because this functionality is new, and i wanted to maintain backwards compatibility.\n                        // this block will only set a connection to be visible if the other endpoint in the connection is also visible.\n                        var oidx = jpc.sourceId === info.id ? 1 : 0;\n                        if (jpc.endpoints[oidx].isVisible()) {\n                            jpc.setVisible(true);\n                        }\n                    }\n                    else { // the default behaviour for show, and what always happens for hide, is to just set the visibility without getting clever.\n                        jpc.setVisible(state);\n                    }\n                }, endpointFunc);\n            },\n            /**\n             * private method to do the business of toggling hiding/showing.\n             */\n            _toggleVisible = function (elId, changeEndpoints) {\n                var endpointFunc = null;\n                if (changeEndpoints) {\n                    endpointFunc = function (ep) {\n                        var state = ep.isVisible();\n                        ep.setVisible(!state);\n                    };\n                }\n                _operation(elId, function (jpc) {\n                    var state = jpc.isVisible();\n                    jpc.setVisible(!state);\n                }, endpointFunc);\n            },\n\n            // TODO comparison performance\n            _getCachedData = function (elId) {\n                var o = offsets[elId];\n                if (!o) {\n                    return _updateOffset({elId: elId});\n                }\n                else {\n                    return {o: o, s: sizes[elId]};\n                }\n            },\n\n            /**\n             * gets an id for the given element, creating and setting one if\n             * necessary.  the id is of the form\n             *\n             *    jsPlumb_<instance index>_<index in instance>\n             *\n             * where \"index in instance\" is a monotonically increasing integer that starts at 0,\n             * for each instance.  this method is used not only to assign ids to elements that do not\n             * have them but also to connections and endpoints.\n             */\n            _getId = function (element, uuid, doNotCreateIfNotFound) {\n                if (_ju.isString(element)) {\n                    return element;\n                }\n                if (element == null) {\n                    return null;\n                }\n                var id = _currentInstance.getAttribute(element, \"id\");\n                if (!id || id === \"undefined\") {\n                    // check if fixed uuid parameter is given\n                    if (arguments.length === 2 && arguments[1] !== undefined) {\n                        id = uuid;\n                    }\n                    else if (arguments.length === 1 || (arguments.length === 3 && !arguments[2])) {\n                        id = \"jsPlumb_\" + _instanceIndex + \"_\" + _idstamp();\n                    }\n\n                    if (!doNotCreateIfNotFound) {\n                        _currentInstance.setAttribute(element, \"id\", id);\n                    }\n                }\n                return id;\n            };\n\n        this.setConnectionBeingDragged = function (v) {\n            connectionBeingDragged = v;\n        };\n        this.isConnectionBeingDragged = function () {\n            return connectionBeingDragged;\n        };\n\n        /**\n         * Returns a map of all the elements this jsPlumbInstance is currently managing.\n         * @returns {Object} Map of [id-> {el, endpoint[], connection, position}] information.\n         */\n        this.getManagedElements = function() {\n            return managedElements;\n        };\n\n        this.connectorClass = \"jtk-connector\";\n        this.connectorOutlineClass = \"jtk-connector-outline\";\n        this.connectedClass = \"jtk-connected\";\n        this.hoverClass = \"jtk-hover\";\n        this.endpointClass = \"jtk-endpoint\";\n        this.endpointConnectedClass = \"jtk-endpoint-connected\";\n        this.endpointFullClass = \"jtk-endpoint-full\";\n        this.endpointDropAllowedClass = \"jtk-endpoint-drop-allowed\";\n        this.endpointDropForbiddenClass = \"jtk-endpoint-drop-forbidden\";\n        this.overlayClass = \"jtk-overlay\";\n        this.draggingClass = \"jtk-dragging\";// CONVERTED\n        this.elementDraggingClass = \"jtk-element-dragging\";// CONVERTED\n        this.sourceElementDraggingClass = \"jtk-source-element-dragging\"; // CONVERTED\n        this.targetElementDraggingClass = \"jtk-target-element-dragging\";// CONVERTED\n        this.endpointAnchorClassPrefix = \"jtk-endpoint-anchor\";\n        this.hoverSourceClass = \"jtk-source-hover\";\n        this.hoverTargetClass = \"jtk-target-hover\";\n        this.dragSelectClass = \"jtk-drag-select\";\n\n        this.Anchors = {};\n        this.Connectors = {  \"svg\": {} };\n        this.Endpoints = { \"svg\": {} };\n        this.Overlays = { \"svg\": {} } ;\n        this.ConnectorRenderers = {};\n        this.SVG = \"svg\";\n\n// --------------------------- jsPlumbInstance public API ---------------------------------------------------------\n\n\n        this.addEndpoint = function (el, params, referenceParams) {\n            referenceParams = referenceParams || {};\n            var p = jsPlumb.extend({}, referenceParams);\n            jsPlumb.extend(p, params);\n            p.endpoint = p.endpoint || _currentInstance.Defaults.Endpoint;\n            p.paintStyle = p.paintStyle || _currentInstance.Defaults.EndpointStyle;\n\n            var results = [],\n                inputs = (_ju.isArray(el) || (el.length != null && !_ju.isString(el))) ? el : [ el ];\n\n            for (var i = 0, j = inputs.length; i < j; i++) {\n                p.source = _currentInstance.getElement(inputs[i]);\n                _ensureContainer(p.source);\n\n                var id = _getId(p.source), e = _newEndpoint(p, id);\n\n                // ensure element is managed. force a recalc if drawing not suspended, to ensure the cached value is fresh\n                var myOffset = _manage(id, p.source, null, !_suspendDrawing).info.o;\n                _ju.addToList(endpointsByElement, id, e);\n\n                if (!_suspendDrawing) {\n                    e.paint({\n                        anchorLoc: e.anchor.compute({ xy: [ myOffset.left, myOffset.top ], wh: sizes[id], element: e, timestamp: _suspendedAt }),\n                        timestamp: _suspendedAt\n                    });\n                }\n\n                results.push(e);\n            }\n\n            return results.length === 1 ? results[0] : results;\n        };\n\n        this.addEndpoints = function (el, endpoints, referenceParams) {\n            var results = [];\n            for (var i = 0, j = endpoints.length; i < j; i++) {\n                var e = _currentInstance.addEndpoint(el, endpoints[i], referenceParams);\n                if (_ju.isArray(e)) {\n                    Array.prototype.push.apply(results, e);\n                }\n                else {\n                    results.push(e);\n                }\n            }\n            return results;\n        };\n\n        this.animate = function (el, properties, options) {\n            if (!this.animationSupported) {\n                return false;\n            }\n\n            options = options || {};\n            var del = _currentInstance.getElement(el),\n                id = _getId(del),\n                stepFunction = jsPlumb.animEvents.step,\n                completeFunction = jsPlumb.animEvents.complete;\n\n            options[stepFunction] = _ju.wrap(options[stepFunction], function () {\n                _currentInstance.revalidate(id);\n            });\n\n            // onComplete repaints, just to make sure everything looks good at the end of the animation.\n            options[completeFunction] = _ju.wrap(options[completeFunction], function () {\n                _currentInstance.revalidate(id);\n            });\n\n            _currentInstance.doAnimate(del, properties, options);\n        };\n\n        /**\n         * checks for a listener for the given condition, executing it if found, passing in the given value.\n         * condition listeners would have been attached using \"bind\" (which is, you could argue, now overloaded, since\n         * firing click events etc is a bit different to what this does).  i thought about adding a \"bindCondition\"\n         * or something, but decided against it, for the sake of simplicity. jsPlumb will never fire one of these\n         * condition events anyway.\n         */\n        this.checkCondition = function (conditionName, args) {\n            var l = _currentInstance.getListener(conditionName),\n                r = true;\n\n            if (l && l.length > 0) {\n                var values = Array.prototype.slice.call(arguments, 1);\n                try {\n                    for (var i = 0, j = l.length; i < j; i++) {\n                        r = r && l[i].apply(l[i], values);\n                    }\n                }\n                catch (e) {\n                    _ju.log(_currentInstance, \"cannot check condition [\" + conditionName + \"]\" + e);\n                }\n            }\n            return r;\n        };\n\n        this.connect = function (params, referenceParams) {\n            // prepare a final set of parameters to create connection with\n            var _p = _prepareConnectionParams(params, referenceParams), jpc;\n            // TODO probably a nicer return value if the connection was not made.  _prepareConnectionParams\n            // will return null (and log something) if either endpoint was full.  what would be nicer is to\n            // create a dedicated 'error' object.\n            if (_p) {\n                if (_p.source == null && _p.sourceEndpoint == null) {\n                    _ju.log(\"Cannot establish connection - source does not exist\");\n                    return;\n                }\n                if (_p.target == null && _p.targetEndpoint == null) {\n                    _ju.log(\"Cannot establish connection - target does not exist\");\n                    return;\n                }\n                _ensureContainer(_p.source);\n                // create the connection.  it is not yet registered\n                jpc = _newConnection(_p);\n                // now add it the model, fire an event, and redraw\n                _finaliseConnection(jpc, _p);\n            }\n            return jpc;\n        };\n\n        var stTypes = [\n            { el: \"source\", elId: \"sourceId\", epDefs: \"sourceEndpointDefinitions\" },\n            { el: \"target\", elId: \"targetId\", epDefs: \"targetEndpointDefinitions\" }\n        ];\n\n        var _set = function (c, el, idx, doNotRepaint) {\n            var ep, _st = stTypes[idx], cId = c[_st.elId], cEl = c[_st.el], sid, sep,\n                oldEndpoint = c.endpoints[idx];\n\n            var evtParams = {\n                index: idx,\n                originalSourceId: idx === 0 ? cId : c.sourceId,\n                newSourceId: c.sourceId,\n                originalTargetId: idx === 1 ? cId : c.targetId,\n                newTargetId: c.targetId,\n                connection: c\n            };\n\n            if (el.constructor === jsPlumb.Endpoint) {\n                ep = el;\n                ep.addConnection(c);\n                el = ep.element;\n            }\n            else {\n                sid = _getId(el);\n                sep = this[_st.epDefs][sid];\n\n                if (sid === c[_st.elId]) {\n                    ep = null; // dont change source/target if the element is already the one given.\n                }\n                else if (sep) {\n                    for (var t in sep) {\n                        if (!sep[t].enabled) {\n                            return;\n                        }\n                        ep = sep[t].endpoint != null && sep[t].endpoint._jsPlumb ? sep[t].endpoint : this.addEndpoint(el, sep[t].def);\n                        if (sep[t].uniqueEndpoint) {\n                            sep[t].endpoint = ep;\n                        }\n                        ep.addConnection(c);\n                    }\n                }\n                else {\n                    ep = c.makeEndpoint(idx === 0, el, sid);\n                }\n            }\n\n            if (ep != null) {\n                oldEndpoint.detachFromConnection(c);\n                c.endpoints[idx] = ep;\n                c[_st.el] = ep.element;\n                c[_st.elId] = ep.elementId;\n                evtParams[idx === 0 ? \"newSourceId\" : \"newTargetId\"] = ep.elementId;\n\n                fireMoveEvent(evtParams);\n\n                if (!doNotRepaint) {\n                    c.repaint();\n                }\n            }\n\n            evtParams.element = el;\n            return evtParams;\n\n        }.bind(this);\n\n        this.setSource = function (connection, el, doNotRepaint) {\n            var p = _set(connection, el, 0, doNotRepaint);\n            this.router.sourceOrTargetChanged(p.originalSourceId, p.newSourceId, connection, p.el, 0);\n        };\n        this.setTarget = function (connection, el, doNotRepaint) {\n            var p = _set(connection, el, 1, doNotRepaint);\n            this.router.sourceOrTargetChanged(p.originalTargetId, p.newTargetId, connection, p.el, 1);\n        };\n\n        this.deleteEndpoint = function (object, dontUpdateHover, deleteAttachedObjects) {\n            var endpoint = (typeof object === \"string\") ? endpointsByUUID[object] : object;\n            if (endpoint) {\n                _currentInstance.deleteObject({ endpoint: endpoint, dontUpdateHover: dontUpdateHover, deleteAttachedObjects:deleteAttachedObjects });\n            }\n            return _currentInstance;\n        };\n\n        this.deleteEveryEndpoint = function () {\n            var _is = _currentInstance.setSuspendDrawing(true);\n            for (var id in endpointsByElement) {\n                var endpoints = endpointsByElement[id];\n                if (endpoints && endpoints.length) {\n                    for (var i = 0, j = endpoints.length; i < j; i++) {\n                        _currentInstance.deleteEndpoint(endpoints[i], true);\n                    }\n                }\n            }\n            endpointsByElement = {};\n            managedElements = {};\n            endpointsByUUID = {};\n            offsets = {};\n            offsetTimestamps = {};\n            _currentInstance.router.reset();\n            var dm = _currentInstance.getDragManager();\n            if (dm) {\n                dm.reset();\n            }\n            if (!_is) {\n                _currentInstance.setSuspendDrawing(false);\n            }\n            return _currentInstance;\n        };\n\n        var fireDetachEvent = function (jpc, doFireEvent, originalEvent) {\n            // may have been given a connection, or in special cases, an object\n            var connType = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType(),\n                argIsConnection = jpc.constructor === connType,\n                params = argIsConnection ? {\n                    connection: jpc,\n                    source: jpc.source, target: jpc.target,\n                    sourceId: jpc.sourceId, targetId: jpc.targetId,\n                    sourceEndpoint: jpc.endpoints[0], targetEndpoint: jpc.endpoints[1]\n                } : jpc;\n\n            if (doFireEvent) {\n                _currentInstance.fire(\"connectionDetached\", params, originalEvent);\n            }\n\n            // always fire this. used by internal jsplumb stuff.\n            _currentInstance.fire(\"internal.connectionDetached\", params, originalEvent);\n\n            _currentInstance.router.connectionDetached(params);\n        };\n\n        var fireMoveEvent = _currentInstance.fireMoveEvent = function (params, evt) {\n            _currentInstance.fire(\"connectionMoved\", params, evt);\n        };\n\n        this.unregisterEndpoint = function (endpoint) {\n            if (endpoint._jsPlumb.uuid) {\n                endpointsByUUID[endpoint._jsPlumb.uuid] = null;\n            }\n            _currentInstance.anchorManager.deleteEndpoint(endpoint);\n            // TODO at least replace this with a removeWithFunction call.\n            for (var e in endpointsByElement) {\n                var endpoints = endpointsByElement[e];\n                if (endpoints) {\n                    var newEndpoints = [];\n                    for (var i = 0, j = endpoints.length; i < j; i++) {\n                        if (endpoints[i] !== endpoint) {\n                            newEndpoints.push(endpoints[i]);\n                        }\n                    }\n\n                    endpointsByElement[e] = newEndpoints;\n                }\n                if (endpointsByElement[e].length < 1) {\n                    delete endpointsByElement[e];\n                }\n            }\n        };\n\n        var IS_DETACH_ALLOWED = \"isDetachAllowed\";\n        var BEFORE_DETACH = \"beforeDetach\";\n        var CHECK_CONDITION = \"checkCondition\";\n\n        /**\n         * Deletes a Connection.\n         * @method deleteConnection\n         * @param connection Connection to delete\n         * @param {Object} [params] Optional delete parameters\n         * @param {Boolean} [params.fireEvent=true] If false, a connection detached event will not be fired. Otherwise one will.\n         * @param {Boolean} [params.force=false] If true, the connection will be deleted even if a beforeDetach interceptor tries to stop the deletion.\n         * @returns {Boolean} True if the connection was deleted, false otherwise.\n         */\n        this.deleteConnection = function(connection, params) {\n\n            if (connection != null) {\n                params = params || {};\n\n                if (params.force || _ju.functionChain(true, false, [\n                        [ connection.endpoints[0], IS_DETACH_ALLOWED, [ connection ] ],\n                        [ connection.endpoints[1], IS_DETACH_ALLOWED, [ connection ] ],\n                        [ connection, IS_DETACH_ALLOWED, [ connection ] ],\n                        [ _currentInstance, CHECK_CONDITION, [ BEFORE_DETACH, connection ] ]\n                    ])) {\n\n                    connection.setHover(false);\n                    fireDetachEvent(connection, !connection.pending && params.fireEvent !== false, params.originalEvent);\n\n                    connection.endpoints[0].detachFromConnection(connection);\n                    connection.endpoints[1].detachFromConnection(connection);\n                    _ju.removeWithFunction(connections, function (_c) {\n                        return connection.id === _c.id;\n                    });\n\n                    connection.cleanup();\n                    connection.destroy();\n                    return true;\n                }\n            }\n            return false;\n        };\n\n        /**\n         * Remove all Connections from all elements, but leaves Endpoints in place ((unless a connection is set to auto delete its Endpoints).\n         * @method deleteEveryConnection\n         * @param {Object} [params] optional params object for the call\n         * @param {Boolean} [params.fireEvent=true] Whether or not to fire detach events\n         * @param {Boolean} [params.forceDetach=false] If true, this call will ignore any `beforeDetach` interceptors.\n         * @returns {Number} The number of connections that were deleted.\n         */\n        this.deleteEveryConnection = function (params) {\n            params = params || {};\n            var count = connections.length, deletedCount = 0;\n            _currentInstance.batch(function () {\n                for (var i = 0; i < count; i++) {\n                    deletedCount += _currentInstance.deleteConnection(connections[0], params) ? 1 : 0;\n                }\n            });\n            return deletedCount;\n        };\n\n        /**\n         * Removes all an element's Connections.\n         * @method deleteConnectionsForElement\n         * @param {Object} el Either the id of the element, or a selector for the element.\n         * @param {Object} [params] Optional parameters.\n         * @param {Boolean} [params.fireEvent=true] Whether or not to fire the detach event.\n         * @param {Boolean} [params.forceDetach=false] If true, this call will ignore any `beforeDetach` interceptors.\n         * @return {jsPlumbInstance} The current jsPlumb instance.\n         */\n        this.deleteConnectionsForElement = function (el, params) {\n            params = params || {};\n            el = _currentInstance.getElement(el);\n            var id = _getId(el), endpoints = endpointsByElement[id];\n            if (endpoints && endpoints.length) {\n                for (var i = 0, j = endpoints.length; i < j; i++) {\n                    endpoints[i].deleteEveryConnection(params);\n                }\n            }\n            return _currentInstance;\n        };\n\n        /// not public.  but of course its exposed. how to change this.\n        this.deleteObject = function (params) {\n            var result = {\n                    endpoints: {},\n                    connections: {},\n                    endpointCount: 0,\n                    connectionCount: 0\n                },\n                deleteAttachedObjects = params.deleteAttachedObjects !== false;\n\n            var unravelConnection = function (connection) {\n                if (connection != null && result.connections[connection.id] == null) {\n                    if (!params.dontUpdateHover && connection._jsPlumb != null) {\n                        connection.setHover(false);\n                    }\n                    result.connections[connection.id] = connection;\n                    result.connectionCount++;\n                }\n            };\n            var unravelEndpoint = function (endpoint) {\n                if (endpoint != null && result.endpoints[endpoint.id] == null) {\n                    if (!params.dontUpdateHover && endpoint._jsPlumb != null) {\n                        endpoint.setHover(false);\n                    }\n                    result.endpoints[endpoint.id] = endpoint;\n                    result.endpointCount++;\n\n                    if (deleteAttachedObjects) {\n                        for (var i = 0; i < endpoint.connections.length; i++) {\n                            var c = endpoint.connections[i];\n                            unravelConnection(c);\n                        }\n                    }\n                }\n            };\n\n            if (params.connection) {\n                unravelConnection(params.connection);\n            }\n            else {\n                unravelEndpoint(params.endpoint);\n            }\n\n            // loop through connections\n            for (var i in result.connections) {\n                var c = result.connections[i];\n                if (c._jsPlumb) {\n                    _ju.removeWithFunction(connections, function (_c) {\n                        return c.id === _c.id;\n                    });\n\n                    fireDetachEvent(c, params.fireEvent === false ? false : !c.pending, params.originalEvent);\n                    var doNotCleanup = params.deleteAttachedObjects == null ? null : !params.deleteAttachedObjects;\n\n                    c.endpoints[0].detachFromConnection(c, null, doNotCleanup);\n                    c.endpoints[1].detachFromConnection(c, null, doNotCleanup);\n\n                    c.cleanup(true);\n                    c.destroy(true);\n                }\n            }\n\n            // loop through endpoints\n            for (var j in result.endpoints) {\n                var e = result.endpoints[j];\n                if (e._jsPlumb) {\n                    _currentInstance.unregisterEndpoint(e);\n                    // FIRE some endpoint deleted event?\n                    e.cleanup(true);\n                    e.destroy(true);\n                }\n            }\n\n            return result;\n        };\n\n\n        // helpers for select/selectEndpoints\n        var _setOperation = function (list, func, args, selector) {\n                for (var i = 0, j = list.length; i < j; i++) {\n                    list[i][func].apply(list[i], args);\n                }\n                return selector(list);\n            },\n            _getOperation = function (list, func, args) {\n                var out = [];\n                for (var i = 0, j = list.length; i < j; i++) {\n                    out.push([ list[i][func].apply(list[i], args), list[i] ]);\n                }\n                return out;\n            },\n            setter = function (list, func, selector) {\n                return function () {\n                    return _setOperation(list, func, arguments, selector);\n                };\n            },\n            getter = function (list, func) {\n                return function () {\n                    return _getOperation(list, func, arguments);\n                };\n            },\n            prepareList = function (input, doNotGetIds) {\n                var r = [];\n                if (input) {\n                    if (typeof input === 'string') {\n                        if (input === \"*\") {\n                            return input;\n                        }\n                        r.push(input);\n                    }\n                    else {\n                        if (doNotGetIds) {\n                            r = input;\n                        }\n                        else {\n                            if (input.length) {\n                                for (var i = 0, j = input.length; i < j; i++) {\n                                    r.push(_info(input[i]).id);\n                                }\n                            }\n                            else {\n                                r.push(_info(input).id);\n                            }\n                        }\n                    }\n                }\n                return r;\n            },\n            filterList = function (list, value, missingIsFalse) {\n                if (list === \"*\") {\n                    return true;\n                }\n                return list.length > 0 ? list.indexOf(value) !== -1 : !missingIsFalse;\n            };\n\n        // get some connections, specifying source/target/scope\n        this.getConnections = function (options, flat) {\n            if (!options) {\n                options = {};\n            } else if (options.constructor === String) {\n                options = { \"scope\": options };\n            }\n            var scope = options.scope || _currentInstance.getDefaultScope(),\n                scopes = prepareList(scope, true),\n                sources = prepareList(options.source),\n                targets = prepareList(options.target),\n                results = (!flat && scopes.length > 1) ? {} : [],\n                _addOne = function (scope, obj) {\n                    if (!flat && scopes.length > 1) {\n                        var ss = results[scope];\n                        if (ss == null) {\n                            ss = results[scope] = [];\n                        }\n                        ss.push(obj);\n                    } else {\n                        results.push(obj);\n                    }\n                };\n\n            for (var j = 0, jj = connections.length; j < jj; j++) {\n                var c = connections[j],\n                    sourceId = c.proxies && c.proxies[0] ? c.proxies[0].originalEp.elementId : c.sourceId,\n                    targetId = c.proxies && c.proxies[1] ? c.proxies[1].originalEp.elementId : c.targetId;\n\n                if (filterList(scopes, c.scope) && filterList(sources, sourceId) && filterList(targets, targetId)) {\n                    _addOne(c.scope, c);\n                }\n            }\n\n            return results;\n        };\n\n        var _curryEach = function (list, executor) {\n                return function (f) {\n                    for (var i = 0, ii = list.length; i < ii; i++) {\n                        f(list[i]);\n                    }\n                    return executor(list);\n                };\n            },\n            _curryGet = function (list) {\n                return function (idx) {\n                    return list[idx];\n                };\n            };\n\n        var _makeCommonSelectHandler = function (list, executor) {\n            var out = {\n                    length: list.length,\n                    each: _curryEach(list, executor),\n                    get: _curryGet(list)\n                },\n                setters = [\"setHover\", \"removeAllOverlays\", \"setLabel\", \"addClass\", \"addOverlay\", \"removeOverlay\",\n                    \"removeOverlays\", \"showOverlay\", \"hideOverlay\", \"showOverlays\", \"hideOverlays\", \"setPaintStyle\",\n                    \"setHoverPaintStyle\", \"setSuspendEvents\", \"setParameter\", \"setParameters\", \"setVisible\",\n                    \"repaint\", \"addType\", \"toggleType\", \"removeType\", \"removeClass\", \"setType\", \"bind\", \"unbind\" ],\n\n                getters = [\"getLabel\", \"getOverlay\", \"isHover\", \"getParameter\", \"getParameters\", \"getPaintStyle\",\n                    \"getHoverPaintStyle\", \"isVisible\", \"hasType\", \"getType\", \"isSuspendEvents\" ],\n                i, ii;\n\n            for (i = 0, ii = setters.length; i < ii; i++) {\n                out[setters[i]] = setter(list, setters[i], executor);\n            }\n\n            for (i = 0, ii = getters.length; i < ii; i++) {\n                out[getters[i]] = getter(list, getters[i]);\n            }\n\n            return out;\n        };\n\n        var _makeConnectionSelectHandler = function (list) {\n            var common = _makeCommonSelectHandler(list, _makeConnectionSelectHandler);\n            return jsPlumb.extend(common, {\n                // setters\n                setDetachable: setter(list, \"setDetachable\", _makeConnectionSelectHandler),\n                setReattach: setter(list, \"setReattach\", _makeConnectionSelectHandler),\n                setConnector: setter(list, \"setConnector\", _makeConnectionSelectHandler),\n                delete: function () {\n                    for (var i = 0, ii = list.length; i < ii; i++) {\n                        _currentInstance.deleteConnection(list[i]);\n                    }\n                },\n                // getters\n                isDetachable: getter(list, \"isDetachable\"),\n                isReattach: getter(list, \"isReattach\")\n            });\n        };\n\n        var _makeEndpointSelectHandler = function (list) {\n            var common = _makeCommonSelectHandler(list, _makeEndpointSelectHandler);\n            return jsPlumb.extend(common, {\n                setEnabled: setter(list, \"setEnabled\", _makeEndpointSelectHandler),\n                setAnchor: setter(list, \"setAnchor\", _makeEndpointSelectHandler),\n                isEnabled: getter(list, \"isEnabled\"),\n                deleteEveryConnection: function () {\n                    for (var i = 0, ii = list.length; i < ii; i++) {\n                        list[i].deleteEveryConnection();\n                    }\n                },\n                \"delete\": function () {\n                    for (var i = 0, ii = list.length; i < ii; i++) {\n                        _currentInstance.deleteEndpoint(list[i]);\n                    }\n                }\n            });\n        };\n\n        this.select = function (params) {\n            params = params || {};\n            params.scope = params.scope || \"*\";\n            return _makeConnectionSelectHandler(params.connections || _currentInstance.getConnections(params, true));\n        };\n\n        this.selectEndpoints = function (params) {\n            params = params || {};\n            params.scope = params.scope || \"*\";\n            var noElementFilters = !params.element && !params.source && !params.target,\n                elements = noElementFilters ? \"*\" : prepareList(params.element),\n                sources = noElementFilters ? \"*\" : prepareList(params.source),\n                targets = noElementFilters ? \"*\" : prepareList(params.target),\n                scopes = prepareList(params.scope, true);\n\n            var ep = [];\n\n            for (var el in endpointsByElement) {\n                var either = filterList(elements, el, true),\n                    source = filterList(sources, el, true),\n                    sourceMatchExact = sources !== \"*\",\n                    target = filterList(targets, el, true),\n                    targetMatchExact = targets !== \"*\";\n\n                // if they requested 'either' then just match scope. otherwise if they requested 'source' (not as a wildcard) then we have to match only endpoints that have isSource set to to true, and the same thing with isTarget.\n                if (either || source || target) {\n                    inner:\n                        for (var i = 0, ii = endpointsByElement[el].length; i < ii; i++) {\n                            var _ep = endpointsByElement[el][i];\n                            if (filterList(scopes, _ep.scope, true)) {\n\n                                var noMatchSource = (sourceMatchExact && sources.length > 0 && !_ep.isSource),\n                                    noMatchTarget = (targetMatchExact && targets.length > 0 && !_ep.isTarget);\n\n                                if (noMatchSource || noMatchTarget) {\n                                    continue inner;\n                                }\n\n                                ep.push(_ep);\n                            }\n                        }\n                }\n            }\n\n            return _makeEndpointSelectHandler(ep);\n        };\n\n        // get all connections managed by the instance of jsplumb.\n        this.getAllConnections = function () {\n            return connections;\n        };\n        this.getDefaultScope = function () {\n            return DEFAULT_SCOPE;\n        };\n        // get an endpoint by uuid.\n        this.getEndpoint = _getEndpoint;\n        /**\n         * Gets the list of Endpoints for a given element.\n         * @method getEndpoints\n         * @param {String|Element|Selector} el The element to get endpoints for.\n         * @return {Endpoint[]} An array of Endpoints for the specified element.\n         */\n        this.getEndpoints = function (el) {\n            return endpointsByElement[_info(el).id] || [];\n        };\n        // gets the default endpoint type. used when subclassing. see wiki.\n        this.getDefaultEndpointType = function () {\n            return jsPlumb.Endpoint;\n        };\n        // gets the default connection type. used when subclassing.  see wiki.\n        this.getDefaultConnectionType = function () {\n            return jsPlumb.Connection;\n        };\n        /*\n         * Gets an element's id, creating one if necessary. really only exposed\n         * for the lib-specific functionality to access; would be better to pass\n         * the current instance into the lib-specific code (even though this is\n         * a static call. i just don't want to expose it to the public API).\n         */\n        this.getId = _getId;\n        this.draw = _draw;\n        this.info = _info;\n\n        this.appendElement = _appendElement;\n\n        var _hoverSuspended = false;\n        this.isHoverSuspended = function () {\n            return _hoverSuspended;\n        };\n        this.setHoverSuspended = function (s) {\n            _hoverSuspended = s;\n        };\n\n        // set an element's connections to be hidden\n        this.hide = function (el, changeEndpoints) {\n            _setVisible(el, \"none\", changeEndpoints);\n            return _currentInstance;\n        };\n\n        // exposed for other objects to use to get a unique id.\n        this.idstamp = _idstamp;\n\n        // ensure that, if the current container exists, it is a DOM element and not a selector.\n        // if it does not exist and `candidate` is supplied, the offset parent of that element will be set as the Container.\n        // this is used to do a better default behaviour for the case that the user has not set a container:\n        // addEndpoint, makeSource, makeTarget and connect all call this method with the offsetParent of the\n        // element in question (for connect it is the source element). So if no container is set, it is inferred\n        // to be the offsetParent of the first element the user tries to connect.\n        var _ensureContainer = function (candidate) {\n            if (!_container && candidate) {\n                var can = _currentInstance.getElement(candidate);\n                if (can.offsetParent) {\n                    _currentInstance.setContainer(can.offsetParent);\n                }\n            }\n        };\n\n        var _getContainerFromDefaults = function () {\n            if (_currentInstance.Defaults.Container) {\n                _currentInstance.setContainer(_currentInstance.Defaults.Container);\n            }\n        };\n\n        // check if a given element is managed or not. if not, add to our map. if drawing is not suspended then\n        // we'll also stash its dimensions; otherwise we'll do this in a lazy way through updateOffset.\n        var _manage = _currentInstance.manage = function (id, element, _transient, _recalc) {\n            if (!managedElements[id]) {\n                managedElements[id] = {\n                    el: element,\n                    endpoints: [],\n                    connections: []\n                };\n\n                managedElements[id].info = _updateOffset({ elId: id, timestamp: _suspendedAt });\n                _currentInstance.addClass(element, \"jtk-managed\");\n\n                if (!_transient) {\n                    _currentInstance.fire(\"manageElement\", { id:id, info:managedElements[id].info, el:element });\n                }\n            } else {\n                if (_recalc) {\n                    managedElements[id].info = _updateOffset({ elId: id, timestamp: _suspendedAt, recalc:true });\n                }\n            }\n\n            return managedElements[id];\n        };\n\n        var _unmanage = _currentInstance.unmanage = function(id) {\n            if (managedElements[id]) {\n                var el = managedElements[id].el;\n               _currentInstance.removeClass(el, \"jtk-managed\");\n                delete managedElements[id];\n                _currentInstance.fire(\"unmanageElement\", {id:id, el:el});\n            }\n        };\n\n        /**\n         * updates the offset and size for a given element, and stores the\n         * values. if 'offset' is not null we use that (it would have been\n         * passed in from a drag call) because it's faster; but if it is null,\n         * or if 'recalc' is true in order to force a recalculation, we get the current values.\n         * @method updateOffset\n         */\n        var _updateOffset = function (params) {\n\n            var timestamp = params.timestamp, recalc = params.recalc, offset = params.offset, elId = params.elId, s;\n            if (_suspendDrawing && !timestamp) {\n                timestamp = _suspendedAt;\n            }\n            if (!recalc) {\n                if (timestamp && timestamp === offsetTimestamps[elId]) {\n                    return {o: params.offset || offsets[elId], s: sizes[elId]};\n                }\n            }\n            if (recalc || (!offset && offsets[elId] == null)) { // if forced repaint or no offset available, we recalculate.\n\n                // get the current size and offset, and store them\n                s = managedElements[elId] ? managedElements[elId].el : null;\n                if (s != null) {\n                    sizes[elId] = _currentInstance.getSize(s);\n                    offsets[elId] = _currentInstance.getOffset(s);\n                    offsetTimestamps[elId] = timestamp;\n                }\n            } else {\n                offsets[elId] = offset || offsets[elId];\n                if (sizes[elId] == null) {\n                    s = managedElements[elId].el;\n                    if (s != null) {\n                        sizes[elId] = _currentInstance.getSize(s);\n                    }\n                }\n                offsetTimestamps[elId] = timestamp;\n            }\n\n            if (offsets[elId] && !offsets[elId].right) {\n                offsets[elId].right = offsets[elId].left + sizes[elId][0];\n                offsets[elId].bottom = offsets[elId].top + sizes[elId][1];\n                offsets[elId].width = sizes[elId][0];\n                offsets[elId].height = sizes[elId][1];\n                offsets[elId].centerx = offsets[elId].left + (offsets[elId].width / 2);\n                offsets[elId].centery = offsets[elId].top + (offsets[elId].height / 2);\n            }\n\n            return {o: offsets[elId], s: sizes[elId]};\n        };\n\n        this.updateOffset = _updateOffset;\n\n        /**\n         * callback from the current library to tell us to prepare ourselves (attach\n         * mouse listeners etc; can't do that until the library has provided a bind method)\n         */\n        this.init = function () {\n            if (!initialized) {\n                _getContainerFromDefaults();\n                _currentInstance.router = new root.jsPlumb.DefaultRouter(_currentInstance);\n                _currentInstance.anchorManager = _currentInstance.router.anchorManager;\n                initialized = true;\n                _currentInstance.fire(\"ready\", _currentInstance);\n            }\n        }.bind(this);\n\n        this.log = log;\n        this.jsPlumbUIComponent = jsPlumbUIComponent;\n\n        /*\n         * Creates an anchor with the given params.\n         *\n         *\n         * Returns: The newly created Anchor.\n         * Throws: an error if a named anchor was not found.\n         */\n        this.makeAnchor = function () {\n            var pp, _a = function (t, p) {\n                if (root.jsPlumb.Anchors[t]) {\n                    return new root.jsPlumb.Anchors[t](p);\n                }\n                if (!_currentInstance.Defaults.DoNotThrowErrors) {\n                    throw { msg: \"jsPlumb: unknown anchor type '\" + t + \"'\" };\n                }\n            };\n            if (arguments.length === 0) {\n                return null;\n            }\n            var specimen = arguments[0], elementId = arguments[1], jsPlumbInstance = arguments[2], newAnchor = null;\n            // if it appears to be an anchor already...\n            if (specimen.compute && specimen.getOrientation) {\n                return specimen;\n            }  //TODO hazy here about whether it should be added or is already added somehow.\n            // is it the name of an anchor type?\n            else if (typeof specimen === \"string\") {\n                newAnchor = _a(arguments[0], {elementId: elementId, jsPlumbInstance: _currentInstance});\n            }\n            // is it an array? it will be one of:\n            // an array of [spec, params] - this defines a single anchor, which may be dynamic, but has parameters.\n            // an array of arrays - this defines some dynamic anchors\n            // an array of numbers - this defines a single anchor.\n            else if (_ju.isArray(specimen)) {\n                if (_ju.isArray(specimen[0]) || _ju.isString(specimen[0])) {\n                    // if [spec, params] format\n                    if (specimen.length === 2 && _ju.isObject(specimen[1])) {\n                        // if first arg is a string, its a named anchor with params\n                        if (_ju.isString(specimen[0])) {\n                            pp = root.jsPlumb.extend({elementId: elementId, jsPlumbInstance: _currentInstance}, specimen[1]);\n                            newAnchor = _a(specimen[0], pp);\n                        }\n                        // otherwise first arg is array, second is params. we treat as a dynamic anchor, which is fine\n                        // even if the first arg has only one entry. you could argue all anchors should be implicitly dynamic in fact.\n                        else {\n                            pp = root.jsPlumb.extend({elementId: elementId, jsPlumbInstance: _currentInstance, anchors: specimen[0]}, specimen[1]);\n                            newAnchor = new root.jsPlumb.DynamicAnchor(pp);\n                        }\n                    }\n                    else {\n                        newAnchor = new jsPlumb.DynamicAnchor({anchors: specimen, selector: null, elementId: elementId, jsPlumbInstance: _currentInstance});\n                    }\n\n                }\n                else {\n                    var anchorParams = {\n                        x: specimen[0], y: specimen[1],\n                        orientation: (specimen.length >= 4) ? [ specimen[2], specimen[3] ] : [0, 0],\n                        offsets: (specimen.length >= 6) ? [ specimen[4], specimen[5] ] : [ 0, 0 ],\n                        elementId: elementId,\n                        jsPlumbInstance: _currentInstance,\n                        cssClass: specimen.length === 7 ? specimen[6] : null\n                    };\n                    newAnchor = new root.jsPlumb.Anchor(anchorParams);\n                    newAnchor.clone = function () {\n                        return new root.jsPlumb.Anchor(anchorParams);\n                    };\n                }\n            }\n\n            if (!newAnchor.id) {\n                newAnchor.id = \"anchor_\" + _idstamp();\n            }\n            return newAnchor;\n        };\n\n        /**\n         * makes a list of anchors from the given list of types or coords, eg\n         * [\"TopCenter\", \"RightMiddle\", \"BottomCenter\", [0, 1, -1, -1] ]\n         */\n        this.makeAnchors = function (types, elementId, jsPlumbInstance) {\n            var r = [];\n            for (var i = 0, ii = types.length; i < ii; i++) {\n                if (typeof types[i] === \"string\") {\n                    r.push(root.jsPlumb.Anchors[types[i]]({elementId: elementId, jsPlumbInstance: jsPlumbInstance}));\n                }\n                else if (_ju.isArray(types[i])) {\n                    r.push(_currentInstance.makeAnchor(types[i], elementId, jsPlumbInstance));\n                }\n            }\n            return r;\n        };\n\n        /**\n         * Makes a dynamic anchor from the given list of anchors (which may be in shorthand notation as strings or dimension arrays, or Anchor\n         * objects themselves) and the given, optional, anchorSelector function (jsPlumb uses a default if this is not provided; most people will\n         * not need to provide this - i think).\n         */\n        this.makeDynamicAnchor = function (anchors, anchorSelector) {\n            return new root.jsPlumb.DynamicAnchor({anchors: anchors, selector: anchorSelector, elementId: null, jsPlumbInstance: _currentInstance});\n        };\n\n// --------------------- makeSource/makeTarget ----------------------------------------------\n\n        this.targetEndpointDefinitions = {};\n        this.sourceEndpointDefinitions = {};\n\n        var selectorFilter = function (evt, _el, selector, _instance, negate) {\n            var t = evt.target || evt.srcElement, ok = false,\n                sel = _instance.getSelector(_el, selector);\n            for (var j = 0; j < sel.length; j++) {\n                if (sel[j] === t) {\n                    ok = true;\n                    break;\n                }\n            }\n            return negate ? !ok : ok;\n        };\n\n        var _makeElementDropHandler = function (elInfo, p, dropOptions, isSource, isTarget) {\n            var proxyComponent = new jsPlumbUIComponent(p);\n            var _drop = p._jsPlumb.EndpointDropHandler({\n                jsPlumb: _currentInstance,\n                enabled: function () {\n                    return elInfo.def.enabled;\n                },\n                isFull: function () {\n                    var targetCount = _currentInstance.select({target: elInfo.id}).length;\n                    return elInfo.def.maxConnections > 0 && targetCount >= elInfo.def.maxConnections;\n                },\n                element: elInfo.el,\n                elementId: elInfo.id,\n                isSource: isSource,\n                isTarget: isTarget,\n                addClass: function (clazz) {\n                    _currentInstance.addClass(elInfo.el, clazz);\n                },\n                removeClass: function (clazz) {\n                    _currentInstance.removeClass(elInfo.el, clazz);\n                },\n                onDrop: function (jpc) {\n                    var source = jpc.endpoints[0];\n                    source.anchor.unlock();\n                },\n                isDropAllowed: function () {\n                    return proxyComponent.isDropAllowed.apply(proxyComponent, arguments);\n                },\n                isRedrop:function(jpc) {\n                    return (jpc.suspendedElement != null && jpc.suspendedEndpoint != null && jpc.suspendedEndpoint.element === elInfo.el);\n                },\n                getEndpoint: function (jpc) {\n\n                    // make a new Endpoint for the target, or get it from the cache if uniqueEndpoint\n                    // is set. if its a redrop the new endpoint will be immediately cleaned up.\n\n                    var newEndpoint = elInfo.def.endpoint;\n\n                    // if no cached endpoint, or there was one but it has been cleaned up\n                    // (ie. detached), create a new one\n                    if (newEndpoint == null || newEndpoint._jsPlumb == null) {\n                        var eps = _currentInstance.deriveEndpointAndAnchorSpec(jpc.getType().join(\" \"), true);\n                        var pp = eps.endpoints ? root.jsPlumb.extend(p, {\n                            endpoint:elInfo.def.def.endpoint || eps.endpoints[1]\n                        }) :p;\n                        if (eps.anchors) {\n                            pp = root.jsPlumb.extend(pp, {\n                                anchor:elInfo.def.def.anchor || eps.anchors[1]\n                            });\n                        }\n                        newEndpoint = _currentInstance.addEndpoint(elInfo.el, pp);\n                        newEndpoint._mtNew = true;\n                    }\n\n                    if (p.uniqueEndpoint) {\n                        elInfo.def.endpoint = newEndpoint;\n                    }\n\n                    newEndpoint.setDeleteOnEmpty(true);\n\n                    // if connection is detachable, init the new endpoint to be draggable, to support that happening.\n                    if (jpc.isDetachable()) {\n                        newEndpoint.initDraggable();\n                    }\n\n                    // if the anchor has a 'positionFinder' set, then delegate to that function to find\n                    // out where to locate the anchor.\n                    if (newEndpoint.anchor.positionFinder != null) {\n                        var dropPosition = _currentInstance.getUIPosition(arguments, _currentInstance.getZoom()),\n                            elPosition = _currentInstance.getOffset(elInfo.el),\n                            elSize = _currentInstance.getSize(elInfo.el),\n                            ap = dropPosition == null ? [0,0] : newEndpoint.anchor.positionFinder(dropPosition, elPosition, elSize, newEndpoint.anchor.constructorParams);\n\n                        newEndpoint.anchor.x = ap[0];\n                        newEndpoint.anchor.y = ap[1];\n                        // now figure an orientation for it..kind of hard to know what to do actually. probably the best thing i can do is to\n                        // support specifying an orientation in the anchor's spec. if one is not supplied then i will make the orientation\n                        // be what will cause the most natural link to the source: it will be pointing at the source, but it needs to be\n                        // specified in one axis only, and so how to make that choice? i think i will use whichever axis is the one in which\n                        // the target is furthest away from the source.\n                    }\n\n                    return newEndpoint;\n                },\n                maybeCleanup: function (ep) {\n                    if (ep._mtNew && ep.connections.length === 0) {\n                        _currentInstance.deleteObject({endpoint: ep});\n                    }\n                    else {\n                        delete ep._mtNew;\n                    }\n                }\n            });\n\n            // wrap drop events as needed and initialise droppable\n            var dropEvent = root.jsPlumb.dragEvents.drop;\n            dropOptions.scope = dropOptions.scope || (p.scope || _currentInstance.Defaults.Scope);\n            dropOptions[dropEvent] = _ju.wrap(dropOptions[dropEvent], _drop, true);\n            dropOptions.rank = p.rank || 0;\n\n            // if target, return true from the over event. this will cause katavorio to stop setting drops to hover\n            // if multipleDrop is set to false.\n            if (isTarget) {\n                dropOptions[root.jsPlumb.dragEvents.over] = function () { return true; };\n            }\n\n            // vanilla jsplumb only\n            if (p.allowLoopback === false) {\n                dropOptions.canDrop = function (_drag) {\n                    var de = _drag.getDragElement()._jsPlumbRelatedElement;\n                    return de !== elInfo.el;\n                };\n            }\n            _currentInstance.initDroppable(elInfo.el, dropOptions, \"internal\");\n\n            return _drop;\n\n        };\n\n        // see API docs\n        this.makeTarget = function (el, params, referenceParams) {\n\n            // put jsplumb ref into params without altering the params passed in\n            var p = root.jsPlumb.extend({_jsPlumb: this}, referenceParams);\n            root.jsPlumb.extend(p, params);\n\n            var maxConnections = p.maxConnections || -1,\n\n                _doOne = function (el) {\n\n                    // get the element's id and store the endpoint definition for it.  jsPlumb.connect calls will look for one of these,\n                    // and use the endpoint definition if found.\n                    // decode the info for this element (id and element)\n                    var elInfo = _info(el),\n                        elid = elInfo.id,\n                        dropOptions = root.jsPlumb.extend({}, p.dropOptions || {}),\n                        type = p.connectionType || \"default\";\n\n                    this.targetEndpointDefinitions[elid] = this.targetEndpointDefinitions[elid] || {};\n\n                    _ensureContainer(elid);\n\n                    // if this is a group and the user has not mandated a rank, set to -1 so that Nodes takes\n                    // precedence.\n                    if (elInfo.el._isJsPlumbGroup && dropOptions.rank == null) {\n                        dropOptions.rank = -1;\n                    }\n\n                    // store the definition\n                    var _def = {\n                        def: root.jsPlumb.extend({}, p),\n                        uniqueEndpoint: p.uniqueEndpoint,\n                        maxConnections: maxConnections,\n                        enabled: true\n                    };\n\n                    if (p.createEndpoint) {\n                        _def.uniqueEndpoint = true;\n                        _def.endpoint = _currentInstance.addEndpoint(el, _def.def);\n                        _def.endpoint.setDeleteOnEmpty(false);\n                    }\n\n                    elInfo.def = _def;\n                    this.targetEndpointDefinitions[elid][type] = _def;\n                    _makeElementDropHandler(elInfo, p, dropOptions, p.isSource === true, true);\n                    // stash the definition on the drop\n                    elInfo.el._katavorioDrop[elInfo.el._katavorioDrop.length - 1].targetDef = _def;\n\n                }.bind(this);\n\n            // make an array if only given one element\n            var inputs = el.length && el.constructor !== String ? el : [ el ];\n\n            // register each one in the list.\n            for (var i = 0, ii = inputs.length; i < ii; i++) {\n                _doOne(inputs[i]);\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.unmakeTarget = function (el, doNotClearArrays) {\n            var info = _info(el);\n            _currentInstance.destroyDroppable(info.el, \"internal\");\n            if (!doNotClearArrays) {\n                delete this.targetEndpointDefinitions[info.id];\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.makeSource = function (el, params, referenceParams) {\n            var p = root.jsPlumb.extend({_jsPlumb: this}, referenceParams);\n            root.jsPlumb.extend(p, params);\n            var type = p.connectionType || \"default\";\n            var aae = _currentInstance.deriveEndpointAndAnchorSpec(type);\n            p.endpoint = p.endpoint || aae.endpoints[0];\n            p.anchor = p.anchor || aae.anchors[0];\n            var maxConnections = p.maxConnections || -1,\n                onMaxConnections = p.onMaxConnections,\n                _doOne = function (elInfo) {\n                    // get the element's id and store the endpoint definition for it.  jsPlumb.connect calls will look for one of these,\n                    // and use the endpoint definition if found.\n                    var elid = elInfo.id,\n                        _del = this.getElement(elInfo.el);\n\n                    this.sourceEndpointDefinitions[elid] = this.sourceEndpointDefinitions[elid] || {};\n                    _ensureContainer(elid);\n\n                    var _def = {\n                        def:root.jsPlumb.extend({}, p),\n                        uniqueEndpoint: p.uniqueEndpoint,\n                        maxConnections: maxConnections,\n                        enabled: true\n                    };\n\n                    if (p.createEndpoint) {\n                        _def.uniqueEndpoint = true;\n                        _def.endpoint = _currentInstance.addEndpoint(el, _def.def);\n                        _def.endpoint.setDeleteOnEmpty(false);\n                    }\n\n                    this.sourceEndpointDefinitions[elid][type] = _def;\n                    elInfo.def = _def;\n\n                    var stopEvent = root.jsPlumb.dragEvents.stop,\n                        dragEvent = root.jsPlumb.dragEvents.drag,\n                        dragOptions = root.jsPlumb.extend({ }, p.dragOptions || {}),\n                        existingDrag = dragOptions.drag,\n                        existingStop = dragOptions.stop,\n                        ep = null,\n                        endpointAddedButNoDragYet = false;\n\n                    // set scope if its not set in dragOptions but was passed in in params\n                    dragOptions.scope = dragOptions.scope || p.scope;\n\n                    dragOptions[dragEvent] = _ju.wrap(dragOptions[dragEvent], function () {\n                        if (existingDrag) {\n                            existingDrag.apply(this, arguments);\n                        }\n                        endpointAddedButNoDragYet = false;\n                    });\n\n                    dragOptions[stopEvent] = _ju.wrap(dragOptions[stopEvent], function () {\n\n                        if (existingStop) {\n                            existingStop.apply(this, arguments);\n                        }\n                        this.currentlyDragging = false;\n                        if (ep._jsPlumb != null) { // if not cleaned up...\n\n                            // reset the anchor to the anchor that was initially provided. the one we were using to drag\n                            // the connection was just a placeholder that was located at the place the user pressed the\n                            // mouse button to initiate the drag.\n                            var anchorDef = p.anchor || this.Defaults.Anchor,\n                                oldAnchor = ep.anchor,\n                                oldConnection = ep.connections[0];\n\n                            var    newAnchor = this.makeAnchor(anchorDef, elid, this),\n                                _el = ep.element;\n\n                            // if the anchor has a 'positionFinder' set, then delegate to that function to find\n                            // out where to locate the anchor. issue 117.\n                            if (newAnchor.positionFinder != null) {\n                                var elPosition = _currentInstance.getOffset(_el),\n                                    elSize = this.getSize(_el),\n                                    dropPosition = { left: elPosition.left + (oldAnchor.x * elSize[0]), top: elPosition.top + (oldAnchor.y * elSize[1]) },\n                                    ap = newAnchor.positionFinder(dropPosition, elPosition, elSize, newAnchor.constructorParams);\n\n                                newAnchor.x = ap[0];\n                                newAnchor.y = ap[1];\n                            }\n\n                            ep.setAnchor(newAnchor, true);\n                            ep.repaint();\n                            this.repaint(ep.elementId);\n                            if (oldConnection != null) {\n                                this.repaint(oldConnection.targetId);\n                            }\n                        }\n                    }.bind(this));\n\n                    // when the user presses the mouse, add an Endpoint, if we are enabled.\n                    var mouseDownListener = function (e) {\n                        // on right mouse button, abort.\n                        if (e.which === 3 || e.button === 2) {\n                            return;\n                        }\n\n                        elid = this.getId(this.getElement(elInfo.el)); // elid might have changed since this method was called to configure the element.\n\n                        // TODO store def on element.\n                        var def = this.sourceEndpointDefinitions[elid][type];\n\n                        // if disabled, return.\n                        if (!def.enabled) {\n                            return;\n                        }\n\n                        // if a filter was given, run it, and return if it says no.\n                        if (p.filter) {\n                            var r = _ju.isString(p.filter) ? selectorFilter(e, elInfo.el, p.filter, this, p.filterExclude) : p.filter(e, elInfo.el);\n                            if (r === false) {\n                                return;\n                            }\n                        }\n\n                        // if maxConnections reached\n                        var sourceCount = this.select({source: elid}).length;\n                        if (def.maxConnections >= 0 && (sourceCount >= def.maxConnections)) {\n                            if (onMaxConnections) {\n                                onMaxConnections({\n                                    element: elInfo.el,\n                                    maxConnections: maxConnections\n                                }, e);\n                            }\n                            return false;\n                        }\n\n                        // find the position on the element at which the mouse was pressed; this is where the endpoint\n                        // will be located.\n                        var elxy = root.jsPlumb.getPositionOnElement(e, _del, _zoom);\n\n                        // we need to override the anchor in here, and force 'isSource', but we don't want to mess with\n                        // the params passed in, because after a connection is established we're going to reset the endpoint\n                        // to have the anchor we were given.\n                        var tempEndpointParams = {};\n                        root.jsPlumb.extend(tempEndpointParams, def.def);\n                        tempEndpointParams.isTemporarySource = true;\n                        tempEndpointParams.anchor = [ elxy[0], elxy[1] , 0, 0];\n                        tempEndpointParams.dragOptions = dragOptions;\n\n                        if (def.def.scope) {\n                            tempEndpointParams.scope = def.def.scope;\n                        }\n\n                        ep = this.addEndpoint(elid, tempEndpointParams);\n                        endpointAddedButNoDragYet = true;\n                        ep.setDeleteOnEmpty(true);\n\n                        // if unique endpoint and it's already been created, push it onto the endpoint we create. at the end\n                        // of a successful connection we'll switch to that endpoint.\n                        // TODO this is the same code as the programmatic endpoints create on line 1050 ish\n                        if (def.uniqueEndpoint) {\n                            if (!def.endpoint) {\n                                def.endpoint = ep;\n                                ep.setDeleteOnEmpty(false);\n                            }\n                            else {\n                                ep.finalEndpoint = def.endpoint;\n                            }\n                        }\n\n                        var _delTempEndpoint = function () {\n                            // this mouseup event is fired only if no dragging occurred, by jquery and yui, but for mootools\n                            // it is fired even if dragging has occurred, in which case we would blow away a perfectly\n                            // legitimate endpoint, were it not for this check.  the flag is set after adding an\n                            // endpoint and cleared in a drag listener we set in the dragOptions above.\n                            _currentInstance.off(ep.canvas, \"mouseup\", _delTempEndpoint);\n                            _currentInstance.off(elInfo.el, \"mouseup\", _delTempEndpoint);\n                            if (endpointAddedButNoDragYet) {\n                                endpointAddedButNoDragYet = false;\n                                _currentInstance.deleteEndpoint(ep);\n                            }\n                        };\n\n                        _currentInstance.on(ep.canvas, \"mouseup\", _delTempEndpoint);\n                        _currentInstance.on(elInfo.el, \"mouseup\", _delTempEndpoint);\n\n                        // optionally check for attributes to extract from the source element\n                        var payload = {};\n                        if (def.def.extract) {\n                            for (var att in def.def.extract) {\n                                var v = (e.srcElement || e.target).getAttribute(att);\n                                if (v) {\n                                    payload[def.def.extract[att]] = v;\n                                }\n                            }\n                        }\n\n                        // and then trigger its mousedown event, which will kick off a drag, which will start dragging\n                        // a new connection from this endpoint.\n                        _currentInstance.trigger(ep.canvas, \"mousedown\", e, payload);\n\n                        _ju.consume(e);\n\n                    }.bind(this);\n\n                    this.on(elInfo.el, \"mousedown\", mouseDownListener);\n                    _def.trigger = mouseDownListener;\n\n                    // if a filter was provided, set it as a dragFilter on the element,\n                    // to prevent the element drag function from kicking in when we want to\n                    // drag a new connection\n                    if (p.filter && (_ju.isString(p.filter) || _ju.isFunction(p.filter))) {\n                        _currentInstance.setDragFilter(elInfo.el, p.filter);\n                    }\n\n                    var dropOptions = root.jsPlumb.extend({}, p.dropOptions || {});\n\n                    _makeElementDropHandler(elInfo, p, dropOptions, true, p.isTarget === true);\n\n                }.bind(this);\n\n            var inputs = el.length && el.constructor !== String ? el : [ el ];\n            for (var i = 0, ii = inputs.length; i < ii; i++) {\n                _doOne(_info(inputs[i]));\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.unmakeSource = function (el, connectionType, doNotClearArrays) {\n            var info = _info(el);\n            _currentInstance.destroyDroppable(info.el, \"internal\");\n            var eldefs = this.sourceEndpointDefinitions[info.id];\n            if (eldefs) {\n                for (var def in eldefs) {\n                    if (connectionType == null || connectionType === def) {\n                        var mouseDownListener = eldefs[def].trigger;\n                        if (mouseDownListener) {\n                            _currentInstance.off(info.el, \"mousedown\", mouseDownListener);\n                        }\n                        if (!doNotClearArrays) {\n                            delete this.sourceEndpointDefinitions[info.id][def];\n                        }\n                    }\n                }\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.unmakeEverySource = function () {\n            for (var i in this.sourceEndpointDefinitions) {\n                _currentInstance.unmakeSource(i, null, true);\n            }\n\n            this.sourceEndpointDefinitions = {};\n            return this;\n        };\n\n        var _getScope = function (el, types, connectionType) {\n            types = _ju.isArray(types) ? types : [ types ];\n            var id = _getId(el);\n            connectionType = connectionType || \"default\";\n            for (var i = 0; i < types.length; i++) {\n                var eldefs = this[types[i]][id];\n                if (eldefs && eldefs[connectionType]) {\n                    return eldefs[connectionType].def.scope || this.Defaults.Scope;\n                }\n            }\n        }.bind(this);\n\n        var _setScope = function (el, scope, types, connectionType) {\n            types = _ju.isArray(types) ? types : [ types ];\n            var id = _getId(el);\n            connectionType = connectionType || \"default\";\n            for (var i = 0; i < types.length; i++) {\n                var eldefs = this[types[i]][id];\n                if (eldefs && eldefs[connectionType]) {\n                    eldefs[connectionType].def.scope = scope;\n                }\n            }\n\n        }.bind(this);\n\n        this.getScope = function (el, scope) {\n            return _getScope(el, [ \"sourceEndpointDefinitions\", \"targetEndpointDefinitions\" ]);\n        };\n        this.getSourceScope = function (el) {\n            return _getScope(el, \"sourceEndpointDefinitions\");\n        };\n        this.getTargetScope = function (el) {\n            return _getScope(el, \"targetEndpointDefinitions\");\n        };\n        this.setScope = function (el, scope, connectionType) {\n            this.setSourceScope(el, scope, connectionType);\n            this.setTargetScope(el, scope, connectionType);\n        };\n        this.setSourceScope = function (el, scope, connectionType) {\n            _setScope(el, scope, \"sourceEndpointDefinitions\", connectionType);\n            // we get the source scope during the mousedown event, but we also want to set this.\n            this.setDragScope(el, scope);\n        };\n        this.setTargetScope = function (el, scope, connectionType) {\n            _setScope(el, scope, \"targetEndpointDefinitions\", connectionType);\n            this.setDropScope(el, scope);\n        };\n\n        // see api docs\n        this.unmakeEveryTarget = function () {\n            for (var i in this.targetEndpointDefinitions) {\n                _currentInstance.unmakeTarget(i, true);\n            }\n\n            this.targetEndpointDefinitions = {};\n            return this;\n        };\n\n        // does the work of setting a source enabled or disabled.\n        var _setEnabled = function (type, el, state, toggle, connectionType) {\n            var a = type === \"source\" ? this.sourceEndpointDefinitions : this.targetEndpointDefinitions,\n                originalState, info, newState;\n\n            connectionType = connectionType || \"default\";\n\n            // a selector or an array\n            if (el.length && !_ju.isString(el)) {\n                originalState = [];\n                for (var i = 0, ii = el.length; i < ii; i++) {\n                    info = _info(el[i]);\n                    if (a[info.id] && a[info.id][connectionType]) {\n                        originalState[i] = a[info.id][connectionType].enabled;\n                        newState = toggle ? !originalState[i] : state;\n                        a[info.id][connectionType].enabled = newState;\n                        _currentInstance[newState ? \"removeClass\" : \"addClass\"](info.el, \"jtk-\" + type + \"-disabled\");\n                    }\n                }\n            }\n            // otherwise a DOM element or a String ID.\n            else {\n                info = _info(el);\n                var id = info.id;\n                if (a[id] && a[id][connectionType]) {\n                    originalState = a[id][connectionType].enabled;\n                    newState = toggle ? !originalState : state;\n                    a[id][connectionType].enabled = newState;\n                    _currentInstance[newState ? \"removeClass\" : \"addClass\"](info.el, \"jtk-\" + type + \"-disabled\");\n                }\n            }\n            return originalState;\n        }.bind(this);\n\n        var _first = function (el, fn) {\n            if (_ju.isString(el) || !el.length) {\n                return fn.apply(this, [ el ]);\n            }\n            else if (el.length) {\n                return fn.apply(this, [ el[0] ]);\n            }\n\n        }.bind(this);\n\n        this.toggleSourceEnabled = function (el, connectionType) {\n            _setEnabled(\"source\", el, null, true, connectionType);\n            return this.isSourceEnabled(el, connectionType);\n        };\n\n        this.setSourceEnabled = function (el, state, connectionType) {\n            return _setEnabled(\"source\", el, state, null, connectionType);\n        };\n        this.isSource = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var eldefs = this.sourceEndpointDefinitions[_info(_el).id];\n                return eldefs != null && eldefs[connectionType] != null;\n            }.bind(this));\n        };\n        this.isSourceEnabled = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var sep = this.sourceEndpointDefinitions[_info(_el).id];\n                return sep && sep[connectionType] && sep[connectionType].enabled === true;\n            }.bind(this));\n        };\n\n        this.toggleTargetEnabled = function (el, connectionType) {\n            _setEnabled(\"target\", el, null, true, connectionType);\n            return this.isTargetEnabled(el, connectionType);\n        };\n\n        this.isTarget = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var eldefs = this.targetEndpointDefinitions[_info(_el).id];\n                return eldefs != null && eldefs[connectionType] != null;\n            }.bind(this));\n        };\n        this.isTargetEnabled = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var tep = this.targetEndpointDefinitions[_info(_el).id];\n                return tep && tep[connectionType] && tep[connectionType].enabled === true;\n            }.bind(this));\n        };\n        this.setTargetEnabled = function (el, state, connectionType) {\n            return _setEnabled(\"target\", el, state, null, connectionType);\n        };\n\n// --------------------- end makeSource/makeTarget ----------------------------------------------\n\n        this.ready = function (fn) {\n            _currentInstance.bind(\"ready\", fn);\n        };\n\n        var _elEach = function(el, fn) {\n            // support both lists...\n            if (typeof el === 'object' && el.length) {\n                for (var i = 0, ii = el.length; i < ii; i++) {\n                    fn(el[i]);\n                }\n            }\n            else {// ...and single strings or elements.\n                fn(el);\n            }\n\n            return _currentInstance;\n        };\n\n        // repaint some element's endpoints and connections\n        this.repaint = function (el, ui, timestamp) {\n            return _elEach(el, function(_el) {\n                _draw(_el, ui, timestamp);\n            });\n        };\n\n        this.revalidate = function (el, timestamp, isIdAlready) {\n            return _elEach(el, function(_el) {\n                var elId = isIdAlready ? _el : _currentInstance.getId(_el);\n                _currentInstance.updateOffset({ elId: elId, recalc: true, timestamp:timestamp });\n                var dm = _currentInstance.getDragManager();\n                if (dm) {\n                    dm.updateOffsets(elId);\n                }\n                _currentInstance.repaint(_el);\n            });\n        };\n\n        // repaint every endpoint and connection.\n        this.repaintEverything = function () {\n            // TODO this timestamp causes continuous anchors to not repaint properly.\n            // fix this. do not just take out the timestamp. it runs a lot faster with\n            // the timestamp included.\n            var timestamp = _timestamp(), elId;\n\n            for (elId in endpointsByElement) {\n                _currentInstance.updateOffset({ elId: elId, recalc: true, timestamp: timestamp });\n            }\n\n            for (elId in endpointsByElement) {\n                _draw(elId, null, timestamp);\n            }\n\n            return this;\n        };\n\n        this.removeAllEndpoints = function (el, recurse, affectedElements) {\n            affectedElements = affectedElements || [];\n            var _one = function (_el) {\n                var info = _info(_el),\n                    ebe = endpointsByElement[info.id],\n                    i, ii;\n\n                if (ebe) {\n                    affectedElements.push(info);\n                    for (i = 0, ii = ebe.length; i < ii; i++) {\n                        _currentInstance.deleteEndpoint(ebe[i], false);\n                    }\n                }\n                delete endpointsByElement[info.id];\n\n                if (recurse) {\n                    if (info.el && info.el.nodeType !== 3 && info.el.nodeType !== 8) {\n                        for (i = 0, ii = info.el.childNodes.length; i < ii; i++) {\n                            _one(info.el.childNodes[i]);\n                        }\n                    }\n                }\n\n            };\n            _one(el);\n            return this;\n        };\n\n        var _doRemove = function(info, affectedElements) {\n            _currentInstance.removeAllEndpoints(info.id, true, affectedElements);\n            var dm = _currentInstance.getDragManager();\n            var _one = function(_info) {\n\n                if (dm) {\n                    dm.elementRemoved(_info.id);\n                }\n                _currentInstance.router.elementRemoved(_info.id);\n\n                if (_currentInstance.isSource(_info.el)) {\n                    _currentInstance.unmakeSource(_info.el);\n                }\n                if (_currentInstance.isTarget(_info.el)) {\n                    _currentInstance.unmakeTarget(_info.el);\n                }\n                _currentInstance.destroyDraggable(_info.el);\n                _currentInstance.destroyDroppable(_info.el);\n\n\n                delete _currentInstance.floatingConnections[_info.id];\n                delete managedElements[_info.id];\n                delete offsets[_info.id];\n                if (_info.el) {\n                    _currentInstance.removeElement(_info.el);\n                    _info.el._jsPlumb = null;\n                }\n            };\n\n            // remove all affected child elements\n            for (var ae = 1; ae < affectedElements.length; ae++) {\n                _one(affectedElements[ae]);\n            }\n            // and always remove the requested one from the dom.\n            _one(info);\n        };\n\n        /**\n         * Remove the given element, including cleaning up all endpoints registered for it.\n         * This is exposed in the public API but also used internally by jsPlumb when removing the\n         * element associated with a connection drag.\n         */\n        this.remove = function (el, doNotRepaint) {\n            var info = _info(el), affectedElements = [];\n            if (info.text && info.el.parentNode) {\n                info.el.parentNode.removeChild(info.el);\n            }\n            else if (info.id) {\n                _currentInstance.batch(function () {\n                    _doRemove(info, affectedElements);\n                }, doNotRepaint === true);\n            }\n            return _currentInstance;\n        };\n\n        this.empty = function (el, doNotRepaint) {\n            var affectedElements = [];\n            var _one = function(el, dontRemoveFocus) {\n                var info = _info(el);\n                if (info.text) {\n                    info.el.parentNode.removeChild(info.el);\n                }\n                else if (info.el) {\n                    while(info.el.childNodes.length > 0) {\n                        _one(info.el.childNodes[0]);\n                    }\n                    if (!dontRemoveFocus) {\n                        _doRemove(info, affectedElements);\n                    }\n                }\n            };\n\n            _currentInstance.batch(function() {\n                _one(el, true);\n            }, doNotRepaint === false);\n\n            return _currentInstance;\n        };\n\n        this.reset = function (doNotUnbindInstanceEventListeners) {\n            _currentInstance.silently(function() {\n                _hoverSuspended = false;\n                _currentInstance.removeAllGroups();\n                _currentInstance.removeGroupManager();\n                _currentInstance.deleteEveryEndpoint();\n                if (!doNotUnbindInstanceEventListeners) {\n                    _currentInstance.unbind();\n                }\n                this.targetEndpointDefinitions = {};\n                this.sourceEndpointDefinitions = {};\n                connections.length = 0;\n                if (this.doReset) {\n                    this.doReset();\n                }\n            }.bind(this));\n        };\n\n        var _clearObject = function (obj) {\n            if (obj.canvas && obj.canvas.parentNode) {\n                obj.canvas.parentNode.removeChild(obj.canvas);\n            }\n            obj.cleanup();\n            obj.destroy();\n        };\n\n        this.clear = function () {\n            _currentInstance.select().each(_clearObject);\n            _currentInstance.selectEndpoints().each(_clearObject);\n\n            endpointsByElement = {};\n            endpointsByUUID = {};\n        };\n\n        this.setDefaultScope = function (scope) {\n            DEFAULT_SCOPE = scope;\n            return _currentInstance;\n        };\n\n        this.deriveEndpointAndAnchorSpec = function(type, dontPrependDefault) {\n            var bits = ((dontPrependDefault ? \"\" : \"default \") + type).split(/[\\s]/), eps = null, ep = null, a = null, as = null;\n            for (var i = 0; i < bits.length; i++) {\n                var _t = _currentInstance.getType(bits[i], \"connection\");\n                if (_t) {\n                    if (_t.endpoints) {\n                        eps = _t.endpoints;\n                    }\n                    if (_t.endpoint) {\n                        ep = _t.endpoint;\n                    }\n                    if (_t.anchors) {\n                        as = _t.anchors;\n                    }\n                    if (_t.anchor) {\n                        a = _t.anchor;\n                    }\n                }\n            }\n            return { endpoints: eps ? eps : [ ep, ep ], anchors: as ? as : [a, a ]};\n        };\n\n        // sets the id of some element, changing whatever we need to to keep track.\n        this.setId = function (el, newId, doNotSetAttribute) {\n            //\n            var id;\n\n            if (_ju.isString(el)) {\n                id = el;\n            }\n            else {\n                el = this.getElement(el);\n                id = this.getId(el);\n            }\n\n            var sConns = this.getConnections({source: id, scope: '*'}, true),\n                tConns = this.getConnections({target: id, scope: '*'}, true);\n\n            newId = \"\" + newId;\n\n            if (!doNotSetAttribute) {\n                el = this.getElement(id);\n                this.setAttribute(el, \"id\", newId);\n            }\n            else {\n                el = this.getElement(newId);\n            }\n\n            endpointsByElement[newId] = endpointsByElement[id] || [];\n            for (var i = 0, ii = endpointsByElement[newId].length; i < ii; i++) {\n                endpointsByElement[newId][i].setElementId(newId);\n                endpointsByElement[newId][i].setReferenceElement(el);\n            }\n            delete endpointsByElement[id];\n\n            this.sourceEndpointDefinitions[newId] = this.sourceEndpointDefinitions[id];\n            delete this.sourceEndpointDefinitions[id];\n            this.targetEndpointDefinitions[newId] = this.targetEndpointDefinitions[id];\n            delete this.targetEndpointDefinitions[id];\n\n            this.router.changeId(id, newId);\n            var dm = this.getDragManager();\n            if (dm) {\n                dm.changeId(id, newId);\n            }\n            managedElements[newId] = managedElements[id];\n            delete managedElements[id];\n\n            var _conns = function (list, epIdx, type) {\n                for (var i = 0, ii = list.length; i < ii; i++) {\n                    list[i].endpoints[epIdx].setElementId(newId);\n                    list[i].endpoints[epIdx].setReferenceElement(el);\n                    list[i][type + \"Id\"] = newId;\n                    list[i][type] = el;\n                }\n            };\n            _conns(sConns, 0, \"source\");\n            _conns(tConns, 1, \"target\");\n\n            this.repaint(newId);\n        };\n\n        this.setDebugLog = function (debugLog) {\n            log = debugLog;\n        };\n\n        this.setSuspendDrawing = function (val, repaintAfterwards) {\n            var curVal = _suspendDrawing;\n            _suspendDrawing = val;\n            if (val) {\n                _suspendedAt = new Date().getTime();\n            } else {\n                _suspendedAt = null;\n            }\n            if (repaintAfterwards) {\n                this.repaintEverything();\n            }\n            return curVal;\n        };\n\n        // returns whether or not drawing is currently suspended.\n        this.isSuspendDrawing = function () {\n            return _suspendDrawing;\n        };\n\n        // return timestamp for when drawing was suspended.\n        this.getSuspendedAt = function () {\n            return _suspendedAt;\n        };\n\n        this.batch = function (fn, doNotRepaintAfterwards) {\n            var _wasSuspended = this.isSuspendDrawing();\n            if (!_wasSuspended) {\n                this.setSuspendDrawing(true);\n            }\n            try {\n                fn();\n            }\n            catch (e) {\n                _ju.log(\"Function run while suspended failed\", e);\n            }\n            if (!_wasSuspended) {\n                this.setSuspendDrawing(false, !doNotRepaintAfterwards);\n            }\n        };\n\n        this.doWhileSuspended = this.batch;\n\n        this.getCachedData = _getCachedData;\n        this.timestamp = _timestamp;\n        this.show = function (el, changeEndpoints) {\n            _setVisible(el, \"block\", changeEndpoints);\n            return _currentInstance;\n        };\n\n        // TODO: update this method to return the current state.\n        this.toggleVisible = _toggleVisible;\n        this.addListener = this.bind;\n\n        var floatingConnections = [];\n        this.registerFloatingConnection = function(info, conn, ep) {\n            floatingConnections[info.id] = conn;\n            // only register for the target endpoint; we will not be dragging the source at any time\n            // before this connection is either discarded or made into a permanent connection.\n            _ju.addToList(endpointsByElement, info.id, ep);\n        };\n        this.getFloatingConnectionFor = function(id) {\n            return floatingConnections[id];\n        };\n\n        this.listManager = new root.jsPlumbListManager(this, this.Defaults.ListStyle);\n    };\n\n    _ju.extend(root.jsPlumbInstance, _ju.EventGenerator, {\n        setAttribute: function (el, a, v) {\n            this.setAttribute(el, a, v);\n        },\n        getAttribute: function (el, a) {\n            return this.getAttribute(root.jsPlumb.getElement(el), a);\n        },\n        convertToFullOverlaySpec: function(spec) {\n            if (_ju.isString(spec)) {\n                spec = [ spec, { } ];\n            }\n            spec[1].id = spec[1].id || _ju.uuid();\n            return spec;\n        },\n        registerConnectionType: function (id, type) {\n            this._connectionTypes[id] = root.jsPlumb.extend({}, type);\n            if (type.overlays) {\n                var to = {};\n                for (var i = 0; i < type.overlays.length; i++) {\n                    // if a string, convert to object representation so that we can store the typeid on it.\n                    // also assign an id.\n                    var fo = this.convertToFullOverlaySpec(type.overlays[i]);\n                    to[fo[1].id] = fo;\n                }\n                this._connectionTypes[id].overlays = to;\n            }\n        },\n        registerConnectionTypes: function (types) {\n            for (var i in types) {\n                this.registerConnectionType(i, types[i]);\n            }\n        },\n        registerEndpointType: function (id, type) {\n            this._endpointTypes[id] = root.jsPlumb.extend({}, type);\n            if (type.overlays) {\n                var to = {};\n                for (var i = 0; i < type.overlays.length; i++) {\n                    // if a string, convert to object representation so that we can store the typeid on it.\n                    // also assign an id.\n                    var fo = this.convertToFullOverlaySpec(type.overlays[i]);\n                    to[fo[1].id] = fo;\n                }\n                this._endpointTypes[id].overlays = to;\n            }\n        },\n        registerEndpointTypes: function (types) {\n            for (var i in types) {\n                this.registerEndpointType(i, types[i]);\n            }\n        },\n        getType: function (id, typeDescriptor) {\n            return typeDescriptor === \"connection\" ? this._connectionTypes[id] : this._endpointTypes[id];\n        },\n        setIdChanged: function (oldId, newId) {\n            this.setId(oldId, newId, true);\n        },\n        // set parent: change the parent for some node and update all the registrations we need to.\n        setParent: function (el, newParent) {\n            var _dom = this.getElement(el),\n                _id = this.getId(_dom),\n                _pdom = this.getElement(newParent),\n                _pid = this.getId(_pdom),\n                dm = this.getDragManager();\n\n            _dom.parentNode.removeChild(_dom);\n            _pdom.appendChild(_dom);\n            if (dm) {\n                dm.setParent(_dom, _id, _pdom, _pid);\n            }\n        },\n        extend: function (o1, o2, names) {\n            var i;\n            if (names) {\n                for (i = 0; i < names.length; i++) {\n                    o1[names[i]] = o2[names[i]];\n                }\n            }\n            else {\n                for (i in o2) {\n                    o1[i] = o2[i];\n                }\n            }\n\n            return o1;\n        },\n        floatingConnections: {},\n        getFloatingAnchorIndex: function (jpc) {\n            return jpc.endpoints[0].isFloating() ? 0 : jpc.endpoints[1].isFloating() ? 1 : -1;\n        },\n        proxyConnection :function(connection, index, proxyEl, proxyElId, endpointGenerator, anchorGenerator) {\n            var proxyEp,\n                originalElementId = connection.endpoints[index].elementId,\n                originalEndpoint = connection.endpoints[index];\n\n            connection.proxies = connection.proxies || [];\n            if(connection.proxies[index]) {\n                proxyEp = connection.proxies[index].ep;\n            }else {\n                proxyEp = this.addEndpoint(proxyEl, {\n                    endpoint:endpointGenerator(connection, index),\n                    anchor:anchorGenerator(connection, index),\n                    parameters:{\n                        isProxyEndpoint:true\n                    }\n                });\n            }\n            proxyEp.setDeleteOnEmpty(true);\n\n            // for this index, stash proxy info: the new EP, the original EP.\n            connection.proxies[index] = { ep:proxyEp, originalEp: originalEndpoint };\n\n            // and advise the anchor manager\n            if (index === 0) {\n                this.router.sourceOrTargetChanged(originalElementId, proxyElId, connection, proxyEl, 0);\n            }\n            else {\n                this.router.sourceOrTargetChanged(originalElementId, proxyElId, connection, proxyEl, 1);\n            }\n\n            // detach the original EP from the connection.\n            originalEndpoint.detachFromConnection(connection, null, true);\n\n            // set the proxy as the new ep\n            proxyEp.connections = [ connection ];\n            connection.endpoints[index] = proxyEp;\n\n            originalEndpoint.setVisible(false);\n\n            connection.setVisible(true);\n\n            this.revalidate(proxyEl);\n        },\n        unproxyConnection : function(connection, index, proxyElId) {\n            // if connection cleaned up, no proxies, or none for this end of the connection, abort.\n            if (connection._jsPlumb == null || connection.proxies == null || connection.proxies[index] == null) {\n                return;\n            }\n\n            var originalElement = connection.proxies[index].originalEp.element,\n                originalElementId = connection.proxies[index].originalEp.elementId;\n\n            connection.endpoints[index] = connection.proxies[index].originalEp;\n            // and advise the anchor manager\n            if (index === 0) {\n                // TODO why are there two differently named methods? Why is there not one method that says \"some end of this\n                // connection changed (you give the index), and here's the new element and element id.\"\n                this.router.sourceOrTargetChanged(proxyElId, originalElementId, connection, originalElement, 0);\n            }\n            else {\n                this.router.sourceOrTargetChanged(proxyElId, originalElementId, connection, originalElement, 1);\n            }\n\n            // detach the proxy EP from the connection (which will cause it to be removed as we no longer need it)\n            connection.proxies[index].ep.detachFromConnection(connection, null);\n\n            connection.proxies[index].originalEp.addConnection(connection);\n            if(connection.isVisible()) {\n                connection.proxies[index].originalEp.setVisible(true);\n            }\n\n            // cleanup\n            delete connection.proxies[index];\n        }\n    });\n\n// --------------------- static instance + module registration -------------------------------------------\n\n// create static instance and assign to window if window exists.\n    var jsPlumb = new jsPlumbInstance();\n    // register on 'root' (lets us run on server or browser)\n    root.jsPlumb = jsPlumb;\n    // add 'getInstance' method to static instance\n    jsPlumb.getInstance = function (_defaults, overrideFns) {\n        var j = new jsPlumbInstance(_defaults);\n        if (overrideFns) {\n            for (var ovf in overrideFns) {\n                j[ovf] = overrideFns[ovf];\n            }\n        }\n        j.init();\n        return j;\n    };\n    jsPlumb.each = function (spec, fn) {\n        if (spec == null) {\n            return;\n        }\n        if (typeof spec === \"string\") {\n            fn(jsPlumb.getElement(spec));\n        }\n        else if (spec.length != null) {\n            for (var i = 0; i < spec.length; i++) {\n                fn(jsPlumb.getElement(spec[i]));\n            }\n        }\n        else {\n            fn(spec);\n        } // assume it's an element.\n    };\n\n    // CommonJS\n    if (typeof exports !== 'undefined') {\n        exports.jsPlumb = jsPlumb;\n    }\n\n// --------------------- end static instance + AMD registration -------------------------------------------\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function() {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    // ------------------------------ BEGIN OverlayCapablejsPlumbUIComponent --------------------------------------------\n\n    var _internalLabelOverlayId = \"__label\",\n    // this is a shortcut helper method to let people add a label as\n    // overlay.\n        _makeLabelOverlay = function (component, params) {\n\n            var _params = {\n                    cssClass: params.cssClass,\n                    labelStyle: component.labelStyle,\n                    id: _internalLabelOverlayId,\n                    component: component,\n                    _jsPlumb: component._jsPlumb.instance  // TODO not necessary, since the instance can be accessed through the component.\n                },\n                mergedParams = _jp.extend(_params, params);\n\n            return new _jp.Overlays[component._jsPlumb.instance.getRenderMode()].Label(mergedParams);\n        },\n        _processOverlay = function (component, o) {\n            var _newOverlay = null;\n            if (_ju.isArray(o)) {\t// this is for the shorthand [\"Arrow\", { width:50 }] syntax\n                // there's also a three arg version:\n                // [\"Arrow\", { width:50 }, {location:0.7}]\n                // which merges the 3rd arg into the 2nd.\n                var type = o[0],\n                // make a copy of the object so as not to mess up anyone else's reference...\n                    p = _jp.extend({component: component, _jsPlumb: component._jsPlumb.instance}, o[1]);\n                if (o.length === 3) {\n                    _jp.extend(p, o[2]);\n                }\n                _newOverlay = new _jp.Overlays[component._jsPlumb.instance.getRenderMode()][type](p);\n            } else if (o.constructor === String) {\n                _newOverlay = new _jp.Overlays[component._jsPlumb.instance.getRenderMode()][o]({component: component, _jsPlumb: component._jsPlumb.instance});\n            } else {\n                _newOverlay = o;\n            }\n\n            _newOverlay.id = _newOverlay.id || _ju.uuid();\n            component.cacheTypeItem(\"overlay\", _newOverlay, _newOverlay.id);\n            component._jsPlumb.overlays[_newOverlay.id] = _newOverlay;\n\n            return _newOverlay;\n        };\n\n    _jp.OverlayCapableJsPlumbUIComponent = function (params) {\n\n        root.jsPlumbUIComponent.apply(this, arguments);\n        this._jsPlumb.overlays = {};\n        this._jsPlumb.overlayPositions = {};\n\n        if (params.label) {\n            this.getDefaultType().overlays[_internalLabelOverlayId] = [\"Label\", {\n                label: params.label,\n                location: params.labelLocation || this.defaultLabelLocation || 0.5,\n                labelStyle: params.labelStyle || this._jsPlumb.instance.Defaults.LabelStyle,\n                id:_internalLabelOverlayId\n            }];\n        }\n\n        this.setListenerComponent = function (c) {\n            if (this._jsPlumb) {\n                for (var i in this._jsPlumb.overlays) {\n                    this._jsPlumb.overlays[i].setListenerComponent(c);\n                }\n            }\n        };\n    };\n\n    _jp.OverlayCapableJsPlumbUIComponent.applyType = function (component, t) {\n        if (t.overlays) {\n            // loop through the ones in the type. if already present on the component,\n            // dont remove or re-add.\n            var keep = {}, i;\n\n            for (i in t.overlays) {\n\n                var existing = component._jsPlumb.overlays[t.overlays[i][1].id];\n                if (existing) {\n                    // maybe update from data, if there were parameterised values for instance.\n                    existing.updateFrom(t.overlays[i][1]);\n                    keep[t.overlays[i][1].id] = true;\n\n                    existing.reattach(component._jsPlumb.instance, component);\n                }\n                else {\n                    var c = component.getCachedTypeItem(\"overlay\", t.overlays[i][1].id);\n                    if (c != null) {\n                        c.reattach(component._jsPlumb.instance, component);\n                        c.setVisible(true);\n                        // maybe update from data, if there were parameterised values for instance.\n                        c.updateFrom(t.overlays[i][1]);\n                        component._jsPlumb.overlays[c.id] = c;\n                    }\n                    else {\n                        c = component.addOverlay(t.overlays[i], true);\n                    }\n                    keep[c.id] = true;\n                }\n            }\n\n            // now loop through the full overlays and remove those that we dont want to keep\n            for (i in component._jsPlumb.overlays) {\n                if (keep[component._jsPlumb.overlays[i].id] == null) {\n                    component.removeOverlay(component._jsPlumb.overlays[i].id, true); // remove overlay but dont clean it up.\n                    // that would remove event listeners etc; overlays are never discarded by the types stuff, they are\n                    // just detached/reattached.\n                }\n            }\n        }\n    };\n\n    _ju.extend(_jp.OverlayCapableJsPlumbUIComponent, root.jsPlumbUIComponent, {\n\n        setHover: function (hover, ignoreAttachedElements) {\n            if (this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\n                for (var i in this._jsPlumb.overlays) {\n                    this._jsPlumb.overlays[i][hover ? \"addClass\" : \"removeClass\"](this._jsPlumb.instance.hoverClass);\n                }\n            }\n        },\n        addOverlay: function (overlay, doNotRepaint) {\n            var o = _processOverlay(this, overlay);\n\n            if (this.getData && o.type === \"Label\" && _ju.isArray(overlay)) {\n                //\n                // component data might contain label location - look for it here.\n                var d = this.getData(), p = overlay[1];\n                if (d) {\n                    var locationAttribute = p.labelLocationAttribute || \"labelLocation\";\n                    var loc = d ? d[locationAttribute] : null;\n\n                    if (loc) {\n                        o.loc = loc;\n                    }\n                }\n            }\n\n            if (!doNotRepaint) {\n                this.repaint();\n            }\n            return o;\n        },\n        getOverlay: function (id) {\n            return this._jsPlumb.overlays[id];\n        },\n        getOverlays: function () {\n            return this._jsPlumb.overlays;\n        },\n        hideOverlay: function (id) {\n            var o = this.getOverlay(id);\n            if (o) {\n                o.hide();\n            }\n        },\n        hideOverlays: function () {\n            for (var i in this._jsPlumb.overlays) {\n                this._jsPlumb.overlays[i].hide();\n            }\n        },\n        showOverlay: function (id) {\n            var o = this.getOverlay(id);\n            if (o) {\n                o.show();\n            }\n        },\n        showOverlays: function () {\n            for (var i in this._jsPlumb.overlays) {\n                this._jsPlumb.overlays[i].show();\n            }\n        },\n        removeAllOverlays: function (doNotRepaint) {\n            for (var i in this._jsPlumb.overlays) {\n                if (this._jsPlumb.overlays[i].cleanup) {\n                    this._jsPlumb.overlays[i].cleanup();\n                }\n            }\n\n            this._jsPlumb.overlays = {};\n            this._jsPlumb.overlayPositions = null;\n            this._jsPlumb.overlayPlacements= {};\n            if (!doNotRepaint) {\n                this.repaint();\n            }\n        },\n        removeOverlay: function (overlayId, dontCleanup) {\n            var o = this._jsPlumb.overlays[overlayId];\n            if (o) {\n                o.setVisible(false);\n                if (!dontCleanup && o.cleanup) {\n                    o.cleanup();\n                }\n                delete this._jsPlumb.overlays[overlayId];\n                if (this._jsPlumb.overlayPositions) {\n                    delete this._jsPlumb.overlayPositions[overlayId];\n                }\n\n                if (this._jsPlumb.overlayPlacements) {\n                    delete this._jsPlumb.overlayPlacements[overlayId];\n                }\n            }\n        },\n        removeOverlays: function () {\n            for (var i = 0, j = arguments.length; i < j; i++) {\n                this.removeOverlay(arguments[i]);\n            }\n        },\n        moveParent: function (newParent) {\n            if (this.bgCanvas) {\n                this.bgCanvas.parentNode.removeChild(this.bgCanvas);\n                newParent.appendChild(this.bgCanvas);\n            }\n\n            if (this.canvas && this.canvas.parentNode) {\n                this.canvas.parentNode.removeChild(this.canvas);\n                newParent.appendChild(this.canvas);\n\n                for (var i in this._jsPlumb.overlays) {\n                    if (this._jsPlumb.overlays[i].isAppendedAtTopLevel) {\n                        var el = this._jsPlumb.overlays[i].getElement();\n                        el.parentNode.removeChild(el);\n                        newParent.appendChild(el);\n                    }\n                }\n            }\n        },\n        getLabel: function () {\n            var lo = this.getOverlay(_internalLabelOverlayId);\n            return lo != null ? lo.getLabel() : null;\n        },\n        getLabelOverlay: function () {\n            return this.getOverlay(_internalLabelOverlayId);\n        },\n        setLabel: function (l) {\n            var lo = this.getOverlay(_internalLabelOverlayId);\n            if (!lo) {\n                var params = l.constructor === String || l.constructor === Function ? { label: l } : l;\n                lo = _makeLabelOverlay(this, params);\n                this._jsPlumb.overlays[_internalLabelOverlayId] = lo;\n            }\n            else {\n                if (l.constructor === String || l.constructor === Function) {\n                    lo.setLabel(l);\n                }\n                else {\n                    if (l.label) {\n                        lo.setLabel(l.label);\n                    }\n                    if (l.location) {\n                        lo.setLocation(l.location);\n                    }\n                }\n            }\n\n            if (!this._jsPlumb.instance.isSuspendDrawing()) {\n                this.repaint();\n            }\n        },\n        cleanup: function (force) {\n            for (var i in this._jsPlumb.overlays) {\n                this._jsPlumb.overlays[i].cleanup(force);\n                this._jsPlumb.overlays[i].destroy(force);\n            }\n            if (force) {\n                this._jsPlumb.overlays = {};\n                this._jsPlumb.overlayPositions = null;\n            }\n        },\n        setVisible: function (v) {\n            this[v ? \"showOverlays\" : \"hideOverlays\"]();\n        },\n        setAbsoluteOverlayPosition: function (overlay, xy) {\n            this._jsPlumb.overlayPositions[overlay.id] = xy;\n        },\n        getAbsoluteOverlayPosition: function (overlay) {\n            return this._jsPlumb.overlayPositions ? this._jsPlumb.overlayPositions[overlay.id] : null;\n        },\n        _clazzManip:function(action, clazz, dontUpdateOverlays) {\n            if (!dontUpdateOverlays) {\n                for (var i in this._jsPlumb.overlays) {\n                    this._jsPlumb.overlays[i][action + \"Class\"](clazz);\n                }\n            }\n        },\n        addClass:function(clazz, dontUpdateOverlays) {\n            this._clazzManip(\"add\", clazz, dontUpdateOverlays);\n        },\n        removeClass:function(clazz, dontUpdateOverlays) {\n            this._clazzManip(\"remove\", clazz, dontUpdateOverlays);\n        }\n    });\n\n// ------------------------------ END OverlayCapablejsPlumbUIComponent --------------------------------------------\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the code for Endpoints.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    // create the drag handler for a connection\n    var _makeConnectionDragHandler = function (endpoint, placeholder, _jsPlumb) {\n        var stopped = false;\n        return {\n            drag: function () {\n                if (stopped) {\n                    stopped = false;\n                    return true;\n                }\n\n                if (placeholder.element) {\n                    var _ui = _jsPlumb.getUIPosition(arguments, _jsPlumb.getZoom());\n                    if (_ui != null) {\n                        _jsPlumb.setPosition(placeholder.element, _ui);\n                    }\n                    _jsPlumb.repaint(placeholder.element, _ui);\n                    // always repaint the source endpoint, because only continuous/dynamic anchors cause the endpoint\n                    // to be repainted, so static anchors need to be told (or the endpoint gets dragged around)\n                    endpoint.paint({anchorPoint:endpoint.anchor.getCurrentLocation({element:endpoint})});\n                }\n            },\n            stopDrag: function () {\n                stopped = true;\n            }\n        };\n    };\n\n    // creates a placeholder div for dragging purposes, adds it, and pre-computes its offset.\n    var _makeDraggablePlaceholder = function (placeholder, _jsPlumb, ipco, ips) {\n        var n = _jsPlumb.createElement(\"div\", { position : \"absolute\" });\n        _jsPlumb.appendElement(n);\n        var id = _jsPlumb.getId(n);\n        _jsPlumb.setPosition(n, ipco);\n        n.style.width = ips[0] + \"px\";\n        n.style.height = ips[1] + \"px\";\n        _jsPlumb.manage(id, n, true); // TRANSIENT MANAGE\n        // create and assign an id, and initialize the offset.\n        placeholder.id = id;\n        placeholder.element = n;\n    };\n\n    // create a floating endpoint (for drag connections)\n    var _makeFloatingEndpoint = function (paintStyle, referenceAnchor, endpoint, referenceCanvas, sourceElement, _jsPlumb, _newEndpoint, scope) {\n        var floatingAnchor = new _jp.FloatingAnchor({ reference: referenceAnchor, referenceCanvas: referenceCanvas, jsPlumbInstance: _jsPlumb });\n        return _newEndpoint({\n            paintStyle: paintStyle,\n            endpoint: endpoint,\n            anchor: floatingAnchor,\n            source: sourceElement,\n            scope: scope\n        });\n    };\n\n    var typeParameters = [ \"connectorStyle\", \"connectorHoverStyle\", \"connectorOverlays\",\n        \"connector\", \"connectionType\", \"connectorClass\", \"connectorHoverClass\" ];\n\n    // a helper function that tries to find a connection to the given element, and returns it if so. if elementWithPrecedence is null,\n    // or no connection to it is found, we return the first connection in our list.\n    var findConnectionToUseForDynamicAnchor = function (ep, elementWithPrecedence) {\n        var idx = 0;\n        if (elementWithPrecedence != null) {\n            for (var i = 0; i < ep.connections.length; i++) {\n                if (ep.connections[i].sourceId === elementWithPrecedence || ep.connections[i].targetId === elementWithPrecedence) {\n                    idx = i;\n                    break;\n                }\n            }\n        }\n\n        return ep.connections[idx];\n    };\n\n    _jp.Endpoint = function (params) {\n        var _jsPlumb = params._jsPlumb,\n            _newConnection = params.newConnection,\n            _newEndpoint = params.newEndpoint;\n\n        this.idPrefix = \"_jsplumb_e_\";\n        this.defaultLabelLocation = [ 0.5, 0.5 ];\n        this.defaultOverlayKeys = [\"Overlays\", \"EndpointOverlays\"];\n        _jp.OverlayCapableJsPlumbUIComponent.apply(this, arguments);\n\n// TYPE\n\n        this.appendToDefaultType({\n            connectionType:params.connectionType,\n            maxConnections: params.maxConnections == null ? this._jsPlumb.instance.Defaults.MaxConnections : params.maxConnections, // maximum number of connections this endpoint can be the source of.,\n            paintStyle: params.endpointStyle || params.paintStyle || params.style || this._jsPlumb.instance.Defaults.EndpointStyle || _jp.Defaults.EndpointStyle,\n            hoverPaintStyle: params.endpointHoverStyle || params.hoverPaintStyle || this._jsPlumb.instance.Defaults.EndpointHoverStyle || _jp.Defaults.EndpointHoverStyle,\n            connectorStyle: params.connectorStyle,\n            connectorHoverStyle: params.connectorHoverStyle,\n            connectorClass: params.connectorClass,\n            connectorHoverClass: params.connectorHoverClass,\n            connectorOverlays: params.connectorOverlays,\n            connector: params.connector,\n            connectorTooltip: params.connectorTooltip\n        });\n\n// END TYPE\n\n        this._jsPlumb.enabled = !(params.enabled === false);\n        this._jsPlumb.visible = true;\n        this.element = _jp.getElement(params.source);\n        this._jsPlumb.uuid = params.uuid;\n        this._jsPlumb.floatingEndpoint = null;\n        var inPlaceCopy = null;\n        if (this._jsPlumb.uuid) {\n            params.endpointsByUUID[this._jsPlumb.uuid] = this;\n        }\n        this.elementId = params.elementId;\n        this.dragProxy = params.dragProxy;\n\n        this._jsPlumb.connectionCost = params.connectionCost;\n        this._jsPlumb.connectionsDirected = params.connectionsDirected;\n        this._jsPlumb.currentAnchorClass = \"\";\n        this._jsPlumb.events = {};\n\n        var deleteOnEmpty = params.deleteOnEmpty === true;\n        this.setDeleteOnEmpty = function(d) {\n            deleteOnEmpty = d;\n        };\n\n        var _updateAnchorClass = function () {\n            // stash old, get new\n            var oldAnchorClass = _jsPlumb.endpointAnchorClassPrefix + \"-\" + this._jsPlumb.currentAnchorClass;\n            this._jsPlumb.currentAnchorClass = this.anchor.getCssClass();\n            var anchorClass = _jsPlumb.endpointAnchorClassPrefix + (this._jsPlumb.currentAnchorClass ? \"-\" + this._jsPlumb.currentAnchorClass : \"\");\n\n            this.removeClass(oldAnchorClass);\n            this.addClass(anchorClass);\n            // add and remove at the same time to reduce the number of reflows.\n            _jp.updateClasses(this.element, anchorClass, oldAnchorClass);\n        }.bind(this);\n\n        this.prepareAnchor = function(anchorParams) {\n            var a = this._jsPlumb.instance.makeAnchor(anchorParams, this.elementId, _jsPlumb);\n            a.bind(\"anchorChanged\", function (currentAnchor) {\n                this.fire(\"anchorChanged\", {endpoint: this, anchor: currentAnchor});\n                _updateAnchorClass();\n            }.bind(this));\n            return a;\n        };\n\n        this.setPreparedAnchor = function(anchor, doNotRepaint) {\n            this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId);\n            this.anchor = anchor;\n            _updateAnchorClass();\n\n            if (!doNotRepaint) {\n                this._jsPlumb.instance.repaint(this.elementId);\n            }\n\n            return this;\n        };\n\n        this.setAnchor = function (anchorParams, doNotRepaint) {\n            var a = this.prepareAnchor(anchorParams);\n            this.setPreparedAnchor(a, doNotRepaint);\n            return this;\n        };\n\n        var internalHover = function (state) {\n            if (this.connections.length > 0) {\n                for (var i = 0; i < this.connections.length; i++) {\n                    this.connections[i].setHover(state, false);\n                }\n            }\n            else {\n                this.setHover(state);\n            }\n        }.bind(this);\n\n        this.bind(\"mouseover\", function () {\n            internalHover(true);\n        });\n        this.bind(\"mouseout\", function () {\n            internalHover(false);\n        });\n\n        // ANCHOR MANAGER\n        if (!params._transient) { // in place copies, for example, are transient.  they will never need to be retrieved during a paint cycle, because they dont move, and then they are deleted.\n            this._jsPlumb.instance.anchorManager.add(this, this.elementId);\n        }\n\n        this.prepareEndpoint = function(ep, typeId) {\n            var _e = function (t, p) {\n                var rm = _jsPlumb.getRenderMode();\n                if (_jp.Endpoints[rm][t]) {\n                    return new _jp.Endpoints[rm][t](p);\n                }\n                if (!_jsPlumb.Defaults.DoNotThrowErrors) {\n                    throw { msg: \"jsPlumb: unknown endpoint type '\" + t + \"'\" };\n                }\n            };\n\n            var endpointArgs = {\n                _jsPlumb: this._jsPlumb.instance,\n                cssClass: params.cssClass,\n                container: params.container,\n                tooltip: params.tooltip,\n                connectorTooltip: params.connectorTooltip,\n                endpoint: this\n            };\n\n            var endpoint;\n\n            if (_ju.isString(ep)) {\n                endpoint = _e(ep, endpointArgs);\n            }\n            else if (_ju.isArray(ep)) {\n                endpointArgs = _ju.merge(ep[1], endpointArgs);\n                endpoint = _e(ep[0], endpointArgs);\n            }\n            else {\n                endpoint = ep.clone();\n            }\n\n            // assign a clone function using a copy of endpointArgs. this is used when a drag starts: the endpoint that was dragged is cloned,\n            // and the clone is left in its place while the original one goes off on a magical journey.\n            // the copy is to get around a closure problem, in which endpointArgs ends up getting shared by\n            // the whole world.\n            //var argsForClone = jsPlumb.extend({}, endpointArgs);\n            endpoint.clone = function () {\n                // TODO this, and the code above, can be refactored to be more dry.\n                if (_ju.isString(ep)) {\n                    return _e(ep, endpointArgs);\n                }\n                else if (_ju.isArray(ep)) {\n                    endpointArgs = _ju.merge(ep[1], endpointArgs);\n                    return _e(ep[0], endpointArgs);\n                }\n            }.bind(this);\n\n            endpoint.typeId = typeId;\n            return endpoint;\n        };\n\n        this.setEndpoint = function(ep, doNotRepaint) {\n            var _ep = this.prepareEndpoint(ep);\n            this.setPreparedEndpoint(_ep, true);\n        };\n\n        this.setPreparedEndpoint = function (ep, doNotRepaint) {\n            if (this.endpoint != null) {\n                this.endpoint.cleanup();\n                this.endpoint.destroy();\n            }\n            this.endpoint = ep;\n            this.type = this.endpoint.type;\n            this.canvas = this.endpoint.canvas;\n        };\n\n        _jp.extend(this, params, typeParameters);\n\n        this.isSource = params.isSource || false;\n        this.isTemporarySource = params.isTemporarySource || false;\n        this.isTarget = params.isTarget || false;\n\n        this.connections = params.connections || [];\n        this.connectorPointerEvents = params[\"connector-pointer-events\"];\n\n        this.scope = params.scope || _jsPlumb.getDefaultScope();\n        this.timestamp = null;\n        this.reattachConnections = params.reattach || _jsPlumb.Defaults.ReattachConnections;\n        this.connectionsDetachable = _jsPlumb.Defaults.ConnectionsDetachable;\n        if (params.connectionsDetachable === false || params.detachable === false) {\n            this.connectionsDetachable = false;\n        }\n        this.dragAllowedWhenFull = params.dragAllowedWhenFull !== false;\n\n        if (params.onMaxConnections) {\n            this.bind(\"maxConnections\", params.onMaxConnections);\n        }\n\n        //\n        // add a connection. not part of public API.\n        //\n        this.addConnection = function (connection) {\n            this.connections.push(connection);\n            this[(this.connections.length > 0 ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointConnectedClass);\n            this[(this.isFull() ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointFullClass);\n        };\n\n        this.detachFromConnection = function (connection, idx, doNotCleanup) {\n            idx = idx == null ? this.connections.indexOf(connection) : idx;\n            if (idx >= 0) {\n                this.connections.splice(idx, 1);\n                this[(this.connections.length > 0 ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointConnectedClass);\n                this[(this.isFull() ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointFullClass);\n            }\n\n            if (!doNotCleanup && deleteOnEmpty && this.connections.length === 0) {\n                _jsPlumb.deleteObject({\n                    endpoint: this,\n                    fireEvent: false,\n                    deleteAttachedObjects: doNotCleanup !== true\n                });\n            }\n        };\n\n        this.deleteEveryConnection = function(params) {\n            var c = this.connections.length;\n            for (var i = 0; i < c; i++) {\n                _jsPlumb.deleteConnection(this.connections[0], params);\n            }\n        };\n\n        this.detachFrom = function (targetEndpoint, fireEvent, originalEvent) {\n            var c = [];\n            for (var i = 0; i < this.connections.length; i++) {\n                if (this.connections[i].endpoints[1] === targetEndpoint || this.connections[i].endpoints[0] === targetEndpoint) {\n                    c.push(this.connections[i]);\n                }\n            }\n            for (var j = 0, count = c.length; j < count; j++) {\n                _jsPlumb.deleteConnection(c[0]);\n            }\n            return this;\n        };\n\n        this.getElement = function () {\n            return this.element;\n        };\n\n        this.setElement = function (el) {\n            var parentId = this._jsPlumb.instance.getId(el),\n                curId = this.elementId;\n            // remove the endpoint from the list for the current endpoint's element\n            _ju.removeWithFunction(params.endpointsByElement[this.elementId], function (e) {\n                return e.id === this.id;\n            }.bind(this));\n            this.element = _jp.getElement(el);\n            this.elementId = _jsPlumb.getId(this.element);\n            _jsPlumb.anchorManager.rehomeEndpoint(this, curId, this.element);\n            _jsPlumb.dragManager.endpointAdded(this.element);\n            _ju.addToList(params.endpointsByElement, parentId, this);\n            return this;\n        };\n\n        /**\n         * private but must be exposed.\n         */\n        this.makeInPlaceCopy = function () {\n            var loc = this.anchor.getCurrentLocation({element: this}),\n                o = this.anchor.getOrientation(this),\n                acc = this.anchor.getCssClass(),\n                inPlaceAnchor = {\n                    bind: function () {\n                    },\n                    compute: function () {\n                        return [ loc[0], loc[1] ];\n                    },\n                    getCurrentLocation: function () {\n                        return [ loc[0], loc[1] ];\n                    },\n                    getOrientation: function () {\n                        return o;\n                    },\n                    getCssClass: function () {\n                        return acc;\n                    }\n                };\n\n            return _newEndpoint({\n                dropOptions: params.dropOptions,\n                anchor: inPlaceAnchor,\n                source: this.element,\n                paintStyle: this.getPaintStyle(),\n                endpoint: params.hideOnDrag ? \"Blank\" : this.endpoint,\n                _transient: true,\n                scope: this.scope,\n                reference:this\n            });\n        };\n\n        /**\n         * returns a connection from the pool; used when dragging starts.  just gets the head of the array if it can.\n         */\n        this.connectorSelector = function () {\n            return this.connections[0];\n        };\n\n        this.setStyle = this.setPaintStyle;\n\n        this.paint = function (params) {\n            params = params || {};\n            var timestamp = params.timestamp, recalc = !(params.recalc === false);\n            if (!timestamp || this.timestamp !== timestamp) {\n\n                var info = _jsPlumb.updateOffset({ elId: this.elementId, timestamp: timestamp });\n\n                var xy = params.offset ? params.offset.o : info.o;\n                if (xy != null) {\n                    var ap = params.anchorPoint, connectorPaintStyle = params.connectorPaintStyle;\n                    if (ap == null) {\n                        var wh = params.dimensions || info.s,\n                            anchorParams = { xy: [ xy.left, xy.top ], wh: wh, element: this, timestamp: timestamp };\n                        if (recalc && this.anchor.isDynamic && this.connections.length > 0) {\n                            var c = findConnectionToUseForDynamicAnchor(this, params.elementWithPrecedence),\n                                oIdx = c.endpoints[0] === this ? 1 : 0,\n                                oId = oIdx === 0 ? c.sourceId : c.targetId,\n                                oInfo = _jsPlumb.getCachedData(oId),\n                                oOffset = oInfo.o, oWH = oInfo.s;\n\n                            anchorParams.index = oIdx === 0 ? 1 : 0;\n                            anchorParams.connection = c;\n                            anchorParams.txy = [ oOffset.left, oOffset.top ];\n                            anchorParams.twh = oWH;\n                            anchorParams.tElement = c.endpoints[oIdx];\n                        } else if (this.connections.length > 0) {\n                            anchorParams.connection = this.connections[0];\n                        }\n                        ap = this.anchor.compute(anchorParams);\n                    }\n\n                    this.endpoint.compute(ap, this.anchor.getOrientation(this), this._jsPlumb.paintStyleInUse, connectorPaintStyle || this.paintStyleInUse);\n                    this.endpoint.paint(this._jsPlumb.paintStyleInUse, this.anchor);\n                    this.timestamp = timestamp;\n\n                    // paint overlays\n                    for (var i in this._jsPlumb.overlays) {\n                        if (this._jsPlumb.overlays.hasOwnProperty(i)) {\n                            var o = this._jsPlumb.overlays[i];\n                            if (o.isVisible()) {\n                                this._jsPlumb.overlayPlacements[i] = o.draw(this.endpoint, this._jsPlumb.paintStyleInUse);\n                                o.paint(this._jsPlumb.overlayPlacements[i]);\n                            }\n                        }\n                    }\n                }\n            }\n        };\n\n        this.getTypeDescriptor = function () {\n            return \"endpoint\";\n        };\n        this.isVisible = function () {\n            return this._jsPlumb.visible;\n        };\n\n        this.repaint = this.paint;\n\n        var draggingInitialised = false;\n        this.initDraggable = function () {\n\n            // is this a connection source? we make it draggable and have the\n            // drag listener maintain a connection with a floating endpoint.\n            if (!draggingInitialised && _jp.isDragSupported(this.element)) {\n                var placeholderInfo = { id: null, element: null },\n                    jpc = null,\n                    existingJpc = false,\n                    existingJpcParams = null,\n                    _dragHandler = _makeConnectionDragHandler(this, placeholderInfo, _jsPlumb),\n                    dragOptions = params.dragOptions || {},\n                    defaultOpts = {},\n                    startEvent = _jp.dragEvents.start,\n                    stopEvent = _jp.dragEvents.stop,\n                    dragEvent = _jp.dragEvents.drag,\n                    beforeStartEvent = _jp.dragEvents.beforeStart,\n                    payload;\n\n                // respond to beforeStart from katavorio; this will have, optionally, a payload of attribute values\n                // that were placed there by the makeSource mousedown listener.\n                var beforeStart = function(beforeStartParams) {\n                    payload = beforeStartParams.e.payload || {};\n                };\n\n                var start = function (startParams) {\n\n// -------------   first, get a connection to drag. this may be null, in which case we are dragging a new one.\n\n                    jpc = this.connectorSelector();\n\n// -------------------------------- now a bunch of tests about whether or not to proceed -------------------------\n\n                    var _continue = true;\n                    // if not enabled, return\n                    if (!this.isEnabled()) {\n                        _continue = false;\n                    }\n                    // if no connection and we're not a source - or temporarily a source, as is the case with makeSource - return.\n                    if (jpc == null && !this.isSource && !this.isTemporarySource) {\n                        _continue = false;\n                    }\n                    // otherwise if we're full and not allowed to drag, also return false.\n                    if (this.isSource && this.isFull() && !(jpc != null && this.dragAllowedWhenFull)) {\n                        _continue = false;\n                    }\n                    // if the connection was setup as not detachable or one of its endpoints\n                    // was setup as connectionsDetachable = false, or Defaults.ConnectionsDetachable\n                    // is set to false...\n                    if (jpc != null && !jpc.isDetachable(this)) {\n                        // .. and the endpoint is full\n                        if (this.isFull()) {\n                            _continue = false;\n                        } else {\n                            // otherwise, if not full, set the connection to null, and we will now proceed\n                            // to drag a new connection.\n                            jpc = null;\n                        }\n                    }\n\n                    var beforeDrag = _jsPlumb.checkCondition(jpc == null ? \"beforeDrag\" : \"beforeStartDetach\", {\n                        endpoint:this,\n                        source:this.element,\n                        sourceId:this.elementId,\n                        connection:jpc\n                    });\n                    if (beforeDrag === false) {\n                        _continue = false;\n                    }\n                    // else we might have been given some data. we'll pass it in to a new connection as 'data'.\n                    // here we also merge in the optional payload we were given on mousedown.\n                    else if (typeof beforeDrag === \"object\") {\n                        _jp.extend(beforeDrag, payload || {});\n                    }\n                    else {\n                        // or if no beforeDrag data, maybe use the payload on its own.\n                        beforeDrag = payload || {};\n                    }\n\n                    if (_continue === false) {\n                        // this is for mootools and yui. returning false from this causes jquery to stop drag.\n                        // the events are wrapped in both mootools and yui anyway, but i don't think returning\n                        // false from the start callback would stop a drag.\n                        if (_jsPlumb.stopDrag) {\n                            _jsPlumb.stopDrag(this.canvas);\n                        }\n                        _dragHandler.stopDrag();\n                        return false;\n                    }\n\n// ---------------------------------------------------------------------------------------------------------------------\n\n                    // ok to proceed.\n\n                    // clear hover for all connections for this endpoint before continuing.\n                    for (var i = 0; i < this.connections.length; i++) {\n                        this.connections[i].setHover(false);\n                    }\n\n                    this.addClass(\"endpointDrag\");\n                    _jsPlumb.setConnectionBeingDragged(true);\n\n                    // if we're not full but there was a connection, make it null. we'll create a new one.\n                    if (jpc && !this.isFull() && this.isSource) {\n                        jpc = null;\n                    }\n\n                    _jsPlumb.updateOffset({ elId: this.elementId });\n\n// ----------------    make the element we will drag around, and position it -----------------------------\n\n                    var ipco = this._jsPlumb.instance.getOffset(this.canvas),\n                        canvasElement = this.canvas,\n                        ips = this._jsPlumb.instance.getSize(this.canvas);\n\n                    _makeDraggablePlaceholder(placeholderInfo, _jsPlumb, ipco, ips);\n\n                    // store the id of the dragging div and the source element. the drop function will pick these up.                   \n                    _jsPlumb.setAttributes(this.canvas, {\n                        \"dragId\": placeholderInfo.id,\n                        \"elId\": this.elementId\n                    });\n\n// ------------------- create an endpoint that will be our floating endpoint ------------------------------------\n\n                    var endpointToFloat = this.dragProxy || this.endpoint;\n                    if (this.dragProxy == null && this.connectionType != null) {\n                        var aae = this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);\n                        if (aae.endpoints[1]) {\n                            endpointToFloat = aae.endpoints[1];\n                        }\n                    }\n                    var centerAnchor = this._jsPlumb.instance.makeAnchor(\"Center\");\n                    centerAnchor.isFloating = true;\n                    this._jsPlumb.floatingEndpoint = _makeFloatingEndpoint(this.getPaintStyle(), centerAnchor, endpointToFloat, this.canvas, placeholderInfo.element, _jsPlumb, _newEndpoint, this.scope);\n                    var _savedAnchor = this._jsPlumb.floatingEndpoint.anchor;\n\n\n                    if (jpc == null) {\n\n                        this.setHover(false, false);\n                        // create a connection. one end is this endpoint, the other is a floating endpoint.                    \n                        jpc = _newConnection({\n                            sourceEndpoint: this,\n                            targetEndpoint: this._jsPlumb.floatingEndpoint,\n                            source: this.element,  // for makeSource with parent option.  ensure source element is represented correctly.\n                            target: placeholderInfo.element,\n                            anchors: [ this.anchor, this._jsPlumb.floatingEndpoint.anchor ],\n                            paintStyle: params.connectorStyle, // this can be null. Connection will use the default.\n                            hoverPaintStyle: params.connectorHoverStyle,\n                            connector: params.connector, // this can also be null. Connection will use the default.\n                            overlays: params.connectorOverlays,\n                            type: this.connectionType,\n                            cssClass: this.connectorClass,\n                            hoverClass: this.connectorHoverClass,\n                            scope:params.scope,\n                            data:beforeDrag\n                        });\n                        jpc.pending = true;\n                        jpc.addClass(_jsPlumb.draggingClass);\n                        this._jsPlumb.floatingEndpoint.addClass(_jsPlumb.draggingClass);\n                        this._jsPlumb.floatingEndpoint.anchor = _savedAnchor;\n                        // fire an event that informs that a connection is being dragged\n                        _jsPlumb.fire(\"connectionDrag\", jpc);\n\n                        // register the new connection on the drag manager. This connection, at this point, is 'pending',\n                        // and has as its target a temporary element (the 'placeholder'). If the connection subsequently\n                        // becomes established, the anchor manager is informed that the target of the connection has\n                        // changed.\n\n                        _jsPlumb.router.newConnection(jpc);\n\n                    } else {\n                        existingJpc = true;\n                        jpc.setHover(false);\n                        // new anchor idx\n                        var anchorIdx = jpc.endpoints[0].id === this.id ? 0 : 1;\n                        this.detachFromConnection(jpc, null, true);                         // detach from the connection while dragging is occurring. but dont cleanup automatically.\n\n                        // store the original scope (issue 57)\n                        var dragScope = _jsPlumb.getDragScope(canvasElement);\n                        _jsPlumb.setAttribute(this.canvas, \"originalScope\", dragScope);\n\n                        // fire an event that informs that a connection is being dragged. we do this before\n                        // replacing the original target with the floating element info.\n                        _jsPlumb.fire(\"connectionDrag\", jpc);\n\n                        // now we replace ourselves with the temporary div we created above:\n                        if (anchorIdx === 0) {\n                            existingJpcParams = [ jpc.source, jpc.sourceId, canvasElement, dragScope ];\n                            _jsPlumb.router.sourceOrTargetChanged(jpc.endpoints[anchorIdx].elementId, placeholderInfo.id, jpc, placeholderInfo.element, 0);\n\n                        } else {\n                            existingJpcParams = [ jpc.target, jpc.targetId, canvasElement, dragScope ];\n                            _jsPlumb.router.sourceOrTargetChanged(jpc.endpoints[anchorIdx].elementId, placeholderInfo.id, jpc, placeholderInfo.element, 1);\n                        }\n\n                        // store the original endpoint and assign the new floating endpoint for the drag.\n                        jpc.suspendedEndpoint = jpc.endpoints[anchorIdx];\n\n                        // PROVIDE THE SUSPENDED ELEMENT, BE IT A SOURCE OR TARGET (ISSUE 39)\n                        jpc.suspendedElement = jpc.endpoints[anchorIdx].getElement();\n                        jpc.suspendedElementId = jpc.endpoints[anchorIdx].elementId;\n                        jpc.suspendedElementType = anchorIdx === 0 ? \"source\" : \"target\";\n\n                        jpc.suspendedEndpoint.setHover(false);\n                        this._jsPlumb.floatingEndpoint.referenceEndpoint = jpc.suspendedEndpoint;\n                        jpc.endpoints[anchorIdx] = this._jsPlumb.floatingEndpoint;\n\n                        jpc.addClass(_jsPlumb.draggingClass);\n                        this._jsPlumb.floatingEndpoint.addClass(_jsPlumb.draggingClass);\n                    }\n\n                    _jsPlumb.registerFloatingConnection(placeholderInfo, jpc, this._jsPlumb.floatingEndpoint);\n\n                    // tell jsplumb about it\n                    _jsPlumb.currentlyDragging = true;\n                }.bind(this);\n\n                var stop = function () {\n                    _jsPlumb.setConnectionBeingDragged(false);\n\n                    if (jpc && jpc.endpoints != null) {\n                        // get the actual drop event (decode from library args to stop function)\n                        var originalEvent = _jsPlumb.getDropEvent(arguments);\n                        // unlock the other endpoint (if it is dynamic, it would have been locked at drag start)\n                        var idx = _jsPlumb.getFloatingAnchorIndex(jpc);\n                        jpc.endpoints[idx === 0 ? 1 : 0].anchor.unlock();\n                        jpc.removeClass(_jsPlumb.draggingClass);\n                        // if we have the floating endpoint then the connection has not been dropped\n                        // on another endpoint.  If it is a new connection we throw it away. If it is an\n                        // existing connection we check to see if we should reattach it, throwing it away\n                        // if not.\n                        if (this._jsPlumb && (jpc.deleteConnectionNow || jpc.endpoints[idx] === this._jsPlumb.floatingEndpoint)) {\n                            // 6a. if the connection was an existing one...\n                            if (existingJpc && jpc.suspendedEndpoint) {\n                                // fix for issue35, thanks Sylvain Gizard: when firing the detach event make sure the\n                                // floating endpoint has been replaced.\n                                if (idx === 0) {\n                                    jpc.floatingElement = jpc.source;\n                                    jpc.floatingId = jpc.sourceId;\n                                    jpc.floatingEndpoint = jpc.endpoints[0];\n                                    jpc.floatingIndex = 0;\n                                    jpc.source = existingJpcParams[0];\n                                    jpc.sourceId = existingJpcParams[1];\n                                } else {\n                                    // keep a copy of the floating element; the anchor manager will want to clean up.\n                                    jpc.floatingElement = jpc.target;\n                                    jpc.floatingId = jpc.targetId;\n                                    jpc.floatingEndpoint = jpc.endpoints[1];\n                                    jpc.floatingIndex = 1;\n                                    jpc.target = existingJpcParams[0];\n                                    jpc.targetId = existingJpcParams[1];\n                                }\n\n                                var fe = this._jsPlumb.floatingEndpoint; // store for later removal.\n                                // restore the original scope (issue 57)\n                                _jsPlumb.setDragScope(existingJpcParams[2], existingJpcParams[3]);\n                                jpc.endpoints[idx] = jpc.suspendedEndpoint;\n                                // if the connection should be reattached, or the other endpoint refuses detach, then\n                                // reset the connection to its original state\n                                if (jpc.isReattach() || jpc._forceReattach || jpc._forceDetach || !_jsPlumb.deleteConnection(jpc, {originalEvent: originalEvent})) {\n\n                                    jpc.setHover(false);\n                                    jpc._forceDetach = null;\n                                    jpc._forceReattach = null;\n                                    this._jsPlumb.floatingEndpoint.detachFromConnection(jpc);\n                                    jpc.suspendedEndpoint.addConnection(jpc);\n\n                                    // TODO this code is duplicated in lots of places...and there is nothing external\n                                    // in the code; it all refers to the connection itself. we could add a\n                                    // `checkSanity(connection)` method to anchorManager that did this.\n                                    if (idx === 1) {\n                                        _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.targetId, jpc, jpc.target, idx);\n                                    }\n                                    else {\n                                        _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source, idx);\n                                    }\n\n                                    _jsPlumb.repaint(existingJpcParams[1]);\n                                }\n                                else {\n                                    _jsPlumb.deleteObject({endpoint: fe});\n                                }\n                            }\n                        }\n\n                        // makeTargets sets this flag, to tell us we have been replaced and should delete this object.\n                        if (this.deleteAfterDragStop) {\n                            _jsPlumb.deleteObject({endpoint: this});\n                        }\n                        else {\n                            if (this._jsPlumb) {\n                                 this.paint({recalc: false});\n                            }\n                        }\n\n                        // although the connection is no longer valid, there are use cases where this is useful.\n                        _jsPlumb.fire(\"connectionDragStop\", jpc, originalEvent);\n                        // fire this event to give people more fine-grained control (connectionDragStop fires a lot)\n                        if (jpc.pending) {\n                            _jsPlumb.fire(\"connectionAborted\", jpc, originalEvent);\n                        }\n                        // tell jsplumb that dragging is finished.\n                        _jsPlumb.currentlyDragging = false;\n                        jpc.suspendedElement = null;\n                        jpc.suspendedEndpoint = null;\n                        jpc = null;\n                    }\n\n                    // if no endpoints, jpc already cleaned up. but still we want to ensure we're reset properly.\n                    // remove the element associated with the floating endpoint\n                    // (and its associated floating endpoint and visual artefacts)\n                    if (placeholderInfo && placeholderInfo.element) {\n                        _jsPlumb.remove(placeholderInfo.element, false, false);\n                    }\n                    // remove the inplace copy\n                    if (inPlaceCopy) {\n                        _jsPlumb.deleteObject({endpoint: inPlaceCopy});\n                    }\n\n                    if (this._jsPlumb) {\n                        // make our canvas visible (TODO: hand off to library; we should not know about DOM)\n                        this.canvas.style.visibility = \"visible\";\n                        // unlock our anchor\n                        this.anchor.unlock();\n                        // clear floating anchor.\n                        this._jsPlumb.floatingEndpoint = null;\n                    }\n\n                }.bind(this);\n\n                dragOptions = _jp.extend(defaultOpts, dragOptions);\n                dragOptions.scope = this.scope || dragOptions.scope;\n                dragOptions[beforeStartEvent] = _ju.wrap(dragOptions[beforeStartEvent], beforeStart, false);\n                dragOptions[startEvent] = _ju.wrap(dragOptions[startEvent], start, false);\n                // extracted drag handler function so can be used by makeSource\n                dragOptions[dragEvent] = _ju.wrap(dragOptions[dragEvent], _dragHandler.drag);\n                dragOptions[stopEvent] = _ju.wrap(dragOptions[stopEvent], stop);\n                dragOptions.multipleDrop = false;\n\n                dragOptions.canDrag = function () {\n                    return this.isSource || this.isTemporarySource || (this.connections.length > 0 && this.connectionsDetachable !== false);\n                }.bind(this);\n\n                _jsPlumb.initDraggable(this.canvas, dragOptions, \"internal\");\n\n                this.canvas._jsPlumbRelatedElement = this.element;\n\n                draggingInitialised = true;\n            }\n        };\n\n        var ep = params.endpoint || this._jsPlumb.instance.Defaults.Endpoint || _jp.Defaults.Endpoint;\n        this.setEndpoint(ep, true);\n        var anchorParamsToUse = params.anchor ? params.anchor : params.anchors ? params.anchors : (_jsPlumb.Defaults.Anchor || \"Top\");\n        this.setAnchor(anchorParamsToUse, true);\n\n        // finally, set type if it was provided\n        var type = [ \"default\", (params.type || \"\")].join(\" \");\n        this.addType(type, params.data, true);\n        this.canvas = this.endpoint.canvas;\n        this.canvas._jsPlumb = this;\n\n        this.initDraggable();\n\n        // pulled this out into a function so we can reuse it for the inPlaceCopy canvas; you can now drop detached connections\n        // back onto the endpoint you detached it from.\n        var _initDropTarget = function (canvas, isTransient, endpoint, referenceEndpoint) {\n\n            if (_jp.isDropSupported(this.element)) {\n                var dropOptions = params.dropOptions || _jsPlumb.Defaults.DropOptions || _jp.Defaults.DropOptions;\n                dropOptions = _jp.extend({}, dropOptions);\n                dropOptions.scope = dropOptions.scope || this.scope;\n                var dropEvent = _jp.dragEvents.drop,\n                    overEvent = _jp.dragEvents.over,\n                    outEvent = _jp.dragEvents.out,\n                    _ep = this,\n                    drop = _jsPlumb.EndpointDropHandler({\n                        getEndpoint: function () {\n                            return _ep;\n                        },\n                        jsPlumb: _jsPlumb,\n                        enabled: function () {\n                            return endpoint != null ? endpoint.isEnabled() : true;\n                        },\n                        isFull: function () {\n                            return endpoint.isFull();\n                        },\n                        element: this.element,\n                        elementId: this.elementId,\n                        isSource: this.isSource,\n                        isTarget: this.isTarget,\n                        addClass: function (clazz) {\n                            _ep.addClass(clazz);\n                        },\n                        removeClass: function (clazz) {\n                            _ep.removeClass(clazz);\n                        },\n                        isDropAllowed: function () {\n                            return _ep.isDropAllowed.apply(_ep, arguments);\n                        },\n                        reference:referenceEndpoint,\n                        isRedrop:function(jpc, dhParams) {\n                            return jpc.suspendedEndpoint && dhParams.reference && (jpc.suspendedEndpoint.id === dhParams.reference.id);\n                        }\n                    });\n\n                dropOptions[dropEvent] = _ju.wrap(dropOptions[dropEvent], drop, true);\n                dropOptions[overEvent] = _ju.wrap(dropOptions[overEvent], function () {\n                    var draggable = _jp.getDragObject(arguments),\n                        id = _jsPlumb.getAttribute(_jp.getElement(draggable), \"dragId\"),\n                        _jpc = _jsPlumb.getFloatingConnectionFor(id);//_jsPlumb.floatingConnections[id];\n\n                    if (_jpc != null) {\n                        var idx = _jsPlumb.getFloatingAnchorIndex(_jpc);\n                        // here we should fire the 'over' event if we are a target and this is a new connection,\n                        // or we are the same as the floating endpoint.\n                        var _cont = (this.isTarget && idx !== 0) || (_jpc.suspendedEndpoint && this.referenceEndpoint && this.referenceEndpoint.id === _jpc.suspendedEndpoint.id);\n                        if (_cont) {\n                            var bb = _jsPlumb.checkCondition(\"checkDropAllowed\", {\n                                sourceEndpoint: _jpc.endpoints[idx],\n                                targetEndpoint: this,\n                                connection: _jpc\n                            });\n                            this[(bb ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointDropAllowedClass);\n                            this[(bb ? \"remove\" : \"add\") + \"Class\"](_jsPlumb.endpointDropForbiddenClass);\n                            _jpc.endpoints[idx].anchor.over(this.anchor, this);\n                        }\n                    }\n                }.bind(this));\n\n                dropOptions[outEvent] = _ju.wrap(dropOptions[outEvent], function () {\n                    var draggable = _jp.getDragObject(arguments),\n                        id = draggable == null ? null : _jsPlumb.getAttribute(_jp.getElement(draggable), \"dragId\"),\n                        _jpc = id ? _jsPlumb.getFloatingConnectionFor(id) : null;\n\n                    if (_jpc != null) {\n                        var idx = _jsPlumb.getFloatingAnchorIndex(_jpc);\n                        var _cont = (this.isTarget && idx !== 0) || (_jpc.suspendedEndpoint && this.referenceEndpoint && this.referenceEndpoint.id === _jpc.suspendedEndpoint.id);\n                        if (_cont) {\n                            this.removeClass(_jsPlumb.endpointDropAllowedClass);\n                            this.removeClass(_jsPlumb.endpointDropForbiddenClass);\n                            _jpc.endpoints[idx].anchor.out();\n                        }\n                    }\n                }.bind(this));\n\n                _jsPlumb.initDroppable(canvas, dropOptions, \"internal\", isTransient);\n            }\n        }.bind(this);\n\n        // Initialise the endpoint's canvas as a drop target. The drop handler will take care of the logic of whether\n        // something can actually be dropped.\n        if (!this.anchor.isFloating) {\n            _initDropTarget(this.canvas, !(params._transient || this.anchor.isFloating), this, params.reference);\n        }\n\n        return this;\n    };\n\n    _ju.extend(_jp.Endpoint, _jp.OverlayCapableJsPlumbUIComponent, {\n\n        setVisible: function (v, doNotChangeConnections, doNotNotifyOtherEndpoint) {\n            this._jsPlumb.visible = v;\n            if (this.canvas) {\n                this.canvas.style.display = v ? \"block\" : \"none\";\n            }\n            this[v ? \"showOverlays\" : \"hideOverlays\"]();\n            if (!doNotChangeConnections) {\n                for (var i = 0; i < this.connections.length; i++) {\n                    this.connections[i].setVisible(v);\n                    if (!doNotNotifyOtherEndpoint) {\n                        var oIdx = this === this.connections[i].endpoints[0] ? 1 : 0;\n                        // only change the other endpoint if this is its only connection.\n                        if (this.connections[i].endpoints[oIdx].connections.length === 1) {\n                            this.connections[i].endpoints[oIdx].setVisible(v, true, true);\n                        }\n                    }\n                }\n            }\n        },\n        getAttachedElements: function () {\n            return this.connections;\n        },\n        applyType: function (t, doNotRepaint) {\n            this.setPaintStyle(t.endpointStyle || t.paintStyle, doNotRepaint);\n            this.setHoverPaintStyle(t.endpointHoverStyle || t.hoverPaintStyle, doNotRepaint);\n            if (t.maxConnections != null) {\n                this._jsPlumb.maxConnections = t.maxConnections;\n            }\n            if (t.scope) {\n                this.scope = t.scope;\n            }\n            _jp.extend(this, t, typeParameters);\n            if (t.cssClass != null && this.canvas) {\n                this._jsPlumb.instance.addClass(this.canvas, t.cssClass);\n            }\n            _jp.OverlayCapableJsPlumbUIComponent.applyType(this, t);\n        },\n        isEnabled: function () {\n            return this._jsPlumb.enabled;\n        },\n        setEnabled: function (e) {\n            this._jsPlumb.enabled = e;\n        },\n        cleanup: function () {\n            var anchorClass = this._jsPlumb.instance.endpointAnchorClassPrefix + (this._jsPlumb.currentAnchorClass ? \"-\" + this._jsPlumb.currentAnchorClass : \"\");\n            _jp.removeClass(this.element, anchorClass);\n            this.anchor = null;\n            this.endpoint.cleanup(true);\n            this.endpoint.destroy();\n            this.endpoint = null;\n            // drag/drop\n            this._jsPlumb.instance.destroyDraggable(this.canvas, \"internal\");\n            this._jsPlumb.instance.destroyDroppable(this.canvas, \"internal\");\n        },\n        setHover: function (h) {\n            if (this.endpoint && this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\n                this.endpoint.setHover(h);\n            }\n        },\n        isFull: function () {\n            return this._jsPlumb.maxConnections === 0 ? true : !(this.isFloating() || this._jsPlumb.maxConnections < 0 || this.connections.length < this._jsPlumb.maxConnections);\n        },\n        /**\n         * private but needs to be exposed.\n         */\n        isFloating: function () {\n            return this.anchor != null && this.anchor.isFloating;\n        },\n        isConnectedTo: function (endpoint) {\n            var found = false;\n            if (endpoint) {\n                for (var i = 0; i < this.connections.length; i++) {\n                    if (this.connections[i].endpoints[1] === endpoint || this.connections[i].endpoints[0] === endpoint) {\n                        found = true;\n                        break;\n                    }\n                }\n            }\n            return found;\n        },\n        getConnectionCost: function () {\n            return this._jsPlumb.connectionCost;\n        },\n        setConnectionCost: function (c) {\n            this._jsPlumb.connectionCost = c;\n        },\n        areConnectionsDirected: function () {\n            return this._jsPlumb.connectionsDirected;\n        },\n        setConnectionsDirected: function (b) {\n            this._jsPlumb.connectionsDirected = b;\n        },\n        setElementId: function (_elId) {\n            this.elementId = _elId;\n            this.anchor.elementId = _elId;\n        },\n        setReferenceElement: function (_el) {\n            this.element = _jp.getElement(_el);\n        },\n        setDragAllowedWhenFull: function (allowed) {\n            this.dragAllowedWhenFull = allowed;\n        },\n        equals: function (endpoint) {\n            return this.anchor.equals(endpoint.anchor);\n        },\n        getUuid: function () {\n            return this._jsPlumb.uuid;\n        },\n        computeAnchor: function (params) {\n            return this.anchor.compute(params);\n        }\n    });\n\n    root.jsPlumbInstance.prototype.EndpointDropHandler = function (dhParams) {\n        return function (e) {\n\n            var _jsPlumb = dhParams.jsPlumb;\n\n            // remove the classes that are added dynamically. drop is neither forbidden nor allowed now that\n            // the drop is finishing.\n            dhParams.removeClass(_jsPlumb.endpointDropAllowedClass);\n            dhParams.removeClass(_jsPlumb.endpointDropForbiddenClass);\n\n            var originalEvent = _jsPlumb.getDropEvent(arguments),\n                draggable = _jsPlumb.getDragObject(arguments),\n                id = _jsPlumb.getAttribute(draggable, \"dragId\"),\n                elId = _jsPlumb.getAttribute(draggable, \"elId\"),\n                scope = _jsPlumb.getAttribute(draggable, \"originalScope\"),\n                jpc = _jsPlumb.getFloatingConnectionFor(id);\n\n            // if no active connection, bail.\n            if (jpc == null) {\n                return;\n            }\n\n            // calculate if this is an existing connection.\n            var existingConnection = jpc.suspendedEndpoint != null;\n\n            // if suspended endpoint exists but has been cleaned up, bail. This means it's an existing connection\n            // that has been detached and will shortly be discarded.\n            if (existingConnection && jpc.suspendedEndpoint._jsPlumb == null) {\n                return;\n            }\n\n            // get the drop endpoint. for a normal connection this is just the one that would replace the currently\n            // floating endpoint. for a makeTarget this is a new endpoint that is created on drop. But we leave that to\n            // the handler to figure out.\n            var _ep = dhParams.getEndpoint(jpc);\n\n            // If we're not given an endpoint to use, bail.\n            if (_ep == null) {\n                return;\n            }\n\n            // if this is a drop back where the connection came from, mark it force reattach and\n            // return; the stop handler will reattach. without firing an event.\n            if (dhParams.isRedrop(jpc, dhParams)) {\n                jpc._forceReattach = true;\n                jpc.setHover(false);\n                if (dhParams.maybeCleanup) {\n                    dhParams.maybeCleanup(_ep);\n                }\n                return;\n            }\n\n            // ensure we dont bother trying to drop sources on non-source eps, and same for target.\n            var idx = _jsPlumb.getFloatingAnchorIndex(jpc);\n            if ((idx === 0 && !dhParams.isSource)|| (idx === 1 && !dhParams.isTarget)){\n                if (dhParams.maybeCleanup) {\n                    dhParams.maybeCleanup(_ep);\n                }\n                return;\n            }\n\n            if (dhParams.onDrop) {\n                dhParams.onDrop(jpc);\n            }\n\n            // restore the original scope if necessary (issue 57)\n            if (scope) {\n                _jsPlumb.setDragScope(draggable, scope);\n            }\n\n            // if the target of the drop is full, fire an event (we abort below)\n            // makeTarget: keep.\n            var isFull = dhParams.isFull(e);\n            if (isFull) {\n                _ep.fire(\"maxConnections\", {\n                    endpoint: this,\n                    connection: jpc,\n                    maxConnections: _ep._jsPlumb.maxConnections\n                }, originalEvent);\n            }\n            //\n            // if endpoint enabled, not full, and matches the index of the floating endpoint...\n            if (!isFull &&  dhParams.enabled()) {\n                var _doContinue = true;\n\n                // before testing for beforeDrop, reset the connection's source/target to be the actual DOM elements\n                // involved (that is, stash any temporary stuff used for dragging. but we need to keep it around in\n                // order that the anchor manager can clean things up properly).\n                if (idx === 0) {\n                    jpc.floatingElement = jpc.source;\n                    jpc.floatingId = jpc.sourceId;\n                    jpc.floatingEndpoint = jpc.endpoints[0];\n                    jpc.floatingIndex = 0;\n                    jpc.source = dhParams.element;\n                    jpc.sourceId = _jsPlumb.getId(dhParams.element);\n                } else {\n                    jpc.floatingElement = jpc.target;\n                    jpc.floatingId = jpc.targetId;\n                    jpc.floatingEndpoint = jpc.endpoints[1];\n                    jpc.floatingIndex = 1;\n                    jpc.target = dhParams.element;\n                    jpc.targetId = _jsPlumb.getId(dhParams.element);\n                }\n\n                // if this is an existing connection and detach is not allowed we won't continue. The connection's\n                // endpoints have been reinstated; everything is back to how it was.\n                if (existingConnection && jpc.suspendedEndpoint.id !== _ep.id) {\n                    if (!jpc.isDetachAllowed(jpc) || !jpc.endpoints[idx].isDetachAllowed(jpc) || !jpc.suspendedEndpoint.isDetachAllowed(jpc) || !_jsPlumb.checkCondition(\"beforeDetach\", jpc)) {\n                        _doContinue = false;\n                    }\n                }\n\n// ------------ wrap the execution path in a function so we can support asynchronous beforeDrop\n\n                var continueFunction = function (optionalData) {\n                    // remove this jpc from the current endpoint, which is a floating endpoint that we will\n                    // subsequently discard.\n                    jpc.endpoints[idx].detachFromConnection(jpc);\n\n                    // if there's a suspended endpoint, detach it from the connection.\n                    if (jpc.suspendedEndpoint) {\n                        jpc.suspendedEndpoint.detachFromConnection(jpc);\n                    }\n\n                    jpc.endpoints[idx] = _ep;\n                    _ep.addConnection(jpc);\n\n                    // copy our parameters in to the connection:\n                    var params = _ep.getParameters();\n                    for (var aParam in params) {\n                        jpc.setParameter(aParam, params[aParam]);\n                    }\n\n                    if (!existingConnection) {\n                        // if not an existing connection and\n                        if (params.draggable) {\n                            _jsPlumb.initDraggable(this.element, dhParams.dragOptions, \"internal\", _jsPlumb);\n                        }\n                    }\n                    else {\n                        var suspendedElementId = jpc.suspendedEndpoint.elementId;\n                        _jsPlumb.fireMoveEvent({\n                            index: idx,\n                            originalSourceId: idx === 0 ? suspendedElementId : jpc.sourceId,\n                            newSourceId: idx === 0 ? _ep.elementId : jpc.sourceId,\n                            originalTargetId: idx === 1 ? suspendedElementId : jpc.targetId,\n                            newTargetId: idx === 1 ? _ep.elementId : jpc.targetId,\n                            originalSourceEndpoint: idx === 0 ? jpc.suspendedEndpoint : jpc.endpoints[0],\n                            newSourceEndpoint: idx === 0 ? _ep : jpc.endpoints[0],\n                            originalTargetEndpoint: idx === 1 ? jpc.suspendedEndpoint : jpc.endpoints[1],\n                            newTargetEndpoint: idx === 1 ? _ep : jpc.endpoints[1],\n                            connection: jpc\n                        }, originalEvent);\n                    }\n\n                    if (idx === 1) {\n                        _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.targetId, jpc, jpc.target, 1);\n                    }\n                    else {\n                        _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source, 0);\n                    }\n\n                    // when makeSource has uniqueEndpoint:true, we want to create connections with new endpoints\n                    // that are subsequently deleted. So makeSource sets `finalEndpoint`, which is the Endpoint to\n                    // which the connection should be attached. The `detachFromConnection` call below results in the\n                    // temporary endpoint being cleaned up.\n                    if (jpc.endpoints[0].finalEndpoint) {\n                        var _toDelete = jpc.endpoints[0];\n                        _toDelete.detachFromConnection(jpc);\n                        jpc.endpoints[0] = jpc.endpoints[0].finalEndpoint;\n                        jpc.endpoints[0].addConnection(jpc);\n                    }\n\n                    // if optionalData was given, merge it onto the connection's data.\n                    if (_ju.isObject(optionalData)) {\n                        jpc.mergeData(optionalData);\n                    }\n                    // finalise will inform the anchor manager and also add to\n                    // connectionsByScope if necessary.\n                    _jsPlumb.finaliseConnection(jpc, null, originalEvent, false);\n                    jpc.setHover(false);\n\n                    // SP continuous anchor flush\n                    _jsPlumb.revalidate(jpc.endpoints[0].element);\n\n                }.bind(this);\n\n                var dontContinueFunction = function () {\n                    // otherwise just put it back on the endpoint it was on before the drag.\n                    if (jpc.suspendedEndpoint) {\n                        jpc.endpoints[idx] = jpc.suspendedEndpoint;\n                        jpc.setHover(false);\n                        jpc._forceDetach = true;\n                        if (idx === 0) {\n                            jpc.source = jpc.suspendedEndpoint.element;\n                            jpc.sourceId = jpc.suspendedEndpoint.elementId;\n                        } else {\n                            jpc.target = jpc.suspendedEndpoint.element;\n                            jpc.targetId = jpc.suspendedEndpoint.elementId;\n                        }\n                        jpc.suspendedEndpoint.addConnection(jpc);\n\n                        // TODO checkSanity\n                        if (idx === 1) {\n                            _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.targetId, jpc, jpc.target, 1);\n                        }\n                        else {\n                            _jsPlumb.router.sourceOrTargetChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source, 0);\n                        }\n\n                        _jsPlumb.repaint(jpc.sourceId);\n                        jpc._forceDetach = false;\n                    }\n                };\n\n// --------------------------------------\n                // now check beforeDrop.  this will be available only on Endpoints that are setup to\n                // have a beforeDrop condition (although, secretly, under the hood all Endpoints and\n                // the Connection have them, because they are on jsPlumbUIComponent.  shhh!), because\n                // it only makes sense to have it on a target endpoint.\n                _doContinue = _doContinue && dhParams.isDropAllowed(jpc.sourceId, jpc.targetId, jpc.scope, jpc, _ep);// && jpc.pending;\n\n                if (_doContinue) {\n                    continueFunction(_doContinue);\n                    return true;\n                }\n                else {\n                    dontContinueFunction();\n                }\n            }\n\n            if (dhParams.maybeCleanup) {\n                dhParams.maybeCleanup(_ep);\n            }\n\n            _jsPlumb.currentlyDragging = false;\n        };\n    };\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the code for Connections.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this,\n        _jp = root.jsPlumb,\n        _ju = root.jsPlumbUtil;\n\n    var makeConnector = function (_jsPlumb, renderMode, connectorName, connectorArgs, forComponent) {\n            // first make sure we have a cache for the specified renderer\n            _jp.Connectors[renderMode] = _jp.Connectors[renderMode] || {};\n\n            // now see if the one we want exists; if not we will try to make it\n            if (_jp.Connectors[renderMode][connectorName] == null) {\n\n                if (_jp.Connectors[connectorName] == null) {\n                    if (!_jsPlumb.Defaults.DoNotThrowErrors) {\n                        throw new TypeError(\"jsPlumb: unknown connector type '\" + connectorName + \"'\");\n                    } else {\n                        return null;\n                    }\n                }\n\n                _jp.Connectors[renderMode][connectorName] = function() {\n                    _jp.Connectors[connectorName].apply(this, arguments);\n                    _jp.ConnectorRenderers[renderMode].apply(this, arguments);\n                };\n\n                _ju.extend(_jp.Connectors[renderMode][connectorName], [ _jp.Connectors[connectorName], _jp.ConnectorRenderers[renderMode]]);\n\n            }\n\n            return new _jp.Connectors[renderMode][connectorName](connectorArgs, forComponent);\n        },\n        _makeAnchor = function (anchorParams, elementId, _jsPlumb) {\n            return (anchorParams) ? _jsPlumb.makeAnchor(anchorParams, elementId, _jsPlumb) : null;\n        },\n        _updateConnectedClass = function (conn, element, _jsPlumb, remove) {\n            if (element != null) {\n                element._jsPlumbConnections = element._jsPlumbConnections || {};\n                if (remove) {\n                    delete element._jsPlumbConnections[conn.id];\n                }\n                else {\n                    element._jsPlumbConnections[conn.id] = true;\n                }\n\n                if (_ju.isEmpty(element._jsPlumbConnections)) {\n                    _jsPlumb.removeClass(element, _jsPlumb.connectedClass);\n                }\n                else {\n                    _jsPlumb.addClass(element, _jsPlumb.connectedClass);\n                }\n            }\n        };\n\n    _jp.Connection = function (params) {\n        var _newEndpoint = params.newEndpoint;\n\n        this.id = params.id;\n        this.connector = null;\n        this.idPrefix = \"_jsplumb_c_\";\n        this.defaultLabelLocation = 0.5;\n        this.defaultOverlayKeys = [\"Overlays\", \"ConnectionOverlays\"];\n        // if a new connection is the result of moving some existing connection, params.previousConnection\n        // will have that Connection in it. listeners for the jsPlumbConnection event can look for that\n        // member and take action if they need to.\n        this.previousConnection = params.previousConnection;\n        this.source = _jp.getElement(params.source);\n        this.target = _jp.getElement(params.target);\n\n\n        _jp.OverlayCapableJsPlumbUIComponent.apply(this, arguments);\n\n        // sourceEndpoint and targetEndpoint override source/target, if they are present. but \n        // source is not overridden if the Endpoint has declared it is not the final target of a connection;\n        // instead we use the source that the Endpoint declares will be the final source element.\n        if (params.sourceEndpoint) {\n            this.source = params.sourceEndpoint.getElement();\n            this.sourceId = params.sourceEndpoint.elementId;\n        } else {\n            this.sourceId = this._jsPlumb.instance.getId(this.source);\n        }\n\n        if (params.targetEndpoint) {\n            this.target = params.targetEndpoint.getElement();\n            this.targetId = params.targetEndpoint.elementId;\n        } else {\n            this.targetId = this._jsPlumb.instance.getId(this.target);\n        }\n\n\n        this.scope = params.scope; // scope may have been passed in to the connect call. if it wasn't, we will pull it from the source endpoint, after having initialised the endpoints.            \n        this.endpoints = [];\n        this.endpointStyles = [];\n\n        var _jsPlumb = this._jsPlumb.instance;\n\n        _jsPlumb.manage(this.sourceId, this.source);\n        _jsPlumb.manage(this.targetId, this.target);\n\n        this._jsPlumb.visible = true;\n\n        this._jsPlumb.params = {\n            cssClass: params.cssClass,\n            container: params.container,\n            \"pointer-events\": params[\"pointer-events\"],\n            editorParams: params.editorParams,\n            overlays: params.overlays\n        };\n        this._jsPlumb.lastPaintedAt = null;\n\n        // listen to mouseover and mouseout events passed from the container delegate.\n        this.bind(\"mouseover\", function () {\n            this.setHover(true);\n        }.bind(this));\n        this.bind(\"mouseout\", function () {\n            this.setHover(false);\n        }.bind(this));\n\n\n// INITIALISATION CODE\n\n        this.makeEndpoint = function (isSource, el, elId, ep, definition) {\n            elId = elId || this._jsPlumb.instance.getId(el);\n            return this.prepareEndpoint(_jsPlumb, _newEndpoint, this, ep, isSource ? 0 : 1, params, el, elId, definition);\n        };\n\n        // if type given, get the endpoint definitions mapping to that type from the jsplumb instance, and use those.\n        // we apply types at the end of this constructor but endpoints are only honoured in a type definition at\n        // create time.\n        if (params.type) {\n            params.endpoints = params.endpoints || this._jsPlumb.instance.deriveEndpointAndAnchorSpec(params.type).endpoints;\n        }\n\n        var eS = this.makeEndpoint(true, this.source, this.sourceId, params.sourceEndpoint),\n            eT = this.makeEndpoint(false, this.target, this.targetId, params.targetEndpoint);\n\n        if (eS) {\n            _ju.addToList(params.endpointsByElement, this.sourceId, eS);\n        }\n        if (eT) {\n            _ju.addToList(params.endpointsByElement, this.targetId, eT);\n        }\n        // if scope not set, set it to be the scope for the source endpoint.\n        if (!this.scope) {\n            this.scope = this.endpoints[0].scope;\n        }\n\n        // if explicitly told to (or not to) delete endpoints when empty, override endpoint's preferences\n        if (params.deleteEndpointsOnEmpty != null) {\n            this.endpoints[0].setDeleteOnEmpty(params.deleteEndpointsOnEmpty);\n            this.endpoints[1].setDeleteOnEmpty(params.deleteEndpointsOnEmpty);\n        }\n\n// -------------------------- DEFAULT TYPE ---------------------------------------------\n\n        // DETACHABLE\n        var _detachable = _jsPlumb.Defaults.ConnectionsDetachable;\n        if (params.detachable === false) {\n            _detachable = false;\n        }\n        if (this.endpoints[0].connectionsDetachable === false) {\n            _detachable = false;\n        }\n        if (this.endpoints[1].connectionsDetachable === false) {\n            _detachable = false;\n        }\n        // REATTACH\n        var _reattach = params.reattach || this.endpoints[0].reattachConnections || this.endpoints[1].reattachConnections || _jsPlumb.Defaults.ReattachConnections;\n\n        this.appendToDefaultType({\n            detachable: _detachable,\n            reattach: _reattach,\n            paintStyle:this.endpoints[0].connectorStyle || this.endpoints[1].connectorStyle || params.paintStyle || _jsPlumb.Defaults.PaintStyle || _jp.Defaults.PaintStyle,\n            hoverPaintStyle:this.endpoints[0].connectorHoverStyle || this.endpoints[1].connectorHoverStyle || params.hoverPaintStyle || _jsPlumb.Defaults.HoverPaintStyle || _jp.Defaults.HoverPaintStyle\n        });\n\n        var _suspendedAt = _jsPlumb.getSuspendedAt();\n        if (!_jsPlumb.isSuspendDrawing()) {\n            // paint the endpoints\n            var myInfo = _jsPlumb.getCachedData(this.sourceId),\n                myOffset = myInfo.o, myWH = myInfo.s,\n                otherInfo = _jsPlumb.getCachedData(this.targetId),\n                otherOffset = otherInfo.o,\n                otherWH = otherInfo.s,\n                initialTimestamp = _suspendedAt || _jsPlumb.timestamp(),\n                anchorLoc = this.endpoints[0].anchor.compute({\n                    xy: [ myOffset.left, myOffset.top ], wh: myWH, element: this.endpoints[0],\n                    elementId: this.endpoints[0].elementId,\n                    txy: [ otherOffset.left, otherOffset.top ], twh: otherWH, tElement: this.endpoints[1],\n                    timestamp: initialTimestamp\n                });\n\n            this.endpoints[0].paint({ anchorLoc: anchorLoc, timestamp: initialTimestamp });\n\n            anchorLoc = this.endpoints[1].anchor.compute({\n                xy: [ otherOffset.left, otherOffset.top ], wh: otherWH, element: this.endpoints[1],\n                elementId: this.endpoints[1].elementId,\n                txy: [ myOffset.left, myOffset.top ], twh: myWH, tElement: this.endpoints[0],\n                timestamp: initialTimestamp\n            });\n            this.endpoints[1].paint({ anchorLoc: anchorLoc, timestamp: initialTimestamp });\n        }\n\n        this.getTypeDescriptor = function () {\n            return \"connection\";\n        };\n        this.getAttachedElements = function () {\n            return this.endpoints;\n        };\n\n        this.isDetachable = function (ep) {\n            return this._jsPlumb.detachable === false ? false : ep != null ? ep.connectionsDetachable === true : this._jsPlumb.detachable === true;\n        };\n        this.setDetachable = function (detachable) {\n            this._jsPlumb.detachable = detachable === true;\n        };\n        this.isReattach = function () {\n            return this._jsPlumb.reattach === true || this.endpoints[0].reattachConnections === true || this.endpoints[1].reattachConnections === true;\n        };\n        this.setReattach = function (reattach) {\n            this._jsPlumb.reattach = reattach === true;\n        };\n\n// END INITIALISATION CODE\n\n\n// COST + DIRECTIONALITY\n        // if cost not supplied, try to inherit from source endpoint\n        this._jsPlumb.cost = params.cost || this.endpoints[0].getConnectionCost();\n        this._jsPlumb.directed = params.directed;\n        // inherit directed flag if set no source endpoint\n        if (params.directed == null) {\n            this._jsPlumb.directed = this.endpoints[0].areConnectionsDirected();\n        }\n// END COST + DIRECTIONALITY\n\n// PARAMETERS\n        // merge all the parameters objects into the connection.  parameters set\n        // on the connection take precedence; then source endpoint params, then\n        // finally target endpoint params.\n        var _p = _jp.extend({}, this.endpoints[1].getParameters());\n        _jp.extend(_p, this.endpoints[0].getParameters());\n        _jp.extend(_p, this.getParameters());\n        this.setParameters(_p);\n// END PARAMETERS\n\n// PAINTING\n\n        this.setConnector(this.endpoints[0].connector || this.endpoints[1].connector || params.connector || _jsPlumb.Defaults.Connector || _jp.Defaults.Connector, true);\n        var data = params.data == null || !_ju.isObject(params.data) ? {} : params.data;\n        this.getData = function() { return data; };\n        this.setData = function(d) { data = d || {}; };\n        this.mergeData = function(d) { data = _jp.extend(data, d); };\n\n        // the very last thing we do is apply types, if there are any.\n        var _types = [ \"default\", this.endpoints[0].connectionType, this.endpoints[1].connectionType,  params.type ].join(\" \");\n        if (/[^\\s]/.test(_types)) {\n            this.addType(_types, params.data, true);\n        }\n\n        this.updateConnectedClass();\n\n// END PAINTING    \n    };\n\n    _ju.extend(_jp.Connection, _jp.OverlayCapableJsPlumbUIComponent, {\n        applyType: function (t, doNotRepaint, typeMap) {\n\n            var _connector = null;\n            if (t.connector != null) {\n                _connector = this.getCachedTypeItem(\"connector\", typeMap.connector);\n                if (_connector == null) {\n                    _connector = this.prepareConnector(t.connector, typeMap.connector);\n                    this.cacheTypeItem(\"connector\", _connector, typeMap.connector);\n                }\n                this.setPreparedConnector(_connector);\n            }\n\n            // none of these things result in the creation of objects so can be ignored.\n            if (t.detachable != null) {\n                this.setDetachable(t.detachable);\n            }\n            if (t.reattach != null) {\n                this.setReattach(t.reattach);\n            }\n            if (t.scope) {\n                this.scope = t.scope;\n            }\n\n            if (t.cssClass != null && this.canvas) {\n                this._jsPlumb.instance.addClass(this.canvas, t.cssClass);\n            }\n\n            var _anchors = null;\n            // this also results in the creation of objects.\n            if (t.anchor) {\n                // note that even if the param was anchor, we store `anchors`.\n                _anchors = this.getCachedTypeItem(\"anchors\", typeMap.anchor);\n                if (_anchors == null) {\n                    _anchors = [ this._jsPlumb.instance.makeAnchor(t.anchor), this._jsPlumb.instance.makeAnchor(t.anchor) ];\n                    this.cacheTypeItem(\"anchors\", _anchors, typeMap.anchor);\n                }\n            }\n            else if (t.anchors) {\n                _anchors = this.getCachedTypeItem(\"anchors\", typeMap.anchors);\n                if (_anchors == null) {\n                    _anchors = [\n                        this._jsPlumb.instance.makeAnchor(t.anchors[0]),\n                        this._jsPlumb.instance.makeAnchor(t.anchors[1])\n                    ];\n                    this.cacheTypeItem(\"anchors\", _anchors, typeMap.anchors);\n                }\n            }\n            if (_anchors != null) {\n                this.endpoints[0].anchor = _anchors[0];\n                this.endpoints[1].anchor = _anchors[1];\n                if (this.endpoints[1].anchor.isDynamic) {\n                    this._jsPlumb.instance.repaint(this.endpoints[1].elementId);\n                }\n            }\n\n            _jp.OverlayCapableJsPlumbUIComponent.applyType(this, t);\n        },\n        addClass: function (c, informEndpoints) {\n            if (informEndpoints) {\n                this.endpoints[0].addClass(c);\n                this.endpoints[1].addClass(c);\n                if (this.suspendedEndpoint) {\n                    this.suspendedEndpoint.addClass(c);\n                }\n            }\n            if (this.connector) {\n                this.connector.addClass(c);\n            }\n        },\n        removeClass: function (c, informEndpoints) {\n            if (informEndpoints) {\n                this.endpoints[0].removeClass(c);\n                this.endpoints[1].removeClass(c);\n                if (this.suspendedEndpoint) {\n                    this.suspendedEndpoint.removeClass(c);\n                }\n            }\n            if (this.connector) {\n                this.connector.removeClass(c);\n            }\n        },\n        isVisible: function () {\n            return this._jsPlumb.visible;\n        },\n        setVisible: function (v) {\n            this._jsPlumb.visible = v;\n            if (this.connector) {\n                this.connector.setVisible(v);\n            }\n            this.repaint();\n        },\n        cleanup: function () {\n            this.updateConnectedClass(true);\n            this.endpoints = null;\n            this.source = null;\n            this.target = null;\n            if (this.connector != null) {\n                this.connector.cleanup(true);\n                this.connector.destroy(true);\n            }\n            this.connector = null;\n        },\n        updateConnectedClass:function(remove) {\n            if (this._jsPlumb) {\n                _updateConnectedClass(this, this.source, this._jsPlumb.instance, remove);\n                _updateConnectedClass(this, this.target, this._jsPlumb.instance, remove);\n            }\n        },\n        setHover: function (state) {\n            if (this.connector && this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\n                this.connector.setHover(state);\n                root.jsPlumb[state ? \"addClass\" : \"removeClass\"](this.source, this._jsPlumb.instance.hoverSourceClass);\n                root.jsPlumb[state ? \"addClass\" : \"removeClass\"](this.target, this._jsPlumb.instance.hoverTargetClass);\n            }\n        },\n        getUuids:function() {\n            return [ this.endpoints[0].getUuid(), this.endpoints[1].getUuid() ];\n        },\n        getCost: function () {\n            return this._jsPlumb ? this._jsPlumb.cost : -Infinity;\n        },\n        setCost: function (c) {\n            this._jsPlumb.cost = c;\n        },\n        isDirected: function () {\n            return this._jsPlumb.directed;\n        },\n        getConnector: function () {\n            return this.connector;\n        },\n        prepareConnector:function(connectorSpec, typeId) {\n            var connectorArgs = {\n                    _jsPlumb: this._jsPlumb.instance,\n                    cssClass: this._jsPlumb.params.cssClass,\n                    container: this._jsPlumb.params.container,\n                    \"pointer-events\": this._jsPlumb.params[\"pointer-events\"]\n                },\n                renderMode = this._jsPlumb.instance.getRenderMode(),\n                connector;\n\n            if (_ju.isString(connectorSpec)) {\n                connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec, connectorArgs, this);\n            } // lets you use a string as shorthand.\n            else if (_ju.isArray(connectorSpec)) {\n                if (connectorSpec.length === 1) {\n                    connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec[0], connectorArgs, this);\n                }\n                else {\n                    connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec[0], _ju.merge(connectorSpec[1], connectorArgs), this);\n                }\n            }\n            if (typeId != null) {\n                connector.typeId = typeId;\n            }\n            return connector;\n        },\n        setPreparedConnector: function(connector, doNotRepaint, doNotChangeListenerComponent, typeId) {\n\n            if (this.connector !== connector) {\n\n                var previous, previousClasses = \"\";\n                // the connector will not be cleaned up if it was set as part of a type, because `typeId` will be set on it\n                // and we havent passed in `true` for \"force\" here.\n                if (this.connector != null) {\n                    previous = this.connector;\n                    previousClasses = previous.getClass();\n                    this.connector.cleanup();\n                    this.connector.destroy();\n                }\n\n                this.connector = connector;\n                if (typeId) {\n                    this.cacheTypeItem(\"connector\", connector, typeId);\n                }\n\n                this.canvas = this.connector.canvas;\n                this.bgCanvas = this.connector.bgCanvas;\n\n                this.connector.reattach(this._jsPlumb.instance);\n\n                // put classes from prior connector onto the canvas\n                this.addClass(previousClasses);\n\n                // new: instead of binding listeners per connector, we now just have one delegate on the container.\n                // so for that handler we set the connection as the '_jsPlumb' member of the canvas element, and\n                // bgCanvas, if it exists, which it does right now in the VML renderer, so it won't from v 2.0.0 onwards.\n                if (this.canvas) {\n                    this.canvas._jsPlumb = this;\n                }\n                if (this.bgCanvas) {\n                    this.bgCanvas._jsPlumb = this;\n                }\n\n                if (previous != null) {\n                    var o = this.getOverlays();\n                    for (var i = 0; i < o.length; i++) {\n                        if (o[i].transfer) {\n                            o[i].transfer(this.connector);\n                        }\n                    }\n                }\n\n                if (!doNotChangeListenerComponent) {\n                    this.setListenerComponent(this.connector);\n                }\n                if (!doNotRepaint) {\n                    this.repaint();\n                }\n            }\n        },\n        setConnector: function (connectorSpec, doNotRepaint, doNotChangeListenerComponent, typeId) {\n            var connector = this.prepareConnector(connectorSpec, typeId);\n            this.setPreparedConnector(connector, doNotRepaint, doNotChangeListenerComponent, typeId);\n        },\n        paint: function (params) {\n\n            if (!this._jsPlumb.instance.isSuspendDrawing() && this._jsPlumb.visible) {\n                params = params || {};\n                var timestamp = params.timestamp,\n                // if the moving object is not the source we must transpose the two references.\n                    swap = false,\n                    tId = swap ? this.sourceId : this.targetId, sId = swap ? this.targetId : this.sourceId,\n                    tIdx = swap ? 0 : 1, sIdx = swap ? 1 : 0;\n\n                if (timestamp == null || timestamp !== this._jsPlumb.lastPaintedAt) {\n                    var sourceInfo = this._jsPlumb.instance.updateOffset({elId:sId}).o,\n                        targetInfo = this._jsPlumb.instance.updateOffset({elId:tId}).o,\n                        sE = this.endpoints[sIdx], tE = this.endpoints[tIdx];\n\n                    var sAnchorP = sE.anchor.getCurrentLocation({xy: [sourceInfo.left, sourceInfo.top], wh: [sourceInfo.width, sourceInfo.height], element: sE, timestamp: timestamp}),\n                        tAnchorP = tE.anchor.getCurrentLocation({xy: [targetInfo.left, targetInfo.top], wh: [targetInfo.width, targetInfo.height], element: tE, timestamp: timestamp});\n\n                    this.connector.resetBounds();\n\n                    this.connector.compute({\n                        sourcePos: sAnchorP,\n                        targetPos: tAnchorP,\n                        sourceOrientation:sE.anchor.getOrientation(sE),\n                        targetOrientation:tE.anchor.getOrientation(tE),\n                        sourceEndpoint: this.endpoints[sIdx],\n                        targetEndpoint: this.endpoints[tIdx],\n                        \"stroke-width\": this._jsPlumb.paintStyleInUse.strokeWidth,\n                        sourceInfo: sourceInfo,\n                        targetInfo: targetInfo\n                    });\n\n                    var extents = {\n                        xmin: Math.min(this.connector.bounds.minX),\n                        ymin: Math.min(this.connector.bounds.minY),\n                        xmax: Math.max(this.connector.bounds.maxX),\n                        ymax: Math.max(this.connector.bounds.maxY)\n                    };\n\n                    // paint the connector.\n                    this.connector.paintExtents = extents;\n                    this.connector.paint(this._jsPlumb.paintStyleInUse, null, extents);\n\n                    // paint overlays. since 2.14.0 we do not need to do this first as we now use overflow:visible on the\n                    // jtk-connector class, which avoids things being clipped.\n                    for (var i in this._jsPlumb.overlays) {\n                        if (this._jsPlumb.overlays.hasOwnProperty(i)) {\n                            var o = this._jsPlumb.overlays[i];\n                            if (o.isVisible()) {\n                                this._jsPlumb.overlayPlacements[i] = o.draw(this.connector, this._jsPlumb.paintStyleInUse, this.getAbsoluteOverlayPosition(o));\n                                o.paint(this._jsPlumb.overlayPlacements[i], extents);\n                            }\n                        }\n                    }\n                }\n                this._jsPlumb.lastPaintedAt = timestamp;\n            }\n        },\n        repaint: function (params) {\n            var p = jsPlumb.extend(params || {}, {});\n            p.elId = this.sourceId;\n            this.paint(p);\n        },\n        prepareEndpoint: function (_jsPlumb, _newEndpoint, conn, existing, index, params, element, elementId, definition) {\n            var e;\n            if (existing) {\n                conn.endpoints[index] = existing;\n                existing.addConnection(conn);\n            } else {\n                if (!params.endpoints) {\n                    params.endpoints = [ null, null ];\n                }\n                var ep = definition || params.endpoints[index] || params.endpoint || _jsPlumb.Defaults.Endpoints[index] || _jp.Defaults.Endpoints[index] || _jsPlumb.Defaults.Endpoint || _jp.Defaults.Endpoint;\n                if (!params.endpointStyles) {\n                    params.endpointStyles = [ null, null ];\n                }\n                if (!params.endpointHoverStyles) {\n                    params.endpointHoverStyles = [ null, null ];\n                }\n                var es = params.endpointStyles[index] || params.endpointStyle || _jsPlumb.Defaults.EndpointStyles[index] || _jp.Defaults.EndpointStyles[index] || _jsPlumb.Defaults.EndpointStyle || _jp.Defaults.EndpointStyle;\n                // Endpoints derive their fill from the connector's stroke, if no fill was specified.\n                if (es.fill == null && params.paintStyle != null) {\n                    es.fill = params.paintStyle.stroke;\n                }\n\n                if (es.outlineStroke == null && params.paintStyle != null) {\n                    es.outlineStroke = params.paintStyle.outlineStroke;\n                }\n                if (es.outlineWidth == null && params.paintStyle != null) {\n                    es.outlineWidth = params.paintStyle.outlineWidth;\n                }\n\n                var ehs = params.endpointHoverStyles[index] || params.endpointHoverStyle || _jsPlumb.Defaults.EndpointHoverStyles[index] || _jp.Defaults.EndpointHoverStyles[index] || _jsPlumb.Defaults.EndpointHoverStyle || _jp.Defaults.EndpointHoverStyle;\n                // endpoint hover fill style is derived from connector's hover stroke style\n                if (params.hoverPaintStyle != null) {\n                    if (ehs == null) {\n                        ehs = {};\n                    }\n                    if (ehs.fill == null) {\n                        ehs.fill = params.hoverPaintStyle.stroke;\n                    }\n                }\n                var a = params.anchors ? params.anchors[index] :\n                        params.anchor ? params.anchor :\n                            _makeAnchor(_jsPlumb.Defaults.Anchors[index], elementId, _jsPlumb) ||\n                            _makeAnchor(_jp.Defaults.Anchors[index], elementId, _jsPlumb) ||\n                            _makeAnchor(_jsPlumb.Defaults.Anchor, elementId, _jsPlumb) ||\n                            _makeAnchor(_jp.Defaults.Anchor, elementId, _jsPlumb),\n                    u = params.uuids ? params.uuids[index] : null;\n\n                e = _newEndpoint({\n                    paintStyle: es, hoverPaintStyle: ehs, endpoint: ep, connections: [ conn ],\n                    uuid: u, anchor: a, source: element, scope: params.scope,\n                    reattach: params.reattach || _jsPlumb.Defaults.ReattachConnections,\n                    detachable: params.detachable || _jsPlumb.Defaults.ConnectionsDetachable\n                });\n                if (existing == null) {\n                    e.setDeleteOnEmpty(true);\n                }\n                conn.endpoints[index] = e;\n\n                if (params.drawEndpoints === false) {\n                    e.setVisible(false, true, true);\n                }\n\n            }\n            return e;\n        },\n        replaceEndpoint:function(idx, endpointDef) {\n\n            var current = this.endpoints[idx],\n                elId = current.elementId,\n                ebe = this._jsPlumb.instance.getEndpoints(elId),\n                _idx = ebe.indexOf(current),\n                _new = this.makeEndpoint(idx === 0, current.element, elId, null, endpointDef);\n\n            this.endpoints[idx] = _new;\n\n            ebe.splice(_idx, 1, _new);\n            this._jsPlumb.instance.deleteObject({endpoint:current, deleteAttachedObjects:false});\n            this._jsPlumb.instance.fire(\"endpointReplaced\", {previous:current, current:_new});\n\n            this._jsPlumb.instance.router.sourceOrTargetChanged(this.endpoints[1].elementId, this.endpoints[1].elementId, this, this.endpoints[1].element, 1);\n\n        }\n\n    }); // END Connection class            \n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the code for creating and manipulating anchors.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n\n    var root = this,\n        _ju = root.jsPlumbUtil,\n        _jp = root.jsPlumb;\n\n    //\n    // manages anchors for all elements.\n    //\n    _jp.AnchorManager = function (params) {\n        var _amEndpoints = {},\n            continuousAnchorLocations = {},\n            continuousAnchorOrientations = {},\n            connectionsByElementId = {},\n            self = this,\n            anchorLists = {},\n            jsPlumbInstance = params.jsPlumbInstance,\n            floatingConnections = {},\n            // used by placeAnchors function\n            placeAnchorsOnLine = function (desc, elementDimensions, elementPosition, connections, horizontal, otherMultiplier, reverse) {\n                var a = [], step = elementDimensions[horizontal ? 0 : 1] / (connections.length + 1);\n\n                for (var i = 0; i < connections.length; i++) {\n                    var val = (i + 1) * step, other = otherMultiplier * elementDimensions[horizontal ? 1 : 0];\n                    if (reverse) {\n                        val = elementDimensions[horizontal ? 0 : 1] - val;\n                    }\n\n                    var dx = (horizontal ? val : other), x = elementPosition[0] + dx, xp = dx / elementDimensions[0],\n                        dy = (horizontal ? other : val), y = elementPosition[1] + dy, yp = dy / elementDimensions[1];\n\n                    a.push([ x, y, xp, yp, connections[i][1], connections[i][2] ]);\n                }\n\n                return a;\n            },\n            rightAndBottomSort = function(a, b) {\n                return b[0][0] - a[0][0];\n            },\n            // used by edgeSortFunctions\n            leftAndTopSort = function (a, b) {\n                var p1 = a[0][0] < 0 ? -Math.PI - a[0][0] : Math.PI - a[0][0],\n                    p2 = b[0][0] < 0 ? -Math.PI - b[0][0] : Math.PI - b[0][0];\n\n                return p1 - p2;\n            },\n            // used by placeAnchors\n            edgeSortFunctions = {\n                \"top\":leftAndTopSort,\n                \"right\": rightAndBottomSort,\n                \"bottom\": rightAndBottomSort,\n                \"left\": leftAndTopSort\n            },\n            // used by placeAnchors\n            _sortHelper = function (_array, _fn) {\n                return _array.sort(_fn);\n            },\n            // used by AnchorManager.redraw\n            placeAnchors = function (elementId, _anchorLists) {\n                var cd = jsPlumbInstance.getCachedData(elementId), sS = cd.s, sO = cd.o,\n                    placeSomeAnchors = function (desc, elementDimensions, elementPosition, unsortedConnections, isHorizontal, otherMultiplier, orientation) {\n                        if (unsortedConnections.length > 0) {\n                            var sc = _sortHelper(unsortedConnections, edgeSortFunctions[desc]), // puts them in order based on the target element's pos on screen\n                                reverse = desc === \"right\" || desc === \"top\",\n                                anchors = placeAnchorsOnLine(desc, elementDimensions,\n                                    elementPosition, sc,\n                                    isHorizontal, otherMultiplier, reverse);\n\n                            // takes a computed anchor position and adjusts it for parent offset and scroll, then stores it.\n                            var _setAnchorLocation = function (endpoint, anchorPos) {\n                                continuousAnchorLocations[endpoint.id] = [ anchorPos[0], anchorPos[1], anchorPos[2], anchorPos[3] ];\n                                continuousAnchorOrientations[endpoint.id] = orientation;\n                            };\n\n                            for (var i = 0; i < anchors.length; i++) {\n                                var c = anchors[i][4], weAreSource = c.endpoints[0].elementId === elementId, weAreTarget = c.endpoints[1].elementId === elementId;\n                                if (weAreSource) {\n                                    _setAnchorLocation(c.endpoints[0], anchors[i]);\n                                }\n                                if (weAreTarget) {\n                                    _setAnchorLocation(c.endpoints[1], anchors[i]);\n                                }\n                            }\n                        }\n                    };\n\n                placeSomeAnchors(\"bottom\", sS, [sO.left, sO.top], _anchorLists.bottom, true, 1, [0, 1]);\n                placeSomeAnchors(\"top\", sS, [sO.left, sO.top], _anchorLists.top, true, 0, [0, -1]);\n                placeSomeAnchors(\"left\", sS, [sO.left, sO.top], _anchorLists.left, false, 0, [-1, 0]);\n                placeSomeAnchors(\"right\", sS, [sO.left, sO.top], _anchorLists.right, false, 1, [1, 0]);\n            };\n\n        this.reset = function () {\n            _amEndpoints = {};\n            connectionsByElementId = {};\n            anchorLists = {};\n        };\n        this.addFloatingConnection = function (key, conn) {\n            floatingConnections[key] = conn;\n        };\n        this.newConnection = function (conn) {\n            var sourceId = conn.sourceId, targetId = conn.targetId,\n                ep = conn.endpoints,\n                doRegisterTarget = true,\n                registerConnection = function (otherIndex, otherEndpoint, otherAnchor, elId, c) {\n                    if ((sourceId === targetId) && otherAnchor.isContinuous) {\n                        // remove the target endpoint's canvas.  we dont need it.\n                        conn._jsPlumb.instance.removeElement(ep[1].canvas);\n                        doRegisterTarget = false;\n                    }\n                    _ju.addToList(connectionsByElementId, elId, [c, otherEndpoint, otherAnchor.constructor === _jp.DynamicAnchor]);\n                };\n\n            registerConnection(0, ep[0], ep[0].anchor, targetId, conn);\n            if (doRegisterTarget) {\n                registerConnection(1, ep[1], ep[1].anchor, sourceId, conn);\n            }\n        };\n        var removeEndpointFromAnchorLists = function (endpoint) {\n            (function (list, eId) {\n                if (list) {  // transient anchors dont get entries in this list.\n                    var f = function (e) {\n                        return e[4] === eId;\n                    };\n                    _ju.removeWithFunction(list.top, f);\n                    _ju.removeWithFunction(list.left, f);\n                    _ju.removeWithFunction(list.bottom, f);\n                    _ju.removeWithFunction(list.right, f);\n                }\n            })(anchorLists[endpoint.elementId], endpoint.id);\n        };\n        this.connectionDetached = function (connInfo, doNotRedraw) {\n            var connection = connInfo.connection || connInfo,\n                sourceId = connInfo.sourceId,\n                targetId = connInfo.targetId,\n                ep = connection.endpoints,\n                removeConnection = function (otherIndex, otherEndpoint, otherAnchor, elId, c) {\n                    _ju.removeWithFunction(connectionsByElementId[elId], function (_c) {\n                        return _c[0].id === c.id;\n                    });\n                };\n\n            removeConnection(1, ep[1], ep[1].anchor, sourceId, connection);\n            removeConnection(0, ep[0], ep[0].anchor, targetId, connection);\n            if (connection.floatingId) {\n                removeConnection(connection.floatingIndex, connection.floatingEndpoint, connection.floatingEndpoint.anchor, connection.floatingId, connection);\n                removeEndpointFromAnchorLists(connection.floatingEndpoint);\n            }\n\n            // remove from anchorLists\n            removeEndpointFromAnchorLists(connection.endpoints[0]);\n            removeEndpointFromAnchorLists(connection.endpoints[1]);\n\n            if (!doNotRedraw) {\n                self.redraw(connection.sourceId);\n                if (connection.targetId !== connection.sourceId) {\n                    self.redraw(connection.targetId);\n                }\n            }\n        };\n        this.add = function (endpoint, elementId) {\n            _ju.addToList(_amEndpoints, elementId, endpoint);\n        };\n        this.changeId = function (oldId, newId) {\n            connectionsByElementId[newId] = connectionsByElementId[oldId];\n            _amEndpoints[newId] = _amEndpoints[oldId];\n            delete connectionsByElementId[oldId];\n            delete _amEndpoints[oldId];\n        };\n        this.getConnectionsFor = function (elementId) {\n            return connectionsByElementId[elementId] || [];\n        };\n        this.getEndpointsFor = function (elementId) {\n            return _amEndpoints[elementId] || [];\n        };\n        this.deleteEndpoint = function (endpoint) {\n            _ju.removeWithFunction(_amEndpoints[endpoint.elementId], function (e) {\n                return e.id === endpoint.id;\n            });\n            removeEndpointFromAnchorLists(endpoint);\n        };\n        this.elementRemoved = function (elementId) {\n            delete floatingConnections[elementId];\n            delete _amEndpoints[elementId];\n            _amEndpoints[elementId] = [];\n        };\n        // updates the given anchor list by either updating an existing anchor's info, or adding it. this function\n        // also removes the anchor from its previous list, if the edge it is on has changed.\n        // all connections found along the way (those that are connected to one of the faces this function\n        // operates on) are added to the connsToPaint list, as are their endpoints. in this way we know to repaint\n        // them wthout having to calculate anything else about them.\n        var _updateAnchorList = function (lists, theta, order, conn, aBoolean, otherElId, idx, reverse, edgeId, elId, connsToPaint, endpointsToPaint) {\n            // first try to find the exact match, but keep track of the first index of a matching element id along the way.s\n            var exactIdx = -1,\n                firstMatchingElIdx = -1,\n                endpoint = conn.endpoints[idx],\n                endpointId = endpoint.id,\n                oIdx = [1, 0][idx],\n                values = [\n                    [ theta, order ],\n                    conn,\n                    aBoolean,\n                    otherElId,\n                    endpointId\n                ],\n                listToAddTo = lists[edgeId],\n                listToRemoveFrom = endpoint._continuousAnchorEdge ? lists[endpoint._continuousAnchorEdge] : null,\n                i,\n                candidate;\n\n            if (listToRemoveFrom) {\n                var rIdx = _ju.findWithFunction(listToRemoveFrom, function (e) {\n                    return e[4] === endpointId;\n                });\n                if (rIdx !== -1) {\n                    listToRemoveFrom.splice(rIdx, 1);\n                    // get all connections from this list\n                    for (i = 0; i < listToRemoveFrom.length; i++) {\n                        candidate = listToRemoveFrom[i][1];\n                        _ju.addWithFunction(connsToPaint, candidate, function (c) {\n                            return c.id === candidate.id;\n                        });\n                        _ju.addWithFunction(endpointsToPaint, listToRemoveFrom[i][1].endpoints[idx], function (e) {\n                            return e.id === candidate.endpoints[idx].id;\n                        });\n                        _ju.addWithFunction(endpointsToPaint, listToRemoveFrom[i][1].endpoints[oIdx], function (e) {\n                            return e.id === candidate.endpoints[oIdx].id;\n                        });\n                    }\n                }\n            }\n\n            for (i = 0; i < listToAddTo.length; i++) {\n                candidate = listToAddTo[i][1];\n                if (params.idx === 1 && listToAddTo[i][3] === otherElId && firstMatchingElIdx === -1) {\n                    firstMatchingElIdx = i;\n                }\n                _ju.addWithFunction(connsToPaint, candidate, function (c) {\n                    return c.id === candidate.id;\n                });\n                _ju.addWithFunction(endpointsToPaint, listToAddTo[i][1].endpoints[idx], function (e) {\n                    return e.id === candidate.endpoints[idx].id;\n                });\n                _ju.addWithFunction(endpointsToPaint, listToAddTo[i][1].endpoints[oIdx], function (e) {\n                    return e.id === candidate.endpoints[oIdx].id;\n                });\n            }\n            if (exactIdx !== -1) {\n                listToAddTo[exactIdx] = values;\n            }\n            else {\n                var insertIdx = reverse ? firstMatchingElIdx !== -1 ? firstMatchingElIdx : 0 : listToAddTo.length; // of course we will get this from having looked through the array shortly.\n                listToAddTo.splice(insertIdx, 0, values);\n            }\n\n            // store this for next time.\n            endpoint._continuousAnchorEdge = edgeId;\n        };\n\n        //\n        // Notification that the connection given has changed source/target from the originalId to the newId.\n        //\n        // For a change of source this involves:\n        // 1. removing the connection from the list of connections stored for the originalId\n        // 2. updating the source information for the target of the connection\n        // 3. re-registering the connection in connectionsByElementId with the newId\n        //\n        // For a change of target this means find the entry in an endpoint's list for this connection and update its target endpoint\n        // with the current target in the connection.\n        //\n        this.sourceOrTargetChanged = function (originalId, newId, connection, newElement, anchorIndex) {\n            if (anchorIndex === 0) {\n                if (originalId !== newId) {\n\n                    connection.sourceId = newId;\n                    connection.source = newElement;\n\n                    // remove the entry that points from the old source to the target\n                    _ju.removeWithFunction(connectionsByElementId[originalId], function (info) {\n                        return info[0].id === connection.id;\n                    });\n                    // find entry for target and update it\n                    var tIdx = _ju.findWithFunction(connectionsByElementId[connection.targetId], function (i) {\n                        return i[0].id === connection.id;\n                    });\n                    if (tIdx > -1) {\n                        connectionsByElementId[connection.targetId][tIdx][0] = connection;\n                        connectionsByElementId[connection.targetId][tIdx][1] = connection.endpoints[0];\n                        connectionsByElementId[connection.targetId][tIdx][2] = connection.endpoints[0].anchor.constructor === _jp.DynamicAnchor;\n                    }\n                    // add entry for new source\n                    _ju.addToList(connectionsByElementId, newId, [connection, connection.endpoints[1], connection.endpoints[1].anchor.constructor === _jp.DynamicAnchor]);\n\n                    // TODO SP not final on this yet. when a user drags an existing connection and it turns into a self\n                    // loop, then this code hides the target endpoint (by removing it from the DOM) But I think this should\n                    // occur only if the anchor is Continuous\n                    if (connection.endpoints[1].anchor.isContinuous) {\n                        if (connection.source === connection.target) {\n                            connection._jsPlumb.instance.removeElement(connection.endpoints[1].canvas);\n                        } else {\n                            if (connection.endpoints[1].canvas.parentNode == null) {\n                                connection._jsPlumb.instance.appendElement(connection.endpoints[1].canvas);\n                            }\n                        }\n                    }\n\n                    connection.updateConnectedClass();\n                }\n            } else if (anchorIndex === 1) {\n                var sourceElId = connection.endpoints[0].elementId;\n\n                connection.target = newElement;\n                connection.targetId = newId;\n\n                var sIndex = _ju.findWithFunction(connectionsByElementId[sourceElId], function (i) {\n                        return i[0].id === connection.id;\n                    }),\n                    tIndex = _ju.findWithFunction(connectionsByElementId[originalId], function (i) {\n                        return i[0].id === connection.id;\n                    });\n\n                // update or add data for source\n                if (sIndex !== -1) {\n                    connectionsByElementId[sourceElId][sIndex][0] = connection;\n                    connectionsByElementId[sourceElId][sIndex][1] = connection.endpoints[1];\n                    connectionsByElementId[sourceElId][sIndex][2] = connection.endpoints[1].anchor.constructor === _jp.DynamicAnchor;\n                }\n\n                // remove entry for previous target (if there)\n                if (tIndex > -1) {\n                    connectionsByElementId[originalId].splice(tIndex, 1);\n                    // add entry for new target\n                    _ju.addToList(connectionsByElementId, newId, [connection, connection.endpoints[0], connection.endpoints[0].anchor.constructor === _jp.DynamicAnchor]);\n                }\n\n                connection.updateConnectedClass();\n            }\n        };\n\n        //\n        // moves the given endpoint from `currentId` to `element`.\n        // This involves:\n        //\n        // 1. changing the key in _amEndpoints under which the endpoint is stored\n        // 2. changing the source or target values in all of the endpoint's connections\n        // 3. changing the array in connectionsByElementId in which the endpoint's connections\n        //    are stored (done by either sourceChanged or updateOtherEndpoint)\n        //\n        this.rehomeEndpoint = function (ep, currentId, element) {\n            var eps = _amEndpoints[currentId] || [],\n                elementId = jsPlumbInstance.getId(element);\n\n            if (elementId !== currentId) {\n                var idx = eps.indexOf(ep);\n                if (idx > -1) {\n                    var _ep = eps.splice(idx, 1)[0];\n                    self.add(_ep, elementId);\n                }\n            }\n\n            for (var i = 0; i < ep.connections.length; i++) {\n                if (ep.connections[i].sourceId === currentId) {\n                    self.sourceOrTargetChanged(currentId, ep.elementId, ep.connections[i], ep.element, 0);\n                }\n                else if (ep.connections[i].targetId === currentId) {\n                    self.sourceOrTargetChanged(currentId, ep.elementId, ep.connections[i], ep.element, 1);\n                }\n            }\n        };\n\n        this.redraw = function (elementId, ui, timestamp, offsetToUI, clearEdits, doNotRecalcEndpoint) {\n\n            if (!jsPlumbInstance.isSuspendDrawing()) {\n                // get all the endpoints for this element\n                var ep = _amEndpoints[elementId] || [],\n                    endpointConnections = connectionsByElementId[elementId] || [],\n                    connectionsToPaint = [],\n                    endpointsToPaint = [],\n                    anchorsToUpdate = [];\n\n                timestamp = timestamp || jsPlumbInstance.timestamp();\n                // offsetToUI are values that would have been calculated in the dragManager when registering\n                // an endpoint for an element that had a parent (somewhere in the hierarchy) that had been\n                // registered as draggable.\n                offsetToUI = offsetToUI || {left: 0, top: 0};\n                if (ui) {\n                    ui = {\n                        left: ui.left + offsetToUI.left,\n                        top: ui.top + offsetToUI.top\n                    };\n                }\n\n                // valid for one paint cycle.\n                var myOffset = jsPlumbInstance.updateOffset({ elId: elementId, offset: ui, recalc: false, timestamp: timestamp }),\n                    orientationCache = {};\n\n                // actually, first we should compute the orientation of this element to all other elements to which\n                // this element is connected with a continuous anchor (whether both ends of the connection have\n                // a continuous anchor or just one)\n\n                for (var i = 0; i < endpointConnections.length; i++) {\n                    var conn = endpointConnections[i][0],\n                        sourceId = conn.sourceId,\n                        targetId = conn.targetId,\n                        sourceContinuous = conn.endpoints[0].anchor.isContinuous,\n                        targetContinuous = conn.endpoints[1].anchor.isContinuous;\n\n                    if (sourceContinuous || targetContinuous) {\n                        var oKey = sourceId + \"_\" + targetId,\n                            o = orientationCache[oKey],\n                            oIdx = conn.sourceId === elementId ? 1 : 0;\n\n                        if (sourceContinuous && !anchorLists[sourceId]) {\n                            anchorLists[sourceId] = { top: [], right: [], bottom: [], left: [] };\n                        }\n                        if (targetContinuous && !anchorLists[targetId]) {\n                            anchorLists[targetId] = { top: [], right: [], bottom: [], left: [] };\n                        }\n\n                        if (elementId !== targetId) {\n                            jsPlumbInstance.updateOffset({ elId: targetId, timestamp: timestamp });\n                        }\n                        if (elementId !== sourceId) {\n                            jsPlumbInstance.updateOffset({ elId: sourceId, timestamp: timestamp });\n                        }\n\n                        var td = jsPlumbInstance.getCachedData(targetId),\n                            sd = jsPlumbInstance.getCachedData(sourceId);\n\n                        if (targetId === sourceId && (sourceContinuous || targetContinuous)) {\n                            // here we may want to improve this by somehow determining the face we'd like\n                            // to put the connector on.  ideally, when drawing, the face should be calculated\n                            // by determining which face is closest to the point at which the mouse button\n                            // was released.  for now, we're putting it on the top face.\n                            _updateAnchorList( anchorLists[sourceId], -Math.PI / 2, 0, conn, false, targetId, 0, false, \"top\", sourceId, connectionsToPaint, endpointsToPaint);\n                            _updateAnchorList( anchorLists[targetId], -Math.PI / 2, 0, conn, false, sourceId, 1, false, \"top\", targetId, connectionsToPaint, endpointsToPaint);\n                        }\n                        else {\n                            if (!o) {\n                                o = this.calculateOrientation(sourceId, targetId, sd.o, td.o, conn.endpoints[0].anchor, conn.endpoints[1].anchor, conn);\n                                orientationCache[oKey] = o;\n                                // this would be a performance enhancement, but the computed angles need to be clamped to\n                                //the (-PI/2 -> PI/2) range in order for the sorting to work properly.\n                                /*  orientationCache[oKey2] = {\n                                 orientation:o.orientation,\n                                 a:[o.a[1], o.a[0]],\n                                 theta:o.theta + Math.PI,\n                                 theta2:o.theta2 + Math.PI\n                                 };*/\n                            }\n                            if (sourceContinuous) {\n                                _updateAnchorList(anchorLists[sourceId], o.theta, 0, conn, false, targetId, 0, false, o.a[0], sourceId, connectionsToPaint, endpointsToPaint);\n                            }\n                            if (targetContinuous) {\n                                _updateAnchorList(anchorLists[targetId], o.theta2, -1, conn, true, sourceId, 1, true, o.a[1], targetId, connectionsToPaint, endpointsToPaint);\n                            }\n                        }\n\n                        if (sourceContinuous) {\n                            _ju.addWithFunction(anchorsToUpdate, sourceId, function (a) {\n                                return a === sourceId;\n                            });\n                        }\n                        if (targetContinuous) {\n                            _ju.addWithFunction(anchorsToUpdate, targetId, function (a) {\n                                return a === targetId;\n                            });\n                        }\n                        _ju.addWithFunction(connectionsToPaint, conn, function (c) {\n                            return c.id === conn.id;\n                        });\n                        if ((sourceContinuous && oIdx === 0) || (targetContinuous && oIdx === 1)) {\n                            _ju.addWithFunction(endpointsToPaint, conn.endpoints[oIdx], function (e) {\n                                return e.id === conn.endpoints[oIdx].id;\n                            });\n                        }\n                    }\n                }\n\n                // place Endpoints whose anchors are continuous but have no Connections\n                for (i = 0; i < ep.length; i++) {\n                    if (ep[i].connections.length === 0 && ep[i].anchor.isContinuous) {\n                        if (!anchorLists[elementId]) {\n                            anchorLists[elementId] = { top: [], right: [], bottom: [], left: [] };\n                        }\n                        _updateAnchorList(anchorLists[elementId], -Math.PI / 2, 0, {endpoints: [ep[i], ep[i]], paint: function () {\n                        }}, false, elementId, 0, false, ep[i].anchor.getDefaultFace(), elementId, connectionsToPaint, endpointsToPaint);\n                        _ju.addWithFunction(anchorsToUpdate, elementId, function (a) {\n                            return a === elementId;\n                        });\n                    }\n                }\n\n                // now place all the continuous anchors we need to;\n                for (i = 0; i < anchorsToUpdate.length; i++) {\n                    placeAnchors(anchorsToUpdate[i], anchorLists[anchorsToUpdate[i]]);\n                }\n\n                // now that continuous anchors have been placed, paint all the endpoints for this element\n                for (i = 0; i < ep.length; i++) {\n                    ep[i].paint({ timestamp: timestamp, offset: myOffset, dimensions: myOffset.s, recalc: doNotRecalcEndpoint !== true });\n                }\n\n                // ... and any other endpoints we came across as a result of the continuous anchors.\n                for (i = 0; i < endpointsToPaint.length; i++) {\n                    var cd = jsPlumbInstance.getCachedData(endpointsToPaint[i].elementId);\n                    //endpointsToPaint[i].paint({ timestamp: timestamp, offset: cd, dimensions: cd.s });\n                    endpointsToPaint[i].paint({ timestamp: null, offset: cd, dimensions: cd.s });\n                }\n\n                // paint all the standard and \"dynamic connections\", which are connections whose other anchor is\n                // static and therefore does need to be recomputed; we make sure that happens only one time.\n\n                // TODO we could have compiled a list of these in the first pass through connections; might save some time.\n                for (i = 0; i < endpointConnections.length; i++) {\n                    var otherEndpoint = endpointConnections[i][1];\n                    if (otherEndpoint.anchor.constructor === _jp.DynamicAnchor) {\n                        otherEndpoint.paint({ elementWithPrecedence: elementId, timestamp: timestamp });\n                        _ju.addWithFunction(connectionsToPaint, endpointConnections[i][0], function (c) {\n                            return c.id === endpointConnections[i][0].id;\n                        });\n                        // all the connections for the other endpoint now need to be repainted\n                        for (var k = 0; k < otherEndpoint.connections.length; k++) {\n                            if (otherEndpoint.connections[k] !== endpointConnections[i][0]) {\n                                _ju.addWithFunction(connectionsToPaint, otherEndpoint.connections[k], function (c) {\n                                    return c.id === otherEndpoint.connections[k].id;\n                                });\n                            }\n                        }\n                    } else {\n                        _ju.addWithFunction(connectionsToPaint, endpointConnections[i][0], function (c) {\n                            return c.id === endpointConnections[i][0].id;\n                        });\n                    }\n                }\n\n                // paint current floating connection for this element, if there is one.\n                var fc = floatingConnections[elementId];\n                if (fc) {\n                    fc.paint({timestamp: timestamp, recalc: false, elId: elementId});\n                }\n\n                // paint all the connections\n                for (i = 0; i < connectionsToPaint.length; i++) {\n                    connectionsToPaint[i].paint({elId: elementId, timestamp: null, recalc: false, clearEdits: clearEdits});\n                }\n            }\n        };\n\n        var ContinuousAnchor = function (anchorParams) {\n            _ju.EventGenerator.apply(this);\n            this.type = \"Continuous\";\n            this.isDynamic = true;\n            this.isContinuous = true;\n            var faces = anchorParams.faces || [\"top\", \"right\", \"bottom\", \"left\"],\n                clockwise = !(anchorParams.clockwise === false),\n                availableFaces = { },\n                opposites = { \"top\": \"bottom\", \"right\": \"left\", \"left\": \"right\", \"bottom\": \"top\" },\n                clockwiseOptions = { \"top\": \"right\", \"right\": \"bottom\", \"left\": \"top\", \"bottom\": \"left\" },\n                antiClockwiseOptions = { \"top\": \"left\", \"right\": \"top\", \"left\": \"bottom\", \"bottom\": \"right\" },\n                secondBest = clockwise ? clockwiseOptions : antiClockwiseOptions,\n                lastChoice = clockwise ? antiClockwiseOptions : clockwiseOptions,\n                cssClass = anchorParams.cssClass || \"\",\n                _currentFace = null, _lockedFace = null, X_AXIS_FACES = [\"left\", \"right\"], Y_AXIS_FACES = [\"top\", \"bottom\"],\n                _lockedAxis = null;\n\n            for (var i = 0; i < faces.length; i++) {\n                availableFaces[faces[i]] = true;\n            }\n\n            this.getDefaultFace = function () {\n                return faces.length === 0 ? \"top\" : faces[0];\n            };\n\n            this.isRelocatable = function() { return true; };\n            this.isSnapOnRelocate = function() { return true; };\n\n            // if the given edge is supported, returns it. otherwise looks for a substitute that _is_\n            // supported. if none supported we also return the request edge.\n            this.verifyEdge = function (edge) {\n                if (availableFaces[edge]) {\n                    return edge;\n                }\n                else if (availableFaces[opposites[edge]]) {\n                    return opposites[edge];\n                }\n                else if (availableFaces[secondBest[edge]]) {\n                    return secondBest[edge];\n                }\n                else if (availableFaces[lastChoice[edge]]) {\n                    return lastChoice[edge];\n                }\n                return edge; // we have to give them something.\n            };\n\n            this.isEdgeSupported = function (edge) {\n                return  _lockedAxis == null ?\n\n                    (_lockedFace == null ? availableFaces[edge] === true : _lockedFace === edge)\n\n                    : _lockedAxis.indexOf(edge) !== -1;\n            };\n\n            this.setCurrentFace = function(face, overrideLock) {\n                _currentFace = face;\n                // if currently locked, and the user wants to override, do that.\n                if (overrideLock && _lockedFace != null) {\n                    _lockedFace = _currentFace;\n                }\n            };\n\n            this.getCurrentFace = function() { return _currentFace; };\n            this.getSupportedFaces = function() {\n                var af = [];\n                for (var k in availableFaces) {\n                    if (availableFaces[k]) {\n                        af.push(k);\n                    }\n                }\n                return af;\n            };\n\n            this.lock = function() {\n                _lockedFace = _currentFace;\n            };\n            this.unlock = function() {\n                _lockedFace = null;\n            };\n            this.isLocked = function() {\n                return _lockedFace != null;\n            };\n\n            this.lockCurrentAxis = function() {\n                if (_currentFace != null) {\n                    _lockedAxis = (_currentFace === \"left\" || _currentFace === \"right\") ? X_AXIS_FACES : Y_AXIS_FACES;\n                }\n            };\n\n            this.unlockCurrentAxis = function() {\n                _lockedAxis = null;\n            };\n\n            this.compute = function (params) {\n                return continuousAnchorLocations[params.element.id] || [0, 0];\n            };\n            this.getCurrentLocation = function (params) {\n                return continuousAnchorLocations[params.element.id] || [0, 0];\n            };\n            this.getOrientation = function (endpoint) {\n                return continuousAnchorOrientations[endpoint.id] || [0, 0];\n            };\n            this.getCssClass = function () {\n                return cssClass;\n            };\n        };\n\n        // continuous anchors\n        jsPlumbInstance.continuousAnchorFactory = {\n            get: function (params) {\n                return new ContinuousAnchor(params);\n            },\n            clear: function (elementId) {\n                delete continuousAnchorLocations[elementId];\n            }\n        };\n    };\n\n    _jp.AnchorManager.prototype.calculateOrientation = function (sourceId, targetId, sd, td, sourceAnchor, targetAnchor) {\n\n        var Orientation = { HORIZONTAL: \"horizontal\", VERTICAL: \"vertical\", DIAGONAL: \"diagonal\", IDENTITY: \"identity\" },\n            axes = [\"left\", \"top\", \"right\", \"bottom\"];\n\n        if (sourceId === targetId) {\n            return {\n                orientation: Orientation.IDENTITY,\n                a: [\"top\", \"top\"]\n            };\n        }\n\n        var theta = Math.atan2((td.centery - sd.centery), (td.centerx - sd.centerx)),\n            theta2 = Math.atan2((sd.centery - td.centery), (sd.centerx - td.centerx));\n\n// --------------------------------------------------------------------------------------\n\n        // improved face calculation. get midpoints of each face for source and target, then put in an array with all combinations of\n        // source/target faces. sort this array by distance between midpoints. the entry at index 0 is our preferred option. we can\n        // go through the array one by one until we find an entry in which each requested face is supported.\n        var candidates = [], midpoints = { };\n        (function (types, dim) {\n            for (var i = 0; i < types.length; i++) {\n                midpoints[types[i]] = {\n                    \"left\": [ dim[i].left, dim[i].centery ],\n                    \"right\": [ dim[i].right, dim[i].centery ],\n                    \"top\": [ dim[i].centerx, dim[i].top ],\n                    \"bottom\": [ dim[i].centerx , dim[i].bottom]\n                };\n            }\n        })([ \"source\", \"target\" ], [ sd, td ]);\n\n        for (var sf = 0; sf < axes.length; sf++) {\n            for (var tf = 0; tf < axes.length; tf++) {\n                candidates.push({\n                    source: axes[sf],\n                    target: axes[tf],\n                    dist: Biltong.lineLength(midpoints.source[axes[sf]], midpoints.target[axes[tf]])\n                });\n            }\n        }\n\n        candidates.sort(function (a, b) {\n            return a.dist < b.dist ? -1 : a.dist > b.dist ? 1 : 0;\n        });\n\n        // now go through this list and try to get an entry that satisfies both (there will be one, unless one of the anchors\n        // declares no available faces)\n        var sourceEdge = candidates[0].source, targetEdge = candidates[0].target;\n        for (var i = 0; i < candidates.length; i++) {\n\n            if (!sourceAnchor.isContinuous || sourceAnchor.isEdgeSupported(candidates[i].source)) {\n                sourceEdge = candidates[i].source;\n            }\n            else {\n                sourceEdge = null;\n            }\n\n            if (!targetAnchor.isContinuous || targetAnchor.isEdgeSupported(candidates[i].target)) {\n                targetEdge = candidates[i].target;\n            }\n            else {\n                targetEdge = null;\n            }\n\n            if (sourceEdge != null && targetEdge != null) {\n                break;\n            }\n        }\n\n        if (sourceAnchor.isContinuous) {\n            sourceAnchor.setCurrentFace(sourceEdge);\n        }\n\n        if (targetAnchor.isContinuous) {\n            targetAnchor.setCurrentFace(targetEdge);\n        }\n\n// --------------------------------------------------------------------------------------\n\n        return {\n            a: [ sourceEdge, targetEdge ],\n            theta: theta,\n            theta2: theta2\n        };\n    };\n\n    /**\n     * Anchors model a position on some element at which an Endpoint may be located.  They began as a first class citizen of jsPlumb, ie. a user\n     * was required to create these themselves, but over time this has been replaced by the concept of referring to them either by name (eg. \"TopMiddle\"),\n     * or by an array describing their coordinates (eg. [ 0, 0.5, 0, -1 ], which is the same as \"TopMiddle\").  jsPlumb now handles all of the\n     * creation of Anchors without user intervention.\n     */\n    _jp.Anchor = function (params) {\n        this.x = params.x || 0;\n        this.y = params.y || 0;\n        this.elementId = params.elementId;\n        this.cssClass = params.cssClass || \"\";\n        this.userDefinedLocation = null;\n        this.orientation = params.orientation || [ 0, 0 ];\n        this.lastReturnValue = null;\n        this.offsets = params.offsets || [ 0, 0 ];\n        this.timestamp = null;\n\n        var relocatable = params.relocatable !== false;\n        this.isRelocatable = function() { return relocatable; };\n        this.setRelocatable = function(_relocatable) { relocatable = _relocatable; };\n        var snapOnRelocate = params.snapOnRelocate !== false;\n        this.isSnapOnRelocate = function() { return snapOnRelocate; };\n\n        var locked = false;\n        this.lock = function() { locked = true; };\n        this.unlock = function() { locked = false; };\n        this.isLocked = function() { return locked; };\n\n        _ju.EventGenerator.apply(this);\n\n        this.compute = function (params) {\n\n            var xy = params.xy, wh = params.wh, timestamp = params.timestamp;\n\n            if (params.clearUserDefinedLocation) {\n                this.userDefinedLocation = null;\n            }\n\n            if (timestamp && timestamp === this.timestamp) {\n                return this.lastReturnValue;\n            }\n\n            if (this.userDefinedLocation != null) {\n                this.lastReturnValue = this.userDefinedLocation;\n            }\n            else {\n                this.lastReturnValue = [ xy[0] + (this.x * wh[0]) + this.offsets[0], xy[1] + (this.y * wh[1]) + this.offsets[1], this.x, this.y ];\n            }\n\n            this.timestamp = timestamp;\n            return this.lastReturnValue;\n        };\n\n        this.getCurrentLocation = function (params) {\n            params = params || {};\n            return (this.lastReturnValue == null || (params.timestamp != null && this.timestamp !== params.timestamp)) ? this.compute(params) : this.lastReturnValue;\n        };\n\n        this.setPosition = function(x, y, ox, oy, overrideLock) {\n            if (!locked || overrideLock) {\n                this.x = x;\n                this.y = y;\n                this.orientation = [ ox, oy ];\n                this.lastReturnValue = null;\n            }\n        };\n    };\n    _ju.extend(_jp.Anchor, _ju.EventGenerator, {\n        equals: function (anchor) {\n            if (!anchor) {\n                return false;\n            }\n            var ao = anchor.getOrientation(),\n                o = this.getOrientation();\n            return this.x === anchor.x && this.y === anchor.y && this.offsets[0] === anchor.offsets[0] && this.offsets[1] === anchor.offsets[1] && o[0] === ao[0] && o[1] === ao[1];\n        },\n        getUserDefinedLocation: function () {\n            return this.userDefinedLocation;\n        },\n        setUserDefinedLocation: function (l) {\n            this.userDefinedLocation = l;\n        },\n        clearUserDefinedLocation: function () {\n            this.userDefinedLocation = null;\n        },\n        getOrientation: function () {\n            return this.orientation;\n        },\n        getCssClass: function () {\n            return this.cssClass;\n        }\n    });\n\n    /**\n     * An Anchor that floats. its orientation is computed dynamically from\n     * its position relative to the anchor it is floating relative to.  It is used when creating\n     * a connection through drag and drop.\n     *\n     * TODO FloatingAnchor could totally be refactored to extend Anchor just slightly.\n     */\n    _jp.FloatingAnchor = function (params) {\n\n        _jp.Anchor.apply(this, arguments);\n\n        // this is the anchor that this floating anchor is referenced to for\n        // purposes of calculating the orientation.\n        var ref = params.reference,\n            // the canvas this refers to.\n            refCanvas = params.referenceCanvas,\n            size = _jp.getSize(refCanvas),\n            // these are used to store the current relative position of our\n            // anchor wrt the reference anchor. they only indicate\n            // direction, so have a value of 1 or -1 (or, very rarely, 0). these\n            // values are written by the compute method, and read\n            // by the getOrientation method.\n            xDir = 0, yDir = 0,\n            // temporary member used to store an orientation when the floating\n            // anchor is hovering over another anchor.\n            orientation = null,\n            _lastResult = null;\n\n        // clear from parent. we want floating anchor orientation to always be computed.\n        this.orientation = null;\n\n        // set these to 0 each; they are used by certain types of connectors in the loopback case,\n        // when the connector is trying to clear the element it is on. but for floating anchor it's not\n        // very important.\n        this.x = 0;\n        this.y = 0;\n\n        this.isFloating = true;\n\n        this.compute = function (params) {\n            var xy = params.xy,\n                result = [ xy[0] + (size[0] / 2), xy[1] + (size[1] / 2) ]; // return origin of the element. we may wish to improve this so that any object can be the drag proxy.\n            _lastResult = result;\n            return result;\n        };\n\n        this.getOrientation = function (_endpoint) {\n            if (orientation) {\n                return orientation;\n            }\n            else {\n                var o = ref.getOrientation(_endpoint);\n                // here we take into account the orientation of the other\n                // anchor: if it declares zero for some direction, we declare zero too. this might not be the most awesome. perhaps we can come\n                // up with a better way. it's just so that the line we draw looks like it makes sense. maybe this wont make sense.\n                return [ Math.abs(o[0]) * xDir * -1,\n                    Math.abs(o[1]) * yDir * -1 ];\n            }\n        };\n\n        /**\n         * notification the endpoint associated with this anchor is hovering\n         * over another anchor; we want to assume that anchor's orientation\n         * for the duration of the hover.\n         */\n        this.over = function (anchor, endpoint) {\n            orientation = anchor.getOrientation(endpoint);\n        };\n\n        /**\n         * notification the endpoint associated with this anchor is no\n         * longer hovering over another anchor; we should resume calculating\n         * orientation as we normally do.\n         */\n        this.out = function () {\n            orientation = null;\n        };\n\n        this.getCurrentLocation = function (params) {\n            return _lastResult == null ? this.compute(params) : _lastResult;\n        };\n    };\n    _ju.extend(_jp.FloatingAnchor, _jp.Anchor);\n\n    var _convertAnchor = function (anchor, jsPlumbInstance, elementId) {\n        return anchor.constructor === _jp.Anchor ? anchor : jsPlumbInstance.makeAnchor(anchor, elementId, jsPlumbInstance);\n    };\n\n    /* \n     * A DynamicAnchor is an Anchor that contains a list of other Anchors, which it cycles\n     * through at compute time to find the one that is located closest to\n     * the center of the target element, and returns that Anchor's compute\n     * method result. this causes endpoints to follow each other with\n     * respect to the orientation of their target elements, which is a useful\n     * feature for some applications.\n     * \n     */\n    _jp.DynamicAnchor = function (params) {\n        _jp.Anchor.apply(this, arguments);\n\n        this.isDynamic = true;\n        this.anchors = [];\n        this.elementId = params.elementId;\n        this.jsPlumbInstance = params.jsPlumbInstance;\n\n        for (var i = 0; i < params.anchors.length; i++) {\n            this.anchors[i] = _convertAnchor(params.anchors[i], this.jsPlumbInstance, this.elementId);\n        }\n\n        this.getAnchors = function () {\n            return this.anchors;\n        };\n\n        var _curAnchor = this.anchors.length > 0 ? this.anchors[0] : null,\n            _lastAnchor = _curAnchor,\n            self = this,\n\n            // helper method to calculate the distance between the centers of the two elements.\n            _distance = function (anchor, cx, cy, xy, wh) {\n                var ax = xy[0] + (anchor.x * wh[0]), ay = xy[1] + (anchor.y * wh[1]),\n                    acx = xy[0] + (wh[0] / 2), acy = xy[1] + (wh[1] / 2);\n                return (Math.sqrt(Math.pow(cx - ax, 2) + Math.pow(cy - ay, 2)) +\n                Math.sqrt(Math.pow(acx - ax, 2) + Math.pow(acy - ay, 2)));\n            },\n            // default method uses distance between element centers.  you can provide your own method in the dynamic anchor\n            // constructor (and also to jsPlumb.makeDynamicAnchor). the arguments to it are four arrays:\n            // xy - xy loc of the anchor's element\n            // wh - anchor's element's dimensions\n            // txy - xy loc of the element of the other anchor in the connection\n            // twh - dimensions of the element of the other anchor in the connection.\n            // anchors - the list of selectable anchors\n            _anchorSelector = params.selector || function (xy, wh, txy, twh, anchors) {\n                    var cx = txy[0] + (twh[0] / 2), cy = txy[1] + (twh[1] / 2);\n                    var minIdx = -1, minDist = Infinity;\n                    for (var i = 0; i < anchors.length; i++) {\n                        var d = _distance(anchors[i], cx, cy, xy, wh);\n                        if (d < minDist) {\n                            minIdx = i + 0;\n                            minDist = d;\n                        }\n                    }\n                    return anchors[minIdx];\n                };\n\n        this.compute = function (params) {\n            var xy = params.xy, wh = params.wh, txy = params.txy, twh = params.twh;\n\n            this.timestamp = params.timestamp;\n\n            var udl = self.getUserDefinedLocation();\n            if (udl != null) {\n                return udl;\n            }\n\n            // if anchor is locked or an opposite element was not given, we\n            // maintain our state. anchor will be locked\n            // if it is the source of a drag and drop.\n            if (this.isLocked() || txy == null || twh == null) {\n                return _curAnchor.compute(params);\n            }\n            else {\n                params.timestamp = null; // otherwise clear this, i think. we want the anchor to compute.\n            }\n\n            _curAnchor = _anchorSelector(xy, wh, txy, twh, this.anchors);\n            this.x = _curAnchor.x;\n            this.y = _curAnchor.y;\n\n            if (_curAnchor !== _lastAnchor) {\n                this.fire(\"anchorChanged\", _curAnchor);\n            }\n\n            _lastAnchor = _curAnchor;\n\n            return _curAnchor.compute(params);\n        };\n\n        this.getCurrentLocation = function (params) {\n            return this.getUserDefinedLocation() || (_curAnchor != null ? _curAnchor.getCurrentLocation(params) : null);\n        };\n\n        this.getOrientation = function (_endpoint) {\n            return _curAnchor != null ? _curAnchor.getOrientation(_endpoint) : [ 0, 0 ];\n        };\n        this.over = function (anchor, endpoint) {\n            if (_curAnchor != null) {\n                _curAnchor.over(anchor, endpoint);\n            }\n        };\n        this.out = function () {\n            if (_curAnchor != null) {\n                _curAnchor.out();\n            }\n        };\n\n        this.setAnchor = function(a) {\n            _curAnchor = a;\n        };\n\n        this.getCssClass = function () {\n            return (_curAnchor && _curAnchor.getCssClass()) || \"\";\n        };\n\n        /**\n         * Attempt to match an anchor with the given coordinates and then set it.\n         * @param coords\n         * @returns true if matching anchor found, false otherwise.\n         */\n        this.setAnchorCoordinates = function(coords) {\n            var idx = jsPlumbUtil.findWithFunction(this.anchors, function(a) {\n                return a.x === coords[0] && a.y === coords[1];\n            });\n            if (idx !== -1) {\n                this.setAnchor(this.anchors[idx]);\n                return true;\n            } else {\n                return false;\n            }\n        };\n    };\n    _ju.extend(_jp.DynamicAnchor, _jp.Anchor);\n\n// -------- basic anchors ------------------    \n    var _curryAnchor = function (x, y, ox, oy, type, fnInit) {\n        _jp.Anchors[type] = function (params) {\n            var a = params.jsPlumbInstance.makeAnchor([ x, y, ox, oy, 0, 0 ], params.elementId, params.jsPlumbInstance);\n            a.type = type;\n            if (fnInit) {\n                fnInit(a, params);\n            }\n            return a;\n        };\n    };\n\n    _curryAnchor(0.5, 0, 0, -1, \"TopCenter\");\n    _curryAnchor(0.5, 1, 0, 1, \"BottomCenter\");\n    _curryAnchor(0, 0.5, -1, 0, \"LeftMiddle\");\n    _curryAnchor(1, 0.5, 1, 0, \"RightMiddle\");\n\n    _curryAnchor(0.5, 0, 0, -1, \"Top\");\n    _curryAnchor(0.5, 1, 0, 1, \"Bottom\");\n    _curryAnchor(0, 0.5, -1, 0, \"Left\");\n    _curryAnchor(1, 0.5, 1, 0, \"Right\");\n    _curryAnchor(0.5, 0.5, 0, 0, \"Center\");\n    _curryAnchor(1, 0, 0, -1, \"TopRight\");\n    _curryAnchor(1, 1, 0, 1, \"BottomRight\");\n    _curryAnchor(0, 0, 0, -1, \"TopLeft\");\n    _curryAnchor(0, 1, 0, 1, \"BottomLeft\");\n\n// ------- dynamic anchors -------------------    \n\n    // default dynamic anchors chooses from Top, Right, Bottom, Left\n    _jp.Defaults.DynamicAnchors = function (params) {\n        return params.jsPlumbInstance.makeAnchors([\"TopCenter\", \"RightMiddle\", \"BottomCenter\", \"LeftMiddle\"], params.elementId, params.jsPlumbInstance);\n    };\n\n    // default dynamic anchors bound to name 'AutoDefault'\n    _jp.Anchors.AutoDefault = function (params) {\n        var a = params.jsPlumbInstance.makeDynamicAnchor(_jp.Defaults.DynamicAnchors(params));\n        a.type = \"AutoDefault\";\n        return a;\n    };\n\n// ------- continuous anchors -------------------    \n\n    var _curryContinuousAnchor = function (type, faces) {\n        _jp.Anchors[type] = function (params) {\n            var a = params.jsPlumbInstance.makeAnchor([\"Continuous\", { faces: faces }], params.elementId, params.jsPlumbInstance);\n            a.type = type;\n            return a;\n        };\n    };\n\n    _jp.Anchors.Continuous = function (params) {\n        return params.jsPlumbInstance.continuousAnchorFactory.get(params);\n    };\n\n    _curryContinuousAnchor(\"ContinuousLeft\", [\"left\"]);\n    _curryContinuousAnchor(\"ContinuousTop\", [\"top\"]);\n    _curryContinuousAnchor(\"ContinuousBottom\", [\"bottom\"]);\n    _curryContinuousAnchor(\"ContinuousRight\", [\"right\"]);\n\n// ------- position assign anchors -------------------    \n\n    // this anchor type lets you assign the position at connection time.\n    _curryAnchor(0, 0, 0, 0, \"Assign\", function (anchor, params) {\n        // find what to use as the \"position finder\". the user may have supplied a String which represents\n        // the id of a position finder in jsPlumb.AnchorPositionFinders, or the user may have supplied the\n        // position finder as a function.  we find out what to use and then set it on the anchor.\n        var pf = params.position || \"Fixed\";\n        anchor.positionFinder = pf.constructor === String ? params.jsPlumbInstance.AnchorPositionFinders[pf] : pf;\n        // always set the constructor params; the position finder might need them later (the Grid one does,\n        // for example)\n        anchor.constructorParams = params;\n    });\n\n    // these are the default anchor positions finders, which are used by the makeTarget function.  supplying\n    // a position finder argument to that function allows you to specify where the resulting anchor will\n    // be located\n    root.jsPlumbInstance.prototype.AnchorPositionFinders = {\n        \"Fixed\": function (dp, ep, es) {\n            return [ (dp.left - ep.left) / es[0], (dp.top - ep.top) / es[1] ];\n        },\n        \"Grid\": function (dp, ep, es, params) {\n            var dx = dp.left - ep.left, dy = dp.top - ep.top,\n                gx = es[0] / (params.grid[0]), gy = es[1] / (params.grid[1]),\n                mx = Math.floor(dx / gx), my = Math.floor(dy / gy);\n            return [ ((mx * gx) + (gx / 2)) / es[0], ((my * gy) + (gy / 2)) / es[1] ];\n        }\n    };\n\n// ------- perimeter anchors -------------------    \n\n    _jp.Anchors.Perimeter = function (params) {\n        params = params || {};\n        var anchorCount = params.anchorCount || 60,\n            shape = params.shape;\n\n        if (!shape) {\n            throw new Error(\"no shape supplied to Perimeter Anchor type\");\n        }\n\n        var _circle = function () {\n                var r = 0.5, step = Math.PI * 2 / anchorCount, current = 0, a = [];\n                for (var i = 0; i < anchorCount; i++) {\n                    var x = r + (r * Math.sin(current)),\n                        y = r + (r * Math.cos(current));\n                    a.push([ x, y, 0, 0 ]);\n                    current += step;\n                }\n                return a;\n            },\n            _path = function (segments) {\n                var anchorsPerFace = anchorCount / segments.length, a = [],\n                    _computeFace = function (x1, y1, x2, y2, fractionalLength, ox, oy) {\n                        anchorsPerFace = anchorCount * fractionalLength;\n                        var dx = (x2 - x1) / anchorsPerFace, dy = (y2 - y1) / anchorsPerFace;\n                        for (var i = 0; i < anchorsPerFace; i++) {\n                            a.push([\n                                x1 + (dx * i),\n                                y1 + (dy * i),\n                                ox == null ? 0 : ox,\n                                oy == null ? 0 : oy\n                            ]);\n                        }\n                    };\n\n                for (var i = 0; i < segments.length; i++) {\n                    _computeFace.apply(null, segments[i]);\n                }\n\n                return a;\n            },\n            _shape = function (faces) {\n                var s = [];\n                for (var i = 0; i < faces.length; i++) {\n                    s.push([faces[i][0], faces[i][1], faces[i][2], faces[i][3], 1 / faces.length, faces[i][4], faces[i][5]]);\n                }\n                return _path(s);\n            },\n            _rectangle = function () {\n                return _shape([\n                    [ 0, 0, 1, 0, 0, -1 ],\n                    [ 1, 0, 1, 1, 1, 0 ],\n                    [ 1, 1, 0, 1, 0, 1 ],\n                    [ 0, 1, 0, 0, -1, 0 ]\n                ]);\n            };\n\n        var _shapes = {\n                \"Circle\": _circle,\n                \"Ellipse\": _circle,\n                \"Diamond\": function () {\n                    return _shape([\n                        [ 0.5, 0, 1, 0.5 ],\n                        [ 1, 0.5, 0.5, 1 ],\n                        [ 0.5, 1, 0, 0.5 ],\n                        [ 0, 0.5, 0.5, 0 ]\n                    ]);\n                },\n                \"Rectangle\": _rectangle,\n                \"Square\": _rectangle,\n                \"Triangle\": function () {\n                    return _shape([\n                        [ 0.5, 0, 1, 1 ],\n                        [ 1, 1, 0, 1 ],\n                        [ 0, 1, 0.5, 0]\n                    ]);\n                },\n                \"Path\": function (params) {\n                    var points = params.points, p = [], tl = 0;\n                    for (var i = 0; i < points.length - 1; i++) {\n                        var l = Math.sqrt(Math.pow(points[i][2] - points[i][0]) + Math.pow(points[i][3] - points[i][1]));\n                        tl += l;\n                        p.push([points[i][0], points[i][1], points[i + 1][0], points[i + 1][1], l]);\n                    }\n                    for (var j = 0; j < p.length; j++) {\n                        p[j][4] = p[j][4] / tl;\n                    }\n                    return _path(p);\n                }\n            },\n            _rotate = function (points, amountInDegrees) {\n                var o = [], theta = amountInDegrees / 180 * Math.PI;\n                for (var i = 0; i < points.length; i++) {\n                    var _x = points[i][0] - 0.5,\n                        _y = points[i][1] - 0.5;\n\n                    o.push([\n                        0.5 + ((_x * Math.cos(theta)) - (_y * Math.sin(theta))),\n                        0.5 + ((_x * Math.sin(theta)) + (_y * Math.cos(theta))),\n                        points[i][2],\n                        points[i][3]\n                    ]);\n                }\n                return o;\n            };\n\n        if (!_shapes[shape]) {\n            throw new Error(\"Shape [\" + shape + \"] is unknown by Perimeter Anchor type\");\n        }\n\n        var da = _shapes[shape](params);\n        if (params.rotation) {\n            da = _rotate(da, params.rotation);\n        }\n        var a = params.jsPlumbInstance.makeDynamicAnchor(da);\n        a.type = \"Perimeter\";\n        return a;\n    };\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * Default router. Defers to an AnchorManager for placement of anchors, and connector paint routines for paths.\n * Currently this is a placeholder and acts as a facade to the pre-existing anchor manager. The Toolkit edition\n * will make use of concept to provide more advanced routing.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n\n;\n(function () {\n\n    \"use strict\";\n\n    var root = this,\n        _ju = root.jsPlumbUtil,\n        _jp = root.jsPlumb;\n\n    _jp.DefaultRouter = function(jsPlumbInstance) {\n        this.jsPlumbInstance = jsPlumbInstance;\n        this.anchorManager = new _jp.AnchorManager({jsPlumbInstance:jsPlumbInstance});\n\n        this.sourceOrTargetChanged = function (originalId, newId, connection, newElement, anchorIndex) {\n            this.anchorManager.sourceOrTargetChanged(originalId, newId, connection, newElement, anchorIndex);\n        };\n\n        this.reset = function() {\n            this.anchorManager.reset();\n        };\n\n        this.changeId = function (oldId, newId) {\n            this.anchorManager.changeId(oldId, newId);\n        };\n\n        this.elementRemoved = function (elementId) {\n            this.anchorManager.elementRemoved(elementId);\n        };\n\n        this.newConnection = function (conn) {\n            this.anchorManager.newConnection(conn);\n        };\n\n        this.connectionDetached = function (connInfo, doNotRedraw) {\n            this.anchorManager.connectionDetached(connInfo, doNotRedraw);\n        };\n    };\n\n\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n\n\n/*\n * This file contains the default Connectors, Endpoint and Overlay definitions.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil, _jg = root.Biltong;\n\n    _jp.Segments = {\n\n        /*\n         * Class: AbstractSegment\n         * A Connector is made up of 1..N Segments, each of which has a Type, such as 'Straight', 'Arc',\n         * 'Bezier'. This is new from 1.4.2, and gives us a lot more flexibility when drawing connections: things such\n         * as rounded corners for flowchart connectors, for example, or a straight line stub for Bezier connections, are\n         * much easier to do now.\n         *\n         * A Segment is responsible for providing coordinates for painting it, and also must be able to report its length.\n         * \n         */\n        AbstractSegment: function (params) {\n            this.params = params;\n\n            /**\n             * Function: findClosestPointOnPath\n             * Finds the closest point on this segment to the given [x, y],\n             * returning both the x and y of the point plus its distance from\n             * the supplied point, and its location along the length of the\n             * path inscribed by the segment.  This implementation returns\n             * Infinity for distance and null values for everything else;\n             * subclasses are expected to override.\n             */\n            this.findClosestPointOnPath = function (x, y) {\n                return {\n                    d: Infinity,\n                    x: null,\n                    y: null,\n                    l: null\n                };\n            };\n\n            this.getBounds = function () {\n                return {\n                    minX: Math.min(params.x1, params.x2),\n                    minY: Math.min(params.y1, params.y2),\n                    maxX: Math.max(params.x1, params.x2),\n                    maxY: Math.max(params.y1, params.y2)\n                };\n            };\n\n            /**\n             * Computes the list of points on the segment that intersect the given line.\n             * @method lineIntersection\n             * @param {number} x1\n             * @param {number} y1\n             * @param {number} x2\n             * @param {number} y2\n             * @returns {Array<[number, number]>}\n             */\n            this.lineIntersection = function(x1, y1, x2, y2) {\n                return [];\n            };\n\n            /**\n             * Computes the list of points on the segment that intersect the box with the given origin and size.\n             * @method boxIntersection\n             * @param {number} x1\n             * @param {number} y1\n             * @param {number} w\n             * @param {number} h\n             * @returns {Array<[number, number]>}\n             */\n            this.boxIntersection = function(x, y, w, h) {\n                var a = [];\n                a.push.apply(a, this.lineIntersection(x, y, x + w, y));\n                a.push.apply(a, this.lineIntersection(x + w, y, x + w, y + h));\n                a.push.apply(a, this.lineIntersection(x + w, y + h, x, y + h));\n                a.push.apply(a, this.lineIntersection(x, y + h, x, y));\n                return a;\n            };\n\n            /**\n             * Computes the list of points on the segment that intersect the given bounding box, which is an object of the form { x:.., y:.., w:.., h:.. }.\n             * @method lineIntersection\n             * @param {BoundingRectangle} box\n             * @returns {Array<[number, number]>}\n             */\n            this.boundingBoxIntersection = function(box) {\n                return this.boxIntersection(box.x, box.y, box.w, box.y);\n            };\n        },\n        Straight: function (params) {\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments),\n                length, m, m2, x1, x2, y1, y2,\n                _recalc = function () {\n                    length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n                    m = _jg.gradient({x: x1, y: y1}, {x: x2, y: y2});\n                    m2 = -1 / m;\n                };\n\n            this.type = \"Straight\";\n\n            this.getLength = function () {\n                return length;\n            };\n            this.getGradient = function () {\n                return m;\n            };\n\n            this.getCoordinates = function () {\n                return { x1: x1, y1: y1, x2: x2, y2: y2 };\n            };\n            this.setCoordinates = function (coords) {\n                x1 = coords.x1;\n                y1 = coords.y1;\n                x2 = coords.x2;\n                y2 = coords.y2;\n                _recalc();\n            };\n            this.setCoordinates({x1: params.x1, y1: params.y1, x2: params.x2, y2: params.y2});\n\n            this.getBounds = function () {\n                return {\n                    minX: Math.min(x1, x2),\n                    minY: Math.min(y1, y2),\n                    maxX: Math.max(x1, x2),\n                    maxY: Math.max(y1, y2)\n                };\n            };\n\n            /**\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\n             * 0 to 1 inclusive. for the straight line segment this is simple maths.\n             */\n            this.pointOnPath = function (location, absolute) {\n                if (location === 0 && !absolute) {\n                    return { x: x1, y: y1 };\n                }\n                else if (location === 1 && !absolute) {\n                    return { x: x2, y: y2 };\n                }\n                else {\n                    var l = absolute ? location > 0 ? location : length + location : location * length;\n                    return _jg.pointOnLine({x: x1, y: y1}, {x: x2, y: y2}, l);\n                }\n            };\n\n            /**\n             * returns the gradient of the segment at the given point - which for us is constant.\n             */\n            this.gradientAtPoint = function (_) {\n                return m;\n            };\n\n            /**\n             * returns the point on the segment's path that is 'distance' along the length of the path from 'location', where\n             * 'location' is a decimal from 0 to 1 inclusive, and 'distance' is a number of pixels.\n             * this hands off to jsPlumbUtil to do the maths, supplying two points and the distance.\n             */\n            this.pointAlongPathFrom = function (location, distance, absolute) {\n                var p = this.pointOnPath(location, absolute),\n                    farAwayPoint = distance <= 0 ? {x: x1, y: y1} : {x: x2, y: y2 };\n\n                /*\n                 location == 1 ? {\n                 x:x1 + ((x2 - x1) * 10),\n                 y:y1 + ((y1 - y2) * 10)\n                 } :\n                 */\n\n                if (distance <= 0 && Math.abs(distance) > 1) {\n                    distance *= -1;\n                }\n\n                return _jg.pointOnLine(p, farAwayPoint, distance);\n            };\n\n            // is c between a and b?\n            var within = function (a, b, c) {\n                return c >= Math.min(a, b) && c <= Math.max(a, b);\n            };\n            // find which of a and b is closest to c\n            var closest = function (a, b, c) {\n                return Math.abs(c - a) < Math.abs(c - b) ? a : b;\n            };\n\n            /**\n             Function: findClosestPointOnPath\n             Finds the closest point on this segment to [x,y]. See\n             notes on this method in AbstractSegment.\n             */\n            this.findClosestPointOnPath = function (x, y) {\n                var out = {\n                    d: Infinity,\n                    x: null,\n                    y: null,\n                    l: null,\n                    x1: x1,\n                    x2: x2,\n                    y1: y1,\n                    y2: y2\n                };\n\n                if (m === 0) {\n                    out.y = y1;\n                    out.x = within(x1, x2, x) ? x : closest(x1, x2, x);\n                }\n                else if (m === Infinity || m === -Infinity) {\n                    out.x = x1;\n                    out.y = within(y1, y2, y) ? y : closest(y1, y2, y);\n                }\n                else {\n                    // closest point lies on normal from given point to this line.  \n                    var b = y1 - (m * x1),\n                        b2 = y - (m2 * x),\n                    // y1 = m.x1 + b and y1 = m2.x1 + b2\n                    // so m.x1 + b = m2.x1 + b2\n                    // x1(m - m2) = b2 - b\n                    // x1 = (b2 - b) / (m - m2)\n                        _x1 = (b2 - b) / (m - m2),\n                        _y1 = (m * _x1) + b;\n\n                    out.x = within(x1, x2, _x1) ? _x1 : closest(x1, x2, _x1);//_x1;\n                    out.y = within(y1, y2, _y1) ? _y1 : closest(y1, y2, _y1);//_y1;\n                }\n\n                var fractionInSegment = _jg.lineLength([ out.x, out.y ], [ x1, y1 ]);\n                out.d = _jg.lineLength([x, y], [out.x, out.y]);\n                out.l = fractionInSegment / length;\n                return out;\n            };\n\n            var _pointLiesBetween = function(q, p1, p2) {\n                return (p2 > p1) ? (p1 <= q && q <= p2) : (p1 >= q && q >= p2);\n            }, _plb = _pointLiesBetween;\n\n            /**\n             * Calculates all intersections of the given line with this segment.\n             * @param _x1\n             * @param _y1\n             * @param _x2\n             * @param _y2\n             * @returns {Array}\n             */\n            this.lineIntersection = function(_x1, _y1, _x2, _y2) {\n                var m2 = Math.abs(_jg.gradient({x: _x1, y: _y1}, {x: _x2, y: _y2})),\n                    m1 = Math.abs(m),\n                    b = m1 === Infinity ? x1 : y1 - (m1 * x1),\n                    out = [],\n                    b2 = m2 === Infinity ? _x1 : _y1 - (m2 * _x1);\n\n                // if lines parallel, no intersection\n                if  (m2 !== m1) {\n                    // perpendicular, segment horizontal\n                    if(m2 === Infinity  && m1 === 0) {\n                        if (_plb(_x1, x1, x2) && _plb(y1, _y1, _y2)) {\n                            out = [ _x1, y1 ];  // we return X on the incident line and Y from the segment\n                        }\n                    } else if(m2 === 0 && m1 === Infinity) {\n                        // perpendicular, segment vertical\n                        if(_plb(_y1, y1, y2) && _plb(x1, _x1, _x2)) {\n                            out = [x1, _y1];  // we return X on the segment and Y from the incident line\n                        }\n                    } else {\n                        var X, Y;\n                        if (m2 === Infinity) {\n                            // test line is a vertical line. where does it cross the segment?\n                            X = _x1;\n                            if (_plb(X, x1, x2)) {\n                                Y = (m1 * _x1) + b;\n                                if (_plb(Y, _y1, _y2)) {\n                                    out = [ X, Y ];\n                                }\n                            }\n                        } else if (m2 === 0) {\n                            Y = _y1;\n                            // test line is a horizontal line. where does it cross the segment?\n                            if (_plb(Y, y1, y2)) {\n                                X = (_y1 - b) / m1;\n                                if (_plb(X, _x1, _x2)) {\n                                    out = [ X, Y ];\n                                }\n                            }\n                        } else {\n                            // mX + b = m2X + b2\n                            // mX - m2X = b2 - b\n                            // X(m - m2) = b2 - b\n                            // X = (b2 - b) / (m - m2)\n                            // Y = mX + b\n                            X = (b2 - b) / (m1 - m2);\n                            Y = (m1 * X) + b;\n                            if(_plb(X, x1, x2) && _plb(Y, y1, y2)) {\n                                out = [ X,  Y];\n                            }\n                        }\n                    }\n                }\n\n                return out;\n            };\n\n            /**\n             * Calculates all intersections of the given box with this segment. By default this method simply calls `lineIntersection` with each of the four\n             * faces of the box; subclasses can override this if they think there's a faster way to compute the entire box at once.\n             * @param x X position of top left corner of box\n             * @param y Y position of top left corner of box\n             * @param w width of box\n             * @param h height of box\n             * @returns {Array}\n             */\n            this.boxIntersection = function(x, y, w, h) {\n                var a = [];\n                a.push.apply(a, this.lineIntersection(x, y, x + w, y));\n                a.push.apply(a, this.lineIntersection(x + w, y, x + w, y + h));\n                a.push.apply(a, this.lineIntersection(x + w, y + h, x, y + h));\n                a.push.apply(a, this.lineIntersection(x, y + h, x, y));\n                return a;\n            };\n\n            /**\n             * Calculates all intersections of the given bounding box with this segment. By default this method simply calls `lineIntersection` with each of the four\n             * faces of the box; subclasses can override this if they think there's a faster way to compute the entire box at once.\n             * @param box Bounding box, in { x:.., y:..., w:..., h:... } format.\n             * @returns {Array}\n             */\n            this.boundingBoxIntersection = function(box) {\n                return this.boxIntersection(box.x, box.y, box.w, box.h);\n            };\n        },\n\n        /*\n         Arc Segment. You need to supply:\n\n         r   -   radius\n         cx  -   center x for the arc\n         cy  -   center y for the arc\n         ac  -   whether the arc is anticlockwise or not. default is clockwise.\n\n         and then either:\n\n         startAngle  -   startAngle for the arc.\n         endAngle    -   endAngle for the arc.\n\n         or:\n\n         x1          -   x for start point\n         y1          -   y for start point\n         x2          -   x for end point\n         y2          -   y for end point\n\n         */\n        Arc: function (params) {\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments),\n                _calcAngle = function (_x, _y) {\n                    return _jg.theta([params.cx, params.cy], [_x, _y]);\n                },\n                _calcAngleForLocation = function (segment, location) {\n                    if (segment.anticlockwise) {\n                        var sa = segment.startAngle < segment.endAngle ? segment.startAngle + TWO_PI : segment.startAngle,\n                            s = Math.abs(sa - segment.endAngle);\n                        return sa - (s * location);\n                    }\n                    else {\n                        var ea = segment.endAngle < segment.startAngle ? segment.endAngle + TWO_PI : segment.endAngle,\n                            ss = Math.abs(ea - segment.startAngle);\n\n                        return segment.startAngle + (ss * location);\n                    }\n                },\n                TWO_PI = 2 * Math.PI;\n\n            this.radius = params.r;\n            this.anticlockwise = params.ac;\n            this.type = \"Arc\";\n\n            if (params.startAngle && params.endAngle) {\n                this.startAngle = params.startAngle;\n                this.endAngle = params.endAngle;\n                this.x1 = params.cx + (this.radius * Math.cos(params.startAngle));\n                this.y1 = params.cy + (this.radius * Math.sin(params.startAngle));\n                this.x2 = params.cx + (this.radius * Math.cos(params.endAngle));\n                this.y2 = params.cy + (this.radius * Math.sin(params.endAngle));\n            }\n            else {\n                this.startAngle = _calcAngle(params.x1, params.y1);\n                this.endAngle = _calcAngle(params.x2, params.y2);\n                this.x1 = params.x1;\n                this.y1 = params.y1;\n                this.x2 = params.x2;\n                this.y2 = params.y2;\n            }\n\n            if (this.endAngle < 0) {\n                this.endAngle += TWO_PI;\n            }\n            if (this.startAngle < 0) {\n                this.startAngle += TWO_PI;\n            }\n\n            // segment is used by vml     \n            //this.segment = _jg.quadrant([this.x1, this.y1], [this.x2, this.y2]);\n\n            // we now have startAngle and endAngle as positive numbers, meaning the\n            // absolute difference (|d|) between them is the sweep (s) of this arc, unless the\n            // arc is 'anticlockwise' in which case 's' is given by 2PI - |d|.\n\n            var ea = this.endAngle < this.startAngle ? this.endAngle + TWO_PI : this.endAngle;\n            this.sweep = Math.abs(ea - this.startAngle);\n            if (this.anticlockwise) {\n                this.sweep = TWO_PI - this.sweep;\n            }\n            var circumference = 2 * Math.PI * this.radius,\n                frac = this.sweep / TWO_PI,\n                length = circumference * frac;\n\n            this.getLength = function () {\n                return length;\n            };\n\n            this.getBounds = function () {\n                return {\n                    minX: params.cx - params.r,\n                    maxX: params.cx + params.r,\n                    minY: params.cy - params.r,\n                    maxY: params.cy + params.r\n                };\n            };\n\n            var VERY_SMALL_VALUE = 0.0000000001,\n                gentleRound = function (n) {\n                    var f = Math.floor(n), r = Math.ceil(n);\n                    if (n - f < VERY_SMALL_VALUE) {\n                        return f;\n                    }\n                    else if (r - n < VERY_SMALL_VALUE) {\n                        return r;\n                    }\n                    return n;\n                };\n\n            /**\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\n             * 0 to 1 inclusive.\n             */\n            this.pointOnPath = function (location, absolute) {\n\n                if (location === 0) {\n                    return { x: this.x1, y: this.y1, theta: this.startAngle };\n                }\n                else if (location === 1) {\n                    return { x: this.x2, y: this.y2, theta: this.endAngle };\n                }\n\n                if (absolute) {\n                    location = location / length;\n                }\n\n                var angle = _calcAngleForLocation(this, location),\n                    _x = params.cx + (params.r * Math.cos(angle)),\n                    _y = params.cy + (params.r * Math.sin(angle));\n\n                return { x: gentleRound(_x), y: gentleRound(_y), theta: angle };\n            };\n\n            /**\n             * returns the gradient of the segment at the given point.\n             */\n            this.gradientAtPoint = function (location, absolute) {\n                var p = this.pointOnPath(location, absolute);\n                var m = _jg.normal([ params.cx, params.cy ], [p.x, p.y ]);\n                if (!this.anticlockwise && (m === Infinity || m === -Infinity)) {\n                    m *= -1;\n                }\n                return m;\n            };\n\n            this.pointAlongPathFrom = function (location, distance, absolute) {\n                var p = this.pointOnPath(location, absolute),\n                    arcSpan = distance / circumference * 2 * Math.PI,\n                    dir = this.anticlockwise ? -1 : 1,\n                    startAngle = p.theta + (dir * arcSpan),\n                    startX = params.cx + (this.radius * Math.cos(startAngle)),\n                    startY = params.cy + (this.radius * Math.sin(startAngle));\n\n                return {x: startX, y: startY};\n            };\n\n            // TODO: lineIntersection\n        },\n\n        Bezier: function (params) {\n            this.curve = [\n                { x: params.x1, y: params.y1},\n                { x: params.cp1x, y: params.cp1y },\n                { x: params.cp2x, y: params.cp2y },\n                { x: params.x2, y: params.y2 }\n            ];\n\n            var _isPoint = function(c) {\n                return c[0].x === c[1].x && c[0].y === c[1].y;\n            };\n\n            var _dist = function(p1, p2 ) {\n                return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n            };\n\n            var _compute = function(loc) {\n\n                var EMPTY_POINT  = {x:0, y:0};\n\n                if (loc === 0) {\n                    return this.curve[0];\n                }\n\n                var degree = this.curve.length - 1;\n\n                if (loc === 1) {\n                    return this.curve[degree];\n                }\n\n                var o = this.curve;\n                var s = 1 - loc;\n\n                if (degree === 0) {\n                    return this.curve[0];\n                }\n\n                if (degree === 1) {\n                    return {\n                        x: s * o[0].x + loc * o[1].x,\n                        y: s * o[0].y + loc * o[1].y\n                    };\n                }\n\n                if (degree < 4) {\n\n                    var l = s * s, h = loc * loc, u = 0, m, g, f;\n\n                    if (degree === 2) {\n                        o = [o[0], o[1], o[2], EMPTY_POINT];\n                        m = l;\n                        g = 2 * (s * loc);\n                        f = h;\n                    } else if (degree === 3) {\n                        m = l * s;\n                        g = 3 * (l * loc);\n                        f = 3 * (s * h);\n                        u = loc * h;\n                    }\n\n                    return {\n                        x: m * o[0].x + g * o[1].x + f * o[2].x + u * o[3].x,\n                        y: m * o[0].y + g * o[1].y + f * o[2].y + u * o[3].y\n                    };\n                } else {\n                    return EMPTY_POINT; // not supported.\n                }\n            }.bind(this);\n\n            var _getLUT = function(steps) {\n                var out = [];\n                steps--;\n                for (var n = 0; n <= steps; n++) {\n                    out.push(_compute(n / steps));\n                }\n                return out;\n            };\n\n            var _computeLength = function() {\n\n                if (_isPoint(this.curve)) {\n                    this.length = 0;\n                }\n\n                var steps = 16;\n                var  lut = _getLUT(steps);\n                this.length = 0;\n\n                for (var i = 0; i < steps - 1; i++) {\n                    var a = lut[i], b = lut[i + 1];\n                    this.length += _dist(a, b);\n                }\n            }.bind(this);\n\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments);\n            // although this is not a strictly rigorous determination of bounds\n            // of a bezier curve, it works for the types of curves that this segment\n            // type produces.\n            this.bounds = {\n                minX: Math.min(params.x1, params.x2, params.cp1x, params.cp2x),\n                minY: Math.min(params.y1, params.y2, params.cp1y, params.cp2y),\n                maxX: Math.max(params.x1, params.x2, params.cp1x, params.cp2x),\n                maxY: Math.max(params.y1, params.y2, params.cp1y, params.cp2y)\n            };\n\n            this.type = \"Bezier\";\n\n            _computeLength();\n\n            var _translateLocation = function (_curve, location, absolute) {\n                if (absolute) {\n                    location = root.jsBezier.locationAlongCurveFrom(_curve, location > 0 ? 0 : 1, location);\n                }\n\n                return location;\n            };\n\n            /**\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\n             * 0 to 1 inclusive.\n             */\n            this.pointOnPath = function (location, absolute) {\n                location = _translateLocation(this.curve, location, absolute);\n                return root.jsBezier.pointOnCurve(this.curve, location);\n            };\n\n            /**\n             * returns the gradient of the segment at the given point.\n             */\n            this.gradientAtPoint = function (location, absolute) {\n                location = _translateLocation(this.curve, location, absolute);\n                return root.jsBezier.gradientAtPoint(this.curve, location);\n            };\n\n            this.pointAlongPathFrom = function (location, distance, absolute) {\n                location = _translateLocation(this.curve, location, absolute);\n                return root.jsBezier.pointAlongCurveFrom(this.curve, location, distance);\n            };\n\n            this.getLength = function () {\n                return this.length;\n            };\n\n            this.getBounds = function () {\n                return this.bounds;\n            };\n\n            this.findClosestPointOnPath = function (x, y) {\n                var p = root.jsBezier.nearestPointOnCurve({x:x,y:y}, this.curve);\n                return {\n                    d:Math.sqrt(Math.pow(p.point.x - x, 2) + Math.pow(p.point.y - y, 2)),\n                    x:p.point.x,\n                    y:p.point.y,\n                    l:1 - p.location,\n                    s:this\n                };\n            };\n\n            this.lineIntersection = function(x1, y1, x2, y2) {\n                return root.jsBezier.lineIntersection(x1, y1, x2, y2, this.curve);\n            };\n        }\n    };\n\n    _jp.SegmentRenderer = {\n        getPath: function (segment, isFirstSegment) {\n            return ({\n                \"Straight\": function (isFirstSegment) {\n                    var d = segment.getCoordinates();\n                    return (isFirstSegment ? \"M \" + d.x1 + \" \" + d.y1 + \" \" : \"\") + \"L \" + d.x2 + \" \" + d.y2;\n                },\n                \"Bezier\": function (isFirstSegment) {\n                    var d = segment.params;\n                    return (isFirstSegment ? \"M \" + d.x2 + \" \" + d.y2 + \" \" : \"\") +\n                        \"C \" + d.cp2x + \" \" + d.cp2y + \" \" + d.cp1x + \" \" + d.cp1y + \" \" + d.x1 + \" \" + d.y1;\n                },\n                \"Arc\": function (isFirstSegment) {\n                    var d = segment.params,\n                        laf = segment.sweep > Math.PI ? 1 : 0,\n                        sf = segment.anticlockwise ? 0 : 1;\n\n                    return  (isFirstSegment ? \"M\" + segment.x1 + \" \" + segment.y1  + \" \" : \"\")  + \"A \" + segment.radius + \" \" + d.r + \" 0 \" + laf + \",\" + sf + \" \" + segment.x2 + \" \" + segment.y2;\n                }\n            })[segment.type](isFirstSegment);\n        }\n    };\n\n    /*\n     Class: UIComponent\n     Superclass for Connector and AbstractEndpoint.\n     */\n    var AbstractComponent = function () {\n        this.resetBounds = function () {\n            this.bounds = { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity };\n        };\n        this.resetBounds();\n    };\n\n    /*\n     * Class: Connector\n     * Superclass for all Connectors; here is where Segments are managed.  This is exposed on jsPlumb just so it\n     * can be accessed from other files. You should not try to instantiate one of these directly.\n     *\n     * When this class is asked for a pointOnPath, or gradient etc, it must first figure out which segment to dispatch\n     * that request to. This is done by keeping track of the total connector length as segments are added, and also\n     * their cumulative ratios to the total length.  Then when the right segment is found it is a simple case of dispatching\n     * the request to it (and adjusting 'location' so that it is relative to the beginning of that segment.)\n     */\n    _jp.Connectors.AbstractConnector = function (params) {\n\n        AbstractComponent.apply(this, arguments);\n\n        var segments = [],\n            totalLength = 0,\n            segmentProportions = [],\n            segmentProportionalLengths = [],\n            stub = params.stub || 0,\n            sourceStub = _ju.isArray(stub) ? stub[0] : stub,\n            targetStub = _ju.isArray(stub) ? stub[1] : stub,\n            gap = params.gap || 0,\n            sourceGap = _ju.isArray(gap) ? gap[0] : gap,\n            targetGap = _ju.isArray(gap) ? gap[1] : gap,\n            userProvidedSegments = null,\n            paintInfo = null;\n\n        this.getPathData = function() {\n            var p = \"\";\n            for (var i = 0; i < segments.length; i++) {\n                p += _jp.SegmentRenderer.getPath(segments[i], i === 0);\n                p += \" \";\n            }\n            return p;\n        };\n\n        /**\n         * Function: findSegmentForPoint\n         * Returns the segment that is closest to the given [x,y],\n         * null if nothing found.  This function returns a JS\n         * object with:\n         *\n         *   d   -   distance from segment\n         *   l   -   proportional location in segment\n         *   x   -   x point on the segment\n         *   y   -   y point on the segment\n         *   s   -   the segment itself.\n         *   connectorLocation - the location on the connector of the point, expressed as a decimal between 0 and 1 inclusive.\n         */\n        this.findSegmentForPoint = function (x, y) {\n            var out = { d: Infinity, s: null, x: null, y: null, l: null };\n            for (var i = 0; i < segments.length; i++) {\n                var _s = segments[i].findClosestPointOnPath(x, y);\n                if (_s.d < out.d) {\n                    out.d = _s.d;\n                    out.l = _s.l;\n                    out.x = _s.x;\n                    out.y = _s.y;\n                    out.s = segments[i];\n                    out.x1 = _s.x1;\n                    out.x2 = _s.x2;\n                    out.y1 = _s.y1;\n                    out.y2 = _s.y2;\n                    out.index = i;\n                    out.connectorLocation = segmentProportions[i][0] + (_s.l * (segmentProportions[i][1] - segmentProportions[i][0]));\n                }\n            }\n\n            return out;\n        };\n\n        this.lineIntersection = function(x1, y1, x2, y2) {\n            var out = [];\n            for (var i = 0; i < segments.length; i++) {\n                out.push.apply(out, segments[i].lineIntersection(x1, y1, x2, y2));\n            }\n            return out;\n        };\n\n        this.boxIntersection = function(x, y, w, h) {\n            var out = [];\n            for (var i = 0; i < segments.length; i++) {\n                out.push.apply(out, segments[i].boxIntersection(x, y, w, h));\n            }\n            return out;\n        };\n\n        this.boundingBoxIntersection = function(box) {\n            var out = [];\n            for (var i = 0; i < segments.length; i++) {\n                out.push.apply(out, segments[i].boundingBoxIntersection(box));\n            }\n            return out;\n        };\n\n        var _updateSegmentProportions = function () {\n                var curLoc = 0;\n                for (var i = 0; i < segments.length; i++) {\n                    var sl = segments[i].getLength();\n                    segmentProportionalLengths[i] = sl / totalLength;\n                    segmentProportions[i] = [curLoc, (curLoc += (sl / totalLength)) ];\n                }\n            },\n\n            /**\n             * returns [segment, proportion of travel in segment, segment index] for the segment\n             * that contains the point which is 'location' distance along the entire path, where\n             * 'location' is a decimal between 0 and 1 inclusive. in this connector type, paths\n             * are made up of a list of segments, each of which contributes some fraction to\n             * the total length.\n             * From 1.3.10 this also supports the 'absolute' property, which lets us specify a location\n             * as the absolute distance in pixels, rather than a proportion of the total path.\n             */\n            _findSegmentForLocation = function (location, absolute) {\n\n                var idx, i, inSegmentProportion;\n\n                if (absolute) {\n                    location = location > 0 ? location / totalLength : (totalLength + location) / totalLength;\n                }\n\n                // if location 1 we know its the last segment\n                if (location === 1) {\n                    idx = segments.length - 1;\n                    inSegmentProportion = 1;\n                } else if (location === 0) {\n                    // if location 0 we know its the first segment\n                    inSegmentProportion = 0;\n                    idx = 0;\n                } else {\n\n                    // if location >= 0.5, traverse backwards (of course not exact, who knows the segment proportions. but\n                    // an educated guess at least)\n                    if (location >= 0.5) {\n\n                        idx = 0;\n                        inSegmentProportion = 0;\n                        for (i = segmentProportions.length - 1; i > -1; i--) {\n                            if (segmentProportions[i][1] >= location && segmentProportions[i][0] <= location) {\n                                idx = i;\n                                inSegmentProportion = (location - segmentProportions[i][0]) / segmentProportionalLengths[i];\n                                break;\n                            }\n                        }\n\n                    } else {\n                        idx = segmentProportions.length - 1;\n                        inSegmentProportion = 1;\n                        for (i = 0; i < segmentProportions.length; i++) {\n                            if (segmentProportions[i][1] >= location) {\n                                idx = i;\n                                inSegmentProportion = (location - segmentProportions[i][0]) / segmentProportionalLengths[i];\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                return { segment: segments[idx], proportion: inSegmentProportion, index: idx };\n            },\n            _addSegment = function (conn, type, params) {\n                if (params.x1 === params.x2 && params.y1 === params.y2) {\n                    return;\n                }\n                var s = new _jp.Segments[type](params);\n                segments.push(s);\n                totalLength += s.getLength();\n                conn.updateBounds(s);\n            },\n            _clearSegments = function () {\n                totalLength = segments.length = segmentProportions.length = segmentProportionalLengths.length = 0;\n            };\n\n        this.setSegments = function (_segs) {\n            userProvidedSegments = [];\n            totalLength = 0;\n            for (var i = 0; i < _segs.length; i++) {\n                userProvidedSegments.push(_segs[i]);\n                totalLength += _segs[i].getLength();\n            }\n        };\n\n        this.getLength = function() {\n            return totalLength;\n        };\n\n        var _prepareCompute = function (params) {\n            this.strokeWidth = params.strokeWidth;\n            var segment = _jg.quadrant(params.sourcePos, params.targetPos),\n                swapX = params.targetPos[0] < params.sourcePos[0],\n                swapY = params.targetPos[1] < params.sourcePos[1],\n                lw = params.strokeWidth || 1,\n                so = params.sourceEndpoint.anchor.getOrientation(params.sourceEndpoint),\n                to = params.targetEndpoint.anchor.getOrientation(params.targetEndpoint),\n                x = swapX ? params.targetPos[0] : params.sourcePos[0],\n                y = swapY ? params.targetPos[1] : params.sourcePos[1],\n                w = Math.abs(params.targetPos[0] - params.sourcePos[0]),\n                h = Math.abs(params.targetPos[1] - params.sourcePos[1]);\n            \n            // if either anchor does not have an orientation set, we derive one from their relative\n            // positions.  we fix the axis to be the one in which the two elements are further apart, and\n            // point each anchor at the other element.  this is also used when dragging a new connection.\n            if (so[0] === 0 && so[1] === 0 || to[0] === 0 && to[1] === 0) {\n                var index = w > h ? 0 : 1, oIndex = [1, 0][index];\n                so = [];\n                to = [];\n                so[index] = params.sourcePos[index] > params.targetPos[index] ? -1 : 1;\n                to[index] = params.sourcePos[index] > params.targetPos[index] ? 1 : -1;\n                so[oIndex] = 0;\n                to[oIndex] = 0;\n            }\n\n            var sx = swapX ? w + (sourceGap * so[0]) : sourceGap * so[0],\n                sy = swapY ? h + (sourceGap * so[1]) : sourceGap * so[1],\n                tx = swapX ? targetGap * to[0] : w + (targetGap * to[0]),\n                ty = swapY ? targetGap * to[1] : h + (targetGap * to[1]),\n                oProduct = ((so[0] * to[0]) + (so[1] * to[1]));\n\n            var result = {\n                sx: sx, sy: sy, tx: tx, ty: ty, lw: lw,\n                xSpan: Math.abs(tx - sx),\n                ySpan: Math.abs(ty - sy),\n                mx: (sx + tx) / 2,\n                my: (sy + ty) / 2,\n                so: so, to: to, x: x, y: y, w: w, h: h,\n                segment: segment,\n                startStubX: sx + (so[0] * sourceStub),\n                startStubY: sy + (so[1] * sourceStub),\n                endStubX: tx + (to[0] * targetStub),\n                endStubY: ty + (to[1] * targetStub),\n                isXGreaterThanStubTimes2: Math.abs(sx - tx) > (sourceStub + targetStub),\n                isYGreaterThanStubTimes2: Math.abs(sy - ty) > (sourceStub + targetStub),\n                opposite: oProduct === -1,\n                perpendicular: oProduct === 0,\n                orthogonal: oProduct === 1,\n                sourceAxis: so[0] === 0 ? \"y\" : \"x\",\n                points: [x, y, w, h, sx, sy, tx, ty ],\n                stubs:[sourceStub, targetStub]\n            };\n            result.anchorOrientation = result.opposite ? \"opposite\" : result.orthogonal ? \"orthogonal\" : \"perpendicular\";\n            return result;\n        };\n\n        this.getSegments = function () {\n            return segments;\n        };\n\n        this.updateBounds = function (segment) {\n            var segBounds = segment.getBounds();\n            this.bounds.minX = Math.min(this.bounds.minX, segBounds.minX);\n            this.bounds.maxX = Math.max(this.bounds.maxX, segBounds.maxX);\n            this.bounds.minY = Math.min(this.bounds.minY, segBounds.minY);\n            this.bounds.maxY = Math.max(this.bounds.maxY, segBounds.maxY);\n        };\n\n        var dumpSegmentsToConsole = function () {\n            console.log(\"SEGMENTS:\");\n            for (var i = 0; i < segments.length; i++) {\n                console.log(segments[i].type, segments[i].getLength(), segmentProportions[i]);\n            }\n        };\n\n        this.pointOnPath = function (location, absolute) {\n            var seg = _findSegmentForLocation(location, absolute);\n            return seg.segment && seg.segment.pointOnPath(seg.proportion, false) || [0, 0];\n        };\n\n        this.gradientAtPoint = function (location, absolute) {\n            var seg = _findSegmentForLocation(location, absolute);\n            return seg.segment && seg.segment.gradientAtPoint(seg.proportion, false) || 0;\n        };\n\n        this.pointAlongPathFrom = function (location, distance, absolute) {\n            var seg = _findSegmentForLocation(location, absolute);\n            // TODO what happens if this crosses to the next segment?\n            return seg.segment && seg.segment.pointAlongPathFrom(seg.proportion, distance, false) || [0, 0];\n        };\n\n        this.compute = function (params) {\n            paintInfo = _prepareCompute.call(this, params);\n\n            _clearSegments();\n            this._compute(paintInfo, params);\n            this.x = paintInfo.points[0];\n            this.y = paintInfo.points[1];\n            this.w = paintInfo.points[2];\n            this.h = paintInfo.points[3];\n            this.segment = paintInfo.segment;\n            _updateSegmentProportions();\n        };\n\n        return {\n            addSegment: _addSegment,\n            prepareCompute: _prepareCompute,\n            sourceStub: sourceStub,\n            targetStub: targetStub,\n            maxStub: Math.max(sourceStub, targetStub),\n            sourceGap: sourceGap,\n            targetGap: targetGap,\n            maxGap: Math.max(sourceGap, targetGap)\n        };\n    };\n    _ju.extend(_jp.Connectors.AbstractConnector, AbstractComponent);\n\n\n    // ********************************* END OF CONNECTOR TYPES *******************************************************************\n\n    // ********************************* ENDPOINT TYPES *******************************************************************\n\n    _jp.Endpoints.AbstractEndpoint = function (params) {\n        AbstractComponent.apply(this, arguments);\n        var compute = this.compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            var out = this._compute.apply(this, arguments);\n            this.x = out[0];\n            this.y = out[1];\n            this.w = out[2];\n            this.h = out[3];\n            this.bounds.minX = this.x;\n            this.bounds.minY = this.y;\n            this.bounds.maxX = this.x + this.w;\n            this.bounds.maxY = this.y + this.h;\n            return out;\n        };\n        return {\n            compute: compute,\n            cssClass: params.cssClass\n        };\n    };\n    _ju.extend(_jp.Endpoints.AbstractEndpoint, AbstractComponent);\n\n    /**\n     * Class: Endpoints.Dot\n     * A round endpoint, with default radius 10 pixels.\n     */\n\n    /**\n     * Function: Constructor\n     *\n     * Parameters:\n     *\n     *    radius    -    radius of the endpoint.  defaults to 10 pixels.\n     */\n    _jp.Endpoints.Dot = function (params) {\n        this.type = \"Dot\";\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        params = params || {};\n        this.radius = params.radius || 10;\n        this.defaultOffset = 0.5 * this.radius;\n        this.defaultInnerRadius = this.radius / 3;\n\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            this.radius = endpointStyle.radius || this.radius;\n            var x = anchorPoint[0] - this.radius,\n                y = anchorPoint[1] - this.radius,\n                w = this.radius * 2,\n                h = this.radius * 2;\n\n            if (endpointStyle.stroke) {\n                var lw = endpointStyle.strokeWidth || 1;\n                x -= lw;\n                y -= lw;\n                w += (lw * 2);\n                h += (lw * 2);\n            }\n            return [ x, y, w, h, this.radius ];\n        };\n    };\n    _ju.extend(_jp.Endpoints.Dot, _jp.Endpoints.AbstractEndpoint);\n\n    _jp.Endpoints.Rectangle = function (params) {\n        this.type = \"Rectangle\";\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        params = params || {};\n        this.width = params.width || 20;\n        this.height = params.height || 20;\n\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            var width = endpointStyle.width || this.width,\n                height = endpointStyle.height || this.height,\n                x = anchorPoint[0] - (width / 2),\n                y = anchorPoint[1] - (height / 2);\n\n            return [ x, y, width, height];\n        };\n    };\n    _ju.extend(_jp.Endpoints.Rectangle, _jp.Endpoints.AbstractEndpoint);\n\n    var DOMElementEndpoint = function (params) {\n        _jp.jsPlumbUIComponent.apply(this, arguments);\n        this._jsPlumb.displayElements = [];\n    };\n    _ju.extend(DOMElementEndpoint, _jp.jsPlumbUIComponent, {\n        getDisplayElements: function () {\n            return this._jsPlumb.displayElements;\n        },\n        appendDisplayElement: function (el) {\n            this._jsPlumb.displayElements.push(el);\n        }\n    });\n\n    /**\n     * Class: Endpoints.Image\n     * Draws an image as the Endpoint.\n     */\n    /**\n     * Function: Constructor\n     *\n     * Parameters:\n     *\n     *    src    -    location of the image to use.\n\n     TODO: multiple references to self. not sure quite how to get rid of them entirely. perhaps self = null in the cleanup\n     function will suffice\n\n     TODO this class still might leak memory.\n\n     */\n    _jp.Endpoints.Image = function (params) {\n\n        this.type = \"Image\";\n        DOMElementEndpoint.apply(this, arguments);\n        _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n\n        var _onload = params.onload,\n            src = params.src || params.url,\n            clazz = params.cssClass ? \" \" + params.cssClass : \"\";\n\n        this._jsPlumb.img = new Image();\n        this._jsPlumb.ready = false;\n        this._jsPlumb.initialized = false;\n        this._jsPlumb.deleted = false;\n        this._jsPlumb.widthToUse = params.width;\n        this._jsPlumb.heightToUse = params.height;\n        this._jsPlumb.endpoint = params.endpoint;\n\n        this._jsPlumb.img.onload = function () {\n            if (this._jsPlumb != null) {\n                this._jsPlumb.ready = true;\n                this._jsPlumb.widthToUse = this._jsPlumb.widthToUse || this._jsPlumb.img.width;\n                this._jsPlumb.heightToUse = this._jsPlumb.heightToUse || this._jsPlumb.img.height;\n                if (_onload) {\n                    _onload(this);\n                }\n            }\n        }.bind(this);\n\n        /*\n         Function: setImage\n         Sets the Image to use in this Endpoint.\n\n         Parameters:\n         img         -   may be a URL or an Image object\n         onload      -   optional; a callback to execute once the image has loaded.\n         */\n        this._jsPlumb.endpoint.setImage = function (_img, onload) {\n            var s = _img.constructor === String ? _img : _img.src;\n            _onload = onload;\n            this._jsPlumb.img.src = s;\n\n            if (this.canvas != null) {\n                this.canvas.setAttribute(\"src\", this._jsPlumb.img.src);\n            }\n        }.bind(this);\n\n        this._jsPlumb.endpoint.setImage(src, _onload);\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            this.anchorPoint = anchorPoint;\n            if (this._jsPlumb.ready) {\n                return [anchorPoint[0] - this._jsPlumb.widthToUse / 2, anchorPoint[1] - this._jsPlumb.heightToUse / 2,\n                    this._jsPlumb.widthToUse, this._jsPlumb.heightToUse];\n            }\n            else {\n                return [0, 0, 0, 0];\n            }\n        };\n\n        this.canvas = _jp.createElement(\"img\", {\n            position:\"absolute\",\n            margin:0,\n            padding:0,\n            outline:0\n        }, this._jsPlumb.instance.endpointClass + clazz);\n\n        if (this._jsPlumb.widthToUse) {\n            this.canvas.setAttribute(\"width\", this._jsPlumb.widthToUse);\n        }\n        if (this._jsPlumb.heightToUse) {\n            this.canvas.setAttribute(\"height\", this._jsPlumb.heightToUse);\n        }\n        this._jsPlumb.instance.appendElement(this.canvas);\n\n        this.actuallyPaint = function (d, style, anchor) {\n            if (!this._jsPlumb.deleted) {\n                if (!this._jsPlumb.initialized) {\n                    this.canvas.setAttribute(\"src\", this._jsPlumb.img.src);\n                    this.appendDisplayElement(this.canvas);\n                    this._jsPlumb.initialized = true;\n                }\n                var x = this.anchorPoint[0] - (this._jsPlumb.widthToUse / 2),\n                    y = this.anchorPoint[1] - (this._jsPlumb.heightToUse / 2);\n                _ju.sizeElement(this.canvas, x, y, this._jsPlumb.widthToUse, this._jsPlumb.heightToUse);\n            }\n        };\n\n        this.paint = function (style, anchor) {\n            if (this._jsPlumb != null) {  // may have been deleted\n                if (this._jsPlumb.ready) {\n                    this.actuallyPaint(style, anchor);\n                }\n                else {\n                    root.setTimeout(function () {\n                        this.paint(style, anchor);\n                    }.bind(this), 200);\n                }\n            }\n        };\n    };\n    _ju.extend(_jp.Endpoints.Image, [ DOMElementEndpoint, _jp.Endpoints.AbstractEndpoint ], {\n        cleanup: function (force) {\n            if (force) {\n                this._jsPlumb.deleted = true;\n                if (this.canvas) {\n                    this.canvas.parentNode.removeChild(this.canvas);\n                }\n                this.canvas = null;\n            }\n        }\n    });\n\n    /*\n     * Class: Endpoints.Blank\n     * An Endpoint that paints nothing (visible) on the screen.  Supports cssClass and hoverClass parameters like all Endpoints.\n     */\n    _jp.Endpoints.Blank = function (params) {\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        this.type = \"Blank\";\n        DOMElementEndpoint.apply(this, arguments);\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            return [anchorPoint[0], anchorPoint[1], 10, 0];\n        };\n\n        var clazz = params.cssClass ? \" \" + params.cssClass : \"\";\n\n        this.canvas = _jp.createElement(\"div\", {\n            display: \"block\",\n            width: \"1px\",\n            height: \"1px\",\n            background: \"transparent\",\n            position: \"absolute\"\n        }, this._jsPlumb.instance.endpointClass + clazz);\n\n        this._jsPlumb.instance.appendElement(this.canvas);\n\n        this.paint = function (style, anchor) {\n            _ju.sizeElement(this.canvas, this.x, this.y, this.w, this.h);\n        };\n    };\n    _ju.extend(_jp.Endpoints.Blank, [_jp.Endpoints.AbstractEndpoint, DOMElementEndpoint], {\n        cleanup: function () {\n            if (this.canvas && this.canvas.parentNode) {\n                this.canvas.parentNode.removeChild(this.canvas);\n            }\n        }\n    });\n\n    /*\n     * Class: Endpoints.Triangle\n     * A triangular Endpoint.\n     */\n    /*\n     * Function: Constructor\n     *\n     * Parameters:\n     *\n     * width   width of the triangle's base.  defaults to 55 pixels.\n     * height  height of the triangle from base to apex.  defaults to 55 pixels.\n     */\n    _jp.Endpoints.Triangle = function (params) {\n        this.type = \"Triangle\";\n        _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        var self = this;\n        params = params || {  };\n        params.width = params.width || 55;\n        params.height = params.height || 55;\n        this.width = params.width;\n        this.height = params.height;\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            var width = endpointStyle.width || self.width,\n                height = endpointStyle.height || self.height,\n                x = anchorPoint[0] - (width / 2),\n                y = anchorPoint[1] - (height / 2);\n            return [ x, y, width, height ];\n        };\n    };\n// ********************************* END OF ENDPOINT TYPES *******************************************************************\n\n\n// ********************************* OVERLAY DEFINITIONS ***********************************************************************    \n\n    var AbstractOverlay = _jp.Overlays.AbstractOverlay = function (params) {\n        this.visible = true;\n        this.isAppendedAtTopLevel = true;\n        this.component = params.component;\n        this.loc = params.location == null ? 0.5 : params.location;\n        this.endpointLoc = params.endpointLocation == null ? [ 0.5, 0.5] : params.endpointLocation;\n        this.visible = params.visible !== false;\n    };\n    AbstractOverlay.prototype = {\n        cleanup: function (force) {\n            if (force) {\n                this.component = null;\n                this.canvas = null;\n                this.endpointLoc = null;\n            }\n        },\n        reattach:function(instance, component) { },\n        setVisible: function (val) {\n            this.visible = val;\n            this.component.repaint();\n        },\n        isVisible: function () {\n            return this.visible;\n        },\n        hide: function () {\n            this.setVisible(false);\n        },\n        show: function () {\n            this.setVisible(true);\n        },\n        incrementLocation: function (amount) {\n            this.loc += amount;\n            this.component.repaint();\n        },\n        setLocation: function (l) {\n            this.loc = l;\n            this.component.repaint();\n        },\n        getLocation: function () {\n            return this.loc;\n        },\n        updateFrom:function() { }\n    };\n\n\n    /*\n     * Class: Overlays.Arrow\n     *\n     * An arrow overlay, defined by four points: the head, the two sides of the tail, and a 'foldback' point at some distance along the length\n     * of the arrow that lines from each tail point converge into.  The foldback point is defined using a decimal that indicates some fraction\n     * of the length of the arrow and has a default value of 0.623.  A foldback point value of 1 would mean that the arrow had a straight line\n     * across the tail.\n     */\n    /*\n     * @constructor\n     *\n     * @param {Object} params Constructor params.\n     * @param {Number} [params.length] Distance in pixels from head to tail baseline. default 20.\n     * @param {Number} [params.width] Width in pixels of the tail baseline. default 20.\n     * @param {String} [params.fill] Style to use when filling the arrow.  defaults to \"black\".\n     * @param {String} [params.stroke] Style to use when stroking the arrow. defaults to null, which means the arrow is not stroked.\n     * @param {Number} [params.stroke-width] Line width to use when stroking the arrow. defaults to 1, but only used if stroke is not null.\n     * @param {Number} [params.foldback] Distance (as a decimal from 0 to 1 inclusive) along the length of the arrow marking the point the tail points should fold back to.  defaults to 0.623.\n     * @param {Number} [params.location] Distance (as a decimal from 0 to 1 inclusive) marking where the arrow should sit on the connector. defaults to 0.5.\n     * @param {NUmber} [params.direction] Indicates the direction the arrow points in. valid values are -1 and 1; 1 is default.\n     */\n    _jp.Overlays.Arrow = function (params) {\n        this.type = \"Arrow\";\n        AbstractOverlay.apply(this, arguments);\n        this.isAppendedAtTopLevel = false;\n        params = params || {};\n        var self = this;\n\n        this.length = params.length || 20;\n        this.width = params.width || 20;\n        this.id = params.id;\n        this.direction = (params.direction || 1) < 0 ? -1 : 1;\n        var paintStyle = params.paintStyle || { \"stroke-width\": 1 },\n        // how far along the arrow the lines folding back in come to. default is 62.3%.\n            foldback = params.foldback || 0.623;\n\n        this.computeMaxSize = function () {\n            return self.width * 1.5;\n        };\n\n        this.elementCreated = function(p, component) {\n            this.path = p;\n            if (params.events) {\n                for (var i in params.events) {\n                    _jp.on(p, i, params.events[i]);\n                }\n            }\n        };\n\n        this.draw = function (component, currentConnectionPaintStyle) {\n\n            var hxy, mid, txy, tail, cxy;\n            if (component.pointAlongPathFrom) {\n\n                if (_ju.isString(this.loc) || this.loc > 1 || this.loc < 0) {\n                    var l = parseInt(this.loc, 10),\n                        fromLoc = this.loc < 0 ? 1 : 0;\n                    hxy = component.pointAlongPathFrom(fromLoc, l, false);\n                    mid = component.pointAlongPathFrom(fromLoc, l - (this.direction * this.length / 2), false);\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\n                }\n                else if (this.loc === 1) {\n                    hxy = component.pointOnPath(this.loc);\n                    mid = component.pointAlongPathFrom(this.loc, -(this.length));\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\n\n                    if (this.direction === -1) {\n                        var _ = txy;\n                        txy = hxy;\n                        hxy = _;\n                    }\n                }\n                else if (this.loc === 0) {\n                    txy = component.pointOnPath(this.loc);\n                    mid = component.pointAlongPathFrom(this.loc, this.length);\n                    hxy = _jg.pointOnLine(txy, mid, this.length);\n                    if (this.direction === -1) {\n                        var __ = txy;\n                        txy = hxy;\n                        hxy = __;\n                    }\n                }\n                else {\n                    hxy = component.pointAlongPathFrom(this.loc, this.direction * this.length / 2);\n                    mid = component.pointOnPath(this.loc);\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\n                }\n\n                tail = _jg.perpendicularLineTo(hxy, txy, this.width);\n                cxy = _jg.pointOnLine(hxy, txy, foldback * this.length);\n\n                var d = { hxy: hxy, tail: tail, cxy: cxy },\n                    stroke = paintStyle.stroke || currentConnectionPaintStyle.stroke,\n                    fill = paintStyle.fill || currentConnectionPaintStyle.stroke,\n                    lineWidth = paintStyle.strokeWidth || currentConnectionPaintStyle.strokeWidth;\n\n                return {\n                    component: component,\n                    d: d,\n                    \"stroke-width\": lineWidth,\n                    stroke: stroke,\n                    fill: fill,\n                    minX: Math.min(hxy.x, tail[0].x, tail[1].x),\n                    maxX: Math.max(hxy.x, tail[0].x, tail[1].x),\n                    minY: Math.min(hxy.y, tail[0].y, tail[1].y),\n                    maxY: Math.max(hxy.y, tail[0].y, tail[1].y)\n                };\n            }\n            else {\n                return {component: component, minX: 0, maxX: 0, minY: 0, maxY: 0};\n            }\n        };\n    };\n    _ju.extend(_jp.Overlays.Arrow, AbstractOverlay, {\n        updateFrom:function(d) {\n            this.length = d.length || this.length;\n            this.width = d.width|| this.width;\n            this.direction = d.direction != null ? d.direction : this.direction;\n            this.foldback = d.foldback|| this.foldback;\n        },\n        cleanup:function() {\n            if (this.path && this.path.parentNode) {\n                this.path.parentNode.removeChild(this.path);\n            }\n        }\n    });\n\n    /*\n     * Class: Overlays.PlainArrow\n     *\n     * A basic arrow.  This is in fact just one instance of the more generic case in which the tail folds back on itself to some\n     * point along the length of the arrow: in this case, that foldback point is the full length of the arrow.  so it just does\n     * a 'call' to Arrow with foldback set appropriately.\n     */\n    /*\n     * Function: Constructor\n     * See <Overlays.Arrow> for allowed parameters for this overlay.\n     */\n    _jp.Overlays.PlainArrow = function (params) {\n        params = params || {};\n        var p = _jp.extend(params, {foldback: 1});\n        _jp.Overlays.Arrow.call(this, p);\n        this.type = \"PlainArrow\";\n    };\n    _ju.extend(_jp.Overlays.PlainArrow, _jp.Overlays.Arrow);\n\n    /*\n     * Class: Overlays.Diamond\n     * \n     * A diamond. Like PlainArrow, this is a concrete case of the more generic case of the tail points converging on some point...it just\n     * happens that in this case, that point is greater than the length of the the arrow.\n     *\n     *      this could probably do with some help with positioning...due to the way it reuses the Arrow paint code, what Arrow thinks is the\n     *      center is actually 1/4 of the way along for this guy.  but we don't have any knowledge of pixels at this point, so we're kind of\n     *      stuck when it comes to helping out the Arrow class. possibly we could pass in a 'transpose' parameter or something. the value\n     *      would be -l/4 in this case - move along one quarter of the total length.\n     */\n    /*\n     * Function: Constructor\n     * See <Overlays.Arrow> for allowed parameters for this overlay.\n     */\n    _jp.Overlays.Diamond = function (params) {\n        params = params || {};\n        var l = params.length || 40,\n            p = _jp.extend(params, {length: l / 2, foldback: 2});\n        _jp.Overlays.Arrow.call(this, p);\n        this.type = \"Diamond\";\n    };\n    _ju.extend(_jp.Overlays.Diamond, _jp.Overlays.Arrow);\n\n    var _getDimensions = function (component, forceRefresh) {\n        if (component._jsPlumb.cachedDimensions == null || forceRefresh) {\n            component._jsPlumb.cachedDimensions = component.getDimensions();\n        }\n        return component._jsPlumb.cachedDimensions;\n    };\n\n    // abstract superclass for overlays that add an element to the DOM.\n    var AbstractDOMOverlay = function (params) {\n        _jp.jsPlumbUIComponent.apply(this, arguments);\n        AbstractOverlay.apply(this, arguments);\n\n        // hand off fired events to associated component.\n        var _f = this.fire;\n        this.fire = function () {\n            _f.apply(this, arguments);\n            if (this.component) {\n                this.component.fire.apply(this.component, arguments);\n            }\n        };\n\n        this.detached=false;\n        this.id = params.id;\n        this._jsPlumb.div = null;\n        this._jsPlumb.initialised = false;\n        this._jsPlumb.component = params.component;\n        this._jsPlumb.cachedDimensions = null;\n        this._jsPlumb.create = params.create;\n        this._jsPlumb.initiallyInvisible = params.visible === false;\n\n        this.getElement = function () {\n            if (this._jsPlumb.div == null) {\n                var div = this._jsPlumb.div = _jp.getElement(this._jsPlumb.create(this._jsPlumb.component));\n                div.style.position = \"absolute\";\n                jsPlumb.addClass(div, this._jsPlumb.instance.overlayClass + \" \" +\n                    (this.cssClass ? this.cssClass :\n                        params.cssClass ? params.cssClass : \"\"));\n                this._jsPlumb.instance.appendElement(div);\n                this._jsPlumb.instance.getId(div);\n                this.canvas = div;\n\n                // in IE the top left corner is what it placed at the desired location.  This will not\n                // be fixed. IE8 is not going to be supported for much longer.\n                var ts = \"translate(-50%, -50%)\";\n                div.style.webkitTransform = ts;\n                div.style.mozTransform = ts;\n                div.style.msTransform = ts;\n                div.style.oTransform = ts;\n                div.style.transform = ts;\n\n                // write the related component into the created element\n                div._jsPlumb = this;\n\n                if (params.visible === false) {\n                    div.style.display = \"none\";\n                }\n            }\n            return this._jsPlumb.div;\n        };\n\n        this.draw = function (component, currentConnectionPaintStyle, absolutePosition) {\n            var td = _getDimensions(this);\n            if (td != null && td.length === 2) {\n                var cxy = { x: 0, y: 0 };\n\n                // absolutePosition would have been set by a call to connection.setAbsoluteOverlayPosition.\n                if (absolutePosition) {\n                    cxy = { x: absolutePosition[0], y: absolutePosition[1] };\n                }\n                else if (component.pointOnPath) {\n                    var loc = this.loc, absolute = false;\n                    if (_ju.isString(this.loc) || this.loc < 0 || this.loc > 1) {\n                        loc = parseInt(this.loc, 10);\n                        absolute = true;\n                    }\n                    cxy = component.pointOnPath(loc, absolute);  // a connection\n                }\n                else {\n                    var locToUse = this.loc.constructor === Array ? this.loc : this.endpointLoc;\n                    cxy = { x: locToUse[0] * component.w,\n                        y: locToUse[1] * component.h };\n                }\n\n                var minx = cxy.x - (td[0] / 2),\n                    miny = cxy.y - (td[1] / 2);\n\n                return {\n                    component: component,\n                    d: { minx: minx, miny: miny, td: td, cxy: cxy },\n                    minX: minx,\n                    maxX: minx + td[0],\n                    minY: miny,\n                    maxY: miny + td[1]\n                };\n            }\n            else {\n                return {minX: 0, maxX: 0, minY: 0, maxY: 0};\n            }\n        };\n    };\n    _ju.extend(AbstractDOMOverlay, [_jp.jsPlumbUIComponent, AbstractOverlay], {\n        getDimensions: function () {\n            return [1,1];\n        },\n        setVisible: function (state) {\n            if (this._jsPlumb.div) {\n                this._jsPlumb.div.style.display = state ? \"block\" : \"none\";\n                // if initially invisible, dimensions are 0,0 and never get updated\n                if (state && this._jsPlumb.initiallyInvisible) {\n                    _getDimensions(this, true);\n                    this.component.repaint();\n                    this._jsPlumb.initiallyInvisible = false;\n                }\n            }\n        },\n        /*\n         * Function: clearCachedDimensions\n         * Clears the cached dimensions for the label. As a performance enhancement, label dimensions are\n         * cached from 1.3.12 onwards. The cache is cleared when you change the label text, of course, but\n         * there are other reasons why the text dimensions might change - if you make a change through CSS, for\n         * example, you might change the font size.  in that case you should explicitly call this method.\n         */\n        clearCachedDimensions: function () {\n            this._jsPlumb.cachedDimensions = null;\n        },\n        cleanup: function (force) {\n            if (force) {\n                if (this._jsPlumb.div != null) {\n                    this._jsPlumb.div._jsPlumb = null;\n                    this._jsPlumb.instance.removeElement(this._jsPlumb.div);\n                }\n            }\n            else {\n                // if not a forced cleanup, just detach child from parent for now.\n                if (this._jsPlumb && this._jsPlumb.div && this._jsPlumb.div.parentNode) {\n                    this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div);\n                }\n                this.detached = true;\n            }\n\n        },\n        reattach:function(instance, component) {\n            if (this._jsPlumb.div != null) {\n                instance.getContainer().appendChild(this._jsPlumb.div);\n            }\n            this.detached = false;\n        },\n        computeMaxSize: function () {\n            var td = _getDimensions(this);\n            return Math.max(td[0], td[1]);\n        },\n        paint: function (p, containerExtents) {\n            if (!this._jsPlumb.initialised) {\n                this.getElement();\n                p.component.appendDisplayElement(this._jsPlumb.div);\n                this._jsPlumb.initialised = true;\n                if (this.detached) {\n                    this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div);\n                }\n            }\n            this._jsPlumb.div.style.left = (p.component.x + p.d.minx) + \"px\";\n            this._jsPlumb.div.style.top = (p.component.y + p.d.miny) + \"px\";\n        }\n    });\n\n    /*\n     * Class: Overlays.Custom\n     * A Custom overlay. You supply a 'create' function which returns some DOM element, and jsPlumb positions it.\n     * The 'create' function is passed a Connection or Endpoint.\n     */\n    /*\n     * Function: Constructor\n     * \n     * Parameters:\n     * create - function for jsPlumb to call that returns a DOM element.\n     * location - distance (as a decimal from 0 to 1 inclusive) marking where the label should sit on the connector. defaults to 0.5.\n     * id - optional id to use for later retrieval of this overlay.\n     *\n     */\n    _jp.Overlays.Custom = function (params) {\n        this.type = \"Custom\";\n        AbstractDOMOverlay.apply(this, arguments);\n    };\n    _ju.extend(_jp.Overlays.Custom, AbstractDOMOverlay);\n\n    _jp.Overlays.GuideLines = function () {\n        var self = this;\n        self.length = 50;\n        self.strokeWidth = 5;\n        this.type = \"GuideLines\";\n        AbstractOverlay.apply(this, arguments);\n        _jp.jsPlumbUIComponent.apply(this, arguments);\n        this.draw = function (connector, currentConnectionPaintStyle) {\n\n            var head = connector.pointAlongPathFrom(self.loc, self.length / 2),\n                mid = connector.pointOnPath(self.loc),\n                tail = _jg.pointOnLine(head, mid, self.length),\n                tailLine = _jg.perpendicularLineTo(head, tail, 40),\n                headLine = _jg.perpendicularLineTo(tail, head, 20);\n\n            return {\n                connector: connector,\n                head: head,\n                tail: tail,\n                headLine: headLine,\n                tailLine: tailLine,\n                minX: Math.min(head.x, tail.x, headLine[0].x, headLine[1].x),\n                minY: Math.min(head.y, tail.y, headLine[0].y, headLine[1].y),\n                maxX: Math.max(head.x, tail.x, headLine[0].x, headLine[1].x),\n                maxY: Math.max(head.y, tail.y, headLine[0].y, headLine[1].y)\n            };\n        };\n\n        // this.cleanup = function() { };  // nothing to clean up for GuideLines\n    };\n\n    /*\n     * Class: Overlays.Label\n\n     */\n    /*\n     * Function: Constructor\n     * \n     * Parameters:\n     * cssClass - optional css class string to append to css class. This string is appended \"as-is\", so you can of course have multiple classes\n     *             defined.  This parameter is preferred to using labelStyle, borderWidth and borderStyle.\n     * label - the label to paint.  May be a string or a function that returns a string.  Nothing will be painted if your label is null or your\n     *         label function returns null.  empty strings _will_ be painted.\n     * location - distance (as a decimal from 0 to 1 inclusive) marking where the label should sit on the connector. defaults to 0.5.\n     * id - optional id to use for later retrieval of this overlay.\n     * \n     *\n     */\n    _jp.Overlays.Label = function (params) {\n        this.labelStyle = params.labelStyle;\n\n        var labelWidth = null, labelHeight = null, labelText = null, labelPadding = null;\n        this.cssClass = this.labelStyle != null ? this.labelStyle.cssClass : null;\n        var p = _jp.extend({\n            create: function () {\n                return _jp.createElement(\"div\");\n            }}, params);\n        _jp.Overlays.Custom.call(this, p);\n        this.type = \"Label\";\n        this.label = params.label || \"\";\n        this.labelText = null;\n        if (this.labelStyle) {\n            var el = this.getElement();\n            this.labelStyle.font = this.labelStyle.font || \"12px sans-serif\";\n            el.style.font = this.labelStyle.font;\n            el.style.color = this.labelStyle.color || \"black\";\n            if (this.labelStyle.fill) {\n                el.style.background = this.labelStyle.fill;\n            }\n            if (this.labelStyle.borderWidth > 0) {\n                var dStyle = this.labelStyle.borderStyle ? this.labelStyle.borderStyle : \"black\";\n                el.style.border = this.labelStyle.borderWidth + \"px solid \" + dStyle;\n            }\n            if (this.labelStyle.padding) {\n                el.style.padding = this.labelStyle.padding;\n            }\n        }\n\n    };\n    _ju.extend(_jp.Overlays.Label, _jp.Overlays.Custom, {\n        cleanup: function (force) {\n            if (force) {\n                this.div = null;\n                this.label = null;\n                this.labelText = null;\n                this.cssClass = null;\n                this.labelStyle = null;\n            }\n        },\n        getLabel: function () {\n            return this.label;\n        },\n        /*\n         * Function: setLabel\n         * sets the label's, um, label.  you would think i'd call this function\n         * 'setText', but you can pass either a Function or a String to this, so\n         * it makes more sense as 'setLabel'. This uses innerHTML on the label div, so keep\n         * that in mind if you need escaped HTML.\n         */\n        setLabel: function (l) {\n            this.label = l;\n            this.labelText = null;\n            this.clearCachedDimensions();\n            this.update();\n            this.component.repaint();\n        },\n        getDimensions: function () {\n            this.update();\n            return AbstractDOMOverlay.prototype.getDimensions.apply(this, arguments);\n        },\n        update: function () {\n            if (typeof this.label === \"function\") {\n                var lt = this.label(this);\n                this.getElement().innerHTML = lt.replace(/\\r\\n/g, \"<br/>\");\n            }\n            else {\n                if (this.labelText == null) {\n                    this.labelText = this.label;\n                    this.getElement().innerHTML = this.labelText.replace(/\\r\\n/g, \"<br/>\");\n                }\n            }\n        },\n        updateFrom:function(d) {\n            if(d.label != null){\n                this.setLabel(d.label);\n            }\n        }\n    });\n\n    // ********************************* END OF OVERLAY DEFINITIONS ***********************************************************************\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function() {\n    \"use strict\";\n\n    var root = this,\n        _ju = root.jsPlumbUtil,\n        _jpi = root.jsPlumbInstance;\n\n    var GROUP_COLLAPSED_CLASS = \"jtk-group-collapsed\";\n    var GROUP_EXPANDED_CLASS = \"jtk-group-expanded\";\n    var GROUP_CONTAINER_SELECTOR = \"[jtk-group-content]\";\n    var ELEMENT_DRAGGABLE_EVENT = \"elementDraggable\";\n    var STOP = \"stop\";\n    var REVERT = \"revert\";\n    var GROUP_MANAGER = \"_groupManager\";\n    var GROUP = \"_jsPlumbGroup\";\n    var GROUP_DRAG_SCOPE = \"_jsPlumbGroupDrag\";\n    var EVT_CHILD_ADDED = \"group:addMember\";\n    var EVT_CHILD_REMOVED = \"group:removeMember\";\n    var EVT_GROUP_ADDED = \"group:add\";\n    var EVT_GROUP_REMOVED = \"group:remove\";\n    var EVT_EXPAND = \"group:expand\";\n    var EVT_COLLAPSE = \"group:collapse\";\n    var EVT_GROUP_DRAG_STOP = \"groupDragStop\";\n    var EVT_CONNECTION_MOVED = \"connectionMoved\";\n    var EVT_INTERNAL_CONNECTION_DETACHED = \"internal.connectionDetached\";\n\n    var CMD_REMOVE_ALL = \"removeAll\";\n    var CMD_ORPHAN_ALL = \"orphanAll\";\n    var CMD_SHOW = \"show\";\n    var CMD_HIDE = \"hide\";\n\n    var GroupManager = function(_jsPlumb) {\n        var _managedGroups = {}, _connectionSourceMap = {}, _connectionTargetMap = {}, self = this;\n\n        // function findGroupFor(el) {\n        //     var c = _jsPlumb.getContainer();\n        //     var abort = false, g = null, child = null;\n        //     while (!abort) {\n        //         if (el == null || el === c) {\n        //             abort = true;\n        //         } else {\n        //             if (el[GROUP]) {\n        //                 g = el[GROUP];\n        //                 child = el;\n        //                 abort = true;\n        //             } else {\n        //                 el = el.parentNode;\n        //             }\n        //         }\n        //     }\n        //     return g;\n        // }\n\n        function isDescendant(el, parentEl) {\n            var c = _jsPlumb.getContainer();\n            var abort = false, g = null, child = null;\n            while (!abort) {\n                if (el == null || el === c) {\n                    return false;\n                } else {\n                    if (el === parentEl) {\n                        return true;\n                    } else {\n                        el = el.parentNode;\n                    }\n                }\n            }\n        }\n\n        _jsPlumb.bind(\"connection\", function(p) {\n\n            var sourceGroup = _jsPlumb.getGroupFor(p.source);\n            var targetGroup = _jsPlumb.getGroupFor(p.target);\n\n            if (sourceGroup != null && targetGroup != null && sourceGroup === targetGroup) {\n                _connectionSourceMap[p.connection.id] = sourceGroup;\n                _connectionTargetMap[p.connection.id] = sourceGroup;\n            }\n            else {\n                if (sourceGroup != null) {\n                    _ju.suggest(sourceGroup.connections.source, p.connection);\n                    _connectionSourceMap[p.connection.id] = sourceGroup;\n                }\n                if (targetGroup != null) {\n                    _ju.suggest(targetGroup.connections.target, p.connection);\n                    _connectionTargetMap[p.connection.id] = targetGroup;\n                }\n            }\n        });\n\n        function _cleanupDetachedConnection(conn) {\n            delete conn.proxies;\n            var group = _connectionSourceMap[conn.id], f;\n            if (group != null) {\n                f = function(c) { return c.id === conn.id; };\n                _ju.removeWithFunction(group.connections.source, f);\n                _ju.removeWithFunction(group.connections.target, f);\n                delete _connectionSourceMap[conn.id];\n            }\n\n            group = _connectionTargetMap[conn.id];\n            if (group != null) {\n                f = function(c) { return c.id === conn.id; };\n                _ju.removeWithFunction(group.connections.source, f);\n                _ju.removeWithFunction(group.connections.target, f);\n                delete _connectionTargetMap[conn.id];\n            }\n        }\n\n        _jsPlumb.bind(EVT_INTERNAL_CONNECTION_DETACHED, function(p) {\n            _cleanupDetachedConnection(p.connection);\n        });\n\n        _jsPlumb.bind(EVT_CONNECTION_MOVED, function(p) {\n            var connMap = p.index === 0 ? _connectionSourceMap : _connectionTargetMap;\n            var group = connMap[p.connection.id];\n            if (group) {\n                var list = group.connections[p.index === 0 ? \"source\" : \"target\"];\n                var idx = list.indexOf(p.connection);\n                if (idx !== -1) {\n                    list.splice(idx, 1);\n                }\n            }\n        });\n\n        this.addGroup = function(group) {\n            _jsPlumb.addClass(group.getEl(), GROUP_EXPANDED_CLASS);\n            _managedGroups[group.id] = group;\n            group.manager = this;\n            _updateConnectionsForGroup(group);\n            _jsPlumb.fire(EVT_GROUP_ADDED, { group:group });\n        };\n\n        this.addToGroup = function(group, el, doNotFireEvent) {\n            group = this.getGroup(group);\n            if (group) {\n                var groupEl = group.getEl();\n\n                if (el._isJsPlumbGroup) {\n                    return;\n                }\n                var currentGroup = el._jsPlumbGroup;\n                // if already a member of this group, do nothing\n                if (currentGroup !== group) {\n\n                    _jsPlumb.removeFromDragSelection(el);\n\n                    var elpos = _jsPlumb.getOffset(el, true);\n                    var cpos = group.collapsed ? _jsPlumb.getOffset(groupEl, true) : _jsPlumb.getOffset(group.getDragArea(), true);\n\n                    // otherwise, transfer to this group.\n                    if (currentGroup != null) {\n                        currentGroup.remove(el, false, doNotFireEvent, false, group);\n                        self.updateConnectionsForGroup(currentGroup);\n                    }\n                    group.add(el, doNotFireEvent/*, currentGroup*/);\n\n                    var handleDroppedConnections = function (list, index) {\n                        var oidx = index === 0 ? 1 : 0;\n                        list.each(function (c) {\n                            c.setVisible(false);\n                            if (c.endpoints[oidx].element._jsPlumbGroup === group) {\n                                c.endpoints[oidx].setVisible(false);\n                                _expandConnection(c, oidx, group);\n                            }\n                            else {\n                                c.endpoints[index].setVisible(false);\n                                _collapseConnection(c, index, group);\n                            }\n                        });\n                    };\n\n                    if (group.collapsed) {\n                        handleDroppedConnections(_jsPlumb.select({source: el}), 0);\n                        handleDroppedConnections(_jsPlumb.select({target: el}), 1);\n                    }\n\n                    var elId = _jsPlumb.getId(el);\n                    _jsPlumb.dragManager.setParent(el, elId, groupEl, _jsPlumb.getId(groupEl), elpos);\n\n                    var newPosition = { left: elpos.left - cpos.left, top: elpos.top - cpos.top };\n\n                    _jsPlumb.setPosition(el, newPosition);\n\n                    _jsPlumb.dragManager.revalidateParent(el, elId, elpos);\n\n                    self.updateConnectionsForGroup(group);\n\n                    _jsPlumb.revalidate(elId);\n\n                    if (!doNotFireEvent) {\n                        var p = {group: group, el: el, pos:newPosition};\n                        if (currentGroup) {\n                            p.sourceGroup = currentGroup;\n                        }\n                        _jsPlumb.fire(EVT_CHILD_ADDED, p);\n                    }\n                }\n            }\n        };\n\n        this.removeFromGroup = function(group, el, doNotFireEvent) {\n            group = this.getGroup(group);\n            if (group) {\n\n                // if this group is currently collapsed then any proxied connections for the given el (or its descendants) need\n                // to be put back on their original element, and unproxied\n                if (group.collapsed) {\n                    var _expandSet = function (conns, index) {\n                        for (var i = 0; i < conns.length; i++) {\n                            var c = conns[i];\n                            if (c.proxies) {\n                                for(var j = 0; j < c.proxies.length; j++) {\n                                    if (c.proxies[j] != null) {\n                                        var proxiedElement = c.proxies[j].originalEp.element;\n                                        if (proxiedElement === el || isDescendant(proxiedElement, el)) {\n                                            _expandConnection(c, index, group);\n                                        }\n                                    }\n\n                                }\n                            }\n                        }\n                    };\n\n                    // setup proxies for sources and targets\n                    _expandSet(group.connections.source.slice(), 0);\n                    _expandSet(group.connections.target.slice(), 1);\n                }\n\n                group.remove(el, null, doNotFireEvent);\n            }\n        };\n\n        this.getGroup = function(groupId) {\n            var group = groupId;\n            if (_ju.isString(groupId)) {\n                group = _managedGroups[groupId];\n                if (group == null) {\n                    throw new TypeError(\"No such group [\" + groupId + \"]\");\n                }\n            }\n            return group;\n        };\n\n        this.getGroups = function() {\n            var o = [];\n            for (var g in _managedGroups) {\n                o.push(_managedGroups[g]);\n            }\n            return o;\n        };\n\n        this.removeGroup = function(group, deleteMembers, manipulateDOM, doNotFireEvent) {\n            group = this.getGroup(group);\n            this.expandGroup(group, true); // this reinstates any original connections and removes all proxies, but does not fire an event.\n            var newPositions = group[deleteMembers ? CMD_REMOVE_ALL : CMD_ORPHAN_ALL](manipulateDOM, doNotFireEvent);\n            _jsPlumb.remove(group.getEl());\n            delete _managedGroups[group.id];\n            delete _jsPlumb._groups[group.id];\n            _jsPlumb.fire(EVT_GROUP_REMOVED, { group:group });\n            return newPositions; // this will be null in the case or remove, but be a map of {id->[x,y]} in the case of orphan\n        };\n\n        this.removeAllGroups = function(deleteMembers, manipulateDOM, doNotFireEvent) {\n            for (var g in _managedGroups) {\n                this.removeGroup(_managedGroups[g], deleteMembers, manipulateDOM, doNotFireEvent);\n            }\n        };\n\n        function _setVisible(group, state) {\n\n            // TODO discovering the list of elements would ideally be a pluggable function.\n            var m = group.getEl().querySelectorAll(\".jtk-managed\");\n            for (var i = 0; i < m.length; i++) {\n                _jsPlumb[state ? CMD_SHOW : CMD_HIDE](m[i], true);\n            }\n        }\n\n        var _collapseConnection = function(c, index, group) {\n\n            var otherEl = c.endpoints[index === 0 ? 1 : 0].element;\n            if (otherEl[GROUP] && (!otherEl[GROUP].shouldProxy() && otherEl[GROUP].collapsed)) {\n                return;\n            }\n\n            var groupEl = group.getEl(), groupElId = _jsPlumb.getId(groupEl);\n\n            _jsPlumb.proxyConnection(c, index, groupEl, groupElId, function(c, index) { return group.getEndpoint(c, index); }, function(c, index) { return group.getAnchor(c, index); });\n        };\n\n        this.collapseGroup = function(group) {\n            group = this.getGroup(group);\n            if (group == null || group.collapsed) {\n                return;\n            }\n            var groupEl = group.getEl();\n\n            // todo remove old proxy endpoints first, just in case?\n            //group.proxies.length = 0;\n\n            // hide all connections\n            _setVisible(group, false);\n\n            if (group.shouldProxy()) {\n                // collapses all connections in a group.\n                var _collapseSet = function (conns, index) {\n                    for (var i = 0; i < conns.length; i++) {\n                        var c = conns[i];\n                        _collapseConnection(c, index, group);\n                    }\n                };\n\n                // setup proxies for sources and targets\n                _collapseSet(group.connections.source, 0);\n                _collapseSet(group.connections.target, 1);\n            }\n\n            group.collapsed = true;\n            _jsPlumb.removeClass(groupEl, GROUP_EXPANDED_CLASS);\n            _jsPlumb.addClass(groupEl, GROUP_COLLAPSED_CLASS);\n            _jsPlumb.revalidate(groupEl);\n            _jsPlumb.fire(EVT_COLLAPSE, { group:group  });\n        };\n\n        var _expandConnection = function(c, index, group) {\n            _jsPlumb.unproxyConnection(c, index, _jsPlumb.getId(group.getEl()));\n        };\n\n        this.expandGroup = function(group, doNotFireEvent) {\n\n            group = this.getGroup(group);\n\n            if (group == null || !group.collapsed) {\n                return;\n            }\n            var groupEl = group.getEl();\n\n            _setVisible(group, true);\n\n            if (group.shouldProxy()) {\n                // expands all connections in a group.\n                var _expandSet = function (conns, index) {\n                    for (var i = 0; i < conns.length; i++) {\n                        var c = conns[i];\n                        _expandConnection(c, index, group);\n                    }\n                };\n\n                // setup proxies for sources and targets\n                _expandSet(group.connections.source, 0);\n                _expandSet(group.connections.target, 1);\n            }\n\n            group.collapsed = false;\n            _jsPlumb.addClass(groupEl, GROUP_EXPANDED_CLASS);\n            _jsPlumb.removeClass(groupEl, GROUP_COLLAPSED_CLASS);\n            _jsPlumb.revalidate(groupEl);\n            this.repaintGroup(group);\n            if (!doNotFireEvent) {\n                _jsPlumb.fire(EVT_EXPAND, { group: group});\n            }\n        };\n\n        this.repaintGroup = function(group) {\n            group = this.getGroup(group);\n            var m = group.getMembers();\n            for (var i = 0; i < m.length; i++) {\n                _jsPlumb.revalidate(m[i]);\n            }\n        };\n\n        // TODO refactor this with the code that responds to `connection` events.\n        function _updateConnectionsForGroup(group) {\n            var members = group.getMembers().slice();\n\n            var childMembers = [];\n            for (var i = 0; i < members.length; i++) {\n                Array.prototype.push.apply(childMembers, members[i].querySelectorAll(\".jtk-managed\"));\n            }\n            Array.prototype.push.apply(members, childMembers);\n\n            var c1 = _jsPlumb.getConnections({source:members, scope:\"*\"}, true);\n            var c2 = _jsPlumb.getConnections({target:members, scope:\"*\"}, true);\n\n            var processed = {};\n            group.connections.source.length = 0;\n            group.connections.target.length = 0;\n            var oneSet = function(c) {\n                for (var i = 0; i < c.length; i++) {\n                    if (processed[c[i].id]) {\n                        continue;\n                    }\n                    processed[c[i].id] = true;\n                    var gs = _jsPlumb.getGroupFor(c[i].source),\n                        gt = _jsPlumb.getGroupFor(c[i].target);\n\n                    if (gs === group) {\n                        if (gt !== group) {\n                            group.connections.source.push(c[i]);\n                        }\n                        _connectionSourceMap[c[i].id] = group;\n                    }\n                    else if (gt === group) {\n                        group.connections.target.push(c[i]);\n                        _connectionTargetMap[c[i].id] = group;\n                    }\n                }\n            };\n            oneSet(c1); oneSet(c2);\n        }\n\n        this.updateConnectionsForGroup = _updateConnectionsForGroup;\n        this.refreshAllGroups = function() {\n            for (var g in _managedGroups) {\n                _updateConnectionsForGroup(_managedGroups[g]);\n                _jsPlumb.dragManager.updateOffsets(_jsPlumb.getId(_managedGroups[g].getEl()));\n            }\n        };\n    };\n\n    /**\n     *\n     * @param {jsPlumbInstance} _jsPlumb Associated jsPlumb instance.\n     * @param {Object} params\n     * @param {Element} params.el The DOM element representing the Group.\n     * @param {String} [params.id] Optional ID for the Group. A UUID will be assigned as the Group's ID if you do not provide one.\n     * @param {Boolean} [params.constrain=false] If true, child elements will not be able to be dragged outside of the Group container.\n     * @param {Boolean} [params.revert=true] By default, child elements revert to the container if dragged outside. You can change this by setting `revert:false`. This behaviour is also overridden if you set `orphan` or `prune`.\n     * @param {Boolean} [params.orphan=false] If true, child elements dropped outside of the Group container will be removed from the Group (but not from the DOM).\n     * @param {Boolean} [params.prune=false] If true, child elements dropped outside of the Group container will be removed from the Group and also from the DOM.\n     * @param {Boolean} [params.dropOverride=false] If true, a child element that has been dropped onto some other Group will not be subject to the controls imposed by `prune`, `revert` or `orphan`.\n     * @constructor\n     */\n    var Group = function(_jsPlumb, params) {\n        var self = this;\n        var el = params.el;\n        this.getEl = function() { return el; };\n        this.id = params.id || _ju.uuid();\n        el._isJsPlumbGroup = true;\n\n        var getDragArea = this.getDragArea = function() {\n            var da = _jsPlumb.getSelector(el, GROUP_CONTAINER_SELECTOR);\n            return da && da.length > 0 ? da[0] : el;\n        };\n\n        var ghost = params.ghost === true;\n        var constrain = ghost || (params.constrain === true);\n        var revert = params.revert !== false;\n        var orphan = params.orphan === true;\n        var prune = params.prune === true;\n        var dropOverride = params.dropOverride === true;\n        var proxied = params.proxied !== false;\n        var elements = [];\n        this.connections = { source:[], target:[], internal:[] };\n\n        // this function, and getEndpoint below, are stubs for a future setup in which we can choose endpoint\n        // and anchor based upon the connection and the index (source/target) of the endpoint to be proxied.\n        this.getAnchor = function(conn, endpointIndex) {\n            return params.anchor || \"Continuous\";\n        };\n\n        this.getEndpoint = function(conn, endpointIndex) {\n            return params.endpoint || [ \"Dot\", { radius:10 }];\n        };\n\n        this.collapsed = false;\n        if (params.draggable !== false) {\n            var opts = {\n                drag:function() {\n                    for (var i = 0; i < elements.length; i++) {\n                        _jsPlumb.draw(elements[i]);\n                    }\n                },\n                stop:function(params) {\n                    _jsPlumb.fire(EVT_GROUP_DRAG_STOP, jsPlumb.extend(params, {group:self}));\n                },\n                scope:GROUP_DRAG_SCOPE\n            };\n            if (params.dragOptions) {\n                root.jsPlumb.extend(opts, params.dragOptions);\n            }\n            _jsPlumb.draggable(params.el, opts);\n        }\n        if (params.droppable !== false) {\n            _jsPlumb.droppable(params.el, {\n                drop:function(p) {\n                    var el = p.drag.el;\n                    if (el._isJsPlumbGroup) {\n                        return;\n                    }\n                    var currentGroup = el._jsPlumbGroup;\n                    if (currentGroup !== self) {\n                        if (currentGroup != null) {\n                            if (currentGroup.overrideDrop(el, self)) {\n                                return;\n                            }\n                        }\n                        _jsPlumb.getGroupManager().addToGroup(self, el, false);\n                    }\n\n                }\n            });\n        }\n        var _each = function(_el, fn) {\n            var els = _el.nodeType == null ?  _el : [ _el ];\n            for (var i = 0; i < els.length; i++) {\n                fn(els[i]);\n            }\n        };\n\n        this.overrideDrop = function(_el, targetGroup) {\n            return dropOverride && (revert || prune || orphan);\n        };\n\n        this.add = function(_el, doNotFireEvent/*, sourceGroup*/) {\n            var dragArea = getDragArea();\n            _each(_el, function(__el) {\n\n                if (__el._jsPlumbGroup != null) {\n                    if (__el._jsPlumbGroup === self) {\n                        return;\n                    } else {\n                        __el._jsPlumbGroup.remove(__el, true, doNotFireEvent, false);\n                    }\n                }\n\n                __el._jsPlumbGroup = self;\n                elements.push(__el);\n                // test if draggable and add handlers if so.\n                if (_jsPlumb.isAlreadyDraggable(__el)) {\n                    _bindDragHandlers(__el);\n                }\n\n                if (__el.parentNode !== dragArea) {\n                    dragArea.appendChild(__el);\n                }\n\n                // if (!doNotFireEvent) {\n                //     var p = {group: self, el: __el};\n                //     if (sourceGroup) {\n                //         p.sourceGroup = sourceGroup;\n                //     }\n                //     //_jsPlumb.fire(EVT_CHILD_ADDED, p);\n                // }\n            });\n\n            _jsPlumb.getGroupManager().updateConnectionsForGroup(self);\n        };\n\n        this.remove = function(el, manipulateDOM, doNotFireEvent, doNotUpdateConnections, targetGroup) {\n\n            _each(el, function(__el) {\n                if (__el._jsPlumbGroup === self) {\n                    delete __el._jsPlumbGroup;\n                    _ju.removeWithFunction(elements, function (e) {\n                        return e === __el;\n                    });\n\n\n                    if (manipulateDOM) {\n                        try {\n                            self.getDragArea().removeChild(__el);\n                        } catch (e) {\n                            jsPlumbUtil.log(\"Could not remove element from Group \" + e);\n                        }\n                    }\n                    _unbindDragHandlers(__el);\n\n                    if (!doNotFireEvent) {\n                        var p = {group: self, el: __el};\n                        if (targetGroup) {\n                            p.targetGroup = targetGroup;\n                        }\n                        _jsPlumb.fire(EVT_CHILD_REMOVED, p);\n                    }\n                }\n            });\n            if (!doNotUpdateConnections) {\n                _jsPlumb.getGroupManager().updateConnectionsForGroup(self);\n            }\n        };\n        this.removeAll = function(manipulateDOM, doNotFireEvent) {\n            for (var i = 0, l = elements.length; i < l; i++) {\n                var el = elements[0];\n                self.remove(el, manipulateDOM, doNotFireEvent, true);\n                _jsPlumb.remove(el, true);\n            }\n            elements.length = 0;\n            _jsPlumb.getGroupManager().updateConnectionsForGroup(self);\n        };\n        this.orphanAll = function() {\n            var orphanedPositions = {};\n            for (var i = 0; i < elements.length; i++) {\n                var newPosition = _orphan(elements[i]);\n                orphanedPositions[newPosition[0]] = newPosition[1];\n            }\n            elements.length = 0;\n\n            return orphanedPositions;\n        };\n        this.getMembers = function() { return elements; };\n\n        el[GROUP] = this;\n\n        _jsPlumb.bind(ELEMENT_DRAGGABLE_EVENT, function(dragParams) {\n            // if its for the current group,\n            if (dragParams.el._jsPlumbGroup === this) {\n                _bindDragHandlers(dragParams.el);\n            }\n        }.bind(this));\n\n        function _findParent(_el) {\n            return _el.offsetParent;\n        }\n\n        function _isInsideParent(_el, pos) {\n            var p = _findParent(_el),\n                s = _jsPlumb.getSize(p),\n                ss = _jsPlumb.getSize(_el),\n                leftEdge = pos[0],\n                rightEdge = leftEdge + ss[0],\n                topEdge = pos[1],\n                bottomEdge = topEdge + ss[1];\n\n            return rightEdge > 0 && leftEdge < s[0] && bottomEdge > 0 && topEdge < s[1];\n        }\n\n        //\n        // orphaning an element means taking it out of the group and adding it to the main jsplumb container.\n        // we return the new calculated position from this method and the element's id.\n        //\n        function _orphan(_el) {\n            var id = _jsPlumb.getId(_el);\n            var pos = _jsPlumb.getOffset(_el);\n            _el.parentNode.removeChild(_el);\n            _jsPlumb.getContainer().appendChild(_el);\n            _jsPlumb.setPosition(_el, pos);\n            _unbindDragHandlers(_el);\n            _jsPlumb.dragManager.clearParent(_el, id);\n            return [id, pos];\n        }\n\n        //\n        // remove an element from the group, then either prune it from the jsplumb instance, or just orphan it.\n        //\n        function _pruneOrOrphan(p) {\n\n            var out = [];\n\n            function _one(el, left, top) {\n                var orphanedPosition = null;\n                if (!_isInsideParent(el, [left, top])) {\n                    var group = el._jsPlumbGroup;\n                    if (prune) {\n                        _jsPlumb.remove(el);\n                    } else {\n                        orphanedPosition = _orphan(el);\n                    }\n\n                    group.remove(el);\n                }\n\n                return orphanedPosition;\n            }\n\n            for (var i = 0; i < p.selection.length; i++) {\n                out.push(_one(p.selection[i][0], p.selection[i][1].left, p.selection[i][1].top));\n            }\n\n            return out.length === 1 ? out[0] : out;\n\n        }\n\n        //\n        // redraws the element\n        //\n        function _revalidate(_el) {\n            var id = _jsPlumb.getId(_el);\n            _jsPlumb.revalidate(_el);\n            _jsPlumb.dragManager.revalidateParent(_el, id);\n        }\n\n        //\n        // unbind the group specific drag/revert handlers.\n        //\n        function _unbindDragHandlers(_el) {\n            if (!_el._katavorioDrag) {\n                return;\n            }\n            if (prune || orphan) {\n                _el._katavorioDrag.off(STOP, _pruneOrOrphan);\n            }\n            if (!prune && !orphan && revert) {\n                _el._katavorioDrag.off(REVERT, _revalidate);\n                _el._katavorioDrag.setRevert(null);\n            }\n        }\n\n        function _bindDragHandlers(_el) {\n            if (!_el._katavorioDrag) {\n                return;\n            }\n            if (prune || orphan) {\n                _el._katavorioDrag.on(STOP, _pruneOrOrphan);\n            }\n\n            if (constrain) {\n                _el._katavorioDrag.setConstrain(true);\n            }\n\n            if (ghost) {\n                _el._katavorioDrag.setUseGhostProxy(true);\n            }\n\n            if (!prune && !orphan && revert) {\n                _el._katavorioDrag.on(REVERT, _revalidate);\n                _el._katavorioDrag.setRevert(function(__el, pos) {\n                    return !_isInsideParent(__el, pos);\n                });\n            }\n        }\n\n        this.shouldProxy = function() {\n            return proxied;\n        };\n\n        _jsPlumb.getGroupManager().addGroup(this);\n    };\n\n    /**\n     * Adds a group to the jsPlumb instance.\n     * @method addGroup\n     * @param {Object} params\n     * @return {Group} The newly created Group.\n     */\n    _jpi.prototype.addGroup = function(params) {\n        var j = this;\n        j._groups = j._groups || {};\n        if (j._groups[params.id] != null) {\n            throw new TypeError(\"cannot create Group [\" + params.id + \"]; a Group with that ID exists\");\n        }\n        if (params.el[GROUP] != null) {\n            throw new TypeError(\"cannot create Group [\" + params.id + \"]; the given element is already a Group\");\n        }\n        var group = new Group(j, params);\n        j._groups[group.id] = group;\n        if (params.collapsed) {\n            this.collapseGroup(group);\n        }\n        return group;\n    };\n\n    /**\n     * Add an element to a group.\n     * @method addToGroup\n     * @param {String} group Group, or ID of the group, to add the element to.\n     * @param {Element} el Element to add to the group.\n     */\n    _jpi.prototype.addToGroup = function(group, el, doNotFireEvent) {\n\n        var _one = function(_el) {\n            var id = this.getId(_el);\n            this.manage(id, _el);\n            this.getGroupManager().addToGroup(group, _el, doNotFireEvent);\n        }.bind(this);\n\n        if (Array.isArray(el)) {\n            for (var i = 0; i < el.length; i++) {\n                _one(el[i]);\n            }\n        } else {\n            _one(el);\n        }\n    };\n\n    /**\n     * Remove an element from a group, and sets its DOM element to be a child of the container again.  ??\n     * @method removeFromGroup\n     * @param {String} group Group, or ID of the group, to remove the element from.\n     * @param {Element} el Element to add to the group.\n     */\n    _jpi.prototype.removeFromGroup = function(group, el, doNotFireEvent) {\n        this.getGroupManager().removeFromGroup(group, el, doNotFireEvent);\n        this.getContainer().appendChild(el);\n    };\n\n    /**\n     * Remove a group, and optionally remove its members from the jsPlumb instance.\n     * @method removeGroup\n     * @param {String|Group} group Group to delete, or ID of Group to delete.\n     * @param {Boolean} [deleteMembers=false] If true, group members will be removed along with the group. Otherwise they will\n     * just be 'orphaned' (returned to the main container).\n     * @returns {Map[String, Position}} When deleteMembers is false, this method returns a map of {id->position}\n     */\n    _jpi.prototype.removeGroup = function(group, deleteMembers, manipulateDOM, doNotFireEvent) {\n        return this.getGroupManager().removeGroup(group, deleteMembers, manipulateDOM, doNotFireEvent);\n    };\n\n    /**\n     * Remove all groups, and optionally remove their members from the jsPlumb instance.\n     * @method removeAllGroup\n     * @param {Boolean} [deleteMembers=false] If true, group members will be removed along with the groups. Otherwise they will\n     * just be 'orphaned' (returned to the main container).\n     */\n    _jpi.prototype.removeAllGroups = function(deleteMembers, manipulateDOM, doNotFireEvent) {\n        this.getGroupManager().removeAllGroups(deleteMembers, manipulateDOM, doNotFireEvent);\n    };\n\n    /**\n     * Get a Group\n     * @method getGroup\n     * @param {String} groupId ID of the group to get\n     * @return {Group} Group with the given ID, null if not found.\n     */\n    _jpi.prototype.getGroup = function(groupId) {\n        return this.getGroupManager().getGroup(groupId);\n    };\n\n    /**\n     * Gets all the Groups managed by the jsPlumb instance.\n     * @returns {Group[]} List of Groups. Empty if none.\n     */\n    _jpi.prototype.getGroups = function() {\n        return this.getGroupManager().getGroups();\n    };\n\n    /**\n     * Expands a group element. jsPlumb doesn't do \"everything\" for you here, because what it means to expand a Group\n     * will vary from application to application. jsPlumb does these things:\n     *\n     * - Hides any connections that are internal to the group (connections between members, and connections from member of\n     * the group to the group itself)\n     * - Proxies all connections for which the source or target is a member of the group.\n     * - Hides the proxied connections.\n     * - Adds the jtk-group-expanded class to the group's element\n     * - Removes the jtk-group-collapsed class from the group's element.\n     *\n     * @method expandGroup\n     * @param {String|Group} group Group to expand, or ID of Group to expand.\n     */\n    _jpi.prototype.expandGroup = function(group) {\n        this.getGroupManager().expandGroup(group);\n    };\n\n    /**\n     * Collapses a group element. jsPlumb doesn't do \"everything\" for you here, because what it means to collapse a Group\n     * will vary from application to application. jsPlumb does these things:\n     *\n     * - Shows any connections that are internal to the group (connections between members, and connections from member of\n     * the group to the group itself)\n     * - Removes proxies for all connections for which the source or target is a member of the group.\n     * - Shows the previously proxied connections.\n     * - Adds the jtk-group-collapsed class to the group's element\n     * - Removes the jtk-group-expanded class from the group's element.\n     *\n     * @method expandGroup\n     * @param {String|Group} group Group to expand, or ID of Group to expand.\n     */\n    _jpi.prototype.collapseGroup = function(groupId) {\n        this.getGroupManager().collapseGroup(groupId);\n    };\n\n\n    _jpi.prototype.repaintGroup = function(group) {\n        this.getGroupManager().repaintGroup(group);\n    };\n\n    /**\n     * Collapses or expands a group element depending on its current state. See notes in the collapseGroup and expandGroup method.\n     *\n     * @method toggleGroup\n     * @param {String|Group} group Group to expand/collapse, or ID of Group to expand/collapse.\n     */\n    _jpi.prototype.toggleGroup = function(group) {\n        group = this.getGroupManager().getGroup(group);\n        if (group != null) {\n            this.getGroupManager()[group.collapsed ? \"expandGroup\" : \"collapseGroup\"](group);\n        }\n    };\n\n    //\n    // lazy init a group manager for the given jsplumb instance.\n    //\n    _jpi.prototype.getGroupManager = function() {\n        var mgr = this[GROUP_MANAGER];\n        if (mgr == null) {\n            mgr = this[GROUP_MANAGER] = new GroupManager(this);\n        }\n        return mgr;\n    };\n\n    _jpi.prototype.removeGroupManager = function() {\n        delete this[GROUP_MANAGER];\n    };\n\n    /**\n     * Gets the Group that the given element belongs to, null if none.\n     * @method getGroupFor\n     * @param {String|Element} el Element, or element ID.\n     * @returns {Group} A Group, if found, or null.\n     */\n    _jpi.prototype.getGroupFor = function(el) {\n        el = this.getElement(el);\n        if (el) {\n            var c = this.getContainer();\n            var abort = false, g = null, child = null;\n            while (!abort) {\n                if (el == null || el === c) {\n                    abort = true;\n                } else {\n                    if (el[GROUP]) {\n                        g = el[GROUP];\n                        child = el;\n                        abort = true;\n                    } else {\n                        el = el.parentNode;\n                    }\n                }\n            }\n            return g;\n        }\n    };\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n\n/*\n * This file contains the 'flowchart' connectors, consisting of vertical and horizontal line segments.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n    var STRAIGHT = \"Straight\";\n    var ARC = \"Arc\";\n\n    var Flowchart = function (params) {\n        this.type = \"Flowchart\";\n        params = params || {};\n        params.stub = params.stub == null ? 30 : params.stub;\n        var segments,\n            _super = _jp.Connectors.AbstractConnector.apply(this, arguments),\n            midpoint = params.midpoint == null ? 0.5 : params.midpoint,\n            alwaysRespectStubs = params.alwaysRespectStubs === true,\n            lastx = null, lasty = null, lastOrientation,\n            cornerRadius = params.cornerRadius != null ? params.cornerRadius : 0,\n\n            // TODO now common between this and AbstractBezierEditor; refactor into superclass?\n            loopbackRadius = params.loopbackRadius || 25,\n            isLoopbackCurrently = false,\n\n            sgn = function (n) {\n                return n < 0 ? -1 : n === 0 ? 0 : 1;\n            },\n            segmentDirections = function(segment) {\n            return [\n                    sgn( segment[2] - segment[0] ),\n                    sgn( segment[3] - segment[1] )\n                ];\n            },\n            /**\n             * helper method to add a segment.\n             */\n            addSegment = function (segments, x, y, paintInfo) {\n                if (lastx === x && lasty === y) {\n                    return;\n                }\n                var lx = lastx == null ? paintInfo.sx : lastx,\n                    ly = lasty == null ? paintInfo.sy : lasty,\n                    o = lx === x ? \"v\" : \"h\";\n\n                lastx = x;\n                lasty = y;\n                segments.push([ lx, ly, x, y, o ]);\n            },\n            segLength = function (s) {\n                return Math.sqrt(Math.pow(s[0] - s[2], 2) + Math.pow(s[1] - s[3], 2));\n            },\n            _cloneArray = function (a) {\n                var _a = [];\n                _a.push.apply(_a, a);\n                return _a;\n            },\n            writeSegments = function (conn, segments, paintInfo) {\n                var current = null, next, currentDirection, nextDirection;\n                for (var i = 0; i < segments.length - 1; i++) {\n\n                    current = current || _cloneArray(segments[i]);\n                    next = _cloneArray(segments[i + 1]);\n\n                    currentDirection = segmentDirections(current);\n                    nextDirection = segmentDirections(next);\n\n                    if (cornerRadius > 0 && current[4] !== next[4]) {\n\n                        var minSegLength = Math.min(segLength(current), segLength(next));\n                        var radiusToUse = Math.min(cornerRadius, minSegLength / 2);\n\n                        current[2] -= currentDirection[0] * radiusToUse;\n                        current[3] -= currentDirection[1] * radiusToUse;\n                        next[0] += nextDirection[0] * radiusToUse;\n                        next[1] += nextDirection[1] * radiusToUse;\n\n                        var ac = (currentDirection[1] === nextDirection[0] && nextDirection[0] === 1) ||\n                                ((currentDirection[1] === nextDirection[0] && nextDirection[0] === 0) && currentDirection[0] !== nextDirection[1]) ||\n                                (currentDirection[1] === nextDirection[0] && nextDirection[0] === -1),\n                                sgny = next[1] > current[3] ? 1 : -1,\n                                sgnx = next[0] > current[2] ? 1 : -1,\n                                sgnEqual = sgny === sgnx,\n                                cx = (sgnEqual && ac || (!sgnEqual && !ac)) ? next[0] : current[2],\n                                cy = (sgnEqual && ac || (!sgnEqual && !ac)) ? current[3] : next[1];\n\n                        _super.addSegment(conn, STRAIGHT, {\n                            x1: current[0], y1: current[1], x2: current[2], y2: current[3]\n                        });\n\n                        _super.addSegment(conn, ARC, {\n                            r: radiusToUse,\n                            x1: current[2],\n                            y1: current[3],\n                            x2: next[0],\n                            y2: next[1],\n                            cx: cx,\n                            cy: cy,\n                            ac: ac\n                        });\n                    }\n                    else {\n                        // dx + dy are used to adjust for line width.\n                        var dx = (current[2] === current[0]) ? 0 : (current[2] > current[0]) ? (paintInfo.lw / 2) : -(paintInfo.lw / 2),\n                            dy = (current[3] === current[1]) ? 0 : (current[3] > current[1]) ? (paintInfo.lw / 2) : -(paintInfo.lw / 2);\n\n                        _super.addSegment(conn, STRAIGHT, {\n                            x1: current[0] - dx, y1: current[1] - dy, x2: current[2] + dx, y2: current[3] + dy\n                        });\n                    }\n                    current = next;\n                }\n                if (next != null) {\n                    // last segment\n                    _super.addSegment(conn, STRAIGHT, {\n                        x1: next[0], y1: next[1], x2: next[2], y2: next[3]\n                    });\n                }\n            };\n\n        this._compute = function (paintInfo, params) {\n\n            segments = [];\n            lastx = null;\n            lasty = null;\n            lastOrientation = null;\n\n            var commonStubCalculator = function () {\n                    return [paintInfo.startStubX, paintInfo.startStubY, paintInfo.endStubX, paintInfo.endStubY];\n                },\n                stubCalculators = {\n                    perpendicular: commonStubCalculator,\n                    orthogonal: commonStubCalculator,\n                    opposite: function (axis) {\n                        var pi = paintInfo,\n                            idx = axis === \"x\" ? 0 : 1,\n                            areInProximity = {\n                                \"x\": function () {\n                                    return ( (pi.so[idx] === 1 && (\n                                        ( (pi.startStubX > pi.endStubX) && (pi.tx > pi.startStubX) ) ||\n                                        ( (pi.sx > pi.endStubX) && (pi.tx > pi.sx))))) ||\n\n                                        ( (pi.so[idx] === -1 && (\n                                        ( (pi.startStubX < pi.endStubX) && (pi.tx < pi.startStubX) ) ||\n                                        ( (pi.sx < pi.endStubX) && (pi.tx < pi.sx)))));\n                                },\n                                \"y\": function () {\n                                    return ( (pi.so[idx] === 1 && (\n                                        ( (pi.startStubY > pi.endStubY) && (pi.ty > pi.startStubY) ) ||\n                                        ( (pi.sy > pi.endStubY) && (pi.ty > pi.sy))))) ||\n\n                                        ( (pi.so[idx] === -1 && (\n                                        ( (pi.startStubY < pi.endStubY) && (pi.ty < pi.startStubY) ) ||\n                                        ( (pi.sy < pi.endStubY) && (pi.ty < pi.sy)))));\n                                }\n                            };\n\n                        if (!alwaysRespectStubs && areInProximity[axis]()) {\n                            return {\n                                \"x\": [(paintInfo.sx + paintInfo.tx) / 2, paintInfo.startStubY, (paintInfo.sx + paintInfo.tx) / 2, paintInfo.endStubY],\n                                \"y\": [paintInfo.startStubX, (paintInfo.sy + paintInfo.ty) / 2, paintInfo.endStubX, (paintInfo.sy + paintInfo.ty) / 2]\n                            }[axis];\n                        }\n                        else {\n                            return [paintInfo.startStubX, paintInfo.startStubY, paintInfo.endStubX, paintInfo.endStubY];\n                        }\n                    }\n                };\n\n            // calculate Stubs.\n            var stubs = stubCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis),\n                idx = paintInfo.sourceAxis === \"x\" ? 0 : 1,\n                oidx = paintInfo.sourceAxis === \"x\" ? 1 : 0,\n                ss = stubs[idx],\n                oss = stubs[oidx],\n                es = stubs[idx + 2],\n                oes = stubs[oidx + 2];\n\n            // add the start stub segment. use stubs for loopback as it will look better, with the loop spaced\n            // away from the element.\n            addSegment(segments, stubs[0], stubs[1], paintInfo);\n\n            // if its a loopback and we should treat it differently.\n            // if (false && params.sourcePos[0] === params.targetPos[0] && params.sourcePos[1] === params.targetPos[1]) {\n            //\n            //     // we use loopbackRadius here, as statemachine connectors do.\n            //     // so we go radius to the left from stubs[0], then upwards by 2*radius, to the right by 2*radius,\n            //     // down by 2*radius, left by radius.\n            //     addSegment(segments, stubs[0] - loopbackRadius, stubs[1], paintInfo);\n            //     addSegment(segments, stubs[0] - loopbackRadius, stubs[1] - (2 * loopbackRadius), paintInfo);\n            //     addSegment(segments, stubs[0] + loopbackRadius, stubs[1] - (2 * loopbackRadius), paintInfo);\n            //     addSegment(segments, stubs[0] + loopbackRadius, stubs[1], paintInfo);\n            //     addSegment(segments, stubs[0], stubs[1], paintInfo);\n            //\n            // }\n            // else {\n\n\n                var midx = paintInfo.startStubX + ((paintInfo.endStubX - paintInfo.startStubX) * midpoint),\n                    midy = paintInfo.startStubY + ((paintInfo.endStubY - paintInfo.startStubY) * midpoint);\n\n                var orientations = {x: [0, 1], y: [1, 0]},\n                    lineCalculators = {\n                        perpendicular: function (axis) {\n                            var pi = paintInfo,\n                                sis = {\n                                    x: [\n                                        [[1, 2, 3, 4], null, [2, 1, 4, 3]],\n                                        null,\n                                        [[4, 3, 2, 1], null, [3, 4, 1, 2]]\n                                    ],\n                                    y: [\n                                        [[3, 2, 1, 4], null, [2, 3, 4, 1]],\n                                        null,\n                                        [[4, 1, 2, 3], null, [1, 4, 3, 2]]\n                                    ]\n                                },\n                                stubs = {\n                                    x: [[pi.startStubX, pi.endStubX], null, [pi.endStubX, pi.startStubX]],\n                                    y: [[pi.startStubY, pi.endStubY], null, [pi.endStubY, pi.startStubY]]\n                                },\n                                midLines = {\n                                    x: [[midx, pi.startStubY], [midx, pi.endStubY]],\n                                    y: [[pi.startStubX, midy], [pi.endStubX, midy]]\n                                },\n                                linesToEnd = {\n                                    x: [[pi.endStubX, pi.startStubY]],\n                                    y: [[pi.startStubX, pi.endStubY]]\n                                },\n                                startToEnd = {\n                                    x: [[pi.startStubX, pi.endStubY], [pi.endStubX, pi.endStubY]],\n                                    y: [[pi.endStubX, pi.startStubY], [pi.endStubX, pi.endStubY]]\n                                },\n                                startToMidToEnd = {\n                                    x: [[pi.startStubX, midy], [pi.endStubX, midy], [pi.endStubX, pi.endStubY]],\n                                    y: [[midx, pi.startStubY], [midx, pi.endStubY], [pi.endStubX, pi.endStubY]]\n                                },\n                                otherStubs = {\n                                    x: [pi.startStubY, pi.endStubY],\n                                    y: [pi.startStubX, pi.endStubX]\n                                },\n                                soIdx = orientations[axis][0], toIdx = orientations[axis][1],\n                                _so = pi.so[soIdx] + 1,\n                                _to = pi.to[toIdx] + 1,\n                                otherFlipped = (pi.to[toIdx] === -1 && (otherStubs[axis][1] < otherStubs[axis][0])) || (pi.to[toIdx] === 1 && (otherStubs[axis][1] > otherStubs[axis][0])),\n                                stub1 = stubs[axis][_so][0],\n                                stub2 = stubs[axis][_so][1],\n                                segmentIndexes = sis[axis][_so][_to];\n\n                            if (pi.segment === segmentIndexes[3] || (pi.segment === segmentIndexes[2] && otherFlipped)) {\n                                return midLines[axis];\n                            }\n                            else if (pi.segment === segmentIndexes[2] && stub2 < stub1) {\n                                return linesToEnd[axis];\n                            }\n                            else if ((pi.segment === segmentIndexes[2] && stub2 >= stub1) || (pi.segment === segmentIndexes[1] && !otherFlipped)) {\n                                return startToMidToEnd[axis];\n                            }\n                            else if (pi.segment === segmentIndexes[0] || (pi.segment === segmentIndexes[1] && otherFlipped)) {\n                                return startToEnd[axis];\n                            }\n                        },\n                        orthogonal: function (axis, startStub, otherStartStub, endStub, otherEndStub) {\n                            var pi = paintInfo,\n                                extent = {\n                                    \"x\": pi.so[0] === -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub),\n                                    \"y\": pi.so[1] === -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub)\n                                }[axis];\n\n                            return {\n                                \"x\": [\n                                    [extent, otherStartStub],\n                                    [extent, otherEndStub],\n                                    [endStub, otherEndStub]\n                                ],\n                                \"y\": [\n                                    [otherStartStub, extent],\n                                    [otherEndStub, extent],\n                                    [otherEndStub, endStub]\n                                ]\n                            }[axis];\n                        },\n                        opposite: function (axis, ss, oss, es) {\n                            var pi = paintInfo,\n                                otherAxis = {\"x\": \"y\", \"y\": \"x\"}[axis],\n                                dim = {\"x\": \"height\", \"y\": \"width\"}[axis],\n                                comparator = pi[\"is\" + axis.toUpperCase() + \"GreaterThanStubTimes2\"];\n\n                            if (params.sourceEndpoint.elementId === params.targetEndpoint.elementId) {\n                                var _val = oss + ((1 - params.sourceEndpoint.anchor[otherAxis]) * params.sourceInfo[dim]) + _super.maxStub;\n                                return {\n                                    \"x\": [\n                                        [ss, _val],\n                                        [es, _val]\n                                    ],\n                                    \"y\": [\n                                        [_val, ss],\n                                        [_val, es]\n                                    ]\n                                }[axis];\n\n                            }\n                            else if (!comparator || (pi.so[idx] === 1 && ss > es) || (pi.so[idx] === -1 && ss < es)) {\n                                return {\n                                    \"x\": [\n                                        [ss, midy],\n                                        [es, midy]\n                                    ],\n                                    \"y\": [\n                                        [midx, ss],\n                                        [midx, es]\n                                    ]\n                                }[axis];\n                            }\n                            else if ((pi.so[idx] === 1 && ss < es) || (pi.so[idx] === -1 && ss > es)) {\n                                return {\n                                    \"x\": [\n                                        [midx, pi.sy],\n                                        [midx, pi.ty]\n                                    ],\n                                    \"y\": [\n                                        [pi.sx, midy],\n                                        [pi.tx, midy]\n                                    ]\n                                }[axis];\n                            }\n                        }\n                    };\n\n                // compute the rest of the line\n                var p = lineCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis, ss, oss, es, oes);\n                if (p) {\n                    for (var i = 0; i < p.length; i++) {\n                        addSegment(segments, p[i][0], p[i][1], paintInfo);\n                    }\n                }\n\n                // line to end stub\n                addSegment(segments, stubs[2], stubs[3], paintInfo);\n\n            //}\n\n            // end stub to end (common)\n            addSegment(segments, paintInfo.tx, paintInfo.ty, paintInfo);\n\n\n\n            // write out the segments.\n            writeSegments(this, segments, paintInfo);\n\n        };\n    };\n\n    _jp.Connectors.Flowchart = Flowchart;\n    _ju.extend(_jp.Connectors.Flowchart, _jp.Connectors.AbstractConnector);\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the code for the Bezier connector type.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    _jp.Connectors.AbstractBezierConnector = function(params) {\n        params = params || {};\n        var showLoopback = params.showLoopback !== false,\n            curviness = params.curviness || 10,\n            margin = params.margin || 5,\n            proximityLimit = params.proximityLimit || 80,\n            clockwise = params.orientation && params.orientation === \"clockwise\",\n            loopbackRadius = params.loopbackRadius || 25,\n            isLoopbackCurrently = false,\n            _super;\n\n        this._compute = function (paintInfo, p) {\n\n            var sp = p.sourcePos,\n                tp = p.targetPos,\n                _w = Math.abs(sp[0] - tp[0]),\n                _h = Math.abs(sp[1] - tp[1]);\n\n            if (!showLoopback || (p.sourceEndpoint.elementId !== p.targetEndpoint.elementId)) {\n                isLoopbackCurrently = false;\n                this._computeBezier(paintInfo, p, sp, tp, _w, _h);\n            } else {\n                isLoopbackCurrently = true;\n                // a loopback connector.  draw an arc from one anchor to the other.\n                var x1 = p.sourcePos[0], y1 = p.sourcePos[1] - margin,\n                    cx = x1, cy = y1 - loopbackRadius,\n                // canvas sizing stuff, to ensure the whole painted area is visible.\n                    _x = cx - loopbackRadius,\n                    _y = cy - loopbackRadius;\n\n                _w = 2 * loopbackRadius;\n                _h = 2 * loopbackRadius;\n\n                paintInfo.points[0] = _x;\n                paintInfo.points[1] = _y;\n                paintInfo.points[2] = _w;\n                paintInfo.points[3] = _h;\n\n                // ADD AN ARC SEGMENT.\n                _super.addSegment(this, \"Arc\", {\n                    loopback: true,\n                    x1: (x1 - _x) + 4,\n                    y1: y1 - _y,\n                    startAngle: 0,\n                    endAngle: 2 * Math.PI,\n                    r: loopbackRadius,\n                    ac: !clockwise,\n                    x2: (x1 - _x) - 4,\n                    y2: y1 - _y,\n                    cx: cx - _x,\n                    cy: cy - _y\n                });\n            }\n        };\n\n        _super = _jp.Connectors.AbstractConnector.apply(this, arguments);\n        return _super;\n    };\n    _ju.extend(_jp.Connectors.AbstractBezierConnector, _jp.Connectors.AbstractConnector);\n\n    var Bezier = function (params) {\n        params = params || {};\n        this.type = \"Bezier\";\n\n        var _super = _jp.Connectors.AbstractBezierConnector.apply(this, arguments),\n            majorAnchor = params.curviness || 150,\n            minorAnchor = 10;\n\n        this.getCurviness = function () {\n            return majorAnchor;\n        };\n\n        this._findControlPoint = function (point, sourceAnchorPosition, targetAnchorPosition, sourceEndpoint, targetEndpoint, soo, too) {\n            // determine if the two anchors are perpendicular to each other in their orientation.  we swap the control\n            // points around if so (code could be tightened up)\n            var perpendicular = soo[0] !== too[0] || soo[1] === too[1],\n                p = [];\n\n            if (!perpendicular) {\n                if (soo[0] === 0) {\n                    p.push(sourceAnchorPosition[0] < targetAnchorPosition[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\n                }\n                else {\n                    p.push(point[0] - (majorAnchor * soo[0]));\n                }\n\n                if (soo[1] === 0) {\n                    p.push(sourceAnchorPosition[1] < targetAnchorPosition[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\n                }\n                else {\n                    p.push(point[1] + (majorAnchor * too[1]));\n                }\n            }\n            else {\n                if (too[0] === 0) {\n                    p.push(targetAnchorPosition[0] < sourceAnchorPosition[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\n                }\n                else {\n                    p.push(point[0] + (majorAnchor * too[0]));\n                }\n\n                if (too[1] === 0) {\n                    p.push(targetAnchorPosition[1] < sourceAnchorPosition[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\n                }\n                else {\n                    p.push(point[1] + (majorAnchor * soo[1]));\n                }\n            }\n\n            return p;\n        };\n\n        this._computeBezier = function (paintInfo, p, sp, tp, _w, _h) {\n\n            var _CP, _CP2,\n                _sx = sp[0] < tp[0] ? _w : 0,\n                _sy = sp[1] < tp[1] ? _h : 0,\n                _tx = sp[0] < tp[0] ? 0 : _w,\n                _ty = sp[1] < tp[1] ? 0 : _h;\n\n            _CP = this._findControlPoint([_sx, _sy], sp, tp, p.sourceEndpoint, p.targetEndpoint, paintInfo.so, paintInfo.to);\n            _CP2 = this._findControlPoint([_tx, _ty], tp, sp, p.targetEndpoint, p.sourceEndpoint, paintInfo.to, paintInfo.so);\n\n\n            _super.addSegment(this, \"Bezier\", {\n                x1: _sx, y1: _sy, x2: _tx, y2: _ty,\n                cp1x: _CP[0], cp1y: _CP[1], cp2x: _CP2[0], cp2y: _CP2[1]\n            });\n        };\n\n\n    };\n\n    _jp.Connectors.Bezier = Bezier;\n    _ju.extend(Bezier, _jp.Connectors.AbstractBezierConnector);\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the state machine connectors, which extend AbstractBezierConnector.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    var _segment = function (x1, y1, x2, y2) {\n            if (x1 <= x2 && y2 <= y1) {\n                return 1;\n            }\n            else if (x1 <= x2 && y1 <= y2) {\n                return 2;\n            }\n            else if (x2 <= x1 && y2 >= y1) {\n                return 3;\n            }\n            return 4;\n        },\n\n    // the control point we will use depends on the faces to which each end of the connection is assigned, specifically whether or not the\n    // two faces are parallel or perpendicular.  if they are parallel then the control point lies on the midpoint of the axis in which they\n    // are parellel and varies only in the other axis; this variation is proportional to the distance that the anchor points lie from the\n    // center of that face.  if the two faces are perpendicular then the control point is at some distance from both the midpoints; the amount and\n    // direction are dependent on the orientation of the two elements. 'seg', passed in to this method, tells you which segment the target element\n    // lies in with respect to the source: 1 is top right, 2 is bottom right, 3 is bottom left, 4 is top left.\n    //\n    // sourcePos and targetPos are arrays of info about where on the source and target each anchor is located.  their contents are:\n    //\n    // 0 - absolute x\n    // 1 - absolute y\n    // 2 - proportional x in element (0 is left edge, 1 is right edge)\n    // 3 - proportional y in element (0 is top edge, 1 is bottom edge)\n    //\n        _findControlPoint = function (midx, midy, segment, sourceEdge, targetEdge, dx, dy, distance, proximityLimit) {\n            // TODO (maybe)\n            // - if anchor pos is 0.5, make the control point take into account the relative position of the elements.\n            if (distance <= proximityLimit) {\n                return [midx, midy];\n            }\n\n            if (segment === 1) {\n                if (sourceEdge[3] <= 0 && targetEdge[3] >= 1) {\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                }\n                else if (sourceEdge[2] >= 1 && targetEdge[2] <= 0) {\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                }\n                else {\n                    return [ midx + (-1 * dx) , midy + (-1 * dy) ];\n                }\n            }\n            else if (segment === 2) {\n                if (sourceEdge[3] >= 1 && targetEdge[3] <= 0) {\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                }\n                else if (sourceEdge[2] >= 1 && targetEdge[2] <= 0) {\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                }\n                else {\n                    return [ midx + dx, midy + (-1 * dy) ];\n                }\n            }\n            else if (segment === 3) {\n                if (sourceEdge[3] >= 1 && targetEdge[3] <= 0) {\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                }\n                else if (sourceEdge[2] <= 0 && targetEdge[2] >= 1) {\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                }\n                else {\n                    return [ midx + (-1 * dx) , midy + (-1 * dy) ];\n                }\n            }\n            else if (segment === 4) {\n                if (sourceEdge[3] <= 0 && targetEdge[3] >= 1) {\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                }\n                else if (sourceEdge[2] <= 0 && targetEdge[2] >= 1) {\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                }\n                else {\n                    return [ midx + dx , midy + (-1 * dy) ];\n                }\n            }\n\n        };\n\n    var StateMachine = function (params) {\n        params = params || {};\n        this.type = \"StateMachine\";\n\n        var _super = _jp.Connectors.AbstractBezierConnector.apply(this, arguments),\n            curviness = params.curviness || 10,\n            margin = params.margin || 5,\n            proximityLimit = params.proximityLimit || 80,\n            clockwise = params.orientation && params.orientation === \"clockwise\",\n            _controlPoint;\n\n        this._computeBezier = function(paintInfo, params, sp, tp, w, h) {\n            var _sx = params.sourcePos[0] < params.targetPos[0] ? 0 : w,\n                _sy = params.sourcePos[1] < params.targetPos[1] ? 0 : h,\n                _tx = params.sourcePos[0] < params.targetPos[0] ? w : 0,\n                _ty = params.sourcePos[1] < params.targetPos[1] ? h : 0;\n\n            // now adjust for the margin\n            if (params.sourcePos[2] === 0) {\n                _sx -= margin;\n            }\n            if (params.sourcePos[2] === 1) {\n                _sx += margin;\n            }\n            if (params.sourcePos[3] === 0) {\n                _sy -= margin;\n            }\n            if (params.sourcePos[3] === 1) {\n                _sy += margin;\n            }\n            if (params.targetPos[2] === 0) {\n                _tx -= margin;\n            }\n            if (params.targetPos[2] === 1) {\n                _tx += margin;\n            }\n            if (params.targetPos[3] === 0) {\n                _ty -= margin;\n            }\n            if (params.targetPos[3] === 1) {\n                _ty += margin;\n            }\n\n            //\n            // these connectors are quadratic bezier curves, having a single control point. if both anchors\n            // are located at 0.5 on their respective faces, the control point is set to the midpoint and you\n            // get a straight line.  this is also the case if the two anchors are within 'proximityLimit', since\n            // it seems to make good aesthetic sense to do that. outside of that, the control point is positioned\n            // at 'curviness' pixels away along the normal to the straight line connecting the two anchors.\n            //\n            // there may be two improvements to this.  firstly, we might actually support the notion of avoiding nodes\n            // in the UI, or at least making a good effort at doing so.  if a connection would pass underneath some node,\n            // for example, we might increase the distance the control point is away from the midpoint in a bid to\n            // steer it around that node.  this will work within limits, but i think those limits would also be the likely\n            // limits for, once again, aesthetic good sense in the layout of a chart using these connectors.\n            //\n            // the second possible change is actually two possible changes: firstly, it is possible we should gradually\n            // decrease the 'curviness' as the distance between the anchors decreases; start tailing it off to 0 at some\n            // point (which should be configurable).  secondly, we might slightly increase the 'curviness' for connectors\n            // with respect to how far their anchor is from the center of its respective face. this could either look cool,\n            // or stupid, and may indeed work only in a way that is so subtle as to have been a waste of time.\n            //\n\n            var _midx = (_sx + _tx) / 2,\n                _midy = (_sy + _ty) / 2,\n                segment = _segment(_sx, _sy, _tx, _ty),\n                distance = Math.sqrt(Math.pow(_tx - _sx, 2) + Math.pow(_ty - _sy, 2)),\n                cp1x, cp2x, cp1y, cp2y;\n\n\n            // calculate the control point.  this code will be where we'll put in a rudimentary element avoidance scheme; it\n            // will work by extending the control point to force the curve to be, um, curvier.\n            _controlPoint = _findControlPoint(_midx,\n                _midy,\n                segment,\n                params.sourcePos,\n                params.targetPos,\n                curviness, curviness,\n                distance,\n                proximityLimit);\n\n            cp1x = _controlPoint[0];\n            cp2x = _controlPoint[0];\n            cp1y = _controlPoint[1];\n            cp2y = _controlPoint[1];\n\n            _super.addSegment(this, \"Bezier\", {\n                x1: _tx, y1: _ty, x2: _sx, y2: _sy,\n                cp1x: cp1x, cp1y: cp1y,\n                cp2x: cp2x, cp2y: cp2y\n            });\n        };\n    };\n\n    _jp.Connectors.StateMachine = StateMachine;\n    _ju.extend(StateMachine, _jp.Connectors.AbstractBezierConnector);\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the 'flowchart' connectors, consisting of vertical and horizontal line segments.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n    var STRAIGHT = \"Straight\";\n\n    var Straight = function (params) {\n        this.type = STRAIGHT;\n        var _super = _jp.Connectors.AbstractConnector.apply(this, arguments);\n\n        this._compute = function (paintInfo, _) {\n            _super.addSegment(this, STRAIGHT, {x1: paintInfo.sx, y1: paintInfo.sy, x2: paintInfo.startStubX, y2: paintInfo.startStubY});\n            _super.addSegment(this, STRAIGHT, {x1: paintInfo.startStubX, y1: paintInfo.startStubY, x2: paintInfo.endStubX, y2: paintInfo.endStubY});\n            _super.addSegment(this, STRAIGHT, {x1: paintInfo.endStubX, y1: paintInfo.endStubY, x2: paintInfo.tx, y2: paintInfo.ty});\n        };\n    };\n\n    _jp.Connectors.Straight = Straight;\n    _ju.extend(Straight, _jp.Connectors.AbstractConnector);\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains the SVG renderers.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n// ************************** SVG utility methods ********************************************\t\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    var svgAttributeMap = {\n            \"stroke-linejoin\": \"stroke-linejoin\",\n            \"stroke-dashoffset\": \"stroke-dashoffset\",\n            \"stroke-linecap\": \"stroke-linecap\"\n        },\n        STROKE_DASHARRAY = \"stroke-dasharray\",\n        DASHSTYLE = \"dashstyle\",\n        LINEAR_GRADIENT = \"linearGradient\",\n        RADIAL_GRADIENT = \"radialGradient\",\n        DEFS = \"defs\",\n        FILL = \"fill\",\n        STOP = \"stop\",\n        STROKE = \"stroke\",\n        STROKE_WIDTH = \"stroke-width\",\n        STYLE = \"style\",\n        NONE = \"none\",\n        JSPLUMB_GRADIENT = \"jsplumb_gradient_\",\n        LINE_WIDTH = \"strokeWidth\",\n        ns = {\n            svg: \"http://www.w3.org/2000/svg\"\n        },\n        _attr = function (node, attributes) {\n            for (var i in attributes) {\n                node.setAttribute(i, \"\" + attributes[i]);\n            }\n        },\n        _node = function (name, attributes) {\n            attributes = attributes || {};\n            attributes.version = \"1.1\";\n            attributes.xmlns = ns.svg;\n            return _jp.createElementNS(ns.svg, name, null, null, attributes);\n        },\n        _pos = function (d) {\n            return \"position:absolute;left:\" + d[0] + \"px;top:\" + d[1] + \"px\";\n        },\n        _clearGradient = function (parent) {\n            var els = parent.querySelectorAll(\" defs,linearGradient,radialGradient\");\n            for (var i = 0; i < els.length; i++) {\n                els[i].parentNode.removeChild(els[i]);\n            }\n        },\n        _updateGradient = function (parent, node, style, dimensions, uiComponent) {\n            var id = JSPLUMB_GRADIENT + uiComponent._jsPlumb.instance.idstamp();\n            // first clear out any existing gradient\n            _clearGradient(parent);\n            // this checks for an 'offset' property in the gradient, and in the absence of it, assumes\n            // we want a linear gradient. if it's there, we create a radial gradient.\n            // it is possible that a more explicit means of defining the gradient type would be\n            // better. relying on 'offset' means that we can never have a radial gradient that uses\n            // some default offset, for instance.\n            // issue 244 suggested the 'gradientUnits' attribute; without this, straight/flowchart connectors with gradients would\n            // not show gradients when the line was perfectly horizontal or vertical.\n            var g;\n            if (!style.gradient.offset) {\n                g = _node(LINEAR_GRADIENT, {id: id, gradientUnits: \"userSpaceOnUse\"});\n            }\n            else {\n                g = _node(RADIAL_GRADIENT, { id: id });\n            }\n\n            var defs = _node(DEFS);\n            parent.appendChild(defs);\n            defs.appendChild(g);\n\n            // the svg radial gradient seems to treat stops in the reverse\n            // order to how canvas does it.  so we want to keep all the maths the same, but\n            // iterate the actual style declarations in reverse order, if the x indexes are not in order.\n            for (var i = 0; i < style.gradient.stops.length; i++) {\n                var styleToUse = uiComponent.segment === 1 || uiComponent.segment === 2 ? i : style.gradient.stops.length - 1 - i,\n                    stopColor = style.gradient.stops[styleToUse][1],\n                    s = _node(STOP, {\"offset\": Math.floor(style.gradient.stops[i][0] * 100) + \"%\", \"stop-color\": stopColor});\n\n                g.appendChild(s);\n            }\n            var applyGradientTo = style.stroke ? STROKE : FILL;\n            node.setAttribute(applyGradientTo, \"url(#\" + id + \")\");\n        },\n        _applyStyles = function (parent, node, style, dimensions, uiComponent) {\n\n            node.setAttribute(FILL, style.fill ? style.fill : NONE);\n            node.setAttribute(STROKE, style.stroke ? style.stroke : NONE);\n\n            if (style.gradient) {\n                _updateGradient(parent, node, style, dimensions, uiComponent);\n            }\n            else {\n                // make sure we clear any existing gradient\n                _clearGradient(parent);\n                node.setAttribute(STYLE, \"\");\n            }\n\n            if (style.strokeWidth) {\n                node.setAttribute(STROKE_WIDTH, style.strokeWidth);\n            }\n\n            // in SVG there is a stroke-dasharray attribute we can set, and its syntax looks like\n            // the syntax in VML but is actually kind of nasty: values are given in the pixel\n            // coordinate space, whereas in VML they are multiples of the width of the stroked\n            // line, which makes a lot more sense.  for that reason, jsPlumb is supporting both\n            // the native svg 'stroke-dasharray' attribute, and also the 'dashstyle' concept from\n            // VML, which will be the preferred method.  the code below this converts a dashstyle\n            // attribute given in terms of stroke width into a pixel representation, by using the\n            // stroke's lineWidth.\n            if (style[DASHSTYLE] && style[LINE_WIDTH] && !style[STROKE_DASHARRAY]) {\n                var sep = style[DASHSTYLE].indexOf(\",\") === -1 ? \" \" : \",\",\n                    parts = style[DASHSTYLE].split(sep),\n                    styleToUse = \"\";\n                parts.forEach(function (p) {\n                    styleToUse += (Math.floor(p * style.strokeWidth) + sep);\n                });\n                node.setAttribute(STROKE_DASHARRAY, styleToUse);\n            }\n            else if (style[STROKE_DASHARRAY]) {\n                node.setAttribute(STROKE_DASHARRAY, style[STROKE_DASHARRAY]);\n            }\n\n            // extra attributes such as join type, dash offset.\n            for (var i in svgAttributeMap) {\n                if (style[i]) {\n                    node.setAttribute(svgAttributeMap[i], style[i]);\n                }\n            }\n        },\n        _appendAtIndex = function (svg, path, idx) {\n            if (svg.childNodes.length > idx) {\n                svg.insertBefore(path, svg.childNodes[idx]);\n            }\n            else {\n                svg.appendChild(path);\n            }\n        };\n\n    /**\n     utility methods for other objects to use.\n     */\n    _ju.svg = {\n        node: _node,\n        attr: _attr,\n        pos: _pos\n    };\n\n    // ************************** / SVG utility methods ********************************************\n\n    /*\n     * Base class for SVG components.\n     */\n    var SvgComponent = function (params) {\n        var pointerEventsSpec = params.pointerEventsSpec || \"all\", renderer = {};\n\n        _jp.jsPlumbUIComponent.apply(this, params.originalArgs);\n        this.canvas = null;\n        this.path = null;\n        this.svg = null;\n        this.bgCanvas = null;\n\n        var clazz = params.cssClass + \" \" + (params.originalArgs[0].cssClass || \"\"),\n            svgParams = {\n                \"style\": \"\",\n                \"width\": 0,\n                \"height\": 0,\n                \"pointer-events\": pointerEventsSpec,\n                \"position\": \"absolute\"\n            };\n\n        this.svg = _node(\"svg\", svgParams);\n\n        if (params.useDivWrapper) {\n            this.canvas = _jp.createElement(\"div\", { position : \"absolute\" });\n            _ju.sizeElement(this.canvas, 0, 0, 1, 1);\n            this.canvas.className = clazz;\n        }\n        else {\n            _attr(this.svg, { \"class\": clazz });\n            this.canvas = this.svg;\n        }\n\n        params._jsPlumb.appendElement(this.canvas, params.originalArgs[0].parent);\n        if (params.useDivWrapper) {\n            this.canvas.appendChild(this.svg);\n        }\n\n        var displayElements = [ this.canvas ];\n        this.getDisplayElements = function () {\n            return displayElements;\n        };\n\n        this.appendDisplayElement = function (el) {\n            displayElements.push(el);\n        };\n\n        this.paint = function (style, anchor, extents) {\n            if (style != null) {\n\n                var xy = [ this.x, this.y ], wh = [ this.w, this.h ], p;\n                if (extents != null) {\n                    if (extents.xmin < 0) {\n                        xy[0] += extents.xmin;\n                    }\n                    if (extents.ymin < 0) {\n                        xy[1] += extents.ymin;\n                    }\n                    wh[0] = extents.xmax + ((extents.xmin < 0) ? -extents.xmin : 0);\n                    wh[1] = extents.ymax + ((extents.ymin < 0) ? -extents.ymin : 0);\n                }\n\n                if (params.useDivWrapper) {\n                    _ju.sizeElement(this.canvas, xy[0], xy[1], wh[0] > 0 ? wh[0] : 1, wh[1] > 0 ? wh[1] : 1);\n                    xy[0] = 0;\n                    xy[1] = 0;\n                    p = _pos([ 0, 0 ]);\n                }\n                else {\n                    p = _pos([ xy[0], xy[1] ]);\n                }\n\n                renderer.paint.apply(this, arguments);\n\n                _attr(this.svg, {\n                    \"style\": p,\n                    \"width\": wh[0] || 1,\n                    \"height\": wh[1] || 1\n                });\n            }\n        };\n\n        return {\n            renderer: renderer\n        };\n    };\n\n    _ju.extend(SvgComponent, _jp.jsPlumbUIComponent, {\n        cleanup: function (force) {\n            if (force || this.typeId == null) {\n                if (this.canvas) {\n                    this.canvas._jsPlumb = null;\n                }\n                if (this.svg) {\n                    this.svg._jsPlumb = null;\n                }\n                if (this.bgCanvas) {\n                    this.bgCanvas._jsPlumb = null;\n                }\n\n                if (this.canvas && this.canvas.parentNode) {\n                    this.canvas.parentNode.removeChild(this.canvas);\n                }\n                if (this.bgCanvas && this.bgCanvas.parentNode) {\n                    this.canvas.parentNode.removeChild(this.canvas);\n                }\n\n                this.svg = null;\n                this.canvas = null;\n                this.path = null;\n                this.group = null;\n            }\n            else {\n                // if not a forced cleanup, just detach from DOM for now.\n                if (this.canvas && this.canvas.parentNode) {\n                    this.canvas.parentNode.removeChild(this.canvas);\n                }\n                if (this.bgCanvas && this.bgCanvas.parentNode) {\n                    this.bgCanvas.parentNode.removeChild(this.bgCanvas);\n                }\n            }\n        },\n        reattach:function(instance) {\n            var c = instance.getContainer();\n            if (this.canvas && this.canvas.parentNode == null) {\n                c.appendChild(this.canvas);\n            }\n            if (this.bgCanvas && this.bgCanvas.parentNode == null) {\n                c.appendChild(this.bgCanvas);\n            }\n        },\n        setVisible: function (v) {\n            if (this.canvas) {\n                this.canvas.style.display = v ? \"block\" : \"none\";\n            }\n        }\n    });\n\n    /*\n     * Base class for SVG connectors.\n     */\n    _jp.ConnectorRenderers.svg = function (params) {\n        var self = this,\n            _super = SvgComponent.apply(this, [\n                {\n                    cssClass: params._jsPlumb.connectorClass,\n                    originalArgs: arguments,\n                    pointerEventsSpec: \"none\",\n                    _jsPlumb: params._jsPlumb\n                }\n            ]);\n\n        _super.renderer.paint = function (style, anchor, extents) {\n\n            var segments = self.getSegments(), p = \"\", offset = [0, 0];\n            if (extents.xmin < 0) {\n                offset[0] = -extents.xmin;\n            }\n            if (extents.ymin < 0) {\n                offset[1] = -extents.ymin;\n            }\n\n            if (segments.length > 0) {\n\n                p = self.getPathData();\n\n                var a = {\n                        d: p,\n                        transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\",\n                        \"pointer-events\": params[\"pointer-events\"] || \"visibleStroke\"\n                    },\n                    outlineStyle = null,\n                    d = [self.x, self.y, self.w, self.h];\n\n                // outline style.  actually means drawing an svg object underneath the main one.\n                if (style.outlineStroke) {\n                    var outlineWidth = style.outlineWidth || 1,\n                        outlineStrokeWidth = style.strokeWidth + (2 * outlineWidth);\n                    outlineStyle = _jp.extend({}, style);\n                    delete outlineStyle.gradient;\n                    outlineStyle.stroke = style.outlineStroke;\n                    outlineStyle.strokeWidth = outlineStrokeWidth;\n\n                    if (self.bgPath == null) {\n                        self.bgPath = _node(\"path\", a);\n                        _jp.addClass(self.bgPath, _jp.connectorOutlineClass);\n                        _appendAtIndex(self.svg, self.bgPath, 0);\n                    }\n                    else {\n                        _attr(self.bgPath, a);\n                    }\n\n                    _applyStyles(self.svg, self.bgPath, outlineStyle, d, self);\n                }\n\n                if (self.path == null) {\n                    self.path = _node(\"path\", a);\n                    _appendAtIndex(self.svg, self.path, style.outlineStroke ? 1 : 0);\n                }\n                else {\n                    _attr(self.path, a);\n                }\n\n                _applyStyles(self.svg, self.path, style, d, self);\n            }\n        };\n    };\n    _ju.extend(_jp.ConnectorRenderers.svg, SvgComponent);\n\n// ******************************* svg segment renderer *****************************************************\t\n\n\n// ******************************* /svg segments *****************************************************\n\n    /*\n     * Base class for SVG endpoints.\n     */\n    var SvgEndpoint = _jp.SvgEndpoint = function (params) {\n        var _super = SvgComponent.apply(this, [\n            {\n                cssClass: params._jsPlumb.endpointClass,\n                originalArgs: arguments,\n                pointerEventsSpec: \"all\",\n                useDivWrapper: true,\n                _jsPlumb: params._jsPlumb\n            }\n        ]);\n\n        _super.renderer.paint = function (style) {\n            var s = _jp.extend({}, style);\n            if (s.outlineStroke) {\n                s.stroke = s.outlineStroke;\n            }\n\n            if (this.node == null) {\n                this.node = this.makeNode(s);\n                this.svg.appendChild(this.node);\n            }\n            else if (this.updateNode != null) {\n                this.updateNode(this.node);\n            }\n            _applyStyles(this.svg, this.node, s, [ this.x, this.y, this.w, this.h ], this);\n            _pos(this.node, [ this.x, this.y ]);\n        }.bind(this);\n\n    };\n    _ju.extend(SvgEndpoint, SvgComponent);\n\n    /*\n     * SVG Dot Endpoint\n     */\n    _jp.Endpoints.svg.Dot = function () {\n        _jp.Endpoints.Dot.apply(this, arguments);\n        SvgEndpoint.apply(this, arguments);\n        this.makeNode = function (style) {\n            return _node(\"circle\", {\n                \"cx\": this.w / 2,\n                \"cy\": this.h / 2,\n                \"r\": this.radius\n            });\n        };\n        this.updateNode = function (node) {\n            _attr(node, {\n                \"cx\": this.w / 2,\n                \"cy\": this.h / 2,\n                \"r\": this.radius\n            });\n        };\n    };\n    _ju.extend(_jp.Endpoints.svg.Dot, [_jp.Endpoints.Dot, SvgEndpoint]);\n\n    /*\n     * SVG Rectangle Endpoint\n     */\n    _jp.Endpoints.svg.Rectangle = function () {\n        _jp.Endpoints.Rectangle.apply(this, arguments);\n        SvgEndpoint.apply(this, arguments);\n        this.makeNode = function (style) {\n            return _node(\"rect\", {\n                \"width\": this.w,\n                \"height\": this.h\n            });\n        };\n        this.updateNode = function (node) {\n            _attr(node, {\n                \"width\": this.w,\n                \"height\": this.h\n            });\n        };\n    };\n    _ju.extend(_jp.Endpoints.svg.Rectangle, [_jp.Endpoints.Rectangle, SvgEndpoint]);\n\n    /*\n     * SVG Image Endpoint is the default image endpoint.\n     */\n    _jp.Endpoints.svg.Image = _jp.Endpoints.Image;\n    /*\n     * Blank endpoint in svg renderer is the default Blank endpoint.\n     */\n    _jp.Endpoints.svg.Blank = _jp.Endpoints.Blank;\n    /*\n     * Label overlay in svg renderer is the default Label overlay.\n     */\n    _jp.Overlays.svg.Label = _jp.Overlays.Label;\n    /*\n     * Custom overlay in svg renderer is the default Custom overlay.\n     */\n    _jp.Overlays.svg.Custom = _jp.Overlays.Custom;\n\n    var AbstractSvgArrowOverlay = function (superclass, originalArgs) {\n        superclass.apply(this, originalArgs);\n        _jp.jsPlumbUIComponent.apply(this, originalArgs);\n        this.isAppendedAtTopLevel = false;\n        var self = this;\n        this.path = null;\n        this.paint = function (params, containerExtents) {\n            // only draws on connections, not endpoints.\n            if (params.component.svg && containerExtents) {\n                if (this.path == null) {\n                    this.path = _node(\"path\", {\n                        \"pointer-events\": \"all\"\n                    });\n                    params.component.svg.appendChild(this.path);\n                    if (this.elementCreated) {\n                        this.elementCreated(this.path, params.component);\n                    }\n\n                    this.canvas = params.component.svg; // for the sake of completeness; this behaves the same as other overlays\n                }\n                var clazz = originalArgs && (originalArgs.length === 1) ? (originalArgs[0].cssClass || \"\") : \"\",\n                    offset = [0, 0];\n\n                if (containerExtents.xmin < 0) {\n                    offset[0] = -containerExtents.xmin;\n                }\n                if (containerExtents.ymin < 0) {\n                    offset[1] = -containerExtents.ymin;\n                }\n\n                _attr(this.path, {\n                    \"d\": makePath(params.d),\n                    \"class\": clazz,\n                    stroke: params.stroke ? params.stroke : null,\n                    fill: params.fill ? params.fill : null,\n                    transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n                });\n            }\n        };\n        var makePath = function (d) {\n            return (isNaN(d.cxy.x) || isNaN(d.cxy.y)) ? \"\" : \"M\" + d.hxy.x + \",\" + d.hxy.y +\n                \" L\" + d.tail[0].x + \",\" + d.tail[0].y +\n                \" L\" + d.cxy.x + \",\" + d.cxy.y +\n                \" L\" + d.tail[1].x + \",\" + d.tail[1].y +\n                \" L\" + d.hxy.x + \",\" + d.hxy.y;\n        };\n        this.transfer = function(target) {\n            if (target.canvas && this.path && this.path.parentNode) {\n                this.path.parentNode.removeChild(this.path);\n                target.canvas.appendChild(this.path);\n            }\n        };\n    };\n\n    var svgProtoFunctions = {\n        cleanup : function (force) {\n            if (this.path != null) {\n                if (force) {\n                    this._jsPlumb.instance.removeElement(this.path);\n                }\n                else {\n                    if (this.path.parentNode) {\n                        this.path.parentNode.removeChild(this.path);\n                    }\n                }\n            }\n        }, reattach :function(instance, component) {\n            if (this.path && component.canvas) {\n                component.canvas.appendChild(this.path);\n            }\n        },\n        setVisible : function (v) {\n            if (this.path != null) {\n                (this.path.style.display = (v ? \"block\" : \"none\"));\n            }\n        }\n    };\n\n    _ju.extend(AbstractSvgArrowOverlay, [_jp.jsPlumbUIComponent, _jp.Overlays.AbstractOverlay]);\n\n    _jp.Overlays.svg.Arrow = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.Arrow, arguments]);\n    };\n    _ju.extend(_jp.Overlays.svg.Arrow, [ _jp.Overlays.Arrow, AbstractSvgArrowOverlay ], svgProtoFunctions);\n\n    _jp.Overlays.svg.PlainArrow = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.PlainArrow, arguments]);\n    };\n    _ju.extend(_jp.Overlays.svg.PlainArrow, [ _jp.Overlays.PlainArrow, AbstractSvgArrowOverlay ], svgProtoFunctions);\n\n    _jp.Overlays.svg.Diamond = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.Diamond, arguments]);\n    };\n    _ju.extend(_jp.Overlays.svg.Diamond, [ _jp.Overlays.Diamond, AbstractSvgArrowOverlay ], svgProtoFunctions);\n\n    // a test\n    _jp.Overlays.svg.GuideLines = function () {\n        var path = null, self = this, p1_1, p1_2;\n        _jp.Overlays.GuideLines.apply(this, arguments);\n        this.paint = function (params, containerExtents) {\n            if (path == null) {\n                path = _node(\"path\");\n                params.connector.svg.appendChild(path);\n                self.attachListeners(path, params.connector);\n                self.attachListeners(path, self);\n\n                p1_1 = _node(\"path\");\n                params.connector.svg.appendChild(p1_1);\n                self.attachListeners(p1_1, params.connector);\n                self.attachListeners(p1_1, self);\n\n                p1_2 = _node(\"path\");\n                params.connector.svg.appendChild(p1_2);\n                self.attachListeners(p1_2, params.connector);\n                self.attachListeners(p1_2, self);\n            }\n\n            var offset = [0, 0];\n            if (containerExtents.xmin < 0) {\n                offset[0] = -containerExtents.xmin;\n            }\n            if (containerExtents.ymin < 0) {\n                offset[1] = -containerExtents.ymin;\n            }\n\n            _attr(path, {\n                \"d\": makePath(params.head, params.tail),\n                stroke: \"red\",\n                fill: null,\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n            });\n\n            _attr(p1_1, {\n                \"d\": makePath(params.tailLine[0], params.tailLine[1]),\n                stroke: \"blue\",\n                fill: null,\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n            });\n\n            _attr(p1_2, {\n                \"d\": makePath(params.headLine[0], params.headLine[1]),\n                stroke: \"green\",\n                fill: null,\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n            });\n        };\n\n        var makePath = function (d1, d2) {\n            return \"M \" + d1.x + \",\" + d1.y +\n                \" L\" + d2.x + \",\" + d2.y;\n        };\n    };\n    _ju.extend(_jp.Overlays.svg.GuideLines, _jp.Overlays.GuideLines);\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * This file contains code used when jsPlumb is being rendered in a DOM.\n *\n * Copyright (c) 2010 - 2020 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * https://jsplumbtoolkit.com\n * https://github.com/jsplumb/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil,\n        _jk = root.Katavorio, _jg = root.Biltong;\n\n    var _getEventManager = function(instance) {\n        var e = instance._mottle;\n        if (!e) {\n            e = instance._mottle = new root.Mottle();\n        }\n        return e;\n    };\n\n    var _getDragManager = function (instance, category) {\n\n        category = category || \"main\";\n        var key = \"_katavorio_\" + category;\n        var k = instance[key],\n            e = instance.getEventManager();\n\n        if (!k) {\n            k = new _jk({\n                bind: e.on,\n                unbind: e.off,\n                getSize: _jp.getSize,\n                getConstrainingRectangle:function(el) {\n                    return [ el.parentNode.scrollWidth, el.parentNode.scrollHeight ];\n                },\n                getPosition: function (el, relativeToRoot) {\n                    // if this is a nested draggable then compute the offset against its own offsetParent, otherwise\n                    // compute against the Container's origin. see also the getUIPosition method below.\n                    var o = instance.getOffset(el, relativeToRoot, el._katavorioDrag ? el.offsetParent : null);\n                    return [o.left, o.top];\n                },\n                setPosition: function (el, xy) {\n                    el.style.left = xy[0] + \"px\";\n                    el.style.top = xy[1] + \"px\";\n                },\n                addClass: _jp.addClass,\n                removeClass: _jp.removeClass,\n                intersects: _jg.intersects,\n                indexOf: function(l, i) { return l.indexOf(i); },\n                scope:instance.getDefaultScope(),\n                css: {\n                    noSelect: instance.dragSelectClass,\n                    droppable: \"jtk-droppable\",\n                    draggable: \"jtk-draggable\",\n                    drag: \"jtk-drag\",\n                    selected: \"jtk-drag-selected\",\n                    active: \"jtk-drag-active\",\n                    hover: \"jtk-drag-hover\",\n                    ghostProxy:\"jtk-ghost-proxy\"\n                }\n            });\n            k.setZoom(instance.getZoom());\n            instance[key] = k;\n            instance.bind(\"zoom\", k.setZoom);\n        }\n        return k;\n    };\n\n    var _dragStart=function(params) {\n        var options = params.el._jsPlumbDragOptions;\n        var cont = true;\n        if (options.canDrag) {\n            cont = options.canDrag();\n        }\n        if (cont) {\n            this.setHoverSuspended(true);\n            this.select({source: params.el}).addClass(this.elementDraggingClass + \" \" + this.sourceElementDraggingClass, true);\n            this.select({target: params.el}).addClass(this.elementDraggingClass + \" \" + this.targetElementDraggingClass, true);\n            this.setConnectionBeingDragged(true);\n        }\n        return cont;\n    };\n    var _dragMove=function(params) {\n        var ui = this.getUIPosition(arguments, this.getZoom());\n        if (ui != null) {\n            var o = params.el._jsPlumbDragOptions;\n            this.draw(params.el, ui, null, true);\n            if (o._dragging) {\n                this.addClass(params.el, \"jtk-dragged\");\n            }\n            o._dragging = true;\n        }\n    };\n    var _dragStop=function(params) {\n        var elements = params.selection, uip;\n\n        var _one = function (_e) {\n            if (_e[1] != null) {\n                // run the reported offset through the code that takes parent containers\n                // into account, to adjust if necessary (issue 554)\n                uip = this.getUIPosition([{\n                    el:_e[2].el,\n                    pos:[_e[1].left, _e[1].top]\n                }]);\n                this.draw(_e[2].el, uip);\n            }\n\n            if (_e[0]._jsPlumbDragOptions != null) {\n                delete _e[0]._jsPlumbDragOptions._dragging;\n            }\n\n            this.removeClass(_e[0], \"jtk-dragged\");\n            this.select({source: _e[2].el}).removeClass(this.elementDraggingClass + \" \" + this.sourceElementDraggingClass, true);\n            this.select({target: _e[2].el}).removeClass(this.elementDraggingClass + \" \" + this.targetElementDraggingClass, true);\n            this.getDragManager().dragEnded(_e[2].el);\n        }.bind(this);\n\n        for (var i = 0; i < elements.length; i++) {\n            _one(elements[i]);\n        }\n\n        this.setHoverSuspended(false);\n        this.setConnectionBeingDragged(false);\n    };\n\n    var _animProps = function (o, p) {\n        var _one = function (pName) {\n            if (p[pName] != null) {\n                if (_ju.isString(p[pName])) {\n                    var m = p[pName].match(/-=/) ? -1 : 1,\n                        v = p[pName].substring(2);\n                    return o[pName] + (m * v);\n                }\n                else {\n                    return p[pName];\n                }\n            }\n            else {\n                return o[pName];\n            }\n        };\n        return [ _one(\"left\"), _one(\"top\") ];\n    };\n\n    var _genLoc = function (prefix, e) {\n            if (e == null) {\n                return [ 0, 0 ];\n            }\n            var ts = _touches(e), t = _getTouch(ts, 0);\n            return [t[prefix + \"X\"], t[prefix + \"Y\"]];\n        },\n        _pageLocation = _genLoc.bind(this, \"page\"),\n        _screenLocation = _genLoc.bind(this, \"screen\"),\n        _clientLocation = _genLoc.bind(this, \"client\"),\n        _getTouch = function (touches, idx) {\n            return touches.item ? touches.item(idx) : touches[idx];\n        },\n        _touches = function (e) {\n            return e.touches && e.touches.length > 0 ? e.touches :\n                e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\n                        [ e ];\n        };\n\n    /**\n     Manages dragging for some instance of jsPlumb.\n\n     TODO instead of this being accessed directly, it should subscribe to events on the jsPlumb instance: every method\n     in here is called directly by jsPlumb. But what should happen is that we have unpublished events that this listens\n     to.  The only trick is getting one of these instantiated with every jsPlumb instance: it needs to have a hook somehow.\n     Basically the general idea is to pull ALL the drag code out (prototype method registrations plus this) into a\n     dedicated drag script), that does not necessarily need to be included.\n\n\n     */\n    var DragManager = function (_currentInstance) {\n        var _draggables = {}, _dlist = [], _delements = {}, _elementsWithEndpoints = {},\n            // elementids mapped to the draggable to which they belong.\n            _draggablesForElements = {};\n\n        /**\n         register some element as draggable.  right now the drag init stuff is done elsewhere, and it is\n         possible that will continue to be the case.\n         */\n        this.register = function (el) {\n            var id = _currentInstance.getId(el),\n                parentOffset;\n\n            if (!_draggables[id]) {\n                _draggables[id] = el;\n                _dlist.push(el);\n                _delements[id] = {};\n            }\n\n            // look for child elements that have endpoints and register them against this draggable.\n            var _oneLevel = function (p) {\n                if (p) {\n                    for (var i = 0; i < p.childNodes.length; i++) {\n                        if (p.childNodes[i].nodeType !== 3 && p.childNodes[i].nodeType !== 8) {\n                            var cEl = jsPlumb.getElement(p.childNodes[i]),\n                                cid = _currentInstance.getId(p.childNodes[i], null, true);\n                            if (cid && _elementsWithEndpoints[cid] && _elementsWithEndpoints[cid] > 0) {\n                                if (!parentOffset) {\n                                    parentOffset = _currentInstance.getOffset(el);\n                                }\n                                var cOff = _currentInstance.getOffset(cEl);\n                                _delements[id][cid] = {\n                                    id: cid,\n                                    offset: {\n                                        left: cOff.left - parentOffset.left,\n                                        top: cOff.top - parentOffset.top\n                                    }\n                                };\n                                _draggablesForElements[cid] = id;\n                            }\n                            _oneLevel(p.childNodes[i]);\n                        }\n                    }\n                }\n            };\n\n            _oneLevel(el);\n        };\n\n        // refresh the offsets for child elements of this element.\n        this.updateOffsets = function (elId, childOffsetOverrides) {\n            if (elId != null) {\n                childOffsetOverrides = childOffsetOverrides || {};\n                var domEl = jsPlumb.getElement(elId),\n                    id = _currentInstance.getId(domEl),\n                    children = _delements[id],\n                    parentOffset;\n\n                if (children) {\n                    for (var i in children) {\n                        if (children.hasOwnProperty(i)) {\n                            var cel = jsPlumb.getElement(i),\n                                cOff = childOffsetOverrides[i] || _currentInstance.getOffset(cel);\n\n                            // do not update if we have a value already and we'd just be writing 0,0\n                            if (cel.offsetParent == null && _delements[id][i] != null) {\n                                continue;\n                            }\n\n                            if (!parentOffset) {\n                                parentOffset = _currentInstance.getOffset(domEl);\n                            }\n\n                            _delements[id][i] = {\n                                id: i,\n                                offset: {\n                                    left: cOff.left - parentOffset.left,\n                                    top: cOff.top - parentOffset.top\n                                }\n                            };\n                            _draggablesForElements[i] = id;\n                        }\n                    }\n                }\n            }\n        };\n\n        /**\n         notification that an endpoint was added to the given el.  we go up from that el's parent\n         node, looking for a parent that has been registered as a draggable. if we find one, we add this\n         el to that parent's list of elements to update on drag (if it is not there already)\n         */\n        this.endpointAdded = function (el, id) {\n\n            id = id || _currentInstance.getId(el);\n\n            var b = document.body,\n                p = el.parentNode;\n\n            _elementsWithEndpoints[id] = _elementsWithEndpoints[id] ? _elementsWithEndpoints[id] + 1 : 1;\n\n            while (p != null && p !== b) {\n                var pid = _currentInstance.getId(p, null, true);\n                if (pid && _draggables[pid]) {\n                    var pLoc = _currentInstance.getOffset(p);\n\n                    if (_delements[pid][id] == null) {\n                        var cLoc = _currentInstance.getOffset(el);\n                        _delements[pid][id] = {\n                            id: id,\n                            offset: {\n                                left: cLoc.left - pLoc.left,\n                                top: cLoc.top - pLoc.top\n                            }\n                        };\n                        _draggablesForElements[id] = pid;\n                    }\n                    break;\n                }\n                p = p.parentNode;\n            }\n        };\n\n        this.endpointDeleted = function (endpoint) {\n            if (_elementsWithEndpoints[endpoint.elementId]) {\n                _elementsWithEndpoints[endpoint.elementId]--;\n                if (_elementsWithEndpoints[endpoint.elementId] <= 0) {\n                    for (var i in _delements) {\n                        if (_delements.hasOwnProperty(i) && _delements[i]) {\n                            delete _delements[i][endpoint.elementId];\n                            delete _draggablesForElements[endpoint.elementId];\n                        }\n                    }\n                }\n            }\n        };\n\n        this.changeId = function (oldId, newId) {\n            _delements[newId] = _delements[oldId];\n            _delements[oldId] = {};\n            _draggablesForElements[newId] = _draggablesForElements[oldId];\n            _draggablesForElements[oldId] = null;\n        };\n\n        this.getElementsForDraggable = function (id) {\n            return _delements[id];\n        };\n\n        this.elementRemoved = function (elementId) {\n            var elId = _draggablesForElements[elementId];\n            if (elId) {\n                delete _delements[elId][elementId];\n                delete _draggablesForElements[elementId];\n            }\n        };\n\n        this.reset = function () {\n            _draggables = {};\n            _dlist = [];\n            _delements = {};\n            _elementsWithEndpoints = {};\n        };\n\n        //\n        // notification drag ended. We check automatically if need to update some\n        // ancestor's offsets.\n        //\n        this.dragEnded = function (el) {\n            if (el.offsetParent != null) {\n                var id = _currentInstance.getId(el),\n                    ancestor = _draggablesForElements[id];\n\n                if (ancestor) {\n                    this.updateOffsets(ancestor);\n                }\n            }\n        };\n\n        this.setParent = function (el, elId, p, pId, currentChildLocation) {\n            var current = _draggablesForElements[elId];\n            if (!_delements[pId]) {\n                _delements[pId] = {};\n            }\n            var pLoc = _currentInstance.getOffset(p),\n                cLoc = currentChildLocation || _currentInstance.getOffset(el);\n\n            if (current && _delements[current]) {\n                delete _delements[current][elId];\n            }\n\n            _delements[pId][elId] = {\n                id:elId,\n                offset : {\n                    left: cLoc.left - pLoc.left,\n                    top: cLoc.top - pLoc.top\n                }\n            };\n            _draggablesForElements[elId] = pId;\n        };\n\n        this.clearParent = function(el, elId) {\n            var current = _draggablesForElements[elId];\n            if (current) {\n                delete _delements[current][elId];\n                delete _draggablesForElements[elId];\n            }\n        };\n\n        this.revalidateParent = function(el, elId, childOffset) {\n            var current = _draggablesForElements[elId];\n            if (current) {\n                var co = {};\n                co[elId] = childOffset;\n                this.updateOffsets(current, co);\n                _currentInstance.revalidate(current);\n            }\n        };\n\n        this.getDragAncestor = function (el) {\n            var de = jsPlumb.getElement(el),\n                id = _currentInstance.getId(de),\n                aid = _draggablesForElements[id];\n\n            if (aid) {\n                return jsPlumb.getElement(aid);\n            }\n            else {\n                return null;\n            }\n        };\n\n    };\n\n    var _setClassName = function (el, cn, classList) {\n            cn = _ju.fastTrim(cn);\n            if (typeof el.className.baseVal !== \"undefined\") {\n                el.className.baseVal = cn;\n            }\n            else {\n                el.className = cn;\n            }\n\n            // recent (i currently have  61.0.3163.100) version of chrome do not update classList when you set the base val\n            // of an svg element's className. in the long run we'd like to move to just using classList anyway\n            try {\n                var cl = el.classList;\n                if (cl != null) {\n                    while (cl.length > 0) {\n                        cl.remove(cl.item(0));\n                    }\n                    for (var i = 0; i < classList.length; i++) {\n                        if (classList[i]) {\n                            cl.add(classList[i]);\n                        }\n                    }\n                }\n            }\n            catch(e) {\n                // not fatal\n                _ju.log(\"JSPLUMB: cannot set class list\", e);\n            }\n        },\n        _getClassName = function (el) {\n            return (typeof el.className.baseVal === \"undefined\") ? el.className : el.className.baseVal;\n        },\n        _classManip = function (el, classesToAdd, classesToRemove) {\n            classesToAdd = classesToAdd == null ? [] : _ju.isArray(classesToAdd) ? classesToAdd : classesToAdd.split(/\\s+/);\n            classesToRemove = classesToRemove == null ? [] : _ju.isArray(classesToRemove) ? classesToRemove : classesToRemove.split(/\\s+/);\n\n            var className = _getClassName(el),\n                curClasses = className.split(/\\s+/);\n\n            var _oneSet = function (add, classes) {\n                for (var i = 0; i < classes.length; i++) {\n                    if (add) {\n                        if (curClasses.indexOf(classes[i]) === -1) {\n                            curClasses.push(classes[i]);\n                        }\n                    }\n                    else {\n                        var idx = curClasses.indexOf(classes[i]);\n                        if (idx !== -1) {\n                            curClasses.splice(idx, 1);\n                        }\n                    }\n                }\n            };\n\n            _oneSet(true, classesToAdd);\n            _oneSet(false, classesToRemove);\n\n            _setClassName(el, curClasses.join(\" \"), curClasses);\n        };\n\n    root.jsPlumb.extend(root.jsPlumbInstance.prototype, {\n\n        headless: false,\n\n        pageLocation: _pageLocation,\n        screenLocation: _screenLocation,\n        clientLocation: _clientLocation,\n\n        getDragManager:function() {\n            if (this.dragManager == null) {\n                this.dragManager = new DragManager(this);\n            }\n\n            return this.dragManager;\n        },\n\n        recalculateOffsets:function(elId) {\n            this.getDragManager().updateOffsets(elId);\n        },\n\n        createElement:function(tag, style, clazz, atts) {\n            return this.createElementNS(null, tag, style, clazz, atts);\n        },\n\n        createElementNS:function(ns, tag, style, clazz, atts) {\n            var e = ns == null ? document.createElement(tag) : document.createElementNS(ns, tag);\n            var i;\n            style = style || {};\n            for (i in style) {\n                e.style[i] = style[i];\n            }\n\n            if (clazz) {\n                e.className = clazz;\n            }\n\n            atts = atts || {};\n            for (i in atts) {\n                e.setAttribute(i, \"\" + atts[i]);\n            }\n\n            return e;\n        },\n\n        getAttribute: function (el, attName) {\n            return el.getAttribute != null ? el.getAttribute(attName) : null;\n        },\n\n        setAttribute: function (el, a, v) {\n            if (el.setAttribute != null) {\n                el.setAttribute(a, v);\n            }\n        },\n\n        setAttributes: function (el, atts) {\n            for (var i in atts) {\n                if (atts.hasOwnProperty(i)) {\n                    el.setAttribute(i, atts[i]);\n                }\n            }\n        },\n        appendToRoot: function (node) {\n            document.body.appendChild(node);\n        },\n        getRenderModes: function () {\n            return [ \"svg\"  ];\n        },\n        getClass:_getClassName,\n        addClass: function (el, clazz) {\n            jsPlumb.each(el, function (e) {\n                _classManip(e, clazz);\n            });\n        },\n        hasClass: function (el, clazz) {\n            el = jsPlumb.getElement(el);\n            if (el.classList) {\n                return el.classList.contains(clazz);\n            }\n            else {\n                return _getClassName(el).indexOf(clazz) !== -1;\n            }\n        },\n        removeClass: function (el, clazz) {\n            jsPlumb.each(el, function (e) {\n                _classManip(e, null, clazz);\n            });\n        },\n        toggleClass:function(el, clazz) {\n            if (jsPlumb.hasClass(el, clazz)) {\n                jsPlumb.removeClass(el, clazz);\n            } else {\n                jsPlumb.addClass(el, clazz);\n            }\n        },\n        updateClasses: function (el, toAdd, toRemove) {\n            jsPlumb.each(el, function (e) {\n                _classManip(e, toAdd, toRemove);\n            });\n        },\n        setClass: function (el, clazz) {\n            if (clazz != null) {\n                jsPlumb.each(el, function (e) {\n                    _setClassName(e, clazz, clazz.split(/\\s+/));\n                });\n            }\n        },\n        setPosition: function (el, p) {\n            el.style.left = p.left + \"px\";\n            el.style.top = p.top + \"px\";\n        },\n        getPosition: function (el) {\n            var _one = function (prop) {\n                var v = el.style[prop];\n                return v ? v.substring(0, v.length - 2) : 0;\n            };\n            return {\n                left: _one(\"left\"),\n                top: _one(\"top\")\n            };\n        },\n        getStyle:function(el, prop) {\n            if (typeof window.getComputedStyle !== 'undefined') {\n                return getComputedStyle(el, null).getPropertyValue(prop);\n            } else {\n                return el.currentStyle[prop];\n            }\n        },\n        getSelector: function (ctx, spec) {\n            var sel = null;\n            if (arguments.length === 1) {\n                sel = ctx.nodeType != null ? ctx : document.querySelectorAll(ctx);\n            }\n            else {\n                sel = ctx.querySelectorAll(spec);\n            }\n\n            return sel;\n        },\n        getOffset:function(el, relativeToRoot, container) {\n            el = jsPlumb.getElement(el);\n            container = container || this.getContainer();\n            var out = {\n                    left: el.offsetLeft,\n                    top: el.offsetTop\n                },\n                op = (relativeToRoot  || (container != null && (el !== container && el.offsetParent !== container))) ?  el.offsetParent : null,\n                _maybeAdjustScroll = function(offsetParent) {\n                    if (offsetParent != null && offsetParent !== document.body && (offsetParent.scrollTop > 0 || offsetParent.scrollLeft > 0)) {\n                        out.left -= offsetParent.scrollLeft;\n                        out.top -= offsetParent.scrollTop;\n                    }\n                }.bind(this);\n\n            while (op != null) {\n                out.left += op.offsetLeft;\n                out.top += op.offsetTop;\n                _maybeAdjustScroll(op);\n                op = relativeToRoot ? op.offsetParent :\n                    op.offsetParent === container ? null : op.offsetParent;\n            }\n\n            // if container is scrolled and the element (or its offset parent) is not absolute or fixed, adjust accordingly.\n            if (container != null && !relativeToRoot && (container.scrollTop > 0 || container.scrollLeft > 0)) {\n                var pp = el.offsetParent != null ? this.getStyle(el.offsetParent, \"position\") : \"static\",\n                    p = this.getStyle(el, \"position\");\n                if (p !== \"absolute\" && p !== \"fixed\" && pp !== \"absolute\" && pp !== \"fixed\") {\n                    out.left -= container.scrollLeft;\n                    out.top -= container.scrollTop;\n                }\n            }\n            return out;\n        },\n        //\n        // return x+y proportion of the given element's size corresponding to the location of the given event.\n        //\n        getPositionOnElement: function (evt, el, zoom) {\n            var box = typeof el.getBoundingClientRect !== \"undefined\" ? el.getBoundingClientRect() : { left: 0, top: 0, width: 0, height: 0 },\n                body = document.body,\n                docElem = document.documentElement,\n                scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\n                scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\n                clientTop = docElem.clientTop || body.clientTop || 0,\n                clientLeft = docElem.clientLeft || body.clientLeft || 0,\n                pst = 0,\n                psl = 0,\n                top = box.top + scrollTop - clientTop + (pst * zoom),\n                left = box.left + scrollLeft - clientLeft + (psl * zoom),\n                cl = jsPlumb.pageLocation(evt),\n                w = box.width || (el.offsetWidth * zoom),\n                h = box.height || (el.offsetHeight * zoom),\n                x = (cl[0] - left) / w,\n                y = (cl[1] - top) / h;\n\n            return [ x, y ];\n        },\n\n        /**\n         * Gets the absolute position of some element as read from the left/top properties in its style.\n         * @method getAbsolutePosition\n         * @param {Element} el The element to retrieve the absolute coordinates from. **Note** this is a DOM element, not a selector from the underlying library.\n         * @return {Number[]} [left, top] pixel values.\n         */\n        getAbsolutePosition: function (el) {\n            var _one = function (s) {\n                var ss = el.style[s];\n                if (ss) {\n                    return parseFloat(ss.substring(0, ss.length - 2));\n                }\n            };\n            return [ _one(\"left\"), _one(\"top\") ];\n        },\n\n        /**\n         * Sets the absolute position of some element by setting the left/top properties in its style.\n         * @method setAbsolutePosition\n         * @param {Element} el The element to set the absolute coordinates on. **Note** this is a DOM element, not a selector from the underlying library.\n         * @param {Number[]} xy x and y coordinates\n         * @param {Number[]} [animateFrom] Optional previous xy to animate from.\n         * @param {Object} [animateOptions] Options for the animation.\n         */\n        setAbsolutePosition: function (el, xy, animateFrom, animateOptions) {\n            if (animateFrom) {\n                this.animate(el, {\n                    left: \"+=\" + (xy[0] - animateFrom[0]),\n                    top: \"+=\" + (xy[1] - animateFrom[1])\n                }, animateOptions);\n            }\n            else {\n                el.style.left = xy[0] + \"px\";\n                el.style.top = xy[1] + \"px\";\n            }\n        },\n        /**\n         * gets the size for the element, in an array : [ width, height ].\n         */\n        getSize: function (el) {\n            return [ el.offsetWidth, el.offsetHeight ];\n        },\n        getWidth: function (el) {\n            return el.offsetWidth;\n        },\n        getHeight: function (el) {\n            return el.offsetHeight;\n        },\n        getRenderMode : function() { return \"svg\"; },\n        draggable : function (el, options) {\n            var info;\n            el = _ju.isArray(el) || (el.length != null && !_ju.isString(el)) ? el: [ el ];\n            Array.prototype.slice.call(el).forEach(function(_el) {\n                info = this.info(_el);\n                if (info.el) {\n                    this._initDraggableIfNecessary(info.el, true, options, info.id, true);\n                }\n            }.bind(this));\n            return this;\n        },\n        snapToGrid : function(el, x, y) {\n            var out = [];\n            var _oneEl = function(_el) {\n                var info = this.info(_el);\n                if (info.el != null && info.el._katavorioDrag) {\n                    var snapped = info.el._katavorioDrag.snap(x, y);\n                    this.revalidate(info.el);\n                    out.push([info.el, snapped]);\n                }\n            }.bind(this);\n\n            // if you call this method with 0 arguments or 2 arguments it is assumed you want to snap all managed elements to\n            // a grid. if you supply one argument or 3, then you are assumed to be specifying one element.\n            if(arguments.length === 1 || arguments.length === 3) {\n                _oneEl(el, x, y);\n            } else {\n                var _me = this.getManagedElements();\n                for (var mel in _me) {\n                    _oneEl(mel, arguments[0], arguments[1]);\n                }\n            }\n\n            return out;\n        },\n        initDraggable: function (el, options, category) {\n            _getDragManager(this, category).draggable(el, options);\n            el._jsPlumbDragOptions = options;\n        },\n        destroyDraggable: function (el, category) {\n            _getDragManager(this, category).destroyDraggable(el);\n            delete el._jsPlumbDragOptions;\n        },\n        unbindDraggable: function (el, evt, fn, category) {\n            _getDragManager(this, category).destroyDraggable(el, evt, fn);\n        },\n        setDraggable : function (element, draggable) {\n            return jsPlumb.each(element, function (el) {\n                if (this.isDragSupported(el)) {\n                    this._draggableStates[this.getAttribute(el, \"id\")] = draggable;\n                    this.setElementDraggable(el, draggable);\n                }\n            }.bind(this));\n        },\n        _draggableStates : {},\n        /*\n         * toggles the draggable state of the given element(s).\n         * el is either an id, or an element object, or a list of ids/element objects.\n         */\n        toggleDraggable : function (el) {\n            var state;\n            jsPlumb.each(el, function (el) {\n                var elId = this.getAttribute(el, \"id\");\n                state = this._draggableStates[elId] == null ? false : this._draggableStates[elId];\n                state = !state;\n                this._draggableStates[elId] = state;\n                this.setDraggable(el, state);\n                return state;\n            }.bind(this));\n            return state;\n        },\n        _initDraggableIfNecessary : function (element, isDraggable, dragOptions, id, fireEvent) {\n            // TODO FIRST: move to DragManager. including as much of the decision to init dragging as possible.\n            if (!jsPlumb.headless) {\n                var _draggable = isDraggable == null ? false : isDraggable;\n                if (_draggable) {\n                    if (jsPlumb.isDragSupported(element, this)) {\n                        var options = dragOptions || this.Defaults.DragOptions;\n                        options = jsPlumb.extend({}, options); // make a copy.\n                        if (!jsPlumb.isAlreadyDraggable(element, this)) {\n                            var dragEvent = jsPlumb.dragEvents.drag,\n                                stopEvent = jsPlumb.dragEvents.stop,\n                                startEvent = jsPlumb.dragEvents.start;\n\n                            this.manage(id, element);\n\n                            options[startEvent] = _ju.wrap(options[startEvent], _dragStart.bind(this));\n\n                            options[dragEvent] = _ju.wrap(options[dragEvent], _dragMove.bind(this));\n\n                            options[stopEvent] = _ju.wrap(options[stopEvent], _dragStop.bind(this));\n\n                            var elId = this.getId(element); // need ID\n\n                            this._draggableStates[elId] = true;\n                            var draggable = this._draggableStates[elId];\n\n                            options.disabled = draggable == null ? false : !draggable;\n                            this.initDraggable(element, options);\n                            this.getDragManager().register(element);\n                            if (fireEvent) {\n                                this.fire(\"elementDraggable\", {el:element, options:options});\n                            }\n                        }\n                        else {\n                            // already draggable. attach any start, drag or stop listeners to the current Drag.\n                            if (dragOptions.force) {\n                                this.initDraggable(element, options);\n                            }\n                        }\n                    }\n                }\n            }\n        },\n        animationSupported:true,\n        getElement: function (el) {\n            if (el == null) {\n                return null;\n            }\n            // here we pluck the first entry if el was a list of entries.\n            // this is not my favourite thing to do, but previous versions of\n            // jsplumb supported jquery selectors, and it is possible a selector\n            // will be passed in here.\n            el = typeof el === \"string\" ? el : el.length != null && el.enctype == null ? el[0] : el;\n            return typeof el === \"string\" ? document.getElementById(el) : el;\n        },\n        removeElement: function (element) {\n            _getDragManager(this).elementRemoved(element);\n            this.getEventManager().remove(element);\n        },\n        //\n        // this adapter supports a rudimentary animation function. no easing is supported.  only\n        // left/top properties are supported. property delta args are expected to be in the form\n        //\n        // +=x.xxxx\n        //\n        // or\n        //\n        // -=x.xxxx\n        //\n        doAnimate: function (el, properties, options) {\n            options = options || {};\n            var o = this.getOffset(el),\n                ap = _animProps(o, properties),\n                ldist = ap[0] - o.left,\n                tdist = ap[1] - o.top,\n                d = options.duration || 250,\n                step = 15, steps = d / step,\n                linc = (step / d) * ldist,\n                tinc = (step / d) * tdist,\n                idx = 0,\n                _int = setInterval(function () {\n                    _jp.setPosition(el, {\n                        left: o.left + (linc * (idx + 1)),\n                        top: o.top + (tinc * (idx + 1))\n                    });\n                    if (options.step != null) {\n                        options.step(idx, Math.ceil(steps));\n                    }\n                    idx++;\n                    if (idx >= steps) {\n                        window.clearInterval(_int);\n                        if (options.complete != null) {\n                            options.complete();\n                        }\n                    }\n                }, step);\n        },\n        // DRAG/DROP\n\n\n        destroyDroppable: function (el, category) {\n            _getDragManager(this, category).destroyDroppable(el);\n        },\n        unbindDroppable: function (el, evt, fn, category) {\n            _getDragManager(this, category).destroyDroppable(el, evt, fn);\n        },\n\n        droppable :function(el, options) {\n            el = _ju.isArray(el) || (el.length != null && !_ju.isString(el)) ? el: [ el ];\n            var info;\n            options = options || {};\n            options.allowLoopback = false;\n            Array.prototype.slice.call(el).forEach(function(_el) {\n                info = this.info(_el);\n                if (info.el) {\n                    this.initDroppable(info.el, options);\n                }\n            }.bind(this));\n            return this;\n        },\n\n        initDroppable: function (el, options, category) {\n            _getDragManager(this, category).droppable(el, options);\n        },\n        isAlreadyDraggable: function (el) {\n            return el._katavorioDrag != null;\n        },\n        isDragSupported: function (el, options) {\n            return true;\n        },\n        isDropSupported: function (el, options) {\n            return true;\n        },\n        isElementDraggable: function (el) {\n            el = _jp.getElement(el);\n            return el._katavorioDrag && el._katavorioDrag.isEnabled();\n        },\n        getDragObject: function (eventArgs) {\n            return eventArgs[0].drag.getDragElement();\n        },\n        getDragScope: function (el) {\n            return el._katavorioDrag && el._katavorioDrag.scopes.join(\" \") || \"\";\n        },\n        getDropEvent: function (args) {\n            return args[0].e;\n        },\n        getUIPosition: function (eventArgs, zoom) {\n            // here the position reported to us by Katavorio is relative to the element's offsetParent. For top\n            // level nodes that is fine, but if we have a nested draggable then its offsetParent is actually\n            // not going to be the jsplumb container; it's going to be some child of that element. In that case\n            // we want to adjust the UI position to account for the offsetParent's position relative to the Container\n            // origin.\n            var el = eventArgs[0].el;\n            if (el.offsetParent == null) {\n                return null;\n            }\n            var finalPos = eventArgs[0].finalPos || eventArgs[0].pos;\n            var p = { left:finalPos[0], top:finalPos[1] };\n            if (el._katavorioDrag && el.offsetParent !== this.getContainer()) {\n                var oc = this.getOffset(el.offsetParent);\n                p.left += oc.left;\n                p.top += oc.top;\n            }\n            return p;\n        },\n        setDragFilter: function (el, filter, _exclude) {\n            if (el._katavorioDrag) {\n                el._katavorioDrag.setFilter(filter, _exclude);\n            }\n        },\n        setElementDraggable: function (el, draggable) {\n            el = _jp.getElement(el);\n            if (el._katavorioDrag) {\n                el._katavorioDrag.setEnabled(draggable);\n            }\n        },\n        setDragScope: function (el, scope) {\n            if (el._katavorioDrag) {\n                el._katavorioDrag.k.setDragScope(el, scope);\n            }\n        },\n        setDropScope:function(el, scope) {\n            if (el._katavorioDrop && el._katavorioDrop.length > 0) {\n                el._katavorioDrop[0].k.setDropScope(el, scope);\n            }\n        },\n        addToPosse:function(el, spec) {\n            var specs = Array.prototype.slice.call(arguments, 1);\n            var dm = _getDragManager(this);\n            _jp.each(el, function(_el) {\n                _el = [ _jp.getElement(_el) ];\n                _el.push.apply(_el, specs );\n                dm.addToPosse.apply(dm, _el);\n            });\n        },\n        setPosse:function(el, spec) {\n            var specs = Array.prototype.slice.call(arguments, 1);\n            var dm = _getDragManager(this);\n            _jp.each(el, function(_el) {\n                _el = [ _jp.getElement(_el) ];\n                _el.push.apply(_el, specs );\n                dm.setPosse.apply(dm, _el);\n            });\n        },\n        removeFromPosse:function(el, posseId) {\n            var specs = Array.prototype.slice.call(arguments, 1);\n            var dm = _getDragManager(this);\n            _jp.each(el, function(_el) {\n                _el = [ _jp.getElement(_el) ];\n                _el.push.apply(_el, specs );\n                dm.removeFromPosse.apply(dm, _el);\n            });\n        },\n        removeFromAllPosses:function(el) {\n            var dm = _getDragManager(this);\n            _jp.each(el, function(_el) { dm.removeFromAllPosses(_jp.getElement(_el)); });\n        },\n        setPosseState:function(el, posseId, state) {\n            var dm = _getDragManager(this);\n            _jp.each(el, function(_el) { dm.setPosseState(_jp.getElement(_el), posseId, state); });\n        },\n        dragEvents: {\n            'start': 'start', 'stop': 'stop', 'drag': 'drag', 'step': 'step',\n            'over': 'over', 'out': 'out', 'drop': 'drop', 'complete': 'complete',\n            'beforeStart':'beforeStart'\n        },\n        animEvents: {\n            'step': \"step\", 'complete': 'complete'\n        },\n        stopDrag: function (el) {\n            if (el._katavorioDrag) {\n                el._katavorioDrag.abort();\n            }\n        },\n        addToDragSelection: function (spec) {\n            var el = this.getElement(spec);\n            if (el != null && (el._isJsPlumbGroup || el._jsPlumbGroup == null)) {\n                _getDragManager(this).select(spec);\n            }\n        },\n        removeFromDragSelection: function (spec) {\n            _getDragManager(this).deselect(spec);\n        },\n        getDragSelection:function() {\n            return _getDragManager(this).getSelection();\n        },\n        clearDragSelection: function () {\n            _getDragManager(this).deselectAll();\n        },\n        trigger: function (el, event, originalEvent, payload) {\n            this.getEventManager().trigger(el, event, originalEvent, payload);\n        },\n        doReset:function() {\n            // look for katavorio instances and reset each one if found.\n            for (var key in this) {\n                if (key.indexOf(\"_katavorio_\") === 0) {\n                    this[key].reset();\n                }\n            }\n        },\n        getEventManager:function() {\n            return _getEventManager(this);\n        },\n        on : function(el, event, callback) {\n            // TODO: here we would like to map the tap event if we know its\n            // an internal bind to a click. we have to know its internal because only\n            // then can we be sure that the UP event wont be consumed (tap is a synthesized\n            // event from a mousedown followed by a mouseup).\n            //event = { \"click\":\"tap\", \"dblclick\":\"dbltap\"}[event] || event;\n            this.getEventManager().on.apply(this, arguments);\n            return this;\n        },\n        off : function(el, event, callback) {\n            this.getEventManager().off.apply(this, arguments);\n            return this;\n        }\n\n    });\n\n    var ready = function (f) {\n        var _do = function () {\n            if (/complete|loaded|interactive/.test(document.readyState) && typeof(document.body) !== \"undefined\" && document.body != null) {\n                f();\n            }\n            else {\n                setTimeout(_do, 9);\n            }\n        };\n\n        _do();\n    };\n    ready(_jp.init);\n\n}).call(typeof window !== 'undefined' ? window : this);\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { DesignComponent } from './design.component';\nimport { WorkflowStudioRootComponent } from './workflow-studio-root/workflow-studio-root.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: DesignComponent,\n  },\n\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class DesignRoutingModule { }\n","import { Component, OnInit, OnDestroy, AfterViewInit, AfterContentInit, ViewEncapsulation, Input, ViewContainerRef, ViewChild } from '@angular/core';\nimport { Observable, Subscription } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Paginated } from '@feathersjs/feathers';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { DataService } from '../core/services/data.service';\n\nimport { NodeService } from './node.service';\n\n@Component({\n  selector: 'app-design',\n  templateUrl: './design.component.html',\n  styleUrls: ['./design.component.scss']\n\n})\nexport class DesignComponent implements OnInit, AfterViewInit {\n\n\tterraformModules$: Observable<any>;\n  ansibleWorkflows$: Observable<any>;\n  pwshScripts$: Observable<any>;\n    \n\n  nodes = [];\n\n  loading: boolean = true;\n\n  nodes$: Observable<any>;\n  connections$: Observable<any>;\n\n  workflow: any;\n\n  connections = [];\n\n  showNodeConfig: boolean = false;\n  currentNode: any = null;\n\n  // @ViewChild('nodes', { read: ViewContainerRef }) viewContainerRef;\n\n\n\n  rootDirectory: any[] = [\n    {\n        name: \"Terraform Modules\",\n        icon: \"terraform\",\n        expanded: true,\n        files: [\n            {\n                icon: \"file\",\n                name: \"Calendar\",\n                active: true\n            },\n            {\n                icon: \"line-chart\",\n                name: \"Charts\",\n                active: false\n            },\n            {\n                icon: \"dashboard\",\n                name: \"Dashboard\",\n                active: false\n            },\n            {\n                icon: \"map\",\n                name: \"Maps\",\n                active: false\n            },\n            \n        ]\n    }\n];\n\n  constructor(\n      private dataService: DataService,\n      private nodeService: NodeService,\n      private activatedRoute: ActivatedRoute\n  ) { }\n\n  ngOnInit(): void {\n\t\t// this.terraformModules$ = this.dataService.records$('api/terraform/modules', {})\n\t\t// \t.pipe(\n\t\t// \t\tmap(( r: Paginated<any>) => r.data)\n\t\t// \t)\n\n\t\t// this.terraformModules$.subscribe( data => {\n\n    //   for ( var d in data ) {\n    //     data[d].node_type = 'terraform-module'\n    //   }\n\t\t// \tthis.rootDirectory[0].files = data;\n\t\t// })\n\n\t\t// this.ansibleWorkflows$ = this.dataService.records$('api/tower/workflows', {})\n\t\t// \t.pipe(\n\t\t// \t\tmap(( r: Paginated<any>) => r.data)\n\t\t// \t)\n\n    // this.pwshScripts$ = this.dataService.records$('api/scripts/pwsh', {})\n\t\t// \t.pipe(\n\t\t// \t\tmap(( r: Paginated<any>) => r.data)\n\t\t// \t)\n\t\t// this.ansibleWorkflows$.subscribe( data => {\n    //   for ( var d in data ) {\n    //     data[d].node_type = 'tower-workflow'\n    //   }\n\t\t// \t  this.rootDirectory[1].files = data;\n    // });\n        \n        //this.fillFromJson();\n\n    // this.activatedRoute.params.subscribe( params => {\n    //   this.workflow = params.id;\n    //   // this.nodes$ = this.dataService.records$('api/workflow-nodes', {\n    //   //   _workflow: this.workflow,\n    //   //   $sort: {\n    //   //     order: 1\n    //   //   }\n    //   // })\n    //   // .pipe(\n    //   //   map(( r: Paginated<any>) => r.data)\n    //   // )\n\n    //   // this.connections$ = this.dataService.records$('api/workflow-connections', {\n    //   //   _workflow: this.workflow\n    //   // })\n    //   // .pipe(\n    //   //   map(( r: Paginated<any>) => r.data)\n    //   // )\n\n    // })\n  }\n\n  // loadConnections() {\n  //   this.dataService.getRecord('api/catalog-workflows', this.workflow)\n  //     .then( wf => {\n  //       if(wf.node_connections) {\n  //         wf.node_connections.forEach( c => {\n  //           this.nodeService.addConnection(c);\n  //         });\n  //       }\n\n  //     });\n  // }\n\n  ngAfterViewInit() {\n\n    // this.nodeService.showNodeDetails$.subscribe( t => {\n    //   this.showNodeConfig = t;\n    // });\n\n    // this.nodeService.currentNodeDetails$.subscribe( n => {\n    //   this.currentNode = n;\n    // });\n\n    // this.nodeService\n    // this.nodeService.setRootViewContainerRef(this.viewContainerRef);\n\n    // this.dataService.findRecords('api/workflow-nodes', {\n    //   _workflow: this.workflow\n    // })\n    // .then( res => {\n\n    //   let nodeCount = 0;\n    //   res.data.forEach( n => {\n    //     this.nodeService.addDynamicNode(n);\n\n      \n    //   })\n      \n    // })\n    // .then( () => {\n    //   setTimeout( () => {\n    //     this.loadConnections();\n    //     this.loading = false;\n    //   }, 5000);\n    // })\n  }\n\n\n  openFile(directoryName: string, fileName: string) {\n  }\n\n  files: any[] = [{ name: 'img_001.jpg' }, { name: 'img_002.jpg' }, { name: 'img_003.jpg' }];\n  activeDemoVariant = 'basic-draggable';\n  droppedFiles: any[] = [];\n\n  private moveItem(item: any, from: any[], to: any[]) {\n    const indexInFiles = from.indexOf(item);\n    if (indexInFiles > -1) {\n      from.splice(indexInFiles, 1);\n    }\n    if (to.indexOf(item) === -1) {\n      to.push(item);\n    }\n  }\n\n//   {\"id\":\"Step_0 id: b46a17\",\"top\":177,\"left\":146}\n  onResourceDrop(dropEvent) {\n      console.log(dropEvent)\n\n      let newNode = {\n        type: dropEvent.dragDataTransfer.node_type,\n        _parent: dropEvent.dragDataTransfer._id,\n        _workflow: this.workflow,\n        icon: dropEvent.dragDataTransfer.icon,\n        name: dropEvent.dragDataTransfer.name,\n        description: dropEvent.dragDataTransfer.description,\n        left: dropEvent.dropPointPosition.pageX - 216,\n        top: dropEvent.dropPointPosition.pageY - 60,\n        order: dropEvent.dropPointPosition.pageY - 60\n      }\n\n      \n\n      this.dataService.createRecord('api/workflow-nodes', newNode)\n        .then( n => {\n          this.nodeService.addDynamicNode(n);\n        })\n      // this.nodeService.addDynamicNode({\n      //     id: dropEvent.dragDataTransfer.name,\n      //     top: 100,\n      //     left: 200\n      // });\n  }\n\n  configureNode(n) {\n    this.showNodeConfig = true;\n    this.currentNode = n;\n  }\n  deleteNode(n) {\n    if( this.currentNode._id == n._id ) {\n      this.showNodeConfig = false;\n    };\n\n    this.dataService.updateRecord('api/workflow-nodes', n._id, { deleted: true });\n  }\n\n\n  // onSaveWorkflow() {\n\n  //     //save element position on Canvas and node conections\n  \n  //     const container = this.viewContainerRef.element.nativeElement.parentNode;\n  //     const nodes = Array.from(container.querySelectorAll('.node')).map((node: HTMLDivElement) => {\n  //       return {\n  //         id: node.id,\n  //         top: node.offsetTop,\n  //         left: node.offsetLeft\n  //       }\n  //     });\n  \n  //     nodes.forEach( n => {\n  //       this.dataService.updateRecord('api/workflow-nodes', n.id, n);\n  //     })\n  \n  //     const connections = (this.nodeService.jsPlumbInstance.getAllConnections() as any[])\n  //         .map((conn) => ({ uuids: conn.getUuids() }));\n\n  //     this.dataService.updateRecord('api/catalog-workflows', this.workflow, { node_connections: connections })\n  \n  //     // connections.forEach( (c:any)=> {\n  //     //   c._workflow = this.workflow;\n  //     //   this.dataService.findRecords('api/workflow-connections', {\n  //     //     _workflow: this.workflow\n  //     //   })\n  //     //   .then( res => {\n  \n  //     //   })\n  //     //   .then( () => {\n  //     //     // res.data.forEach(w => {\n  //     //     //   this.dataService.deleteRecord('api/workflow-connections', w._id, w);\n  //     //     // });\n  //     //     this.dataService.createRecord('api/workflow-connections', c);\n  //     //   })\n  \n        \n  //     // })\n  \n  //     // const json = JSON.stringify({ nodes, connections });\n  \n  //     // console.log(json);\n\n  // }\n\n}\n","<div class=\"main-container\">\n  <!-- <div class=\"alert alert-app-level\">\n      ...\n  </div> -->\n  <nav class=\"subnav\">\n    <ul class=\"nav\">\n      <li class=\"nav-item\">\n        <a class=\"nav-link\" routerLink=\"/pages/home\" routerLinkActive=\"active\">Home</a>\n      </li>\n      <li class=\"nav-item\">\n        <a class=\"nav-link\" routerLink=\"/pages/catalog\" routerLinkActive=\"active\">Catalog</a>\n      </li>\n      <li class=\"nav-item\">\n        <a class=\"nav-link\" routerLink=\"/pages/requests\" routerLinkActive=\"active\">Requests</a>\n      </li>\n      <li class=\"nav-item\">\n        <a class=\"nav-link\" routerLink=\"/pages/approvals\" routerLinkActive=\"active\">Approvals</a>\n      </li>\n    </ul>\n  </nav>\n  <div class=\"content-container\">\n    <div class=\"content-area\">\n      <router-outlet></router-outlet>\n    </div>\n    <!-- <nav class=\"sidenav\">\n        ...\n    </nav> -->\n  </div>\n</div>","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { DesignRoutingModule } from './design-routing.module';\n\nimport { AngularSplitModule } from 'angular-split';\nimport { DesignComponent } from './design.component';\nimport { SharedModule } from '../shared/shared.module';\nimport { ClarityModule } from '@clr/angular';\nimport { WorkflowStudioRootComponent } from './workflow-studio-root/workflow-studio-root.component';\nimport { NodesContainerComponent } from './nodes-container/nodes-container.component';\nimport { NodeService } from './node.service';\nimport { NodeComponent } from './node.component';\nimport { WorkflowNodeDetailsComponent } from './workflow-node-details/workflow-node-details.component';\n\n\n@NgModule({\n  declarations: [DesignComponent, WorkflowStudioRootComponent, NodesContainerComponent, NodeComponent, WorkflowNodeDetailsComponent],\n  imports: [\n    CommonModule,\n    ClarityModule,\n    SharedModule,\n    AngularSplitModule,\n    DesignRoutingModule\n  ],\n  entryComponents: [\n    NodeComponent\n  ],\n  providers: [\n    NodeService\n  ]\n})\nexport class DesignModule { }\n","import { Component, Input, AfterViewInit, ViewEncapsulation } from '@angular/core';\nimport { NodeService } from './node.service';\n\nexport interface Node {\n  id: string,\n  _id: string;\n  type: string,\n  name: string,\n  icon: string,\n  _workflow: string,\n  top?: number;\n  left?: number\n}\n\n\n\n@Component({\n  selector: 'node',\n  templateUrl: './node.component.html',\n  encapsulation: ViewEncapsulation.None\n})\nexport class NodeComponent implements AfterViewInit {\n  @Input() node: any;\n\n  @Input('showNodeConfig') showNodeConfig: any;\n\n  @Input() jsPlumbInstance;\n\n\n  connectorPaintStyle = {\n    strokeWidth: 2,\n    stroke: \"#61B7CF\",\n    joinstyle: \"flow\",\n    outlineStroke: \"white\",\n    outlineWidth: 0\n  }\n  // .. and this is the hover style.\n  connectorHoverStyle = {\n    strokeWidth: 5,\n    stroke: \"#216477\",\n    outlineWidth: 0,\n    outlineStroke: \"white\"\n  }\n  endpointHoverStyle = {\n    fill: \"#216477\",\n    stroke: \"#216477\"\n  }\n  // the definition of source endpoints (the small blue ones)\n  sourceEndpoint = {\n    endpoint: \"Dot\",\n    paintStyle: {\n        stroke: \"#7AB02C\",\n        fill: \"transparent\",\n        radius: 10,\n        strokeWidth: 2\n    },\n    isSource: true,\n    connector: [ \"Flowchart\", { stub: [40, 60], gap: 10, cornerRadius: 5, alwaysRespectStubs: true } ],\n    connectorStyle: this.connectorPaintStyle,\n    hoverPaintStyle: this.endpointHoverStyle,\n    connectorHoverStyle: this.connectorHoverStyle,\n    dragOptions: {},\n    overlays: [\n        [ \"Label\", {\n            location: [0.5, 1.5],\n            label: \"OUT\",\n            cssClass: \"endpointSourceLabel\",\n            visible:true\n        } ]\n    ]\n  }\n  // the definition of target endpoints (will appear when the user drags a connection)\n  targetEndpoint = {\n    endpoint: \"Dot\",\n    paintStyle: { fill: \"#7AB02C\", radius: 10 },\n    hoverPaintStyle: this.endpointHoverStyle,\n    maxConnections: 10,\n    dropOptions: { hoverClass: \"hover\", activeClass: \"active\" },\n    isTarget: true,\n    overlays: [\n        [ \"Label\", { location: [0.5, 1.5], label: \"IN\", cssClass: \"endpointTargetLabel\", visible:true } ]\n    ]\n  }\n\n\n  sourceAnchors = [\n    [ 0, 1, 0, 1 ],\n    [ 0.25, 1, 0, 1 ],\n    [ 0.5, 1, 0, 1 ],\n    [ 0.75, 1, 0, 1 ],\n    [ 1, 1, 0, 1 ]\n  ];\n\n  constructor(\n    private nodeService: NodeService\n  ) {\n\n  }\n\n\n  handleClick(event, node) {\n    if(event.metaKey) {\n      let endpoints = this.jsPlumbInstance.getEndpoints(node._id)\n      console.log(endpoints)\n      if(endpoints.length == 2) {\n        this.jsPlumbInstance.addEndpoint(node._id, { anchor: 'TopRight', uuid: node._id + new Date() }, this.sourceEndpoint);\n      }\n      else {\n\n          alert('NO MORE!')\n\n      }\n      \n    }\n  }\n\n  ngAfterViewInit() {\n\n\n\n    // this is the paint style for the connecting lines..\n\n    const id = this.node._id;\n    \n    this.jsPlumbInstance.batch( () => {\n      this._addEndpoints(id, [\"BottomRight\"], [\"TopLeft\"]);\n    })\n    \n    //this.jsPlumbInstance.fire(\"jsPlumbDemoLoaded\", this.jsPlumbInstance);\n    //this.jsPlumbInstance.addEndpoint(id, { anchor: 'TopCenter', uuid: id + '_top' }, targetEndpoint);\n    this.jsPlumbInstance.draggable(id);\n\n\n\n\n    console.log(this.jsPlumbInstance);\n  }\n  _addEndpoints (toId, sourceAnchors, targetAnchors) {\n    for (var i = 0; i < sourceAnchors.length; i++) {\n        var sourceUUID = toId + sourceAnchors[i];\n        this.jsPlumbInstance.addEndpoint(toId, this.sourceEndpoint, {\n            anchor: sourceAnchors[i], uuid: sourceUUID\n        });\n    }\n    for (var j = 0; j < targetAnchors.length; j++) {\n        var targetUUID = toId + targetAnchors[j];\n        this.jsPlumbInstance.addEndpoint(toId, this.targetEndpoint, { anchor: targetAnchors[j], uuid: targetUUID });\n    }\n  };\n\n  loadNodeDetails(n) {\n    console.log('\\n\\n---- NODE ----');\n    console.log(n)\n    this.nodeService.showDetails(n);\n  }\n}\n\n\n"," <div class=\"node studio-component-node\" id=\"{{node._id}}\" [style.top.px]=\"node.top || 0\" [style.left.px]=\"node.left || 20\">\n  \n     <div class=\"studio-node-data\" style=\"height: 100%\">\n    \n      <a (click)=\"handleClick($event, node);\" style=\"margin-top: 0px !important\" (dblclick)=\"loadNodeDetails(node)\" href=\"javascript://\" class=\"card clickable\">\n        <div class=\"card-block\">\n          <div class=\"progress danger top\">\n            <progress value=\"100\" max=\"100\"></progress>\n          </div>\n          <p class=\"card-text flex-container\">\n            <span style=\"margin-right: 10px;\">\n              <clr-icon [attr.shape]=\"node.icon\"></clr-icon>\n            </span>\n            <span>\n              {{ node.name }}\n            </span>\n          </p>\n        </div>\n      </a>\n    \n     </div>\n\n   </div>\n\n\n<style>\n.flex-container {\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.flex-container > a {\n  width: 300px;\n  height: 200px;\n  margin: 10px;\n}\n</style>","import {\n  ComponentRef,\n  ComponentFactoryResolver,\n  Injectable,\n  Inject,\n  ReflectiveInjector\n} from '@angular/core';\nimport { jsPlumb } from 'jsplumb';\n\nimport { NodeComponent, Node } from './node.component';\nimport { Subscribable, Subject } from 'rxjs';\n\n@Injectable()\nexport class NodeService {\n\n  private rootViewContainer: any;\n\n  showNodeDetails = new Subject<boolean>();\n  showNodeDetails$ = this.showNodeDetails.asObservable();\n\n  currentNodeDetails = new Subject<any>();\n  currentNodeDetails$ = this.currentNodeDetails.asObservable();\n\n  jsPlumbInstance = jsPlumb.getInstance({\n    // drag options\n    DragOptions: { cursor: \"pointer\", zIndex: 2000 },\n    // default to a gradient stroke from blue to green.\n    PaintStyle: {\n      // @ts-ignore\n        gradient: { stops: [\n            [ 0, \"#0d78bc\" ],\n            [ 1, \"#558822\" ] \n        ] },\n        stroke: \"#558822\",\n        strokeWidth: 10\n    },\n    Container: \"canvas\"\n});\n\n  constructor(private factoryResolver: ComponentFactoryResolver) { }\n\n  public setRootViewContainerRef(viewContainerRef) {\n    console.log('\\n\\n ---- SET VIEW ----');\n    console.log(viewContainerRef);\n    this.rootViewContainer = viewContainerRef;\n  }\n\n  public addDynamicNode(node: any) {\n    const factory = this.factoryResolver.resolveComponentFactory(NodeComponent);\n    const component = factory.create(this.rootViewContainer.parentInjector);\n    (<any>component.instance).node = node;\n    (<any>component.instance).jsPlumbInstance = this.jsPlumbInstance;\n    this.rootViewContainer.insert(component.hostView);\n    //console.log(\"in NodeService..\" , component.instance );\n  }\n \n  addConnection(connection) {\n    //console.log(connection)\n    this.jsPlumbInstance.connect({ uuids: connection.uuids });\n  }\n\n  showDetails(node) {\n    this.currentNodeDetails.next(node);\n    this.showNodeDetails.next(true);\n  }\n\n  hideDetails() {\n    this.showNodeDetails.next(false)\n  }\n\n  setCurrentNode() {\n    \n  }\n\n  public clear() {\n    this.rootViewContainer.clear();\n  }\n}\n\n","import { Component, OnInit, OnChanges, Input, ChangeDetectionStrategy, ViewContainerRef, ViewChild, ComponentFactoryResolver, AfterViewInit, ViewEncapsulation } from '@angular/core';\nimport { NodeService } from '../node.service';\nimport { DataService } from '../../core/services/data.service';\nimport { Subject, Subscribable } from 'rxjs';\n\n\n\n@Component({\n  selector: 'nodes-container',\n  templateUrl: './nodes-container.component.html',\n  styleUrls: ['./nodes-container.component.scss'],\n  encapsulation: ViewEncapsulation.None\n // changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class NodesContainerComponent implements OnInit, AfterViewInit {\n  @Input() nodes = [];\n\n  @Input() connections = [];\n\n  @Input() workflow: any;\n\n  @Input('showNodeConfig') showNodeConfig: any;\n\n  \n\n  // @ViewChild('nodes', { read: ViewContainerRef }) viewContainerRef: ViewContainerRef;\n\n  @ViewChild('nodes', { read: ViewContainerRef }) viewContainerRef;\n\n  constructor(\n    private r: ComponentFactoryResolver,\n    private nodeService: NodeService,\n    private dataService: DataService\n  ) {}\n\n  ngOnInit() {\n\n    \n\n  }  \n\n \n\n\n  loadConnections() {\n    for ( var c in this.connections ) {\n      this.nodeService.addConnection(this.connections[c])\n    }\n\n    return true;\n  }\n\n  ngAfterViewInit() {\n    //console.log(this.viewContainerRef);\n    this.nodeService.setRootViewContainerRef(this.viewContainerRef);\n\n    //console.log(this.nodeService);\n\n\n    let nodesAdded = 0;\n    this.nodes.forEach(n => {\n      this.nodeService.addDynamicNode(n);\n\n      nodesAdded++;\n\n      if(nodesAdded == this.nodes.length) {\n        //this.loadConnections();\n\n        console.log(nodesAdded);\n        console.log(this.nodes.length)\n      }\n    })\n\n    // this.connections.forEach(conn => {\n    //   this.nodeService.addConnection(conn);\n    // })\n    \n    // setTimeout(() => {\n    //   this.connections.forEach(connection => {\n    //     console.log(connection)\n    //     this.nodeService.addConnection(connection);\n    //   });\n    // }, )\n  }\n\n  addNode() {\n\n  }\n\n  saveNodeJson(){\n    //save element position on Canvas and node conections\n\n    const container = this.viewContainerRef.element.nativeElement.parentNode;\n    const nodes = Array.from(container.querySelectorAll('.node')).map((node: HTMLDivElement) => {\n      return {\n        id: node.id,\n        top: node.offsetTop,\n        left: node.offsetLeft\n      }\n    });\n\n    nodes.forEach( n => {\n      this.dataService.updateRecord('api/workflow-nodes', n.id, n);\n    })\n\n    const connections = (this.nodeService.jsPlumbInstance.getAllConnections() as any[])\n        .map((conn) => ({ uuids: conn.getUuids() }));\n\n    connections.forEach( (c:any)=> {\n      c._workflow = this.workflow;\n      this.dataService.findRecords('api/workflow-connections', {\n        _workflow: this.workflow\n      })\n      .then( res => {\n\n      })\n      .then( () => {\n        // res.data.forEach(w => {\n        //   this.dataService.deleteRecord('api/workflow-connections', w._id, w);\n        // });\n        this.dataService.createRecord('api/workflow-connections', c);\n      })\n\n      \n    })\n\n    const json = JSON.stringify({ nodes, connections });\n\n    console.log(json);\n  }\n  \n}","<!-- <div class=\"nodes-container studio-canvas\">\n  <button (click)=\"saveNodeJson();\">SAVE</button>\n  <div class=\"nodes\" style=\"height: 100%;\">\n    <ng-template class=\"ss-node\" #nodes></ng-template>\n  </div>\n</div> -->\n\n\n<div id=\"canvas\" class=\"nodes-container studio-canvas\">\n  <button (click)=\"saveNodeJson();\">SAVE</button>\n  <div class=\"nodes\" style=\"height: 100%;\">\n    <ng-template class=\"ss-node\" #nodes [showNodesConfig]=\"showNodesConfig\"></ng-template>\n  </div>\n</div>","import { Component, OnInit, OnDestroy, AfterViewInit, AfterContentInit, Input } from '@angular/core';\nimport { Observable, Subscription } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Paginated } from '@feathersjs/feathers';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { DataService } from '../../core/services/data.service';\nimport { NodeService } from '../node.service';\n\n\n@Component({\n  selector: 'workflow-node-details',\n  templateUrl: './workflow-node-details.component.html',\n  styleUrls: ['./workflow-node-details.component.scss']\n})\nexport class WorkflowNodeDetailsComponent implements OnInit {\n\n  @Input('node') node: any;\n  @Input('showDetails') showDetails: boolean;\n\n  table: any;\n\n  parentVariables$: Observable<any>;\n  parent$: Observable<any>;\n\n  node_vars = [];\n\n  constructor(\n    private dataService: DataService,\n    private nodeService: NodeService\n  ) { }\n\n  ngOnInit(): void {\n\n    console.log(this.node)\n\n    if(this.node.type == 'terraform-module') {\n      this.parentVariables$ = this.dataService.records$('api/terraform/module-variables', {\n        _parent: this.node._parent\n      })\n      .pipe(\n        map(( r: Paginated<any>) => r.data)\n      )\n\n      this.parentVariables$.subscribe( vars => {\n\n        vars.forEach(v => {\n          this.node_vars.push(v);\n        });\n        \n\n        // this.dataService.createRecord('api/workflow-node-variables', v);\n      })\n\n      this.parent$ = this.dataService.record$('api/terraform/module', this.node._parent);\n\n    }\n  }\n\n  addNodeConnector() {\n\n  }\n\n  saveNode(){\n    this.dataService.updateRecord('api/workflow-nodes', this.node._id, this.node);\n  }\n\n  deleteNode() {\n    this.dataService.updateRecord('api/workflow-nodes', this.node._id, { deleted: true });\n    \n  }\n\n  syncVariablesFromParentModule() {\n\n    this.dataService.findRecords('api/terraform/module-variables', {\n      _parent: this.node._parent\n    })\n    .then( res => {\n      res.data.forEach( v => {\n        v._parent = this.node._id;\n        // v._parent_module = v._parent;\n\n        v._id = this.node._id + v._id;\n\n\n        this.dataService.getRecord('api/workflow-node-variables', v._id)\n          .then( res => {\n            this.dataService.updateRecord('api/workflow-node-variables', v._id, v);\n          })\n          .catch( () => {\n            this.dataService.createRecord('api/workflow-node-variables', v);\n          })\n\n      });\n    })\n  }\n\n}\n","<div class=\"module-content-container\">\n  <div class=\"module-header-wrapper\" style=\"border-bottom: 1px solid #cccccc;\">\n    <div class=\"module-header-container\" class=\"flex-container\"  style=\"padding: 15px;\">\n\n      <div class=\"module-branding\">\n        <div class=\"module-brand\">\n          <clr-icon class=\"is-solid\" style=\"margin-right: 10px;\" [attr.shape]=\"node.icon\"></clr-icon>\n          <span class=\"module-title\">\n            {{ node.name }}\n          </span>\n\n        </div>\n      </div>\n\n      <div class=\"module-nav\" style=\"margin-left: 25px;\">\n        <!-- <a href=\"javascript://\" class=\"nav-link nav-icon\">\n          <clr-icon shape=\"plus-circle\" class=\"is-solid\"></clr-icon>\n        </a> -->\n      </div>\n\n    </div>\n\n  </div>\n\n\n  <div class=\"module-content-area\" style=\"padding: 10px;\">\n\n    <!-- <div class=\"btn-group btn-outline-primary btn-sm\">\n      <button class=\"btn\" (click)=\"addNodeConnector();\">Add Connector</button>\n      <button class=\"btn\">Edit</button>\n      <button class=\"btn\">Download</button>\n      <button class=\"btn\">Delete</button>\n    </div> -->\n\n    <clr-tabs>\n      <clr-tab>\n          <button clrTabLink id=\"link1\">Resource Details</button>\n          <clr-tab-content id=\"content1\" *clrIfActive>\n            <form clrForm>\n              <clr-input-container>\n                <label>Name</label>\n                <input clrInput placeholder=\"Fill me in, scotty!\" name=\"name\" [(ngModel)]=\"node.name\" />\n                <clr-control-helper>This is a label that overrides the how the resource is displayed on workflows and in the catalog.</clr-control-helper>\n              </clr-input-container>\n\n              <clr-input-container>\n                <label>Icon</label>\n                <input clrInput placeholder=\"Fill me in, scotty!\" name=\"icon\" [(ngModel)]=\"node.icon\" />\n                <clr-control-helper>The icon displayed on the workflow and in the catalog.</clr-control-helper>\n              </clr-input-container>\n\n\n\n              <clr-textarea-container>\n                <label>Description</label>\n                <textarea clrTextarea placeholder=\"Fill me in, scotty!\" name=\"description\" [(ngModel)]=\"node.description\"></textarea>\n                <clr-control-helper>The description of the resource displayed on the workflow and in the catalog.</clr-control-helper>\n              </clr-textarea-container>\n            </form>\n\n\n            <button (click)=\"saveNode();\" class=\"btn btn-sm btn-primary\">Save</button>\n            <button (click)=\"deleteNode();\" class=\"btn btn-sm btn-danger\">Delete</button>\n          </clr-tab-content>\n      </clr-tab>\n\n      <clr-tab>\n        <button clrTabLink>Resource Variables</button>\n        <clr-tab-content *clrIfActive>\n\n\n          <div class=\"module-variables-container\" style=\"margin-top: 10px; height: 80% !important;\">\n            <app-records-list-view [table]=\"'workflowNodeVariables'\" [filterOnParent]=\"true\" [parentId]=\"node._id\"></app-records-list-view>\n          </div>\n\n          <button (click)=\"syncVariablesFromParentModule();\" class=\"btn btn-sm\">Sync From Parent Module</button>\n\n          \n        </clr-tab-content>\n    </clr-tab>\n      <clr-tab>\n          <button clrTabLink>Module Variables</button>\n          <clr-tab-content *clrIfActive>\n            <div class=\"module-variables-container\" style=\"margin-top: 10px; height: 50% !important;\">\n              <app-records-list-view [table]=\"'moduleVariables'\" [filterOnParent]=\"true\" [parentId]=\"node._parent\"></app-records-list-view>\n            </div>\n            \n          </clr-tab-content>\n      </clr-tab>\n    </clr-tabs>\n\n  \n  </div>\n\n</div>\n\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-workflow-studio-root',\n  templateUrl: './workflow-studio-root.component.html',\n  styleUrls: ['./workflow-studio-root.component.scss']\n})\nexport class WorkflowStudioRootComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<p>workflow-studio-root works!</p>\n"]}